# 🏗️ System Design: Блок 1 - Основы и фундамент

---

## 📊 Обзор блока
**Продолжительность:** 4-6 недель  
**Временные затраты:** 8-12 часов в неделю  
**Цель:** Заложить прочную теоретическую базу и понимание ключевых концепций

```
Неделя 1-2: Введение в System Design
    ├── Что такое System Design
    └── Основные принципы архитектуры

Неделя 3-4: Сетевые основы
    ├── Клиент-серверная архитектура  
    └── Протоколы HTTP/HTTPS, TCP/UDP

Неделя 5-6: Хранение данных
    ├── Базы данных: SQL vs NoSQL
    └── Кэширование: основы и стратегии
```

---

## 📅 Неделя 1-2: Введение в System Design

### 🎯 Глава 1.1: Что такое System Design и зачем он нужен

#### 📚 Теория (2 часа)

**System Design** — это процесс определения архитектуры, компонентов, модулей, интерфейсов и данных системы для удовлетворения указанных требований.

```
┌─────────────────────────────────────────────┐
│                ЗАЧЕМ НУЖЕН                  │
│              SYSTEM DESIGN?                 │
├─────────────────────────────────────────────┤
│                                             │
│  📈 Масштабируемость                        │
│      Система готова к росту пользователей   │
│                                             │
│  🛡️ Надежность                              │
│      Минимум простоев и сбоев               │
│                                             │
│  ⚡ Производительность                       │
│      Быстрый отклик системы                 │
│                                             │
│  💰 Экономическая эффективность              │
│      Оптимальные затраты на инфраструктуру  │
│                                             │
│  🔧 Поддерживаемость                        │
│      Легко вносить изменения и исправления  │
│                                             │
└─────────────────────────────────────────────┘
```

#### 💡 Ключевые концепции:

**Стоимость изменений на разных этапах:**
```
Требования  →  Дизайн  →  Кодирование  →  Тестирование  →  Продакшн
    $1           $10         $100           $1,000         $10,000
```

**Роль архитектора в команде:**
- 🎨 **Визионер** - видит общую картину
- 🔗 **Интегратор** - связывает разные части системы  
- 📋 **Планировщик** - определяет техническую стратегию
- 🗣️ **Коммуникатор** - объясняет решения команде

#### 🛠️ Практика (3 часа)

**Задание 1:** Анализ архитектуры знакомых приложений

```
┌─────────────┐    HTTP/HTTPS     ┌─────────────┐
│   WhatsApp  │ ◄───────────────► │   Сервер    │
│  (Клиент)   │                   │ обработки   │
└─────────────┘                   │ сообщений   │
                                  └─────────────┘
                                         │
                                         ▼
                                  ┌─────────────┐
                                  │ База данных │
                                  │  сообщений  │
                                  └─────────────┘
```

**Задание 2:** Создание простой диаграммы веб-приложения
```
┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│             │    │             │    │             │
│   Browser   │◄──►│ Web Server  │◄──►│  Database   │
│             │    │             │    │             │
└─────────────┘    └─────────────┘    └─────────────┘
```

---

### 🏛️ Глава 1.2: Основные принципы архитектуры систем

#### 📚 Теория (2 часа)

**SOLID принципы в контексте систем:**

```
┌─────────────────────────────────────────────┐
│                SOLID                        │
├─────────────────────────────────────────────┤
│                                             │
│  S - Single Responsibility Principle        │
│      Один сервис = одна ответственность     │
│                                             │
│  O - Open/Closed Principle                  │
│      Открыт для расширения, закрыт для      │
│      модификации                            │
│                                             │
│  L - Liskov Substitution Principle          │
│      Компоненты должны быть взаимозаменяемы │
│                                             │
│  I - Interface Segregation Principle        │
│      Множество специализированных           │
│      интерфейсов лучше одного универсального│
│                                             │
│  D - Dependency Inversion Principle         │
│      Зависимость от абстракций, а не от     │
│      конкретных реализаций                  │
│                                             │
└─────────────────────────────────────────────┘
```

**Separation of Concerns:**
```
┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐
│   Presentation  │  │   Business      │  │   Data Access   │
│     Layer       │  │     Logic       │  │     Layer       │
│                 │  │     Layer       │  │                 │
│ • UI/UX         │  │ • Validation    │  │ • Database      │
│ • User Input    │  │ • Calculations  │  │ • File Storage  │
│ • Display       │  │ • Workflows     │  │ • APIs          │
└─────────────────┘  └─────────────────┘  └─────────────────┘
```

**Loose Coupling & High Cohesion:**
```
LOOSE COUPLING (Слабая связанность)
┌─────────┐    API    ┌─────────┐
│Service A│◄─────────►│Service B│
└─────────┘           └─────────┘
     ▲                    ▲
     │                    │
Минимальные       Независимые
зависимости        изменения

HIGH COHESION (Высокая связность)
┌─────────────────────┐
│     Service A       │
├─────────────────────┤
│ Все функции         │
│ логически связаны   │
│ и работают вместе   │
└─────────────────────┘
```

#### 🛠️ Практика (3 часа)

**Задание:** Рефакторинг монолитной схемы в модульную

**До (Монолит):**
```
┌─────────────────────────────────────┐
│           МОНОЛИТНОЕ                │
│          ПРИЛОЖЕНИЕ                 │
├─────────────────────────────────────┤
│ • Аутентификация                    │
│ • Управление пользователями         │
│ • Заказы                            │
│ • Платежи                           │
│ • Доставка                          │
│ • Уведомления                       │
│ • Отчеты                            │
└─────────────────────────────────────┘
```

**После (Модульная архитектура):**
```
┌─────────────┐  ┌─────────────┐  ┌─────────────┐
│    Auth     │  │    User     │  │   Orders    │
│   Service   │  │  Management │  │   Service   │
└─────────────┘  └─────────────┘  └─────────────┘
        │                │                │
        └────────────────┼────────────────┘
                         │
┌─────────────┐  ┌─────────────┐  ┌─────────────┐
│  Payments   │  │  Delivery   │  │ Notification│
│   Service   │  │   Service   │  │   Service   │
└─────────────┘  └─────────────┘  └─────────────┘
```

---

## 📅 Неделя 3-4: Сетевые основы и базы данных

### 🌐 Глава 1.3: Клиент-серверная архитектура

#### 📚 Теория (2 часа)

**Модель клиент-сервер:**
```
┌─────────────┐                    ┌─────────────┐
│   КЛИЕНТ    │    1. Запрос       │   СЕРВЕР    │
│             │ ─────────────────► │             │
│ • Веб-браузер│                   │ • Веб-сервер │
│ • Мобильное │    2. Ответ        │ • База данных│
│   приложение│ ◄───────────────── │ • Бизнес-    │
│ • Desktop   │                    │   логика    │
│   программа │                    │             │
└─────────────┘                    └─────────────┘
```

**Трехуровневая архитектура:**
```
┌─────────────────────────────────────────────────────┐
│                PRESENTATION TIER                    │
│            (Уровень представления)                  │
├─────────────────────────────────────────────────────┤
│ • Web browsers                                      │
│ • Mobile apps                                       │
│ • Desktop clients                                   │
└─────────────────────────────────────────────────────┘
                         │
                         ▼
┌─────────────────────────────────────────────────────┐
│                 APPLICATION TIER                    │
│               (Уровень приложения)                  │
├─────────────────────────────────────────────────────┤
│ • Web servers                                       │
│ • Application servers                               │
│ • Business logic                                    │
│ • API endpoints                                     │
└─────────────────────────────────────────────────────┘
                         │
                         ▼
┌─────────────────────────────────────────────────────┐
│                   DATA TIER                         │
│                (Уровень данных)                     │
├─────────────────────────────────────────────────────┤
│ • Database servers                                  │
│ • File systems                                      │
│ • Data warehouses                                   │
└─────────────────────────────────────────────────────┘
```

**Stateless vs Stateful:**
```
STATELESS (Без состояния)
┌─────────┐     Request     ┌─────────┐
│ Client  │ ──────────────► │ Server  │
└─────────┘                 └─────────┘
     │                           │
     │      Response             │
     │ ◄─────────────────────────┘
     │
Каждый запрос независим

STATEFUL (С состоянием)  
┌─────────┐     Session     ┌─────────┐
│ Client  │ ◄──────────────► │ Server  │
└─────────┘                 └─────────┘
     │                           │
     │                    ┌─────────┐
     │                    │ Session │
     │                    │  Store  │
     │                    └─────────┘
     │
Сервер помнит состояние клиента
```

#### 🛠️ Практика (3 часа)

**Задание:** Проектирование REST API для CRUD приложения

```
POST   /api/users          - Создать пользователя
GET    /api/users          - Получить всех пользователей  
GET    /api/users/{id}     - Получить пользователя по ID
PUT    /api/users/{id}     - Обновить пользователя
DELETE /api/users/{id}     - Удалить пользователя

POST   /api/posts          - Создать пост
GET    /api/posts          - Получить все посты
GET    /api/posts/{id}     - Получить пост по ID
PUT    /api/posts/{id}     - Обновить пост
DELETE /api/posts/{id}     - Удалить пост
```

**Диаграмма взаимодействия:**
```
┌─────────────┐    HTTP     ┌─────────────┐    SQL      ┌─────────────┐
│   Client    │ ─────────► │ REST API    │ ─────────► │  Database   │
│             │            │   Server    │            │             │
│ • React     │ ◄───────── │             │ ◄───────── │ • PostgreSQL│
│ • Angular   │  Response  │ • Node.js   │  Result    │ • MySQL     │
│ • Vue       │            │ • Python    │            │ • MongoDB   │
└─────────────┘            │ • Java      │            └─────────────┘
                           └─────────────┘
```

---

### 🔗 Глава 1.4: Протоколы HTTP/HTTPS, TCP/UDP

#### 📚 Теория (3 часа)

**HTTP методы и их применение:**
```
┌─────────────────────────────────────────────────────┐
│                 HTTP МЕТОДЫ                         │
├─────────────────────────────────────────────────────┤
│                                                     │
│  GET    │ Получение данных        │ Безопасный     │
│  POST   │ Создание ресурса        │ Не безопасный  │
│  PUT    │ Обновление ресурса      │ Идемпотентный  │
│  PATCH  │ Частичное обновление    │ Не идемпотентный│
│  DELETE │ Удаление ресурса        │ Идемпотентный  │
│  HEAD   │ Получение заголовков    │ Безопасный     │
│  OPTIONS│ Получение методов       │ Безопасный     │
│                                                     │
└─────────────────────────────────────────────────────┘
```

**HTTP Status Codes:**
```
┌─────────────────────────────────────────────────────┐
│              STATUS CODES                           │
├─────────────────────────────────────────────────────┤
│                                                     │
│  2xx - Успех                                        │
│  ├── 200 OK                                         │
│  ├── 201 Created                                    │
│  └── 204 No Content                                 │
│                                                     │
│  4xx - Ошибки клиента                               │
│  ├── 400 Bad Request                                │
│  ├── 401 Unauthorized                               │
│  ├── 403 Forbidden                                  │
│  ├── 404 Not Found                                  │
│  └── 429 Too Many Requests                          │
│                                                     │
│  5xx - Ошибки сервера                               │
│  ├── 500 Internal Server Error                      │
│  ├── 502 Bad Gateway                                │
│  └── 503 Service Unavailable                        │
│                                                     │
└─────────────────────────────────────────────────────┘
```

**HTTPS и SSL/TLS:**
```
HTTP (Незащищенный)
┌─────────┐    Plaintext    ┌─────────┐
│ Client  │ ─────────────► │ Server  │
└─────────┘                └─────────┘
    ⚠️ Данные могут быть перехвачены

HTTPS (Защищенный)
┌─────────┐   Encrypted    ┌─────────┐
│ Client  │ ═══════════► │ Server  │
└─────────┘               └─────────┘
    🔒 Данные зашифрованы
```

**TCP vs UDP:**
```
┌─────────────────┐              ┌─────────────────┐
│       TCP       │              │       UDP       │
├─────────────────┤              ├─────────────────┤
│                 │              │                 │
│ ✅ Надежная     │              │ ⚡ Быстрая      │
│    доставка     │              │    доставка     │
│                 │              │                 │
│ ✅ Порядок      │              │ ❌ Без гарантий │
│    сообщений    │              │    порядка      │
│                 │              │                 │
│ ✅ Контроль     │              │ ❌ Без контроля │
│    ошибок       │              │    ошибок       │
│                 │              │                 │
│ ❌ Больше       │              │ ✅ Меньше       │
│    накладных    │              │    накладных    │
│    расходов     │              │    расходов     │
│                 │              │                 │
│ 🎯 HTTP/HTTPS   │              │ 🎯 DNS, DHCP    │
│    SMTP, FTP    │              │    Gaming       │
│                 │              │    Streaming    │
└─────────────────┘              └─────────────────┘
```

**WebSockets для real-time коммуникации:**
```
┌─────────────┐    Handshake     ┌─────────────┐
│   Client    │ ─────────────► │   Server    │
└─────────────┘                 └─────────────┘
       │                               │
       │        Upgrade to             │
       │       WebSocket               │
       │ ◄─────────────────────────── │
       │                               │
┌─────────────┐   Bidirectional   ┌─────────────┐
│   Client    │ ◄═══════════════► │   Server    │
└─────────────┘   Real-time       └─────────────┘
                 Communication
```

#### 🛠️ Практика (2 часа)

**Задание:** Проектирование API endpoints

```
Блог API Endpoints:

Authentication:
POST /auth/login
POST /auth/logout  
POST /auth/refresh

Users:
GET  /users/profile
PUT  /users/profile
POST /users/register

Posts:
GET  /posts                    - Список постов
GET  /posts/{id}              - Конкретный пост
POST /posts                   - Создать пост
PUT  /posts/{id}              - Обновить пост
DELETE /posts/{id}            - Удалить пост

Comments:
GET  /posts/{id}/comments     - Комментарии к посту
POST /posts/{id}/comments     - Добавить комментарий
PUT  /comments/{id}           - Обновить комментарий
DELETE /comments/{id}         - Удалить комментарий
```

---

## 📅 Неделя 5-6: Хранение данных

### 🗄️ Глава 1.5: Базы данных: SQL vs NoSQL

#### 📚 Теория (3 часа)

**Реляционные БД и ACID свойства:**
```
┌─────────────────────────────────────────────────────┐
│                 ACID СВОЙСТВА                       │
├─────────────────────────────────────────────────────┤
│                                                     │
│  A - Atomicity (Атомарность)                       │
│      Транзакция выполняется полностью или не        │
│      выполняется вообще                             │
│                                                     │
│  C - Consistency (Согласованность)                  │
│      База данных остается в согласованном состоянии │
│      после каждой транзакции                        │
│                                                     │
│  I - Isolation (Изолированность)                    │
│      Параллельные транзакции не влияют друг на друга│
│                                                     │
│  D - Durability (Долговечность)                     │
│      Зафиксированные изменения сохраняются навсегда │
│                                                     │
└─────────────────────────────────────────────────────┘
```

**NoSQL типы:**
```
┌─────────────────┐  ┌─────────────────┐
│   DOCUMENT      │  │   KEY-VALUE     │
│   DATABASES     │  │   DATABASES     │
├─────────────────┤  ├─────────────────┤
│                 │  │                 │
│ • MongoDB       │  │ • Redis         │
│ • CouchDB       │  │ • DynamoDB      │
│ • Amazon        │  │ • Riak          │
│   DocumentDB    │  │ • Memcached     │
│                 │  │                 │
│ JSON документы  │  │ Простые пары    │
│ Гибкая схема    │  │ ключ-значение   │
└─────────────────┘  └─────────────────┘

┌─────────────────┐  ┌─────────────────┐
│  COLUMN-FAMILY  │  │     GRAPH       │
│   DATABASES     │  │   DATABASES     │
├─────────────────┤  ├─────────────────┤
│                 │  │                 │
│ • Cassandra     │  │ • Neo4j         │
│ • HBase         │  │ • Amazon        │
│ • Amazon        │  │   Neptune       │
│   SimpleDB      │  │ • ArangoDB      │
│                 │  │                 │
│ Семейства       │  │ Узлы и связи    │
│ колонок         │  │ Графовые запросы│
└─────────────────┘  └─────────────────┘
```

**CAP теорема (введение):**
```
┌─────────────────────────────────────────────────────┐
│                 CAP ТЕОРЕМА                         │
├─────────────────────────────────────────────────────┤
│                                                     │
│  Можно гарантировать только 2 из 3 свойств:        │
│                                                     │
│       C                                             │
│   Consistency    ◄─────┐                           │
│  (Согласованность)     │                           │
│          │             │                           │
│          │             │                           │
│          │             │                           │
│          ▼             │                           │
│       Choose 2         │                           │
│          │             │                           │
│          │             │                           │
│          │             ▼                           │
│   Availability    ◄─────┘                           │
│  (Доступность)                                      │
│          │                                          │
│          │                                          │
│          ▼                                          │
│   Partition Tolerance                               │
│  (Устойчивость к разделению)                       │
│                                                     │
└─────────────────────────────────────────────────────┘
```

**Когда выбирать SQL vs NoSQL:**
```
┌─────────────────┐              ┌─────────────────┐
│   ВЫБИРАЙ SQL   │              │ ВЫБИРАЙ NoSQL   │
├─────────────────┤              ├─────────────────┤
│                 │              │                 │
│ ✅ Структури-   │              │ ✅ Гибкая схема │
│    рованные     │              │                 │
│    данные       │              │ ✅ Горизон-     │
│                 │              │    тальное      │
│ ✅ ACID         │              │    масштаби-    │
│    требования   │              │    рование      │
│                 │              │                 │
│ ✅ Сложные      │              │ ✅ Быстрая      │
│    запросы      │              │    разработка   │
│                 │              │                 │
│ ✅ Отчетность   │              │ ✅ Большие      │
│                 │              │    объемы       │
│ ✅ Транзакции   │              │    данных       │
│                 │              │                 │
└─────────────────┘              └─────────────────┘
```

#### 🛠️ Практика (3 часа)

**Задание:** Проектирование схемы БД для блога

**SQL решение (PostgreSQL):**
```sql
-- Таблица пользователей
CREATE TABLE users (
    id SERIAL PRIMARY KEY,
    username VARCHAR(50) UNIQUE NOT NULL,
    email VARCHAR(100) UNIQUE NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Таблица постов
CREATE TABLE posts (
    id SERIAL PRIMARY KEY,
    title VARCHAR(200) NOT NULL,
    content TEXT NOT NULL,
    author_id INTEGER REFERENCES users(id),
    published_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Таблица комментариев
CREATE TABLE comments (
    id SERIAL PRIMARY KEY,
    content TEXT NOT NULL,
    author_id INTEGER REFERENCES users(id),
    post_id INTEGER REFERENCES posts(id),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

**NoSQL решение (MongoDB):**
```javascript
// Коллекция users
{
  "_id": ObjectId("..."),
  "username": "johndoe",
  "email": "john@example.com",
  "passwordHash": "...",
  "createdAt": ISODate("2024-01-01")
}

// Коллекция posts
{
  "_id": ObjectId("..."),
  "title": "Мой первый пост",
  "content": "Содержание поста...",
  "author": {
    "id": ObjectId("..."),
    "username": "johndoe"
  },
  "publishedAt": ISODate("2024-01-01"),
  "comments": [
    {
      "id": ObjectId("..."),
      "content": "Отличный пост!",
      "author": {
        "id": ObjectId("..."),
        "username": "janedoe"
      },
      "createdAt": ISODate("2024-01-01")
    }
  ],
  "tags": ["технологии", "веб-разработка"]
}
```

---

### ⚡ Глава 1.6: Кэширование: основы и стратегии

#### 📚 Теория (2 часа)

**Зачем нужно кэширование:**
```
БЕЗ КЭША:
┌─────────┐     Request     ┌─────────┐     Query      ┌─────────┐
│ Client  │ ──────────────► │ Server  │ ─────────────► │Database │
└─────────┘                 └─────────┘                └─────────┘
     │                           │                          │
     │         Response          │         Result           │
     │ ◄────────────────────────┼◄─────────────────────────┘
     │                           │
⏱️ Время ответа: 100-500ms     💸 Высокая нагрузка на БД

С КЭШЕМ:
┌─────────┐     Request     ┌─────────┐     Query      ┌─────────┐
│ Client  │ ──────────────► │ Server  │ ─────────────► │Database │
└─────────┘                 └─────────┘                └─────────┘
     │                           │                          │
     │         Response          │         Result           │
     │ ◄────────────────────────┼◄─────────────────────────┘
     │                           ▼                          
     │                      ┌─────────┐                     
     │                      │  Cache  │                     
     │                      └─────────┘                     
⏱️ Время ответа: 1-10ms      💰 Низкая нагрузка на БД
```

**Уровни кэширования:**
```
┌─────────────────────────────────────────────────────┐
│                УРОВНИ КЭШИРОВАНИЯ                   │
├─────────────────────────────────────────────────────┤
│                                                     │
│  1️⃣ Browser Cache                                   │
│      Кэширование в браузере пользователя           │
│                                                     │
│  2️⃣ CDN Cache                                       │
│      Кэширование на граничных серверах             │
│                                                     │
│  3️⃣ Load Balancer Cache                             │
│      Кэширование на балансировщике нагрузки        │
│                                                     │
│  4️⃣ Application Cache                               │
│      Кэширование в приложении (Redis, Memcached)   │
│                                                     │
│  5️⃣ Database Cache                                  │
│      Внутренний кэш СУБД                            │
│                                                     │
└─────────────────────────────────────────────────────┘
```

**Стратегии кэширования:**
```
CACHE-ASIDE (Lazy Loading)
┌─────────┐  1. Check   ┌─────────┐  2. Miss    ┌─────────┐
│  App    │ ─────────► │  Cache  │ ─────────► │   DB    │
└─────────┘            └─────────┘            └─────────┘
     │                      │                      │
     │  4. Return           │  3. Load             │
     │ ◄─────────────────── │ ◄──────────────────┘
     │                      │
     │  5. Store in cache   │
     │ ─────────────────► │
     
WRITE-THROUGH
┌─────────┐   Write    ┌─────────┐   Write    ┌─────────┐
│  App    │ ────────► │  Cache  │ ────────► │   DB    │
└─────────┘           └─────────┘           └─────────┘
     │                     │                     │
     │      Confirm        │      Confirm        │
     │ ◄─────────────────┼◄──────────────────┘
     
WRITE-BEHIND (Write-Back)
┌─────────┐   Write    ┌─────────┐  Async     ┌─────────┐
│  App    │ ────────► │  Cache  │ ────────► │   DB    │
└─────────┘           └─────────┘           └─────────┘
     │                     │
     │    Immediate        │
     │     Confirm         │
     │ ◄─────────────────┘
```

**TTL и invalidation стратегии:**
```
TTL (Time To Live)
┌─────────────────────────────────────────────────────┐
│  Key: "user:123"                                    │
│  Value: {"name": "John", "email": "john@email.com"} │
│  TTL: 3600 seconds (1 hour)                         │
│                                                     │
│  После истечения TTL данные автоматически удаляются │
└─────────────────────────────────────────────────────┘

INVALIDATION СТРАТЕГИИ
┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐
│   Manual        │  │   Event-based   │  │   Tag-based     │
│   Invalidation  │  │   Invalidation  │  │   Invalidation  │
├─────────────────┤  ├─────────────────┤  ├─────────────────┤
│                 │  │                 │  │                 │
│ Удаляем кэш     │  │ Удаляем при     │  │ Удаляем по      │
│ вручную при     │  │ обновлении      │  │ тегам:          │
│ обновлении      │  │ данных в БД     │  │ • user:*        │
│ данных          │  │                 │  │ • post:*        │
│                 │  │                 │  │ • comment:*     │
└─────────────────┘  └─────────────────┘  └─────────────────┘
```

#### 🛠️ Практика (2 часа)

**Задание:** Проектирование кэширования для новостного сайта

```
НОВОСТНОЙ САЙТ - СТРАТЕГИЯ КЭШИРОВАНИЯ

1. STATIC CONTENT (CSS, JS, Images)
   ┌─────────────┐    CDN     ┌─────────────┐
   │   Browser   │ ◄────────► │    CDN      │
   └─────────────┘            └─────────────┘
   TTL: 7 дней для статических файлов

2. NEWS ARTICLES
   ┌─────────────┐   Redis    ┌─────────────┐
   │    App      │ ◄────────► │   Cache     │
   └─────────────┘            └─────────────┘
   Key: "article:{id}"
   TTL: 1 час для статей
   
3. NEWS FEED (Homepage)
   Key: "homepage:feed"
   TTL: 5 минут
   Invalidation: При публикации новой статьи
   
4. USER SESSIONS
   Key: "session:{token}"
   TTL: 24 часа
   Store: Токены аутентификации
   
5. SEARCH RESULTS
   Key: "search:{query}:{page}"
   TTL: 15 минут
   Популярные запросы кэшируются дольше
```

---

## 🎯 Контрольные задания блока 1

### 📋 Проект: Архитектура простого форума

**Задание:** Спроектировать архитектуру форума со следующими требованиями:
- Регистрация и аутентификация пользователей
- Создание тем и сообщений
- Система голосования (лайки/дизлайки)
- Поиск по сообщениям
- Модерация контента

**Компоненты системы:**
```
┌─────────────────────────────────────────────────────┐
│                 FORUM ARCHITECTURE                  │
├─────────────────────────────────────────────────────┤
│                                                     │
│  Frontend (React/Vue)                               │
│  ├── User Interface                                 │
│  ├── Authentication Forms                           │
│  └── Real-time Updates                              │
│                                                     │
│  API Gateway                                        │
│  ├── Rate Limiting                                  │
│  ├── Authentication                                 │
│  └── Request Routing                                │
│                                                     │
│  Services Layer                                     │
│  ├── User Service                                   │
│  ├── Forum Service                                  │
│  ├── Search Service                                 │
│  └── Notification Service                           │
│                                                     │
│  Data Layer                                         │
│  ├── PostgreSQL (Users, Posts)                     │
│  ├── Redis (Sessions, Cache)                       │
│  └── Elasticsearch (Search)                        │
│                                                     │
└─────────────────────────────────────────────────────┘
```

**API Endpoints:**
```
Authentication:
POST /auth/register
POST /auth/login
POST /auth/logout

Users:
GET  /users/{id}
PUT  /users/{id}

Forums:
GET  /forums
POST /forums
GET  /forums/{id}/topics

Topics:
GET  /topics/{id}
POST /topics
PUT  /topics/{id}
DELETE /topics/{id}

Posts:
GET  /topics/{id}/posts
POST /topics/{id}/posts
PUT  /posts/{id}
DELETE /posts/{id}

Votes:
POST /posts/{id}/vote
DELETE /posts/{id}/vote

Search:
GET  /search?q={query}&type={type}
```

**Схема базы данных:**
```sql
-- Users table
CREATE TABLE users (
    id SERIAL PRIMARY KEY,
    username VARCHAR(50) UNIQUE NOT NULL,
    email VARCHAR(100) UNIQUE NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    role VARCHAR(20) DEFAULT 'user',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Forums table  
CREATE TABLE forums (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    description TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Topics table
CREATE TABLE topics (
    id SERIAL PRIMARY KEY,
    title VARCHAR(200) NOT NULL,
    forum_id INTEGER REFERENCES forums(id),
    author_id INTEGER REFERENCES users(id),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Posts table
CREATE TABLE posts (
    id SERIAL PRIMARY KEY,
    content TEXT NOT NULL,
    topic_id INTEGER REFERENCES topics(id),
    author_id INTEGER REFERENCES users(id),
    parent_id INTEGER REFERENCES posts(id),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Votes table
CREATE TABLE votes (
    id SERIAL PRIMARY KEY,
    post_id INTEGER REFERENCES posts(id),
    user_id INTEGER REFERENCES users(id),
    vote_type INTEGER CHECK (vote_type IN (-1, 1)),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    UNIQUE(post_id, user_id)
);
```

**Стратегия кэширования:**
```
1. USER SESSIONS
   Key: "session:{token}"
   TTL: 24 hours
   
2. FORUM METADATA
   Key: "forum:{id}"
   TTL: 1 hour
   
3. POPULAR TOPICS
   Key: "popular_topics:{forum_id}"
   TTL: 10 minutes
   
4. SEARCH RESULTS
   Key: "search:{query}:{filters}"
   TTL: 5 minutes
   
5. USER PROFILES
   Key: "user:{id}"
   TTL: 30 minutes
```

---

## 📝 Теоретический тест (20 вопросов)

### ❓ Вопросы для самопроверки

1. **Что такое System Design и почему он важен?**
   - Объясните стоимость изменений на разных этапах разработки

2. **SOLID принципы:**
   - Как Single Responsibility Principle применяется к сервисам?
   - Что означает Open/Closed Principle в контексте архитектуры?

3. **Клиент-серверная архитектура:**
   - В чем разница между Stateless и Stateful подходами?
   - Объясните трехуровневую архитектуру

4. **HTTP/HTTPS:**
   - Какие HTTP методы идемпотентны и почему это важно?
   - Объясните разницу между HTTP и HTTPS

5. **TCP vs UDP:**
   - Когда использовать TCP, а когда UDP?
   - Что такое WebSockets и для чего они нужны?

6. **Базы данных:**
   - Объясните ACID свойства
   - В каких случаях выбрать SQL, а в каких NoSQL?

7. **CAP теорема:**
   - Какие 3 свойства включает CAP теорема?
   - Приведите примеры выбора между свойствами

8. **Кэширование:**
   - Объясните стратегии Cache-aside, Write-through, Write-behind
   - Что такое TTL и cache invalidation?

---

## 🏆 Результат блока 1

После завершения этого блока вы будете обладать:

✅ **Пониманием базовых концепций** системного дизайна  
✅ **Умением объяснить архитектуру** простых систем  
✅ **Навыками создания** первого системного дизайна  
✅ **Знанием принципов** проектирования надежных систем  
✅ **Пониманием trade-offs** в архитектурных решениях

---

## 📚 Рекомендуемые материалы для изучения

### 📖 Книги:
- "Clean Architecture" - Robert Martin
- "Building Microservices" - Sam Newman  
- "Designing Data-Intensive Applications" - Martin Kleppmann

### 🌐 Онлайн ресурсы:
- High Scalability blog
- AWS Architecture Center
- System Design Primer (GitHub)

### 🛠️ Практические инструменты:
- Draw.io для создания диаграмм
- Postman для тестирования API
- Docker для контейнеризации

---

**Следующий блок:** [Блок 2: Масштабирование и производительность] ➡️