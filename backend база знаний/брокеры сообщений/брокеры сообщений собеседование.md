# Техническое интервью: Backend разработчик - Брокеры сообщений

## Введение
Данное интервью предназначено для оценки глубоких знаний backend разработчика в области брокеров сообщений: RabbitMQ, Apache Kafka и NATS. Каждый основной вопрос содержит 5 углубляющих подвопросов для детальной проверки понимания.

---

## RabbitMQ

### 1. Что такое RabbitMQ и как он реализует протокол AMQP?
1. Какие основные компоненты протокола AMQP 0-9-1 вы знаете?
2. Чем отличается AMQP 0-9-1 от AMQP 1.0?
3. Как RabbitMQ обрабатывает connection и channel?
4. Что происходит при превышении лимита channel на connection?
5. Как работает flow control в AMQP?

### 2. Объясните архитектуру Exchange в RabbitMQ
1. Какие типы exchange существуют и чем они отличаются?
2. Как работает алгоритм маршрутизации в topic exchange?
3. Что такое alternate exchange и когда его использовать?
4. Как реализовать delayed exchange без плагинов?
5. В чем разница между durable и transient exchange?

### 3. Как работают очереди (queues) в RabbitMQ?
1. Какие типы очередей поддерживает RabbitMQ 3.x?
2. Что такое quorum queues и чем они отличаются от classic queues?
3. Как работает TTL на уровне очереди и сообщения?
4. Что происходит с сообщениями при overflow в очереди?
5. Как настроить stream queues и когда их использовать?

### 4. Расскажите о механизмах доставки сообщений в RabbitMQ
1. В чем разница между at-most-once, at-least-once и exactly-once доставкой?
2. Как работает publisher confirms?
3. Что такое consumer acknowledgments и их типы?
4. Как реализовать idempotent consumers?
5. Как работает nack и reject с requeue?

### 5. Что такое Dead Letter Exchange (DLX) и как его настроить?
1. При каких условиях сообщение попадает в DLX?
2. Как настроить routing key для dead letter сообщений?
3. Можно ли создать цепочку DLX?
4. Как предотвратить бесконечные циклы в DLX?
5. Какие headers добавляются к dead letter сообщениям?

### 6. Объясните концепцию кластеризации в RabbitMQ
1. Какие типы узлов существуют в RabbitMQ кластере?
2. Как работает репликация metadata между узлами?
3. Что такое queue mirroring и чем оно отличается от quorum queues?
4. Как происходит failover при недоступности узла?
5. Какие проблемы может вызвать network partition?

### 7. Как работает система мониторинга и метрик в RabbitMQ?
1. Какие ключевые метрики нужно отслеживать в production?
2. Как настроить alerting на memory и disk watermarks?
3. Что показывает connection churn rate?
4. Как интерпретировать queue depth и message rates?
5. Какие проблемы может выявить high GC activity?

### 8. Расскажите о производительности RabbitMQ
1. Какие факторы влияют на throughput RabbitMQ?
2. Как настроить prefetch для оптимальной производительности?
3. В чем разница между persistent и transient сообщений по производительности?
4. Как батчинг влияет на latency и throughput?
5. Какие bottleneck чаще всего возникают в RabbitMQ?

### 9. Что такое RabbitMQ Streams и когда их использовать?
1. Чем RabbitMQ Streams отличаются от обычных очередей?
2. Как работает offset tracking в streams?
3. Можно ли использовать routing с streams?
4. Как настроить retention policy для streams?
5. В каких сценариях streams предпочтительнее Kafka?

### 10. Объясните механизм backpressure в RabbitMQ
1. Как работают memory и disk alarms?
2. Что происходит при срабатывании flow control?
3. Как настроить memory watermarks?
4. Что такое credit-based flow control?
5. Как publisher может обработать blocked connection?

### 11. Расскажите о безопасности в RabbitMQ
1. Какие механизмы аутентификации поддерживает RabbitMQ?
2. Как работает RBAC в RabbitMQ?
3. Что такое virtual hosts и как они изолируют ресурсы?
4. Как настроить TLS для client connections?
5. Как реализовать audit logging?

### 12. Что такое Federation и Shovel в RabbitMQ?
1. В чем разница между Federation и Shovel?
2. Когда использовать federation links?
3. Как работает топология в federated exchanges?
4. Что происходит при разрыве federation link?
5. Как настроить bi-directional federation?

### 13. Как работает persistence в RabbitMQ?
1. Что такое message store и как он организован?
2. Как работает garbage collection для persisted messages?
3. В чем разница между message store и queue index?
4. Как настроить sync batching для лучшей производительности?
5. Что происходит при corruption message store?

### 14. Объясните различные паттерны messaging с RabbitMQ
1. Как реализовать Request-Reply паттерн?
2. Что такое RPC over RabbitMQ и его ограничения?
3. Как реализовать Publish-Subscribe с routing?
4. Что такое scatter-gather паттерн?
5. Как реализовать competing consumers pattern?

### 15. Расскажите о troubleshooting в RabbitMQ
1. Как диагностировать проблемы с connection leaks?
2. Что делать при high memory usage?
3. Как найти причину slow consumers?
4. Что означает unroutable messages и как их обработать?
5. Как диагностировать problems с cluster partitions?

### 16. Что такое RabbitMQ Management API?
1. Какие операции доступны через HTTP API?
2. Как получить метрики через Management API?
3. Что такое definitions и как их экспортировать?
4. Как автоматизировать deployment конфигурации?
5. Какие rate limits есть у Management API?

### 17. Как работает message routing в RabbitMQ?
1. Что происходит с mandatory messages?
2. Как работает immediate flag (deprecated)?
3. Что такое return listener и когда его использовать?
4. Как работает routing с headers exchange?
5. Что происходит при routing в несуществующий exchange?

### 18. Объясните концепцию transactions в RabbitMQ
1. Как работают AMQP transactions?
2. В чем разница между transactions и publisher confirms?
3. Какое влияние на производительность оказывают transactions?
4. Можно ли использовать transactions с multiple channels?
5. Что происходит при rollback transaction?

### 19. Расскажите о RabbitMQ plugins
1. Какие официальные plugins вы знаете?
2. Как работает rabbitmq-delayed-message-exchange?
3. Что такое rabbitmq-consistent-hash-exchange?
4. Как создать custom plugin?
5. Как влияют plugins на performance и stability?

### 20. Что такое message properties в RabbitMQ?
1. Какие standard properties поддерживает AMQP?
2. Как использовать custom headers?
3. Что такое message priority и как его настроить?
4. Как работает correlation ID в RPC?
5. Для чего используется reply-to property?

### 21. Как настроить высокую доступность в RabbitMQ?
1. Что такое highly available queues?
2. Как работает master election в mirrored queues?
3. В чем преимущества quorum queues над mirrored?
4. Как настроить load balancer для RabbitMQ cluster?
5. Что такое pause minority mode?

### 22. Объясните memory management в RabbitMQ
1. Как RabbitMQ управляет memory для queues?
2. Что такое page out и когда оно происходит?
3. Как работает lazy queues?
4. Что влияет на memory footprint connections?
5. Как настроить vm_memory_high_watermark?

### 23. Расскажите о RabbitMQ в containerized окружении
1. Какие проблемы возникают при запуске в Docker?
2. Как правильно настроить resource limits?
3. Что такое peer discovery в Kubernetes?
4. Как работать с persistent volumes?
5. Какие anti-patterns в container deployment?

### 24. Что такое consumer patterns в RabbitMQ?
1. Как реализовать graceful shutdown consumers?
2. Что такое consumer cancellation notification?
3. Как обработать consumer timeout?
4. Что происходит при exclusive consumer disconnect?
5. Как реализовать round-robin vs fair dispatch?

### 25. Объясните advanced routing в RabbitMQ
1. Как использовать wildcards в topic routing?
2. Что такое binding arguments?
3. Как работает x-match в headers exchange?
4. Можно ли создать conditional routing?
5. Как реализовать content-based routing?

---

## Apache Kafka

### 26. Что такое Apache Kafka и его основная архитектура?
1. Что такое distributed commit log и как Kafka его реализует?
2. Как работает партиционирование в Kafka?
3. Что такое replication factor и leader/follower модель?
4. Как происходит leader election при failure?
5. Что такое ISR (In-Sync Replicas) и как они поддерживаются?

### 27. Объясните концепцию topics и partitions в Kafka
1. Как выбрать оптимальное количество партиций для topic?
2. Что происходит при изменении количества партиций?
3. Как работает partition assignment для consumers?
4. Что такое compacted topics и когда их использовать?
5. Как ordering гарантируется внутри partition?

### 28. Расскажите о Kafka Producers
1. Какие acknowledgment modes поддерживает producer?
2. Как работает idempotent producer?
3. Что такое batching и как его настроить?
4. Как работает partitioner и можно ли создать custom?
5. Что происходит при send timeout или buffer overflow?

### 29. Как работают Kafka Consumers и Consumer Groups?
1. Что такое consumer group rebalancing?
2. Какие стратегии partition assignment существуют?
3. Как работает offset management?
4. Что такое consumer lag и как его мониторить?
5. Как обработать случай slow consumer в группе?

### 30. Объясните Kafka offset management
1. Где хранятся consumer offsets?
2. Что такое auto commit vs manual commit?
3. Как работает offset reset при missing offset?
4. Что происходит при seek operations?
5. Как реализовать exactly-once consuming?

### 31. Что такое Kafka Connect?
1. В чем разница между source и sink connectors?
2. Как работает distributed mode в Kafka Connect?
3. Что такое transforms в Kafka Connect?
4. Как обрабатываются schema changes?
5. Как настроить fault tolerance в connectors?

### 32. Расскажите о Kafka Streams
1. Что такое stream processing topology?
2. Как работает stateful operations в Kafka Streams?
3. Что такое KTable vs KStream?
4. Как работает windowing operations?
5. Что такое interactive queries?

### 33. Объясните Kafka cluster management
1. Как работает Kafka Controller?
2. Что такое preferred replica election?
3. Как происходит graceful shutdown broker?
4. Что такое rack awareness в Kafka?
5. Как работает автоматическое broker replacement?

### 34. Что такое Kafka security?
1. Какие протоколы authentication поддерживает Kafka?
2. Как работает SASL/PLAIN vs SASL/SCRAM?
3. Что такое ACLs в Kafka и как их настроить?
4. Как enable SSL/TLS encryption?
5. Что такое delegation tokens?

### 35. Расскажите о performance tuning Kafka
1. Какие key metrics нужно мониторить?
2. Как настроить producer для максимального throughput?
3. Что влияет на end-to-end latency?
4. Как optimize disk I/O performance?
5. Какие JVM settings критичны для Kafka?

### 36. Объясните Kafka storage internals
1. Как организованы log segments на диске?
2. Что такое log compaction и как он работает?
3. Как работает index files (offset index, time index)?
4. Что происходит при log retention?
5. Как работает zero-copy optimization?

### 37. Что такое exactly-once semantics в Kafka?
1. Как работает transactional producer?
2. Что такое transaction coordinator?
3. Как consumers читают transactional messages?
4. Что происходит при transaction timeout?
5. Какие ограничения у exactly-once delivery?

### 38. Расскажите о Kafka replication
1. Как работает leader-follower replication?
2. Что такое replica lag и high water mark?
3. Как работает replica fetcher threads?
4. Что происходит при unclean leader election?
5. Как настроить min.insync.replicas?

### 39. Что такое Kafka quotas и throttling?
1. Какие типы quotas поддерживает Kafka?
2. Как работает client throttling?
3. Что такое replication throttling?
4. Как динамически изменять quotas?
5. Как мониторить quota violations?

### 40. Объясните Kafka monitoring и observability
1. Какие JMX metrics наиболее важны?
2. Как настроить log aggregation для Kafka?
3. Что такое controlled shutdown и его метрики?
4. Как мониторить consumer group health?
5. Какие tools использовать для Kafka monitoring?

### 41. Расскажите о Kafka upgrades и backwards compatibility
1. Как проводить rolling upgrade Kafka cluster?
2. Что такое inter-broker protocol version?
3. Как работает message format versioning?
4. Какие breaking changes бывают между версиями?
5. Как тестировать compatibility при upgrade?

### 42. Что такое Kafka schema management?
1. Как работает Confluent Schema Registry?
2. Что такое schema evolution policies?
3. Как обрабатывать schema compatibility?
4. Что происходит при schema conflicts?
5. Как версионировать schemas?

### 43. Объясните Kafka disaster recovery
1. Как реализовать cross-datacenter replication?
2. Что такое MirrorMaker 2.0?
3. Как восстановить cluster после полного failure?
4. Что такое backup strategies для Kafka?
5. Как handle split-brain scenarios?

### 44. Расскажите о Kafka in cloud environments
1. Какие особенности deployment в AWS/GCP/Azure?
2. Как работать с managed Kafka services?
3. Что такое auto-scaling для Kafka?
4. Как optimize cloud storage costs?
5. Какие cloud-specific monitoring tools использовать?

### 45. Что такое Kafka операционные паттерны?
1. Как реализовать blue-green deployment с Kafka?
2. Что такое consumer group rewind?
3. Как проводить topic migration?
4. Что делать при broker disk failure?
5. Как handle poison messages?

### 46. Объясните advanced Kafka configuration
1. Какие broker configs наиболее критичны?
2. Как настроить page cache optimization?
3. Что такое replica.lag.time.max.ms?
4. Как работает compression на broker side?
5. Какие настройки влияют на durability?

### 47. Расскажите о Kafka testing strategies
1. Как unit-тестировать Kafka producers/consumers?
2. Что такое embedded Kafka для тестов?
3. Как integration-тестировать с Kafka?
4. Что такое chaos engineering для Kafka?
5. Как performance testing Kafka applications?

### 48. Что такое Kafka multi-tenancy?
1. Как изолировать tenants в Kafka?
2. Что такое topic naming conventions?
3. Как implement resource quotas per tenant?
4. Что делать с noisy neighbor problem?
5. Как secure multi-tenant deployment?

### 49. Объясните Kafka stream processing patterns
1. Что такое event sourcing с Kafka?
2. Как реализовать CQRS pattern?
3. Что такое saga pattern с Kafka?
4. Как implement distributed tracing?
5. Что такое outbox pattern?

### 50. Расскажите о Kafka capacity planning
1. Как рассчитать disk space requirements?
2. Что влияет на network bandwidth utilization?
3. Как планировать CPU и memory resources?
4. Что такое burst capacity planning?
5. Как growth planning для Kafka cluster?

---

## NATS

### 51. Что такое NATS и его основные принципы?
1. В чем заключается философия "always on, dial tone"?
2. Как NATS реализует at-most-once delivery?
3. Что такое subject-based messaging?
4. Как работает decentralized authentication в NATS?
5. В чем отличие от традиционных message brokers?

### 52. Объясните NATS subjects и subscription patterns
1. Как работают wildcards в NATS subjects?
2. Что такое queue groups и как они работают?
3. Как реализовать load balancing с queue subscriptions?
4. Что происходит при subject permissions violations?
5. Как работает subject hierarchy и routing?

### 53. Расскажите о NATS Clustering
1. Как работает cluster topology в NATS?
2. Что такое route connections между серверами?
3. Как происходит subject interest propagation?
4. Что происходит при network partition в cluster?
5. Как работает client reconnection logic?

### 54. Что такое NATS JetStream?
1. Чем JetStream отличается от core NATS?
2. Как работает persistent storage в JetStream?
3. Что такое stream replication и acknowledgments?
4. Как работают consumers в JetStream?
5. Что такое delivery semantics в JetStream?

### 55. Объясните NATS security model
1. Как работает JWT-based authentication?
2. Что такое NKeys и как они используются?
3. Как настроить TLS encryption?
4. Что такое account-based multi-tenancy?
5. Как работают user permissions и subject limits?

### 56. Расскажите о NATS performance характеристиках
1. Какие факторы влияют на latency в NATS?
2. Как измерить throughput NATS сервера?
3. Что такое slow consumer detection?
4. Как work publish и subscription buffers?
5. Какие optimizations доступны для high-performance scenarios?

### 57. Что такое NATS Streaming (deprecated) vs JetStream?
1. Почему NATS Streaming был заменен на JetStream?
2. Как мигрировать с NATS Streaming на JetStream?
3. Какие возможности появились в JetStream?
4. Что такое durable subscriptions в контексте migration?
5. Какие breaking changes при переходе?

### 58. Объясните NATS monitoring и observability
1. Какие metrics expose NATS server?
2. Как настроить monitoring endpoints?
3. Что показывают connection и subscription stats?
4. Как мониторить cluster health?
5. Какие tools использовать для NATS observability?

### 59. Расскажите о NATS clients и connection management
1. Как работает automatic reconnection в clients?
2. Что такое connection draining?
3. Как handle client disconnect scenarios?
4. Что происходит при max connections limit?
5. Как работает client authentication flow?

### 60. Что такое NATS request-reply pattern?
1. Как реализовать synchronous request-reply?
2. Что происходит при timeout request?
3. Как работает inbox subjects для replies?
4. Можно ли реализовать multiplexed requests?
5. Как handle reply subject permissions?

### 61. Объясните NATS JetStream streams configuration
1. Какие storage types поддерживает JetStream?
2. Как настроить retention policies?
3. Что такое stream limits и policies?
4. Как работает message deduplication?
5. Что такое stream mirroring и sourcing?

### 62. Расскажите о NATS deployment patterns
1. Как deploy NATS в Kubernetes?
2. Что такое leaf node connections?
3. Как работает NATS с service mesh?
4. Какие patterns для multi-region deployment?
5. Как handle NATS upgrades?

### 63. Что такое NATS KV и Object Store?
1. Как работает key-value store в NATS?
2. Что такое object store capabilities?
3. Как реализуется consistency в KV?
4. Какие use cases для NATS KV vs external stores?
5. Как работает bucket management?

### 64. Объясните NATS configuration management
1. Как работает configuration reload?
2. Что такое configuration contexts?
3. Как настроить logging levels и outputs?
4. Что можно настроять через include files?
5. Как работает environment variable substitution?

### 65. Расскажите о NATS troubleshooting
1. Как диагностировать connection issues?
2. Что означают различные error codes?
3. Как debug subject permission problems?
4. Что делать при slow consumer warnings?
5. Как analyze NATS server logs?

---

## Сравнительные и архитектурные вопросы

### 66. Сравните RabbitMQ, Kafka и NATS по delivery guarantees
1. Как каждый брокер обеспечивает at-least-once delivery?
2. Какой брокер лучше подходит для exactly-once processing?
3. В каких случаях at-most-once delivery приемлема?
4. Как влияют delivery guarantees на performance?
5. Какие trade-offs между consistency и availability?

### 67. Какой брокер выбрать для different use cases?
1. Когда использовать RabbitMQ vs Kafka?
2. В каких сценариях NATS предпочтительнее?
3. Как requirements влияют на выбор брокера?
4. Что важнее: latency, throughput или durability?
5. Как operational complexity влияет на выбор?

### 68. Сравните persistence models разных брокеров
1. Как каждый брокер хранит messages на диске?
2. Какие trade-offs между memory и disk usage?
3. Как работает message retention в каждом брокере?
4. Что происходит при disk space exhaustion?
5. Какие recovery capabilities у каждого брокера?

### 69. Объясните clustering и high availability approaches
1. Как каждый брокер решает split-brain problem?
2. Какие модели consistency используются?
3. Как происходит failover в каждом брокере?
4. Что такое CAP theorem применительно к брокерам?
5. Какие operational overheads у каждого решения?

### 70. Сравните performance characteristics
1. Какой брокер показывает лучший throughput?
2. У кого минимальная latency?
3. Как каждый брокер масштабируется horizontal?
4. Какие resource requirements у каждого брокера?
5. Как batching влияет на performance в каждом случае?

### 71. Расскажите о операционной сложности каждого брокера
1. Какой брокер проще в deployment и maintenance?
2. Что требует больше operational expertise?
3. Как monitoring и troubleshooting отличаются?
4. Какие automation capabilities доступны?
5. Что сложнее в production operations?

### 72. Объясните различные messaging patterns
1. Как реализовать pub-sub в каждом брокере?
2. Какие возможности для request-reply patterns?
3. Как implement message routing и filtering?
4. Что доступно для stream processing?
5. Какие patterns для event sourcing?

### 73. Сравните security models
1. Какие authentication mechanisms поддерживаются?
2. Как работает authorization в каждом брокере?
3. Какие encryption capabilities доступны?
4. Как implement multi-tenancy?
5. Что с audit и compliance capabilities?

### 74. Расскажите о ecosystem и integration
1. Какие client libraries наиболее mature?
2. Что с integration tools и connectors?
3. Какие managed services доступны в cloud?
4. Что с community support и documentation?
5. Какие третий-party tools доступны?

### 75. Объясните migration strategies между брокерами
1. Как мигрировать с RabbitMQ на Kafka?
2. Что нужно учесть при переходе на NATS?
3. Какие challenges при migration данных?
4. Как обеспечить zero-downtime migration?
5. Что с backward compatibility?

### 76. Сравните cost considerations
1. Какие licensing costs у каждого брокера?
2. Что с operational costs (hardware, maintenance)?
3. Как cloud deployment costs отличаются?
4. Какие hidden costs могут возникнуть?
5. Что с TCO в long-term perspective?

### 77. Расскажите о testing и development experience
1. Какие tools для local development доступны?
2. Как unit и integration testing отличается?
3. Что с debugging capabilities?
4. Какие dev tools и IDEs поддержка?
5. Что с learning curve для команды?

### 78. Объясните anti-patterns для каждого брокера
1. Каких ошибок избегать с RabbitMQ?
2. Что неправильно делают с Kafka?
3. Какие NATS anti-patterns существуют?
4. Как wrong tool choice влияет на architecture?
5. Что с over-engineering vs under-engineering?

### 79. Расскажите о future trends и evolution
1. Как развиваются современные брокеры?
2. Что с cloud-native и serverless trends?
3. Какие новые requirements появляются?
4. Что с edge computing и IoT scenarios?
5. Как AI/ML влияет на messaging requirements?

### 80. Дайте практические recommendations
1. Как провести proper evaluation брокеров?
2. Что включить в proof of concept?
3. Какие key questions задать business stakeholders?
4. Как plan migration strategy?
5. Что с team training и knowledge transfer?

---

## Заключение

Данное интервью покрывает широкий спектр знаний о брокерах сообщений от базовых концепций до advanced topics. Оценка ответов должна учитывать:

- **Глубину технического понимания**
- **Практический опыт и real-world scenarios**
- **Знание trade-offs и architectural decisions**
- **Умение сравнивать и выбирать подходящие решения**
- **Понимание operational aspects**

Рекомендуется адаптировать вопросы в зависимости от уровня позиции и specific requirements проекта.