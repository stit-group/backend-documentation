# ğŸ”’ Ğ‘Ğ»Ğ¾Ğº 5: Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ Ğ¸ Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ ÑĞµÑ‚ĞµĞ¹
**â±ï¸ Ğ’Ñ€ĞµĞ¼Ñ Ğ¸Ğ·ÑƒÑ‡ĞµĞ½Ğ¸Ñ: 3-4 Ğ¼ĞµÑÑÑ†Ğ°**

---

## ğŸ¯ Ğ¦ĞµĞ»Ğ¸ Ğ±Ğ»Ğ¾ĞºĞ°

Ğš ĞºĞ¾Ğ½Ñ†Ñƒ ÑÑ‚Ğ¾Ğ³Ğ¾ Ğ±Ğ»Ğ¾ĞºĞ° Ğ²Ñ‹ Ğ±ÑƒĞ´ĞµÑ‚Ğµ:
- ĞŸĞ¾Ğ½Ğ¸Ğ¼Ğ°Ñ‚ÑŒ ÑĞ¾Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ ÑƒĞ³Ñ€Ğ¾Ğ·Ñ‹ Ğ¸ Ğ¼ĞµÑ‚Ğ¾Ğ´Ñ‹ Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ñ‹ ÑĞµÑ‚ĞµĞ¹
- Ğ£Ğ¼ĞµÑ‚ÑŒ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¼Ğ½Ğ¾Ğ³Ğ¾ÑƒÑ€Ğ¾Ğ²Ğ½ĞµĞ²Ñ‹Ğµ ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚Ğ¸
- Ğ’Ğ»Ğ°Ğ´ĞµÑ‚ÑŒ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ğ¼Ğ¸ Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³Ğ° Ğ¸ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ° Ñ‚Ñ€Ğ°Ñ„Ğ¸ĞºĞ°
- Ğ¡Ğ¿Ğ¾ÑĞ¾Ğ±Ğ½Ñ‹ Ñ€ĞµĞ°Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ½Ğ° Ğ¸Ğ½Ñ†Ğ¸Ğ´ĞµĞ½Ñ‚Ñ‹ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚Ğ¸
- Ğ—Ğ½Ğ°Ñ‚ÑŒ Ğ¿Ñ€Ğ¸Ğ½Ñ†Ğ¸Ğ¿Ñ‹ Zero Trust Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ñ‹

---

## ğŸ“š Ğ“Ğ»Ğ°Ğ²Ğ° 5.1: Ğ¡ĞµÑ‚ĞµĞ²Ğ°Ñ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ

### 5.1.1 ĞœĞ¾Ğ´ĞµĞ»ÑŒ ÑƒĞ³Ñ€Ğ¾Ğ· Ğ¸ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ· Ñ€Ğ¸ÑĞºĞ¾Ğ²

#### ĞŸĞ¾Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ğµ Ğ»Ğ°Ğ½Ğ´ÑˆĞ°Ñ„Ñ‚Ğ° ÑƒĞ³Ñ€Ğ¾Ğ·

Ğ¡Ğ¾Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ğ°Ñ ÑĞµÑ‚ĞµĞ²Ğ°Ñ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ Ğ½Ğ°Ñ‡Ğ¸Ğ½Ğ°ĞµÑ‚ÑÑ Ñ Ğ¿Ğ¾Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ñ Ñ‚Ğ¾Ğ³Ğ¾, **Ğ§Ğ¢Ğ** Ğ¼Ñ‹ Ğ·Ğ°Ñ‰Ğ¸Ñ‰Ğ°ĞµĞ¼, **ĞĞ¢ ĞšĞĞ“Ğ** Ğ·Ğ°Ñ‰Ğ¸Ñ‰Ğ°ĞµĞ¼ Ğ¸ **ĞšĞĞš** ÑÑ‚Ğ¾ Ğ´ĞµĞ»Ğ°Ñ‚ÑŒ ÑÑ„Ñ„ĞµĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾.

```
ĞšĞ»Ğ°ÑÑĞ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ ÑƒĞ³Ñ€Ğ¾Ğ· Ğ¿Ğ¾ Ğ¸ÑÑ‚Ğ¾Ñ‡Ğ½Ğ¸ĞºĞ°Ğ¼:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                Ğ’ĞĞ•Ğ¨ĞĞ˜Ğ• Ğ£Ğ“Ğ ĞĞ—Ğ«                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Ğ¥Ğ°ĞºĞµÑ€Ñ‹-Ğ¾Ğ´Ğ¸Ğ½Ğ¾Ñ‡ĞºĞ¸                              â”‚
â”‚ â€¢ ĞÑ€Ğ³Ğ°Ğ½Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ³Ñ€ÑƒĞ¿Ğ¿Ñ‹                         â”‚
â”‚ â€¢ Ğ“Ğ¾ÑÑƒĞ´Ğ°Ñ€ÑÑ‚Ğ²ĞµĞ½Ğ½Ñ‹Ğµ Ğ°ĞºÑ‚Ğ¾Ñ€Ñ‹ (APT)                 â”‚
â”‚ â€¢ ĞšĞ¾Ğ½ĞºÑƒÑ€ĞµĞ½Ñ‚Ñ‹                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ĞŸĞ•Ğ Ğ˜ĞœĞ•Ğ¢Ğ  Ğ¡Ğ•Ğ¢Ğ˜                      â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚    â”‚         Ğ’ĞĞ£Ğ¢Ğ Ğ•ĞĞĞ˜Ğ• Ğ£Ğ“Ğ ĞĞ—Ğ«           â”‚      â”‚
â”‚    â”‚ â€¢ ĞĞµĞ´Ğ¾Ğ²Ğ¾Ğ»ÑŒĞ½Ñ‹Ğµ ÑĞ¾Ñ‚Ñ€ÑƒĞ´Ğ½Ğ¸ĞºĞ¸           â”‚      â”‚
â”‚    â”‚ â€¢ ĞĞµĞ¾ÑÑ‚Ğ¾Ñ€Ğ¾Ğ¶Ğ½Ñ‹Ğµ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ğ¸        â”‚      â”‚
â”‚    â”‚ â€¢ Ğ˜Ğ½ÑĞ°Ğ¹Ğ´ĞµÑ€Ñ‹ Ñ Ğ¿Ñ€Ğ¸Ğ²Ğ¸Ğ»ĞµĞ³Ğ¸ÑĞ¼Ğ¸         â”‚      â”‚
â”‚    â”‚ â€¢ Ğ¡ĞºĞ¾Ğ¼Ğ¿Ñ€Ğ¾Ğ¼ĞµÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ°ĞºĞºĞ°ÑƒĞ½Ñ‚Ñ‹     â”‚      â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ĞœĞ¾Ğ´ĞµĞ»ÑŒ STRIDE Ğ´Ğ»Ñ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ° ÑƒĞ³Ñ€Ğ¾Ğ·

**STRIDE** - ÑÑ‚Ğ¾ Ğ¼ĞµÑ‚Ğ¾Ğ´Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ñ Microsoft Ğ´Ğ»Ñ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ³Ğ¾ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ° ÑƒĞ³Ñ€Ğ¾Ğ·:

- **S**poofing (ĞŸĞ¾Ğ´Ğ¼ĞµĞ½Ğ°) - Ğ°Ñ‚Ğ°ĞºÑƒÑÑ‰Ğ¸Ğ¹ Ğ¿Ñ€Ğ¸Ñ‚Ğ²Ğ¾Ñ€ÑĞµÑ‚ÑÑ ĞºĞµĞ¼-Ñ‚Ğ¾ Ğ´Ñ€ÑƒĞ³Ğ¸Ğ¼
- **T**ampering (Ğ˜Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğµ) - Ğ½ĞµÑĞ°Ğ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ°Ñ Ğ¼Ğ¾Ğ´Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
- **R**epudiation (ĞÑ‚ĞºĞ°Ğ·) - Ğ¾Ñ‚Ñ€Ğ¸Ñ†Ğ°Ğ½Ğ¸Ğµ ÑĞ¾Ğ²ĞµÑ€ÑˆĞµĞ½Ğ½Ñ‹Ñ… Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğ¹
- **I**nformation Disclosure (Ğ Ğ°ÑĞºÑ€Ñ‹Ñ‚Ğ¸Ğµ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ğ¸) - Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ Ğº ĞºĞ¾Ğ½Ñ„Ğ¸Ğ´ĞµĞ½Ñ†Ğ¸Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¼ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğ¼
- **D**enial of Service (ĞÑ‚ĞºĞ°Ğ· Ğ² Ğ¾Ğ±ÑĞ»ÑƒĞ¶Ğ¸Ğ²Ğ°Ğ½Ğ¸Ğ¸) - Ğ½Ğ°Ñ€ÑƒÑˆĞµĞ½Ğ¸Ğµ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾ÑÑ‚Ğ¸
- **E**levation of Privilege (ĞŸĞ¾Ğ²Ñ‹ÑˆĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¸Ğ²Ğ¸Ğ»ĞµĞ³Ğ¸Ğ¹) - Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ½ĞµÑĞ°Ğ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ¿Ñ€Ğ°Ğ²

#### ĞœĞµÑ‚Ğ¾Ğ´Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ñ Ğ¾Ñ†ĞµĞ½ĞºĞ¸ Ñ€Ğ¸ÑĞºĞ¾Ğ²

```
ĞŸÑ€Ğ¾Ñ†ĞµÑÑ Ğ¾Ñ†ĞµĞ½ĞºĞ¸ Ñ€Ğ¸ÑĞºĞ¾Ğ²:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. Ğ˜Ğ”Ğ•ĞĞ¢Ğ˜Ğ¤Ğ˜ĞšĞĞ¦Ğ˜Ğ¯ ĞĞšĞ¢Ğ˜Ğ’ĞĞ’
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ â€¢ Ğ¡ĞµÑ€Ğ²ĞµÑ€Ñ‹        â”‚
   â”‚ â€¢ Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ         â”‚ â”€â”€â”
   â”‚ â€¢ ĞŸÑ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ     â”‚   â”‚
   â”‚ â€¢ Ğ¡ĞµÑ‚ĞµĞ²Ğ¾Ğµ ĞŸĞ     â”‚   â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
                          â”‚
2. ĞĞĞĞ›Ğ˜Ğ— Ğ£Ğ¯Ğ—Ğ’Ğ˜ĞœĞĞ¡Ğ¢Ğ•Ğ™     â”‚
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
   â”‚ â€¢ CVE Ğ±Ğ°Ğ·Ñ‹       â”‚   â”‚
   â”‚ â€¢ ĞŸĞµĞ½Ñ‚ĞµÑÑ‚Ñ‹       â”‚ â”€â”€â”¼â”€â–º Ğ Ğ˜Ğ¡Ğš = Ğ£Ğ“Ğ ĞĞ—Ğ Ã— Ğ£Ğ¯Ğ—Ğ’Ğ˜ĞœĞĞ¡Ğ¢Ğ¬ Ã— Ğ’ĞĞ—Ğ”Ğ•Ğ™Ğ¡Ğ¢Ğ’Ğ˜Ğ•
   â”‚ â€¢ ĞÑƒĞ´Ğ¸Ñ‚Ñ‹        â”‚   â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
                          â”‚
3. ĞĞ¦Ğ•ĞĞšĞ Ğ£Ğ“Ğ ĞĞ—           â”‚
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
   â”‚ â€¢ Threat Intel   â”‚   â”‚
   â”‚ â€¢ Ğ˜ÑÑ‚Ğ¾Ñ€Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ   â”‚ â”€â”€â”˜
   â”‚   Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ        â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.1.2 VPN Ñ‚ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ğ¸

#### IPSec - Internet Protocol Security

IPSec Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ Ğ½Ğ° ÑĞµÑ‚ĞµĞ²Ğ¾Ğ¼ ÑƒÑ€Ğ¾Ğ²Ğ½Ğµ Ğ¸ Ğ¾Ğ±ĞµÑĞ¿ĞµÑ‡Ğ¸Ğ²Ğ°ĞµÑ‚ **Ğ¿Ñ€Ğ¾Ğ·Ñ€Ğ°Ñ‡Ğ½ÑƒÑ** Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ñƒ Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¹.

```
ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° IPSec:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ĞšĞ»Ğ¸ĞµĞ½Ñ‚    â”‚      â”‚ IPSec Gatewayâ”‚      â”‚   Ğ¡ĞµÑ€Ğ²ĞµÑ€    â”‚
â”‚             â”‚      â”‚             â”‚      â”‚             â”‚
â”‚ 192.168.1.10â”‚â—„â”€â”€â”€â”€â–ºâ”‚  VPN Router â”‚â—„â”€â”€â”€â”€â–ºâ”‚ 10.0.0.100  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                      â”‚                    â”‚
      â”‚                      â”‚                    â”‚
   Tunnel Mode          Policy Decision       Protected
      ESP                 Point (PDP)         Network
      AH                      â”‚
                             â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ IKE (Phase 1)   â”‚ â† Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° SA
                    â”‚ â€¢ ĞÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñâ”‚
                    â”‚ â€¢ ĞĞ±Ğ¼ĞµĞ½ ĞºĞ»ÑÑ‡Ğ°Ğ¼Ğ¸ â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ IKE (Phase 2)   â”‚ â† Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ñ‚ÑƒĞ½Ğ½ĞµĞ»Ñ
                    â”‚ â€¢ IPSec SA      â”‚
                    â”‚ â€¢ ĞŸĞ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹ ESP â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ğ¿Ñ€Ğ¾Ñ‚Ğ¾ĞºĞ¾Ğ»Ñ‹ IPSec:**

1. **AH (Authentication Header)** - Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ°ÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ
2. **ESP (Encapsulating Security Payload)** - ÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ + Ğ°ÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ
3. **IKE (Internet Key Exchange)** - ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ ĞºĞ»ÑÑ‡Ğ°Ğ¼Ğ¸

**Ğ ĞµĞ¶Ğ¸Ğ¼Ñ‹ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹:**
- **Transport Mode** - Ğ·Ğ°Ñ‰Ğ¸Ñ‰Ğ°ĞµÑ‚ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ payload
- **Tunnel Mode** - Ğ·Ğ°Ñ‰Ğ¸Ñ‰Ğ°ĞµÑ‚ Ğ²ĞµÑÑŒ IP Ğ¿Ğ°ĞºĞµÑ‚ (ÑĞ¾Ğ·Ğ´Ğ°ĞµÑ‚ Ğ½Ğ¾Ğ²Ñ‹Ğ¹ IP Ğ·Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²Ğ¾Ğº)

#### SSL/TLS VPN

Ğ Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ Ğ½Ğ° Ğ¿Ñ€Ğ¸ĞºĞ»Ğ°Ğ´Ğ½Ğ¾Ğ¼ ÑƒÑ€Ğ¾Ğ²Ğ½Ğµ, Ğ½Ğµ Ñ‚Ñ€ĞµĞ±ÑƒĞµÑ‚ ÑĞ¿ĞµÑ†Ğ¸Ğ°Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ ĞºĞ»Ğ¸ĞµĞ½Ñ‚Ğ°.

```
SSL VPN vs IPSec:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

SSL/TLS VPN                    IPSec VPN
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€             â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Web Browser   â”‚           â”‚ IPSec Client    â”‚
â”‚                 â”‚           â”‚                 â”‚
â”‚ HTTPS Session   â”‚           â”‚ ESP/AH Tunnel   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚      TCP        â”‚           â”‚       IP        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚      IP         â”‚           â”‚    Ethernet     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Ethernet      â”‚           â”‚    Physical     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ĞŸÑ€ĞµĞ¸Ğ¼ÑƒÑ‰ĞµÑÑ‚Ğ²Ğ°:                ĞŸÑ€ĞµĞ¸Ğ¼ÑƒÑ‰ĞµÑÑ‚Ğ²Ğ°:
â€¢ ĞŸÑ€Ğ¾ÑÑ‚Ğ¾Ñ‚Ğ° Ñ€Ğ°Ğ·Ğ²ĞµÑ€Ñ‚Ñ‹Ğ²Ğ°Ğ½Ğ¸Ñ      â€¢ ĞŸÑ€Ğ¾Ğ·Ñ€Ğ°Ñ‡Ğ½Ğ¾ÑÑ‚ÑŒ Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¹
â€¢ Ğ Ğ°Ğ±Ğ¾Ñ‚Ğ° Ñ‡ĞµÑ€ĞµĞ· NAT           â€¢ Ğ’Ñ‹ÑĞ¾ĞºĞ°Ñ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ
â€¢ Ğ“Ñ€Ğ°Ğ½ÑƒĞ»ÑÑ€Ğ½Ñ‹Ğ¹ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿         â€¢ Ğ¨Ğ¸Ñ€Ğ¾ĞºĞ°Ñ Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ° Ğ¿Ñ€Ğ¾Ñ‚Ğ¾ĞºĞ¾Ğ»Ğ¾Ğ²
```

#### WireGuard - ÑĞ¾Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ğ°Ñ VPN Ñ‚ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ñ

WireGuard Ğ¿Ñ€ĞµĞ´ÑÑ‚Ğ°Ğ²Ğ»ÑĞµÑ‚ Ğ½Ğ¾Ğ²Ñ‹Ğ¹ Ğ¿Ğ¾Ğ´Ñ…Ğ¾Ğ´ Ğº VPN Ñ Ğ°ĞºÑ†ĞµĞ½Ñ‚Ğ¾Ğ¼ Ğ½Ğ° **Ğ¿Ñ€Ğ¾ÑÑ‚Ğ¾Ñ‚Ñƒ** Ğ¸ **Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ**.

```
ĞŸÑ€Ğ¸Ğ½Ñ†Ğ¸Ğ¿Ñ‹ WireGuard:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. ĞšĞ Ğ˜ĞŸĞ¢ĞĞ“Ğ ĞĞ¤Ğ˜Ğ§Ğ•Ğ¡ĞšĞĞ¯ ĞŸĞ ĞĞ¡Ğ¢ĞĞ¢Ğ
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Curve25519 (ECDH)                  â”‚ â† ĞĞ±Ğ¼ĞµĞ½ ĞºĞ»ÑÑ‡Ğ°Ğ¼Ğ¸
   â”‚ ChaCha20 (ÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ)              â”‚ â† Ğ¨Ğ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
   â”‚ Poly1305 (Ğ°ÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ)          â”‚ â† ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ñ†ĞµĞ»Ğ¾ÑÑ‚Ğ½Ğ¾ÑÑ‚Ğ¸
   â”‚ BLAKE2s (Ñ…ĞµÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ)              â”‚ â† Ğ¥ĞµÑˆ-Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ñ
   â”‚ SipHash24 (Ñ…ĞµÑˆ-Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹)            â”‚ â† Ğ’Ğ½ÑƒÑ‚Ñ€ĞµĞ½Ğ½Ğ¸Ğµ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñ‹
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

2. ĞĞ Ğ¥Ğ˜Ğ¢Ğ•ĞšĞ¢Ğ£Ğ Ğ "CRYPTOKEY ROUTING"
   Peer A â—„â”€â”€â”€â”€â”€â”€â”€â”€ Ğ—Ğ°ÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹ Ñ‚ÑƒĞ½Ğ½ĞµĞ»ÑŒ â”€â”€â”€â”€â”€â”€â”€â”€â–º Peer B
   Public Key:       Ñ‡ĞµÑ€ĞµĞ· UDP                   Public Key:
   ABC123...                                     XYZ789...
   
   ĞšĞ°Ğ¶Ğ´Ñ‹Ğ¹ peer Ğ·Ğ½Ğ°ĞµÑ‚ Ğ¿ÑƒĞ±Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ğµ ĞºĞ»ÑÑ‡Ğ¸ Ñ€Ğ°Ğ·Ñ€ĞµÑˆĞµĞ½Ğ½Ñ‹Ñ… ÑĞ¾Ğ±ĞµÑĞµĞ´Ğ½Ğ¸ĞºĞ¾Ğ²
```

### 5.1.3 Firewalls Ğ¸ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ñ‚Ñ€Ğ°Ñ„Ğ¸ĞºĞ°

#### Ğ­Ğ²Ğ¾Ğ»ÑÑ†Ğ¸Ñ Ñ‚ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ğ¹ firewall

```
ĞŸĞ¾ĞºĞ¾Ğ»ĞµĞ½Ğ¸Ñ Firewall:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1-Ğµ Ğ¿Ğ¾ĞºĞ¾Ğ»ĞµĞ½Ğ¸Ğµ: PACKET FILTER
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ IP src: 192.168.1.0/24 â†’ ALLOW         â”‚
â”‚ IP dst: 10.0.0.0/8, Port 80 â†’ ALLOW    â”‚
â”‚ IP dst: ANY, Port 22 â†’ DENY            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
ĞĞ½Ğ°Ğ»Ğ¸Ğ·: Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ·Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²ĞºĞ¸ Ğ¿Ğ°ĞºĞµÑ‚Ğ¾Ğ²

2-Ğµ Ğ¿Ğ¾ĞºĞ¾Ğ»ĞµĞ½Ğ¸Ğµ: STATEFUL INSPECTION
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Connection Table               â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ SRC â†’ DST:PORT  STATE    TIME      â”‚ â”‚
â”‚ â”‚ A â†’ B:80        ESTAB    120s      â”‚ â”‚
â”‚ â”‚ C â†’ D:443       SYN_SENT 30s       â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
ĞĞ½Ğ°Ğ»Ğ¸Ğ·: ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ ÑĞ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ğ¹

3-Ğµ Ğ¿Ğ¾ĞºĞ¾Ğ»ĞµĞ½Ğ¸Ğµ: APPLICATION LAYER
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Deep Packet Inspection (DPI)       â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ HTTP: Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ *.exe Ñ„Ğ°Ğ¹Ğ»Ñ‹      â”‚ â”‚
â”‚ â”‚ SMTP: Ğ°Ğ½Ñ‚Ğ¸Ğ²Ğ¸Ñ€ÑƒÑ ÑĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ       â”‚ â”‚
â”‚ â”‚ P2P:  Ğ¾Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾Ğ»Ğ¾ÑÑ‹           â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
ĞĞ½Ğ°Ğ»Ğ¸Ğ·: ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ¸Ğ¼Ğ¾Ğµ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¹
```

#### Next-Generation Firewall (NGFW)

NGFW Ğ¾Ğ±ÑŠĞµĞ´Ğ¸Ğ½ÑĞµÑ‚ Ñ‚Ñ€Ğ°Ğ´Ğ¸Ñ†Ğ¸Ğ¾Ğ½Ğ½Ñ‹Ğµ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸ Ñ ÑĞ¾Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğ¼Ğ¸ Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚ÑĞ¼Ğ¸:

```
ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹ NGFW:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   NGFW STACK                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Application Identification & Control           â”‚ â† ĞĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¹
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ User Identity Integration                       â”‚ â† ĞŸÑ€Ğ¸Ğ²ÑĞ·ĞºĞ° Ğº Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑĞ¼
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Intrusion Prevention System (IPS)              â”‚ â† ĞĞ±Ğ½Ğ°Ñ€ÑƒĞ¶ĞµĞ½Ğ¸Ğµ Ğ°Ñ‚Ğ°Ğº
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Advanced Malware Protection                     â”‚ â† Ğ—Ğ°Ñ‰Ğ¸Ñ‚Ğ° Ğ¾Ñ‚ Ğ²Ñ€ĞµĞ´Ğ¾Ğ½Ğ¾ÑĞ¾Ğ²
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ URL Filtering & Reputation                      â”‚ â† Ğ’ĞµĞ±-Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Traditional Firewall (Stateful)                â”‚ â† ĞšĞ»Ğ°ÑÑĞ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### IDS/IPS - ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹ Ğ¾Ğ±Ğ½Ğ°Ñ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ Ğ¸ Ğ¿Ñ€ĞµĞ´Ğ¾Ñ‚Ğ²Ñ€Ğ°Ñ‰ĞµĞ½Ğ¸Ñ Ğ²Ñ‚Ğ¾Ñ€Ğ¶ĞµĞ½Ğ¸Ğ¹

```
IDS vs IPS Positioning:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

NETWORK-BASED IDS (NIDS):
Internet â”€â”€â–º Router â”€â”€â–º Switch â”€â”€â”¬â”€â–º Internal Network
                                â”‚
                                â”œâ”€â–º IDS Sensor
                                    (Ğ¿Ğ°ÑÑĞ¸Ğ²Ğ½Ğ¾Ğµ Ğ¿Ñ€Ğ¾ÑĞ»ÑƒÑˆĞ¸Ğ²Ğ°Ğ½Ğ¸Ğµ)
                                    â”‚
                                    â–¼
                               Security Center
                               (Ğ°Ğ»ĞµÑ€Ñ‚Ñ‹ Ğ¸ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·)

NETWORK-BASED IPS (NIPS):
Internet â”€â”€â–º Router â”€â”€â–º IPS â”€â”€â–º Switch â”€â”€â–º Internal Network
                        â”‚
                        â–¼
                   Ğ‘Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
                   Ğ°Ñ‚Ğ°Ğº Ğ² Ñ€ĞµĞ°Ğ»ÑŒĞ½Ğ¾Ğ¼
                   Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸
```

**ĞœĞµÑ‚Ğ¾Ğ´Ñ‹ Ğ¾Ğ±Ğ½Ğ°Ñ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ:**

1. **Signature-based** - ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ Ñ Ğ±Ğ°Ğ·Ğ¾Ğ¹ Ğ¸Ğ·Ğ²ĞµÑÑ‚Ğ½Ñ‹Ñ… Ğ¿Ğ°Ñ‚Ñ‚ĞµÑ€Ğ½Ğ¾Ğ² Ğ°Ñ‚Ğ°Ğº
2. **Anomaly-based** - Ğ²Ñ‹ÑĞ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¾Ñ‚ĞºĞ»Ğ¾Ğ½ĞµĞ½Ğ¸Ğ¹ Ğ¾Ñ‚ Ğ½Ğ¾Ñ€Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ Ğ¿Ğ¾Ğ²ĞµĞ´ĞµĞ½Ğ¸Ñ
3. **Behavioral-based** - Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ· Ğ¿Ğ¾Ğ²ĞµĞ´ĞµĞ½Ğ¸Ñ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹ Ğ¸ ÑĞ¸ÑÑ‚ĞµĞ¼

### 5.1.4 Zero Trust Architecture

#### ĞŸÑ€Ğ¸Ğ½Ñ†Ğ¸Ğ¿Ñ‹ Zero Trust

Zero Trust Ğ¾ÑĞ½Ğ¾Ğ²Ñ‹Ğ²Ğ°ĞµÑ‚ÑÑ Ğ½Ğ° Ğ¿Ñ€Ğ¸Ğ½Ñ†Ğ¸Ğ¿Ğµ **"Never trust, always verify"**.

```
Traditional Perimeter vs Zero Trust:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

TRADITIONAL PERIMETER SECURITY:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                TRUSTED ZONE                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚User â”‚  â”‚App  â”‚  â”‚DB   â”‚  â”‚File â”‚        â”‚
â”‚  â”‚     â”‚  â”‚     â”‚  â”‚     â”‚  â”‚Srv  â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Implicit Trust â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
                â”‚
            Firewall
                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             UNTRUSTED ZONE                  â”‚
â”‚              (Internet)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ZERO TRUST ARCHITECTURE:
   User â†â”€â”¬â”€â†’ Policy Engine â†â”€â”¬â”€â†’ Application
          â”‚                  â”‚
          â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚    â”‚     Policy Decision       â”‚
          â”‚    â”‚     â€¢ Identity           â”‚
          â”‚    â”‚     â€¢ Device State       â”‚
          â”‚    â”‚     â€¢ Location           â”‚
          â”‚    â”‚     â€¢ Time              â”‚
          â”‚    â”‚     â€¢ Risk Score        â”‚
          â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                  â”‚
          â””â”€â”€â–º Enforcement â—„â”€â”˜
               Point
```

#### ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹ Zero Trust

```
Zero Trust Control Plane:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. POLICY ENGINE (PE)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ â€¢ ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ² Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ°              â”‚
   â”‚ â€¢ ĞŸÑ€Ğ¸Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾Ğ»Ğ¸Ñ‚Ğ¸Ğº                   â”‚
   â”‚ â€¢ Ğ’Ñ‹Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ¸Ğµ risk score                â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
2. POLICY ADMINISTRATOR (PA)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ â€¢ ĞŸĞµÑ€ĞµĞ²Ğ¾Ğ´ Ñ€ĞµÑˆĞµĞ½Ğ¸Ğ¹ Ğ² ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹            â”‚
   â”‚ â€¢ ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ PEP                     â”‚
   â”‚ â€¢ ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ ÑĞ¾Ğ¾Ñ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²Ğ¸Ñ              â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
3. POLICY ENFORCEMENT POINTS (PEP)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ â€¢ Gateways                             â”‚
   â”‚ â€¢ Proxy ÑĞµÑ€Ğ²ĞµÑ€Ñ‹                        â”‚
   â”‚ â€¢ VPN ĞºĞ¾Ğ½Ñ†ĞµĞ½Ñ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€Ñ‹                    â”‚
   â”‚ â€¢ Cloud security services             â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“š Ğ“Ğ»Ğ°Ğ²Ğ° 5.2: ĞÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ Ğ¸ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»ÑŒ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ°

### 5.2.1 Network Access Control (NAC) Ğ¸ 802.1X

#### ĞŸĞ¾Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ğµ 802.1X

802.1X - ÑÑ‚Ğ¾ ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚ IEEE Ğ´Ğ»Ñ **port-based authentication** Ğ² ÑĞµÑ‚ÑÑ….

```
ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° 802.1X:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Supplicant          Authenticator         Authentication Server
(ĞšĞ»Ğ¸ĞµĞ½Ñ‚)           (ĞšĞ¾Ğ¼Ğ¼ÑƒÑ‚Ğ°Ñ‚Ğ¾Ñ€)              (RADIUS)
    â”‚                     â”‚                      â”‚
    â”‚                     â”‚                      â”‚
    â”‚ 1. EAP Start        â”‚                      â”‚
    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                      â”‚
    â”‚                     â”‚                      â”‚
    â”‚ 2. EAP Identity     â”‚                      â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                      â”‚
    â”‚                     â”‚ 3. RADIUS Access-Req â”‚
    â”‚                     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
    â”‚                     â”‚                      â”‚
    â”‚ 4. EAP Challenge    â”‚ 4. RADIUS Challenge  â”‚
    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚                     â”‚                      â”‚
    â”‚ 5. EAP Response     â”‚ 5. RADIUS Access-Req â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
    â”‚                     â”‚                      â”‚
    â”‚ 6. EAP Success      â”‚ 6. RADIUS Accept     â”‚
    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚                     â”‚                      â”‚
    â”‚ 7. Port Authorized  â”‚                      â”‚
    â”‚â—„â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â–ºâ”‚                      â”‚
```

#### Ğ¢Ğ¸Ğ¿Ñ‹ EAP Ğ¼ĞµÑ‚Ğ¾Ğ´Ğ¾Ğ²

```
EAP Methods Comparison:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Method    â”‚  Credentials â”‚   Security   â”‚  Use Case    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ EAP-MD5     â”‚ Password     â”‚ Weak         â”‚ Legacy only  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ EAP-TLS     â”‚ Certificates â”‚ Very Strong  â”‚ High Securityâ”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PEAP        â”‚ Password     â”‚ Strong       â”‚ Enterprise   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ EAP-TTLS    â”‚ Various      â”‚ Strong       â”‚ Flexible     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ EAP-FAST    â”‚ PAC + Pwd    â”‚ Strong       â”‚ Cisco        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Dynamic VLAN Assignment

```
NAC Workflow Ñ Dynamic VLAN:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ°
   Device â”€â”€â–º Switch Port (Access VLAN 999 - Quarantine)

2. 802.1X Ğ°ÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ
   Device â—„â”€â”€â–º Switch â—„â”€â”€â–º RADIUS Server
                           â”‚
                           â–¼
                      User Database
                      â€¢ User: john@company.com
                      â€¢ Group: Engineering
                      â€¢ VLAN: 100

3. Ğ£ÑĞ¿ĞµÑˆĞ½Ğ°Ñ Ğ°Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ
   Device â”€â”€â–º Switch Port (Access VLAN 100 - Engineering)
   
4. ĞŸĞ¾Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ¸ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ° Ğ¿Ñ€Ğ¸Ğ¼ĞµĞ½ĞµĞ½Ñ‹
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ VLAN 100 Policies:                     â”‚
   â”‚ â€¢ Internet: Allow                      â”‚
   â”‚ â€¢ File Servers: Allow                  â”‚
   â”‚ â€¢ HR Systems: Deny                     â”‚
   â”‚ â€¢ Guest Network: Deny                  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2.2 RADIUS Ğ¸ TACACS+

#### RADIUS - Remote Authentication Dial-In User Service

```
RADIUS Packet Flow:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

NAS (Network Access Server)     RADIUS Server
        â”‚                            â”‚
        â”‚ 1. Access-Request          â”‚
        â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
        â”‚   â€¢ Username               â”‚
        â”‚   â€¢ Password (encrypted)   â”‚
        â”‚   â€¢ NAS-IP-Address         â”‚
        â”‚                            â”‚
        â”‚ 2. Access-Challenge        â”‚
        â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
        â”‚   â€¢ Challenge String       â”‚
        â”‚                            â”‚
        â”‚ 3. Access-Request          â”‚
        â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
        â”‚   â€¢ Challenge Response     â”‚
        â”‚                            â”‚
        â”‚ 4. Access-Accept/Reject    â”‚
        â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
        â”‚   â€¢ Service-Type           â”‚
        â”‚   â€¢ VLAN Assignment        â”‚
        â”‚   â€¢ Session-Timeout        â”‚
```

#### TACACS+ vs RADIUS

```
Protocol Comparison:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

RADIUS                          TACACS+
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€        â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AAA Ğ² Ğ¾Ğ´Ğ½Ğ¾Ğ¼ Ğ¿Ğ°ĞºĞµÑ‚Ğµ  â”‚          â”‚ Ğ Ğ°Ğ·Ğ´ĞµĞ»ÑŒĞ½Ñ‹Ğµ AAA      â”‚
â”‚                     â”‚          â”‚                     â”‚
â”‚ UDP Transport       â”‚          â”‚ TCP Transport       â”‚
â”‚ (Ğ¿Ğ¾Ñ€Ñ‚Ñ‹ 1812/1813)   â”‚          â”‚ (Ğ¿Ğ¾Ñ€Ñ‚ 49)           â”‚
â”‚                     â”‚          â”‚                     â”‚
â”‚ Ğ¨Ğ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾   â”‚          â”‚ ĞŸĞ¾Ğ»Ğ½Ğ¾Ğµ ÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ  â”‚
â”‚ Ğ¿Ğ°Ñ€Ğ¾Ğ»Ñ              â”‚          â”‚ Ğ²ÑĞµĞ³Ğ¾ Ğ¿Ğ°ĞºĞµÑ‚Ğ°        â”‚
â”‚                     â”‚          â”‚                     â”‚
â”‚ Ğ¡Ñ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚ RFC        â”‚          â”‚ Cisco Ğ¿Ñ€Ğ¾Ğ¿Ñ€Ğ¸ĞµÑ‚Ğ°Ñ€Ğ½Ñ‹Ğ¹ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

         â”‚                                  â”‚
         â–¼                                  â–¼
   
Ğ›ÑƒÑ‡ÑˆĞµ Ğ´Ğ»Ñ:                        Ğ›ÑƒÑ‡ÑˆĞµ Ğ´Ğ»Ñ:
â€¢ Ğ”Ğ¾ÑÑ‚ÑƒĞ¿ Ğº ÑĞµÑ‚Ğ¸                   â€¢ Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ°Ğ¼Ğ¸
â€¢ VPN Ğ°ÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ              â€¢ Command authorization
â€¢ Wi-Fi Ğ°ÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ            â€¢ Ğ”ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ accounting
```

### 5.2.3 Certificate Management Ğ¸ PKI

#### Public Key Infrastructure (PKI)

```
PKI Hierarchy:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

                 Root CA
               (Offline, Secure)
                     â”‚
                     â”‚ ĞŸĞ¾Ğ´Ğ¿Ğ¸ÑÑ‹Ğ²Ğ°ĞµÑ‚
                     â–¼
               Intermediate CA
              (Online, Operational)
                     â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚        â”‚        â”‚
            â–¼        â–¼        â–¼
      User Certs  Server   Device
                  Certs    Certs

Certificate Fields:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Subject: CN=user@company.com           â”‚
â”‚ Issuer: CN=Company Intermediate CA     â”‚
â”‚ Serial Number: 0x1234567890ABCDEF      â”‚
â”‚ Valid From: 2024-01-01                 â”‚
â”‚ Valid To: 2025-01-01                   â”‚
â”‚ Public Key: RSA 2048-bit               â”‚
â”‚ Signature: SHA-256 with RSA            â”‚
â”‚ Extensions:                            â”‚
â”‚   â€¢ Key Usage: Digital Signature      â”‚
â”‚   â€¢ Extended Key Usage: Client Auth    â”‚
â”‚   â€¢ Subject Alternative Name: DNS     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Certificate Lifecycle Management

```
Certificate Lifecycle:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. REQUEST
   User/Device â”€â”€â–º Certificate Authority
                   â€¢ CSR (Certificate Signing Request)
                   â€¢ Identity verification
                   
2. ISSUANCE
   CA â”€â”€â–º User/Device
         â€¢ Signed certificate
         â€¢ Root CA certificate chain
         
3. DEPLOYMENT
   Certificate installed on:
   â€¢ User devices
   â€¢ Servers
   â€¢ Network equipment
   
4. VALIDATION
   Regular checks:
   â€¢ Certificate expiration
   â€¢ Revocation status (CRL/OCSP)
   â€¢ Key compromise indicators
   
5. RENEWAL/REVOCATION
   â€¢ Automatic renewal before expiry
   â€¢ Immediate revocation if compromised
   â€¢ CRL/OCSP updates
```

### 5.2.4 Multi-Factor Authentication (MFA)

#### Ğ¤Ğ°ĞºÑ‚Ğ¾Ñ€Ñ‹ Ğ°ÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸

```
Authentication Factors:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

SOMETHING YOU KNOW          SOMETHING YOU HAVE
(Knowledge Factor)          (Possession Factor)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â€¢ ĞŸĞ°Ñ€Ğ¾Ğ»Ğ¸        â”‚         â”‚ â€¢ Ğ¡Ğ¼Ğ°Ñ€Ñ‚-ĞºĞ°Ñ€Ñ‚Ñ‹   â”‚
â”‚ â€¢ PIN ĞºĞ¾Ğ´Ñ‹      â”‚         â”‚ â€¢ Ğ¢Ğ¾ĞºĞµĞ½Ñ‹        â”‚
â”‚ â€¢ Ğ¡ĞµĞºÑ€ĞµÑ‚Ğ½Ñ‹Ğµ     â”‚         â”‚ â€¢ ĞœĞ¾Ğ±Ğ¸Ğ»ÑŒĞ½Ñ‹Ğµ     â”‚
â”‚   Ğ²Ğ¾Ğ¿Ñ€Ğ¾ÑÑ‹       â”‚         â”‚   Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                           â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ SOMETHING YOU ARE â”‚
        â”‚ (Inherence Factor)â”‚
        â”‚ â€¢ ĞÑ‚Ğ¿ĞµÑ‡Ğ°Ñ‚ĞºĞ¸      â”‚
        â”‚ â€¢ Ğ Ğ°Ğ´ÑƒĞ¶ĞºĞ° Ğ³Ğ»Ğ°Ğ·Ğ°  â”‚
        â”‚ â€¢ Ğ“Ğ¾Ğ»Ğ¾Ñ          â”‚
        â”‚ â€¢ ĞŸĞ¾Ğ²ĞµĞ´ĞµĞ½Ğ¸Ğµ      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### SAML Ğ¸ Ñ„ĞµĞ´ĞµÑ€Ğ°Ñ‚Ğ¸Ğ²Ğ½Ğ°Ñ Ğ°ÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ

```
SAML SSO Flow:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

User                Service Provider (SP)      Identity Provider (IdP)
 â”‚                         â”‚                          â”‚
 â”‚ 1. Ğ”Ğ¾ÑÑ‚ÑƒĞ¿ Ğº Ñ€ĞµÑÑƒÑ€ÑÑƒ    â”‚                          â”‚
 â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                          â”‚
 â”‚                         â”‚ 2. Redirect to IdP       â”‚
 â”‚                         â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
 â”‚ 3. Redirect to IdP      â”‚                          â”‚
 â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
 â”‚                         â”‚                          â”‚
 â”‚ 4. ĞÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ       â”‚                          â”‚
 â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
 â”‚                         â”‚                          â”‚
 â”‚ 5. SAML Response        â”‚                          â”‚
 â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
 â”‚                         â”‚                          â”‚
 â”‚ 6. Ğ”Ğ¾ÑÑ‚ÑƒĞ¿ Ğº Ñ€ĞµÑÑƒÑ€ÑÑƒ     â”‚                          â”‚
 â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                          â”‚
 â”‚                         â”‚                          â”‚
 â”‚ 7. ĞŸÑ€ĞµĞ´Ğ¾ÑÑ‚Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ       â”‚                          â”‚
 â”‚    Ñ€ĞµÑÑƒÑ€ÑĞ°              â”‚                          â”‚
 â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                          â”‚
```

---

## ğŸ“š Ğ“Ğ»Ğ°Ğ²Ğ° 5.3: ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ Ğ¸ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·

### 5.3.1 Wireshark Ğ¸ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ· Ñ‚Ñ€Ğ°Ñ„Ğ¸ĞºĞ°

#### ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ° Ğ¿Ğ°ĞºĞµÑ‚Ğ¾Ğ²

```
Packet Capture Architecture:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Physical Network
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Network TAP    â”‚ â—„â”€â”€â”€ ĞŸĞ°ÑÑĞ¸Ğ²Ğ½Ğ¾Ğµ ÑĞ½ÑÑ‚Ğ¸Ğµ ĞºĞ¾Ğ¿Ğ¸Ğ¸ Ñ‚Ñ€Ğ°Ñ„Ğ¸ĞºĞ°
â”‚  Ğ¸Ğ»Ğ¸            â”‚
â”‚  Mirror Port    â”‚ â—„â”€â”€â”€ ĞšĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ‡ĞµÑ€ĞµĞ· ĞºĞ¾Ğ¼Ğ¼ÑƒÑ‚Ğ°Ñ‚Ğ¾Ñ€
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Packet Capture  â”‚
â”‚ Buffer          â”‚ â—„â”€â”€â”€ Ğ’Ñ€ĞµĞ¼ĞµĞ½Ğ½Ğ¾Ğµ Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ¿Ğ°ĞºĞµÑ‚Ğ¾Ğ²
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Protocol        â”‚
â”‚ Decoders        â”‚ â—„â”€â”€â”€ Ğ Ğ°Ğ·Ğ±Ğ¾Ñ€ Ğ¿Ñ€Ğ¾Ñ‚Ğ¾ĞºĞ¾Ğ»Ğ¾Ğ²
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Analysis        â”‚
â”‚ Engine          â”‚ â—„â”€â”€â”€ ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ğ¸ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ñ‚ĞµÑ…Ğ½Ğ¸ĞºĞ¸ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ°

**1. Display Filters (Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ñ‹ Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ)**

```
ĞŸÑ€Ğ¸Ğ¼ĞµÑ€Ñ‹ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ¾Ğ² Wireshark:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğµ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ñ‹:
â€¢ ip.addr == 192.168.1.100        # Ğ›ÑĞ±Ğ¾Ğ¹ Ñ‚Ñ€Ğ°Ñ„Ğ¸Ğº Ñ/Ğ½Ğ° IP
â€¢ tcp.port == 80                  # HTTP Ñ‚Ñ€Ğ°Ñ„Ğ¸Ğº
â€¢ http.request.method == "GET"     # HTTP GET Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹

Ğ¡Ğ»Ğ¾Ğ¶Ğ½Ñ‹Ğµ ÑƒÑĞ»Ğ¾Ğ²Ğ¸Ñ:
â€¢ tcp.flags.syn == 1 and tcp.flags.ack == 0    # TCP SYN Ğ¿Ğ°ĞºĞµÑ‚Ñ‹
â€¢ ip.src == 10.0.0.0/8 and not icmp           # Ğ¢Ñ€Ğ°Ñ„Ğ¸Ğº Ğ¸Ğ· 10.x.x.x ĞºÑ€Ğ¾Ğ¼Ğµ ping
â€¢ dns.qry.name contains "malware"              # DNS Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹ Ñ "malware"

Ğ’Ñ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ñ‹:
â€¢ frame.time >= "2024-01-01 00:00:00"         # ĞŸĞ°ĞºĞµÑ‚Ñ‹ Ğ¿Ğ¾ÑĞ»Ğµ Ğ´Ğ°Ñ‚Ñ‹
â€¢ tcp.time_delta > 1                          # ĞœĞµĞ´Ğ»ĞµĞ½Ğ½Ñ‹Ğµ TCP Ğ¾Ñ‚Ğ²ĞµÑ‚Ñ‹
```

**2. Follow Streams (ÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ğ¾Ñ‚Ğ¾ĞºĞ°Ğ¼)**

ĞŸĞ¾Ğ·Ğ²Ğ¾Ğ»ÑĞµÑ‚ Ğ²Ğ¸Ğ´ĞµÑ‚ÑŒ Ğ¿Ğ¾Ğ»Ğ½Ñ‹Ğ¹ Ğ´Ğ¸Ğ°Ğ»Ğ¾Ğ³ Ğ¼ĞµĞ¶Ğ´Ñƒ ĞºĞ»Ğ¸ĞµĞ½Ñ‚Ğ¾Ğ¼ Ğ¸ ÑĞµÑ€Ğ²ĞµÑ€Ğ¾Ğ¼.

```
Stream Analysis:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

TCP Stream Example:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Client â†’ Server: HTTP Request               â”‚
â”‚ GET /index.html HTTP/1.1                   â”‚
â”‚ Host: www.example.com                      â”‚
â”‚ User-Agent: Mozilla/5.0...                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Server â†’ Client: HTTP Response             â”‚
â”‚ HTTP/1.1 200 OK                           â”‚
â”‚ Content-Type: text/html                    â”‚
â”‚ Content-Length: 1234                       â”‚
â”‚                                            â”‚
â”‚ <html>...</html>                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Performance Analysis Ñ Wireshark

```
Network Performance Metrics:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. LATENCY ANALYSIS
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ TCP Handshake Timing:                  â”‚
   â”‚ â€¢ SYN â†’ SYN+ACK: Network RTT          â”‚
   â”‚ â€¢ SYN+ACK â†’ ACK: Processing delay     â”‚
   â”‚ â€¢ Total handshake time                â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

2. THROUGHPUT ANALYSIS
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Window Size Tracking:                  â”‚
   â”‚ â€¢ TCP window scaling                   â”‚
   â”‚ â€¢ Window full conditions               â”‚
   â”‚ â€¢ Bandwidth utilization               â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

3. LOSS DETECTION
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ TCP Issues:                           â”‚
   â”‚ â€¢ Duplicate ACKs                      â”‚
   â”‚ â€¢ Fast retransmissions               â”‚
   â”‚ â€¢ Out of order packets               â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.3.2 NetFlow/sFlow Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·

#### ĞŸĞ¾Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ğµ Flow-based Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³Ğ°

Flow - ÑÑ‚Ğ¾ Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ Ğ¿Ğ°ĞºĞµÑ‚Ğ¾Ğ² Ñ Ğ¾Ğ´Ğ¸Ğ½Ğ°ĞºĞ¾Ğ²Ñ‹Ğ¼Ğ¸ Ñ…Ğ°Ñ€Ğ°ĞºÑ‚ĞµÑ€Ğ¸ÑÑ‚Ğ¸ĞºĞ°Ğ¼Ğ¸.

```
Flow Definition:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

NetFlow v5 Flow Key (5-tuple):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â€¢ Source IP Address                     â”‚
â”‚ â€¢ Destination IP Address                â”‚
â”‚ â€¢ Source Port                          â”‚
â”‚ â€¢ Destination Port                      â”‚
â”‚ â€¢ Protocol (TCP/UDP/ICMP...)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
Flow Record:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Flow Key + Metadata:                   â”‚
â”‚ â€¢ Start/End timestamps                 â”‚
â”‚ â€¢ Packet count                         â”‚
â”‚ â€¢ Byte count                          â”‚
â”‚ â€¢ TCP flags                           â”‚
â”‚ â€¢ Input/Output interface              â”‚
â”‚ â€¢ Next hop IP                         â”‚
â”‚ â€¢ AS numbers                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### NetFlow vs sFlow

```
Sampling Comparison:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

NetFlow (Deterministic):           sFlow (Statistical):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€          â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Every Flow Tracked                 Packet Sampling
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Flow 1: 100%    â”‚                â”‚ Packet 1: âœ“     â”‚
â”‚ Flow 2: 100%    â”‚                â”‚ Packet 2: âœ—     â”‚
â”‚ Flow 3: 100%    â”‚                â”‚ Packet 3: âœ—     â”‚
â”‚ Flow 4: 100%    â”‚                â”‚ Packet 4: âœ“     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ĞŸÑ€ĞµĞ¸Ğ¼ÑƒÑ‰ĞµÑÑ‚Ğ²Ğ°:                      ĞŸÑ€ĞµĞ¸Ğ¼ÑƒÑ‰ĞµÑÑ‚Ğ²Ğ°:
â€¢ Ğ¢Ğ¾Ñ‡Ğ½Ğ°Ñ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ°               â€¢ ĞĞ¸Ğ·ĞºĞ°Ñ Ğ½Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ½Ğ° CPU
â€¢ Ğ”ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ            â€¢ ĞœĞ°ÑÑˆÑ‚Ğ°Ğ±Ğ¸Ñ€ÑƒĞµĞ¼Ğ¾ÑÑ‚ÑŒ
â€¢ Security Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·                 â€¢ ĞœÑƒĞ»ÑŒÑ‚Ğ¸Ğ²ĞµĞ½Ğ´Ğ¾Ñ€Ğ½Ğ¾ÑÑ‚ÑŒ

ĞĞµĞ´Ğ¾ÑÑ‚Ğ°Ñ‚ĞºĞ¸:                       ĞĞµĞ´Ğ¾ÑÑ‚Ğ°Ñ‚ĞºĞ¸:
â€¢ Ğ’Ñ‹ÑĞ¾ĞºĞ°Ñ Ğ½Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ½Ğ° CPU         â€¢ Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸Ñ‡ĞµÑĞºĞ°Ñ Ñ‚Ğ¾Ñ‡Ğ½Ğ¾ÑÑ‚ÑŒ
â€¢ ĞĞ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ½Ğ°Ñ Ğ¼Ğ°ÑÑˆÑ‚Ğ°Ğ±Ğ¸Ñ€ÑƒĞµĞ¼Ğ¾ÑÑ‚ÑŒ   â€¢ ĞœĞµĞ½ĞµĞµ Ğ´ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ
```

#### ĞŸÑ€Ğ¸Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ Flow Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ°

```
Flow Analytics Use Cases:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. CAPACITY PLANNING
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Interface Utilization Trends:          â”‚
   â”‚                                        â”‚
   â”‚ GigE 0/1  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ 80% (peak)       â”‚
   â”‚ GigE 0/2  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘ 60% (average)    â”‚
   â”‚ GigE 0/3  â–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘ 30% (low)        â”‚
   â”‚                                        â”‚
   â”‚ Prediction: GigE 0/1 needs upgrade    â”‚
   â”‚ in 6 months at current growth rate    â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

2. SECURITY MONITORING
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Anomaly Detection:                     â”‚
   â”‚                                        â”‚
   â”‚ â€¢ Unusual traffic patterns            â”‚
   â”‚ â€¢ DDoS attack signatures              â”‚
   â”‚ â€¢ Data exfiltration (large outbound)  â”‚
   â”‚ â€¢ Scanning activity (many dst ports)  â”‚
   â”‚ â€¢ Botnet communication patterns       â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

3. APPLICATION PERFORMANCE
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Top Talkers Analysis:                  â”‚
   â”‚                                        â”‚
   â”‚ Source IP    â†’ Destination  | Bytes    â”‚
   â”‚ 10.1.1.100   â†’ 172.16.1.5 | 2.3 GB   â”‚
   â”‚ 192.168.1.50 â†’ 10.0.0.100 | 1.8 GB   â”‚
   â”‚ 10.1.1.200   â†’ 8.8.8.8    | 1.2 GB   â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.3.3 SIEM Ğ¸ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ

#### Security Information and Event Management

```
SIEM Architecture:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Data Sources                Collection Layer         Processing Layer
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Firewalls   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ Log         â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ Correlation â”‚
â”‚ IDS/IPS     â”‚             â”‚ Collectors  â”‚          â”‚ Engine      â”‚
â”‚ Servers     â”‚             â”‚             â”‚          â”‚             â”‚
â”‚ Workstationsâ”‚             â”‚ â€¢ Syslog    â”‚          â”‚ â€¢ Rules     â”‚
â”‚ Applicationsâ”‚             â”‚ â€¢ SNMP      â”‚          â”‚ â€¢ Patterns  â”‚
â”‚ Network     â”‚             â”‚ â€¢ APIs      â”‚          â”‚ â€¢ ML/AI     â”‚
â”‚ Devices     â”‚             â”‚ â€¢ Agents    â”‚          â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚                        â”‚
                                   â–¼                        â–¼
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚ Normalizationâ”‚          â”‚ Alerting &  â”‚
                            â”‚ & Parsing   â”‚          â”‚ Dashboards  â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Event Correlation Rules

```
Correlation Examples:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. MULTIPLE FAILED LOGINS
   Rule: 
   IF (failed_login_count > 5) 
   AND (time_window < 5_minutes) 
   AND (same_source_ip)
   THEN generate_alert("Brute Force Attack")

2. PRIVILEGE ESCALATION
   Rule:
   IF (user_login) 
   AND (privilege_change within 10_minutes)
   AND (admin_access_granted)
   THEN generate_alert("Potential Privilege Escalation")

3. DATA EXFILTRATION
   Rule:
   IF (outbound_traffic > baseline * 3)
   AND (outside_business_hours)
   AND (sensitive_file_access_logged)
   THEN generate_alert("Possible Data Exfiltration")
```

#### Threat Intelligence Integration

```
Threat Intel Workflow:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

External Feeds              Internal Processing        Response Actions
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Commercial  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ IOC         â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ Automated   â”‚
â”‚ Feeds       â”‚             â”‚ Database    â”‚           â”‚ Blocking    â”‚
â”‚             â”‚             â”‚             â”‚           â”‚             â”‚
â”‚ Open Source â”‚             â”‚ â€¢ IPs       â”‚           â”‚ Manual      â”‚
â”‚ Intelligenceâ”‚             â”‚ â€¢ Domains   â”‚           â”‚ Investigationâ”‚
â”‚             â”‚             â”‚ â€¢ Hashes    â”‚           â”‚             â”‚
â”‚ Government  â”‚             â”‚ â€¢ URLs      â”‚           â”‚ Threat      â”‚
â”‚ Feeds       â”‚             â”‚ â€¢ Patterns  â”‚           â”‚ Hunting     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â–¼
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚ Enrichment  â”‚
                            â”‚ â€¢ Context   â”‚
                            â”‚ â€¢ Reputationâ”‚
                            â”‚ â€¢ History   â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.3.4 Threat Hunting

#### Proactive vs Reactive Security

```
Security Approaches:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

REACTIVE (Traditional):
Incident occurs â”€â”€â–º Detection â”€â”€â–º Response â”€â”€â–º Recovery
                     â”‚               â”‚
                  Signature      Containment
                   Based         & Cleanup

PROACTIVE (Threat Hunting):
Hypothesis â”€â”€â–º Hunt â”€â”€â–º Discover â”€â”€â–º Investigate â”€â”€â–º Improve
     â”‚          â”‚         â”‚            â”‚             â”‚
  Threat      Search    Anomalies   Root Cause    New Rules
  Intel       Patterns   Found      Analysis      & IOCs
```

#### Hunting Methodologies

```
Hunt Process Framework:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. HYPOTHESIS FORMATION
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Based on:                              â”‚
   â”‚ â€¢ Threat intelligence                   â”‚
   â”‚ â€¢ Attack frameworks (MITRE ATT&CK)     â”‚
   â”‚ â€¢ Environmental knowledge              â”‚
   â”‚ â€¢ Recent incidents                     â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

2. DATA COLLECTION
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Sources:                               â”‚
   â”‚ â€¢ Network logs (NetFlow, DNS, Proxy)   â”‚
   â”‚ â€¢ Host logs (System, Security, Apps)   â”‚
   â”‚ â€¢ Security tools (SIEM, IDS, EDR)     â”‚
   â”‚ â€¢ Threat intelligence feeds           â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

3. ANALYSIS TECHNIQUES
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Methods:                               â”‚
   â”‚ â€¢ Statistical analysis                 â”‚
   â”‚ â€¢ Pattern matching                     â”‚
   â”‚ â€¢ Behavioral analysis                  â”‚
   â”‚ â€¢ Timeline reconstruction              â”‚
   â”‚ â€¢ Pivot and drill-down                 â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ ĞŸÑ€Ğ°ĞºÑ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ

### Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ 1: ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ğ¸Ğ½Ñ†Ğ¸Ğ´ĞµĞ½Ñ‚Ğ° Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚Ğ¸

**Ğ¡Ñ†ĞµĞ½Ğ°Ñ€Ğ¸Ğ¹:** Ğ’ Ğ²Ğ°ÑˆĞµĞ¹ ÑĞµÑ‚Ğ¸ Ğ¾Ğ±Ğ½Ğ°Ñ€ÑƒĞ¶ĞµĞ½Ğ° Ğ¿Ğ¾Ğ´Ğ¾Ğ·Ñ€Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ°Ñ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ - Ğ¼Ğ½Ğ¾Ğ¶ĞµÑÑ‚Ğ²ĞµĞ½Ğ½Ñ‹Ğµ Ğ½ĞµÑƒĞ´Ğ°Ñ‡Ğ½Ñ‹Ğµ Ğ¿Ğ¾Ğ¿Ñ‹Ñ‚ĞºĞ¸ Ğ²Ñ…Ğ¾Ğ´Ğ°, Ğ·Ğ° ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğ¼Ğ¸ ÑĞ»ĞµĞ´ÑƒĞµÑ‚ ÑƒÑĞ¿ĞµÑˆĞ½Ğ°Ñ Ğ°ÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ Ğ¸ Ğ°Ğ½Ğ¾Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ ÑĞµÑ‚ĞµĞ²Ğ¾Ğ¹ Ñ‚Ñ€Ğ°Ñ„Ğ¸Ğº.

**Ğ’Ğ°ÑˆĞ¸ Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ:**
1. ĞĞ¿Ñ€ĞµĞ´ĞµĞ»Ğ¸Ñ‚Ğµ Ğ¸ÑÑ‚Ğ¾Ñ‡Ğ½Ğ¸ĞºĞ¸ Ğ»Ğ¾Ğ³Ğ¾Ğ² Ğ´Ğ»Ñ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ°
2. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹Ñ‚Ğµ timeline ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹
3. ĞŸÑ€Ğ¾Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ· Ñ‚Ñ€Ğ°Ñ„Ğ¸ĞºĞ°
4. ĞĞ¿Ñ€ĞµĞ´ĞµĞ»Ğ¸Ñ‚Ğµ scope Ğ¸Ğ½Ñ†Ğ¸Ğ´ĞµĞ½Ñ‚Ğ°
5. Ğ Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ğ¹Ñ‚Ğµ Ğ¿Ğ»Ğ°Ğ½ containment

### Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ 2: ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° 802.1X

**Ğ¦ĞµĞ»ÑŒ:** ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¸Ñ‚ÑŒ port-based authentication Ğ´Ğ»Ñ ĞºĞ¾Ñ€Ğ¿Ğ¾Ñ€Ğ°Ñ‚Ğ¸Ğ²Ğ½Ğ¾Ğ¹ ÑĞµÑ‚Ğ¸.

**ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹:**
- ĞšĞ¾Ğ¼Ğ¼ÑƒÑ‚Ğ°Ñ‚Ğ¾Ñ€Ñ‹ Ñ Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ¾Ğ¹ 802.1X
- RADIUS ÑĞµÑ€Ğ²ĞµÑ€ (FreeRADIUS)
- Certificate Authority
- ĞšĞ»Ğ¸ĞµĞ½Ñ‚ÑĞºĞ¸Ğµ ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ°

**Ğ¢Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ:**
- Dynamic VLAN assignment
- Quarantine VLAN Ğ´Ğ»Ñ Ğ½ĞµĞ°Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ñ… ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²
- Guest network Ğ´Ğ»Ñ Ğ¿Ğ¾ÑĞµÑ‚Ğ¸Ñ‚ĞµĞ»ĞµĞ¹

### Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ 3: ĞĞ½Ğ°Ğ»Ğ¸Ğ· NetFlow Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

**Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ°:** ĞŸÑ€Ğ¾Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ NetFlow Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ·Ğ° Ğ½ĞµĞ´ĞµĞ»Ñ Ğ¸ Ğ²Ñ‹ÑĞ²Ğ¸Ñ‚ÑŒ:
- Top talkers (Ğ¸ÑÑ‚Ğ¾Ñ‡Ğ½Ğ¸ĞºĞ¸ Ñ‚Ñ€Ğ°Ñ„Ğ¸ĞºĞ°)
- ĞĞ½Ğ¾Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ Ğ¿Ğ°Ñ‚Ñ‚ĞµÑ€Ğ½Ñ‹
- Potential security threats
- Capacity planning recommendations

---

## ğŸ“‹ ĞšĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»ÑŒĞ½Ñ‹Ğµ Ğ²Ğ¾Ğ¿Ñ€Ğ¾ÑÑ‹

### Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹ ÑƒÑ€Ğ¾Ğ²ĞµĞ½ÑŒ:
1. ĞĞ±ÑŠÑÑĞ½Ğ¸Ñ‚Ğµ Ñ€Ğ°Ğ·Ğ½Ğ¸Ñ†Ñƒ Ğ¼ĞµĞ¶Ğ´Ñƒ IDS Ğ¸ IPS
2. ĞšĞ°ĞºĞ¸Ğµ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹ Ğ²Ñ…Ğ¾Ğ´ÑÑ‚ Ğ² PKI Ğ¸Ğ½Ñ„Ñ€Ğ°ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñƒ?
3. Ğ§Ñ‚Ğ¾ Ñ‚Ğ°ĞºĞ¾Ğµ Zero Trust Ğ¸ ĞµĞ³Ğ¾ Ğ¾ÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ Ğ¿Ñ€Ğ¸Ğ½Ñ†Ğ¸Ğ¿Ñ‹?
4. Ğ§ĞµĞ¼ Ğ¾Ñ‚Ğ»Ğ¸Ñ‡Ğ°ĞµÑ‚ÑÑ NetFlow Ğ¾Ñ‚ sFlow?

### ĞŸÑ€Ğ¾Ğ´Ğ²Ğ¸Ğ½ÑƒÑ‚Ñ‹Ğ¹ ÑƒÑ€Ğ¾Ğ²ĞµĞ½ÑŒ:
1. ĞšĞ°Ğº Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ defense-in-depth Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ñƒ?
2. ĞšĞ°ĞºĞ¸Ğµ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ´Ğ»Ñ threat hunting?
3. ĞšĞ°Ğº Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ threat intelligence Ğ² SIEM?
4. ĞœĞµÑ‚Ğ¾Ğ´Ñ‹ Ğ¾Ğ±Ğ½Ğ°Ñ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ advanced persistent threats (APT)?

### Ğ­ĞºÑĞ¿ĞµÑ€Ñ‚Ğ½Ñ‹Ğ¹ ÑƒÑ€Ğ¾Ğ²ĞµĞ½ÑŒ:
1. Ğ Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ğ¹Ñ‚Ğµ ÑÑ‚Ñ€Ğ°Ñ‚ĞµĞ³Ğ¸Ñ Ğ¿ĞµÑ€ĞµÑ…Ğ¾Ğ´Ğ° Ğº Zero Trust
2. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹Ñ‚Ğµ Ğ¼ĞµÑ‚Ğ¾Ğ´Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ñ threat hunting Ğ´Ğ»Ñ Ğ²Ğ°ÑˆĞµĞ¹ Ğ¾Ñ€Ğ³Ğ°Ğ½Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸
3. Ğ¡Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ¸Ñ€ÑƒĞ¹Ñ‚Ğµ SIEM Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ñƒ Ğ´Ğ»Ñ enterprise ÑĞµÑ‚Ğ¸
4. ĞÑ†ĞµĞ½Ğ¸Ñ‚Ğµ ÑÑ„Ñ„ĞµĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ Ñ‚ĞµĞºÑƒÑ‰Ğ¸Ñ… security controls

---

## ğŸš€ Ğ¡Ğ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğµ ÑˆĞ°Ğ³Ğ¸

ĞŸĞ¾ÑĞ»Ğµ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾Ğ³Ğ¾ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¸Ñ ÑÑ‚Ğ¾Ğ³Ğ¾ Ğ±Ğ»Ğ¾ĞºĞ° Ğ²Ñ‹ Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ñ‹ Ğº:

**Ğ‘Ğ»Ğ¾Ğº 6: Ğ¡Ğ¾Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ Ñ‚ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ğ¸ Ğ¸ Ğ¾Ğ±Ğ»Ğ°ĞºĞ°**
- Software-Defined Networking (SDN)
- ĞĞ±Ğ»Ğ°Ñ‡Ğ½Ñ‹Ğµ ÑĞµÑ‚ĞµĞ²Ñ‹Ğµ ÑĞµÑ€Ğ²Ğ¸ÑÑ‹
- ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¸ Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ ÑĞµÑ‚ĞµĞ¹
- Container Ğ¸ microservices networking

**ĞŸÑ€Ğ¾Ñ„ĞµÑÑĞ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ Ñ†ĞµĞ»Ğ¸:**
- Security Architect Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ğ¸
- SOC Analyst/Manager Ñ€Ğ¾Ğ»Ğ¸
- Network Security Engineer Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ğ¸
- ĞšĞ¾Ğ½ÑĞ°Ğ»Ñ‚Ğ¸Ğ½Ğ³ Ğ¿Ğ¾ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ğ¾Ğ½Ğ½Ğ¾Ğ¹ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚Ğ¸

**Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµĞ¼Ñ‹Ğµ ÑĞµÑ€Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸:**
- CISSP (Certified Information Systems Security Professional)
- CCNP Security
- GCIH (GIAC Certified Incident Handler)
- CEH (Certified Ethical Hacker)