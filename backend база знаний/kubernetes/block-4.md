# ğŸ”’ Ğ‘Ğ»Ğ¾Ğº 4: Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ Ğ¸ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ¾Ğ¼ Ğ² Kubernetes

**â±ï¸ ĞŸÑ€Ğ¾Ğ´Ğ¾Ğ»Ğ¶Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ:** 2-3 Ğ½ĞµĞ´ĞµĞ»Ğ¸  
**ğŸ¯ Ğ¦ĞµĞ»ÑŒ:** ĞÑĞ²Ğ¾Ğ¸Ñ‚ÑŒ Ğ¿Ñ€Ğ¸Ğ½Ñ†Ğ¸Ğ¿Ñ‹ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚Ğ¸ Ğ² Kubernetes  
**ğŸ“ Ğ£Ñ€Ğ¾Ğ²ĞµĞ½ÑŒ:** Ğ¡Ñ€ĞµĞ´Ğ½Ğ¸Ğ¹ â†’ ĞŸÑ€Ğ¾Ğ´Ğ²Ğ¸Ğ½ÑƒÑ‚Ñ‹Ğ¹

---

## ğŸ“– Ğ’Ğ²ĞµĞ´ĞµĞ½Ğ¸Ğµ Ğ² Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ Kubernetes

Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ Ğ² Kubernetes â€” ÑÑ‚Ğ¾ Ğ½Ğµ Ğ¾Ğ´Ğ½Ğ° Ñ‚ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ñ, Ğ° ĞºĞ¾Ğ¼Ğ¿Ğ»ĞµĞºÑĞ½Ğ°Ñ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ° Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ñ‹, Ğ¿Ğ¾ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ½Ğ°Ñ Ğ½Ğ° Ğ¿Ñ€Ğ¸Ğ½Ñ†Ğ¸Ğ¿Ğ°Ñ…:

**ğŸ›¡ï¸ ĞœĞ½Ğ¾Ğ³Ğ¾ÑƒÑ€Ğ¾Ğ²Ğ½ĞµĞ²Ğ°Ñ Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ğ° (Defense in Depth)**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Cloud/Network Layer           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚           Cluster Layer                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚           Node Layer                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚           Pod/Container Layer           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ” ĞŸÑ€Ğ¸Ğ½Ñ†Ğ¸Ğ¿ Ğ¼Ğ¸Ğ½Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ñ… Ğ¿Ñ€Ğ¸Ğ²Ğ¸Ğ»ĞµĞ³Ğ¸Ğ¹ (Principle of Least Privilege)**
- ĞšĞ°Ğ¶Ğ´Ñ‹Ğ¹ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ°ĞµÑ‚ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ½ĞµĞ¾Ğ±Ñ…Ğ¾Ğ´Ğ¸Ğ¼Ñ‹Ğµ Ğ¿Ñ€Ğ°Ğ²Ğ°
- Ğ ĞµĞ³ÑƒĞ»ÑÑ€Ğ½Ñ‹Ğ¹ Ğ°ÑƒĞ´Ğ¸Ñ‚ Ğ¸ Ğ¿ĞµÑ€ĞµÑĞ¼Ğ¾Ñ‚Ñ€ Ñ€Ğ°Ğ·Ñ€ĞµÑˆĞµĞ½Ğ¸Ğ¹
- Ğ’Ñ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ Ñ‚Ğ¾ĞºĞµĞ½Ñ‹ Ğ²Ğ¼ĞµÑÑ‚Ğ¾ Ğ¿Ğ¾ÑÑ‚Ğ¾ÑĞ½Ğ½Ñ‹Ñ… ĞºĞ»ÑÑ‡ĞµĞ¹

---

## 4.1 RBAC (Role-Based Access Control)

### ğŸ¯ ĞšĞ¾Ğ½Ñ†ĞµĞ¿Ñ†Ğ¸Ñ RBAC

RBAC Ğ² Kubernetes â€” ÑÑ‚Ğ¾ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ° Ğ°Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸, ĞºĞ¾Ñ‚Ğ¾Ñ€Ğ°Ñ Ñ€ĞµĞ³ÑƒĞ»Ğ¸Ñ€ÑƒĞµÑ‚ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ Ğº Ñ€ĞµÑÑƒÑ€ÑĞ°Ğ¼ ĞºĞ»Ğ°ÑÑ‚ĞµÑ€Ğ° Ğ½Ğ° Ğ¾ÑĞ½Ğ¾Ğ²Ğµ Ñ€Ğ¾Ğ»ĞµĞ¹ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹.

**Ğ¤Ğ¸Ğ»Ğ¾ÑĞ¾Ñ„Ğ¸Ñ RBAC:**
- **"ĞšÑ‚Ğ¾?"** (Ğ¡ÑƒĞ±ÑŠĞµĞºÑ‚) â†’ **"Ğ§Ñ‚Ğ¾ Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ´ĞµĞ»Ğ°Ñ‚ÑŒ?"** (Ğ Ğ¾Ğ»ÑŒ) â†’ **"Ğ¡ Ñ‡ĞµĞ¼?"** (Ğ ĞµÑÑƒÑ€Ñ)

---

### ğŸ—ï¸ ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° RBAC

```
        ĞŸĞĞ›Ğ¬Ğ—ĞĞ’ĞĞ¢Ğ•Ğ›Ğ˜/Ğ¡Ğ•Ğ Ğ’Ğ˜Ğ¡Ğ«
              â”‚
              â”‚ ÑĞ²ÑĞ·Ñ‹Ğ²Ğ°ĞµÑ‚ÑÑ Ñ‡ĞµÑ€ĞµĞ·
              â–¼
         Ğ ĞĞ›Ğ˜ (ROLES)
              â”‚
              â”‚ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ÑÑÑ‚ Ğ¿Ñ€Ğ°Ğ²Ğ° Ğ½Ğ°
              â–¼
      Ğ Ğ•Ğ¡Ğ£Ğ Ğ¡Ğ« KUBERNETES
```

**ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹:**

1. **Ğ¡ÑƒĞ±ÑŠĞµĞºÑ‚Ñ‹ (Subjects)**
   - Users (Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ğ¸)
   - Groups (Ğ³Ñ€ÑƒĞ¿Ğ¿Ñ‹ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹)
   - Service Accounts (ÑĞµÑ€Ğ²Ğ¸ÑĞ½Ñ‹Ğµ ÑƒÑ‡ĞµÑ‚Ğ½Ñ‹Ğµ Ğ·Ğ°Ğ¿Ğ¸ÑĞ¸)

2. **Ğ Ğ¾Ğ»Ğ¸ (Roles)**
   - **Role** â€” Ğ¿Ñ€Ğ°Ğ²Ğ° Ğ² Ñ€Ğ°Ğ¼ĞºĞ°Ñ… namespace
   - **ClusterRole** â€” Ğ¿Ñ€Ğ°Ğ²Ğ° Ğ½Ğ° ÑƒÑ€Ğ¾Ğ²Ğ½Ğµ Ğ²ÑĞµĞ³Ğ¾ ĞºĞ»Ğ°ÑÑ‚ĞµÑ€Ğ°

3. **ĞŸÑ€Ğ¸Ğ²ÑĞ·ĞºĞ¸ (Bindings)**
   - **RoleBinding** â€” ÑĞ²ÑĞ·Ñ‹Ğ²Ğ°ĞµÑ‚ ÑÑƒĞ±ÑŠĞµĞºÑ‚ Ñ Ñ€Ğ¾Ğ»ÑŒÑ Ğ² namespace
   - **ClusterRoleBinding** â€” ÑĞ²ÑĞ·Ñ‹Ğ²Ğ°ĞµÑ‚ ÑÑƒĞ±ÑŠĞµĞºÑ‚ Ñ ĞºĞ»Ğ°ÑÑ‚ĞµÑ€Ğ½Ğ¾Ğ¹ Ñ€Ğ¾Ğ»ÑŒÑ

---

### ğŸ­ Ğ¢Ğ¸Ğ¿Ñ‹ Ñ€Ğ¾Ğ»ĞµĞ¹ Ğ¸ Ğ¸Ñ… Ğ¾Ğ±Ğ»Ğ°ÑÑ‚ÑŒ Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ

```
CLUSTER LEVEL                    NAMESPACE LEVEL
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ClusterRole   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      Role       â”‚
â”‚                 â”‚             â”‚                 â”‚
â”‚ â€¢ Nodes         â”‚             â”‚ â€¢ Pods          â”‚
â”‚ â€¢ Namespaces    â”‚             â”‚ â€¢ Services      â”‚
â”‚ â€¢ PVs           â”‚             â”‚ â€¢ ConfigMaps    â”‚
â”‚ â€¢ CRDs          â”‚             â”‚ â€¢ Secrets       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                               â”‚
        â–¼                               â–¼
ClusterRoleBinding                RoleBinding
```

**ĞšĞ¾Ğ³Ğ´Ğ° Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ Role vs ClusterRole:**

**Role** â€” Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ ĞºĞ¾Ğ³Ğ´Ğ°:
- ĞÑƒĞ¶Ğ½Ğ¾ Ğ¾Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ‡Ğ¸Ñ‚ÑŒ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ Ğ² Ğ¿Ñ€ĞµĞ´ĞµĞ»Ğ°Ñ… Ğ¾Ğ´Ğ½Ğ¾Ğ³Ğ¾ namespace
- Ğ Ğ°Ğ±Ğ¾Ñ‚Ğ° Ñ Ğ¾Ğ±Ñ‹Ñ‡Ğ½Ñ‹Ğ¼Ğ¸ Ñ€ĞµÑÑƒÑ€ÑĞ°Ğ¼Ğ¸ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¹ (pods, services, configmaps)
- ĞšĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ° Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸ĞºĞ¾Ğ² Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ ÑĞ¾ ÑĞ²Ğ¾Ğ¸Ğ¼ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ¾Ğ¼

**ClusterRole** â€” Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ ĞºĞ¾Ğ³Ğ´Ğ°:
- ĞÑƒĞ¶ĞµĞ½ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ Ğº Ñ€ĞµÑÑƒÑ€ÑĞ°Ğ¼ Ğ²ÑĞµĞ³Ğ¾ ĞºĞ»Ğ°ÑÑ‚ĞµÑ€Ğ°
- Ğ Ğ°Ğ±Ğ¾Ñ‚Ğ° Ñ Ğ³Ğ»Ğ¾Ğ±Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¼Ğ¸ Ñ€ĞµÑÑƒÑ€ÑĞ°Ğ¼Ğ¸ (nodes, persistent volumes)
- ĞĞ´Ğ¼Ğ¸Ğ½Ğ¸ÑÑ‚Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ ĞºĞ»Ğ°ÑÑ‚ĞµÑ€Ğ°

---

### ğŸ¯ ĞŸÑ€Ğ¸Ğ½Ñ†Ğ¸Ğ¿Ñ‹ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ ÑÑ„Ñ„ĞµĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ñ… Ñ€Ğ¾Ğ»ĞµĞ¹

**1. Ğ“Ñ€Ğ°Ğ½ÑƒĞ»ÑÑ€Ğ½Ğ¾ÑÑ‚ÑŒ Ñ€Ğ°Ğ·Ñ€ĞµÑˆĞµĞ½Ğ¸Ğ¹**
```
ĞŸĞ›ĞĞ¥Ğ: verb: ["*"]
Ğ¥ĞĞ ĞĞ¨Ğ: verb: ["get", "list", "watch"]

ĞŸĞ›ĞĞ¥Ğ: resources: ["*"]  
Ğ¥ĞĞ ĞĞ¨Ğ: resources: ["pods", "services"]
```

**2. Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ resourceNames Ğ´Ğ»Ñ Ñ‚Ğ¾Ñ‡ĞµÑ‡Ğ½Ğ¾Ğ³Ğ¾ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ°**
```
ĞŸÑ€Ğ¸Ğ¼ĞµÑ€: Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğº ĞºĞ¾Ğ½ĞºÑ€ĞµÑ‚Ğ½Ğ¾Ğ¼Ñƒ ÑĞµĞºÑ€ĞµÑ‚Ñƒ
resources: ["secrets"]
resourceNames: ["my-app-secret"]
```

**3. Ğ˜ĞµÑ€Ğ°Ñ€Ñ…Ğ¸Ñ Ñ€Ğ¾Ğ»ĞµĞ¹**
```
    cluster-admin (Ğ²ÑĞµ Ğ¿Ñ€Ğ°Ğ²Ğ°)
           â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
    â”‚             â”‚
namespace-admin  view-only
    â”‚             â”‚
app-developer  auditor
```

---

### ğŸ” ĞÑƒĞ´Ğ¸Ñ‚ Ğ¸ Ğ¾Ñ‚Ğ»Ğ°Ğ´ĞºĞ° RBAC

**ĞšĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹ Ğ´Ğ»Ñ Ğ´Ğ¸Ğ°Ğ³Ğ½Ğ¾ÑÑ‚Ğ¸ĞºĞ¸:**

1. **ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ¿Ñ€Ğ°Ğ² Ñ‚ĞµĞºÑƒÑ‰ĞµĞ³Ğ¾ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ:**
   ```bash
   kubectl auth can-i <verb> <resource>
   kubectl auth can-i create pods
   kubectl auth can-i get secrets --namespace=production
   ```

2. **ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ¿Ñ€Ğ°Ğ² Ğ´Ñ€ÑƒĞ³Ğ¾Ğ³Ğ¾ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ:**
   ```bash
   kubectl auth can-i get pods --as=developer@company.com
   ```

3. **ĞŸÑ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ Ğ²ÑĞµÑ… Ğ¿Ñ€Ğ¸Ğ²ÑĞ·Ğ¾Ğº:**
   ```bash
   kubectl get rolebindings,clusterrolebindings --all-namespaces
   ```

**ğŸ“Š ĞœĞ°Ñ‚Ñ€Ğ¸Ñ†Ğ° Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ° RBAC:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒâ”‚ Ğ Ğ¾Ğ»ÑŒ  â”‚ Ğ ĞµÑÑƒÑ€Ñ  â”‚ Ğ“Ğ»Ğ°Ğ³Ğ¾Ğ» â”‚ Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”œ
â”‚ developer    â”‚ edit  â”‚ pods    â”‚ create â”‚ âœ… Ğ”Ğ   â”‚
â”‚ developer    â”‚ edit  â”‚ secrets â”‚ delete â”‚ âŒ ĞĞ•Ğ¢  â”‚  
â”‚ admin        â”‚ admin â”‚ *       â”‚ *      â”‚ âœ… Ğ”Ğ   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4.2 Service Accounts Ğ¸ Ğ°ÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ

### ğŸ¯ ĞŸĞ¾Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ğµ Service Accounts

Service Account â€” ÑÑ‚Ğ¾ ÑĞ¿Ğ¾ÑĞ¾Ğ± Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ´Ğ¾Ğ² Ğ¸ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ğ² Ğ²Ğ½ÑƒÑ‚Ñ€Ğ¸ ĞºĞ»Ğ°ÑÑ‚ĞµÑ€Ğ° Ğ°ÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸Ñ†Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒÑÑ Ğ² Kubernetes API.

**Ğ Ğ°Ğ·Ğ»Ğ¸Ñ‡Ğ¸Ñ Ğ¼ĞµĞ¶Ğ´Ñƒ Ñ‚Ğ¸Ğ¿Ğ°Ğ¼Ğ¸ Ğ°ĞºĞºĞ°ÑƒĞ½Ñ‚Ğ¾Ğ²:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Ğ¢Ğ˜ĞŸĞ« ĞĞšĞšĞĞ£ĞĞ¢ĞĞ’                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   USER ACCOUNTS     â”‚      SERVICE ACCOUNTS         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Ğ”Ğ»Ñ Ğ»ÑĞ´ĞµĞ¹         â”‚ â€¢ Ğ”Ğ»Ñ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¹ Ğ¸ ÑĞµÑ€Ğ²Ğ¸ÑĞ¾Ğ²   â”‚
â”‚ â€¢ Ğ“Ğ»Ğ¾Ğ±Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ        â”‚ â€¢ ĞŸÑ€Ğ¸Ğ²ÑĞ·Ğ°Ğ½Ñ‹ Ğº namespace       â”‚
â”‚ â€¢ Ğ’Ğ½ĞµÑˆĞ½ÑÑ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ°   â”‚ â€¢ Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ÑÑÑ‚ÑÑ Kubernetes      â”‚  
â”‚ â€¢ OIDC, LDAP        â”‚ â€¢ JWT Ñ‚Ğ¾ĞºĞµĞ½Ñ‹                  â”‚
â”‚ â€¢ Ğ¡ĞµÑ€Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ‚Ñ‹       â”‚ â€¢ ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### ğŸ” Ğ–Ğ¸Ğ·Ğ½ĞµĞ½Ğ½Ñ‹Ğ¹ Ñ†Ğ¸ĞºĞ» Service Account Token

```
1. Ğ¡ĞĞ—Ğ”ĞĞĞ˜Ğ• ĞŸĞĞ”Ğ
   â”‚
   â”‚ Kubernetes Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸:
   â–¼
2. ĞŸĞ Ğ˜Ğ’Ğ¯Ğ—ĞšĞ SERVICE ACCOUNT
   â”‚ (default Ğ¸Ğ»Ğ¸ ÑƒĞºĞ°Ğ·Ğ°Ğ½Ğ½Ñ‹Ğ¹)
   â–¼
3. Ğ“Ğ•ĞĞ•Ğ ĞĞ¦Ğ˜Ğ¯ JWT Ğ¢ĞĞšĞ•ĞĞ
   â”‚ (Ñ Ğ¾Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ½Ñ‹Ğ¼ Ğ²Ñ€ĞµĞ¼ĞµĞ½ĞµĞ¼ Ğ¶Ğ¸Ğ·Ğ½Ğ¸)
   â–¼
4. ĞœĞĞĞ¢Ğ˜Ğ ĞĞ’ĞĞĞ˜Ğ• Ğ’ ĞŸĞĞ”
   â”‚ (/var/run/secrets/kubernetes.io/serviceaccount/)
   â–¼
5. Ğ˜Ğ¡ĞŸĞĞ›Ğ¬Ğ—ĞĞ’ĞĞĞ˜Ğ• Ğ”Ğ›Ğ¯ API Ğ—ĞĞŸĞ ĞĞ¡ĞĞ’
   â”‚
   â–¼
6. ĞĞ’Ğ¢ĞĞœĞĞ¢Ğ˜Ğ§Ğ•Ğ¡ĞšĞĞ• ĞĞ‘ĞĞĞ’Ğ›Ğ•ĞĞ˜Ğ•
   (Ğ¿Ñ€Ğ¸ Ğ½ĞµĞ¾Ğ±Ñ…Ğ¾Ğ´Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸)
```

**Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ñ‚Ğ¾ĞºĞµĞ½Ğ° Ğ² Ğ¿Ğ¾Ğ´Ğµ:**
```
/var/run/secrets/kubernetes.io/serviceaccount/
â”œâ”€â”€ token          # JWT Ñ‚Ğ¾ĞºĞµĞ½ Ğ´Ğ»Ñ Ğ°ÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸
â”œâ”€â”€ ca.crt         # Ğ¡ĞµÑ€Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ‚ Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸ API ÑĞµÑ€Ğ²ĞµÑ€Ğ°
â””â”€â”€ namespace      # Ğ¢ĞµĞºÑƒÑ‰Ğ¸Ğ¹ namespace
```

---

### ğŸ­ Ğ¢Ğ¸Ğ¿Ñ‹ Ğ°ÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸ Ğ² Kubernetes

**1. Service Account Tokens (Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ´Ğ¾Ğ²)**
```
Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚ JWT Ñ‚Ğ¾ĞºĞµĞ½Ğ°:
eyJhbGciOiJSUzI1NiIsImt...
â”‚
â”œâ”€ Header: Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼ Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞ¸
â”œâ”€ Payload: claims (ĞºÑ‚Ğ¾, ĞºĞ¾Ğ³Ğ´Ğ°, Ğ¿Ñ€Ğ°Ğ²Ğ°)
â””â”€ Signature: Ñ†Ğ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ñ Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑÑŒ
```

**2. OIDC (OpenID Connect) Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    1. ĞÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Client    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚ OIDC Providerâ”‚
â”‚             â”‚                        â”‚ (Azure AD,   â”‚
â”‚             â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚  Google)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    2. ID Token         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 3. Ğ—Ğ°Ğ¿Ñ€Ğ¾Ñ Ğº K8s API Ñ Ñ‚Ğ¾ĞºĞµĞ½Ğ¾Ğ¼
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Kubernetes  â”‚
â”‚ API Server  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**3. Webhook Token Authentication**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   Token   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   HTTP   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Kubernetes   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚   Webhook   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚  External   â”‚
â”‚ API Server   â”‚           â”‚ Authenti-   â”‚          â”‚   Auth      â”‚
â”‚              â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ cator       â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  Service    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  Response â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ Response â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### ğŸ›¡ï¸ Best Practices Ğ´Ğ»Ñ Service Accounts

**1. ĞŸÑ€Ğ¸Ğ½Ñ†Ğ¸Ğ¿ Ğ¼Ğ¸Ğ½Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ñ… Ğ¿Ñ€Ğ¸Ğ²Ğ¸Ğ»ĞµĞ³Ğ¸Ğ¹**
```
âŒ ĞŸĞ›ĞĞ¥Ğ:
serviceAccountName: default
# Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ½Ñ‹Ğ¹ SA ÑĞ¾ Ğ²ÑĞµĞ¼Ğ¸ Ğ¿Ñ€Ğ°Ğ²Ğ°Ğ¼Ğ¸

âœ… Ğ¥ĞĞ ĞĞ¨Ğ:
serviceAccountName: my-app-reader
# ÑĞ¾Ğ·Ğ´Ğ°Ğ½ ÑĞ¿ĞµÑ†Ğ¸Ğ°Ğ»ÑŒĞ½Ğ¾ Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ
```

**2. ĞÑ‚ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ³Ğ¾ Ğ¼Ğ¾Ğ½Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ñ‚Ğ¾ĞºĞµĞ½Ğ¾Ğ²**
```yaml
# ĞĞ° ÑƒÑ€Ğ¾Ğ²Ğ½Ğµ Service Account
apiVersion: v1
kind: ServiceAccount
metadata:
  name: no-token-sa
automountServiceAccountToken: false

# ĞĞ° ÑƒÑ€Ğ¾Ğ²Ğ½Ğµ Pod
spec:
  automountServiceAccountToken: false
```

**3. Ğ Ğ¾Ñ‚Ğ°Ñ†Ğ¸Ñ Ñ‚Ğ¾ĞºĞµĞ½Ğ¾Ğ²**
```
BOUND SERVICE ACCOUNT TOKENS:
â”œâ”€ Ğ’Ñ€ĞµĞ¼Ñ Ğ¶Ğ¸Ğ·Ğ½Ğ¸: 1 Ñ‡Ğ°Ñ (Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ)
â”œâ”€ ĞŸÑ€Ğ¸Ğ²ÑĞ·Ğ°Ğ½Ñ‹ Ğº ĞºĞ¾Ğ½ĞºÑ€ĞµÑ‚Ğ½Ğ¾Ğ¼Ñƒ Ğ¿Ğ¾Ğ´Ñƒ
â”œâ”€ ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ
â””â”€ ĞÑƒĞ´Ğ¸Ñ‚ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
```

---

## 4.3 Pod Security Standards

### ğŸ¯ Ğ­Ğ²Ğ¾Ğ»ÑÑ†Ğ¸Ñ Pod Security

```
Ğ˜Ğ¡Ğ¢ĞĞ Ğ˜Ğ¯ Ğ ĞĞ—Ğ’Ğ˜Ğ¢Ğ˜Ğ¯ Ğ‘Ğ•Ğ—ĞĞŸĞĞ¡ĞĞĞ¡Ğ¢Ğ˜ ĞŸĞĞ”ĞĞ’:

2017-2021: Pod Security Policies (PSP)
    â”‚ ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ñ‹: ÑĞ»Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚ÑŒ, Ğ½ĞµĞ¿Ñ€ĞµĞ´ÑĞºĞ°Ğ·ÑƒĞµĞ¼Ğ¾ÑÑ‚ÑŒ
    â–¼
2021-2022: Pod Security Standards (PSS)  
    â”‚ Ğ£Ğ¿Ñ€Ğ¾Ñ‰ĞµĞ½Ğ¸Ğµ Ğ¸ ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ
    â–¼
2022+: Pod Security Admission (PSA)
    â”‚ Ğ’ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ½Ñ‹Ğ¹ Ğ¼ĞµÑ…Ğ°Ğ½Ğ¸Ğ·Ğ¼ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»Ñ
```

---

### ğŸ—ï¸ Ğ¢Ñ€Ğ¸ ÑƒÑ€Ğ¾Ğ²Ğ½Ñ Pod Security Standards

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 SECURITY LEVELS                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PRIVILEGED  â”‚    BASELINE     â”‚     RESTRICTED      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Ğ‘ĞµĞ·         â”‚ ĞœĞ¸Ğ½Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ     â”‚ Ğ¡Ñ‚Ñ€Ğ¾Ğ³Ğ¸Ğµ Ğ¾Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ¸Ñâ”‚
â”‚ Ğ¾Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ¸Ğ¹ â”‚ Ğ¾Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ¸Ñ     â”‚ Ğ¿Ğ¾ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚Ğ¸     â”‚
â”‚             â”‚                 â”‚                     â”‚
â”‚ â€¢ Legacy    â”‚ â€¢ Ğ˜Ğ·Ğ²ĞµÑÑ‚Ğ½Ñ‹Ğµ     â”‚ â€¢ Hardened          â”‚
â”‚   apps      â”‚   privileged    â”‚   applications      â”‚
â”‚ â€¢ System    â”‚   escalations   â”‚ â€¢ Defense in depth  â”‚
â”‚   pods      â”‚ â€¢ Host access   â”‚ â€¢ Compliance        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### ğŸ”’ Ğ”ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ñ€Ğ°Ğ·Ğ±Ğ¾Ñ€ ÑƒÑ€Ğ¾Ğ²Ğ½ĞµĞ¹ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚Ğ¸

**PRIVILEGED (ĞŸÑ€Ğ¸Ğ²Ğ¸Ğ»ĞµĞ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹)**
```
Ğ Ğ°Ğ·Ñ€ĞµÑˆĞµĞ½Ğ¾ Ğ’Ğ¡Ğ•:
â”œâ”€ privileged: true
â”œâ”€ hostNetwork: true  
â”œâ”€ hostPID: true
â”œâ”€ hostIPC: true
â”œâ”€ Ğ›ÑĞ±Ñ‹Ğµ volume Ñ‚Ğ¸Ğ¿Ñ‹
â””â”€ Ğ—Ğ°Ğ¿ÑƒÑĞº Ğ¾Ñ‚ root (UID 0)

Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ: ÑĞ¸ÑÑ‚ĞµĞ¼Ğ½Ñ‹Ğµ Ğ¿Ğ¾Ğ´Ñ‹, CNI, CSI Ğ´Ñ€Ğ°Ğ¹Ğ²ĞµÑ€Ñ‹
```

**BASELINE (Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹)**
```
Ğ—ĞĞŸĞ Ğ•Ğ©Ğ•ĞĞ:
â”œâ”€ privileged: true
â”œâ”€ hostNetwork: true
â”œâ”€ hostPID: true  
â”œâ”€ hostIPC: true
â”œâ”€ hostPath volumes
â”œâ”€ hostPort mapping
â”œâ”€ AppArmor: Unconfined
â”œâ”€ SELinux: Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒÑĞºĞ¸Ğµ Ñ‚Ğ¸Ğ¿Ñ‹
â”œâ”€ /proc mount options
â”œâ”€ Sysctl Ğ¼Ğ¾Ğ´Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸
â”œâ”€ privileged capabilities
â””â”€ HostProcess containers (Windows)

Ğ ĞĞ—Ğ Ğ•Ğ¨Ğ•ĞĞ: Ğ±Ğ¾Ğ»ÑŒÑˆĞ¸Ğ½ÑÑ‚Ğ²Ğ¾ Ğ¾Ğ±Ñ‹Ñ‡Ğ½Ñ‹Ñ… Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¹
```

**RESTRICTED (ĞĞ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ½Ñ‹Ğ¹)**
```
Ğ’Ğ¡Ğ• ĞĞ“Ğ ĞĞĞ˜Ğ§Ğ•ĞĞ˜Ğ¯ BASELINE +
â”œâ”€ runAsNonRoot: true (Ğ¾Ğ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾)
â”œâ”€ allowPrivilegeEscalation: false
â”œâ”€ capabilities: Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ NET_BIND_SERVICE
â”œâ”€ seccompProfile: RuntimeDefault Ğ¸Ğ»Ğ¸ Localhost
â”œâ”€ readOnlyRootFilesystem: true (Ñ€ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµÑ‚ÑÑ)
â””â”€ ĞĞ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ½Ñ‹Ğµ volume types
```

---

### ğŸšï¸ Ğ ĞµĞ¶Ğ¸Ğ¼Ñ‹ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹ Pod Security Admission

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 ENFORCEMENT MODES                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   ENFORCE   â”‚      AUDIT      â”‚        WARN         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Ğ‘Ğ»Ğ¾ĞºĞ¸Ñ€ÑƒĞµÑ‚   â”‚ Ğ Ğ°Ğ·Ñ€ĞµÑˆĞ°ĞµÑ‚ +     â”‚ Ğ Ğ°Ğ·Ñ€ĞµÑˆĞ°ĞµÑ‚ +         â”‚
â”‚ Ğ½Ğ°Ñ€ÑƒÑˆĞµĞ½Ğ¸Ñ   â”‚ Ğ·Ğ°Ğ¿Ğ¸ÑÑ‹Ğ²Ğ°ĞµÑ‚ Ğ²    â”‚ Ğ¿Ñ€ĞµĞ´ÑƒĞ¿Ñ€ĞµĞ¶Ğ´ĞµĞ½Ğ¸Ğµ      â”‚
â”‚             â”‚ audit log       â”‚ Ğ² Ğ¾Ñ‚Ğ²ĞµÑ‚Ğµ            â”‚
â”‚             â”‚                 â”‚                     â”‚
â”‚ Production  â”‚ ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³      â”‚ Development         â”‚
â”‚ Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ   â”‚ ÑĞ¾Ğ¾Ñ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²Ğ¸Ñ    â”‚ Testing             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ Ğ½Ğ° ÑƒÑ€Ğ¾Ğ²Ğ½Ğµ namespace:**
```yaml
apiVersion: v1
kind: Namespace
metadata:
  name: secure-namespace
  labels:
    # ĞĞ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾Ğµ ÑĞ¾Ğ±Ğ»ÑĞ´ĞµĞ½Ğ¸Ğµ baseline
    pod-security.kubernetes.io/enforce: baseline
    pod-security.kubernetes.io/enforce-version: v1.28
    
    # ĞÑƒĞ´Ğ¸Ñ‚ Ğ½Ğ° ÑƒÑ€Ğ¾Ğ²Ğ½Ğµ restricted
    pod-security.kubernetes.io/audit: restricted
    pod-security.kubernetes.io/audit-version: v1.28
    
    # ĞŸÑ€ĞµĞ´ÑƒĞ¿Ñ€ĞµĞ¶Ğ´ĞµĞ½Ğ¸Ñ Ğ´Ğ»Ñ restricted
    pod-security.kubernetes.io/warn: restricted
    pod-security.kubernetes.io/warn-version: v1.28
```

---

### ğŸ›¡ï¸ Security Context: Ğ´ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ğ°Ñ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ

**Ğ˜ĞµÑ€Ğ°Ñ€Ñ…Ğ¸Ñ Security Context:**
```
POD SECURITY CONTEXT
â”œâ”€ ĞĞ±Ñ‰Ğ¸Ğµ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ´Ğ»Ñ Ğ²ÑĞµÑ… ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ¾Ğ²
â”œâ”€ runAsUser: 1000
â”œâ”€ runAsGroup: 1000  
â”œâ”€ fsGroup: 1000
â””â”€ supplementalGroups: [1000, 2000]
    â”‚
    â””â”€ CONTAINER SECURITY CONTEXT
       â”œâ”€ ĞŸĞµÑ€ĞµĞ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ÑĞµÑ‚ pod-level Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸
       â”œâ”€ allowPrivilegeEscalation: false
       â”œâ”€ runAsNonRoot: true
       â”œâ”€ readOnlyRootFilesystem: true
       â””â”€ capabilities:
          â”œâ”€ drop: ["ALL"]
          â””â”€ add: ["NET_BIND_SERVICE"]
```

**ĞŸÑ€Ğ°ĞºÑ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€ secure Ğ¿Ğ¾Ğ´Ğ°:**
```yaml
apiVersion: v1
kind: Pod
metadata:
  name: secure-app
spec:
  # Pod Security Context
  securityContext:
    runAsUser: 1000
    runAsGroup: 1000
    runAsNonRoot: true
    fsGroup: 1000
    seccompProfile:
      type: RuntimeDefault
  
  containers:
  - name: app
    image: nginx:alpine
    # Container Security Context
    securityContext:
      allowPrivilegeEscalation: false
      readOnlyRootFilesystem: true
      capabilities:
        drop:
        - ALL
        add:
        - NET_BIND_SERVICE
```

---

## 4.4 Admission Controllers

### ğŸ¯ ĞšĞ¾Ğ½Ñ†ĞµĞ¿Ñ†Ğ¸Ñ Admission Controllers

Admission Controllers â€” ÑÑ‚Ğ¾ Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½Ñ‹, ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğµ Ğ¿ĞµÑ€ĞµÑ…Ğ²Ğ°Ñ‚Ñ‹Ğ²Ğ°ÑÑ‚ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹ Ğº Kubernetes API Ğ¿Ğ¾ÑĞ»Ğµ Ğ¸Ñ… Ğ°ÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸ Ğ¸ Ğ°Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸, Ğ½Ğ¾ Ğ´Ğ¾ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ñ Ğ¾Ğ±ÑŠĞµĞºÑ‚Ğ¾Ğ² Ğ² etcd.

**ĞœĞµÑÑ‚Ğ¾ Ğ² Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğµ:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”
â”‚   Client    â”‚â”€â”€â–ºâ”‚ Authenticationâ”‚â”€â”€â–ºâ”‚   Authorization â”‚â”€â”€â–ºâ”‚ etcd â”‚
â”‚  (kubectl)  â”‚   â”‚   Module     â”‚   â”‚     (RBAC)      â”‚   â”‚      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”˜
                                             â”‚
                                             â–¼
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚   ADMISSION     â”‚
                                    â”‚   CONTROLLERS   â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                             â”‚
                                             â”œâ”€ Mutating AC
                                             â””â”€ Validating AC
```

---

### ğŸ”„ Ğ¢Ğ¸Ğ¿Ñ‹ Admission Controllers

**1. Mutating Admission Controllers**
```
Ğ¤Ğ£ĞĞšĞ¦Ğ˜Ğ¯: Ğ˜Ğ·Ğ¼ĞµĞ½ÑÑÑ‚ Ğ¾Ğ±ÑŠĞµĞºÑ‚Ñ‹ Ğ¿ĞµÑ€ĞµĞ´ Ğ¸Ñ… ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸ĞµĞ¼

ĞŸÑ€Ğ¸Ğ¼ĞµÑ€Ñ‹ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğ¹:
â”œâ”€ Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Service Account
â”œâ”€ Ğ˜Ğ½ÑŠĞµĞºÑ†Ğ¸Ñ sidecar ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ¾Ğ²  
â”œâ”€ Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° resource limits
â”œâ”€ Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ labels Ğ¸ annotations
â””â”€ ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ security context

ĞŸĞ¾ÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ: FIFO (Ğ¿ĞµÑ€Ğ²Ñ‹Ğ¹ Ğ²Ğ¾ÑˆĞµĞ» - Ğ¿ĞµÑ€Ğ²Ñ‹Ğ¹ Ğ²Ñ‹ÑˆĞµĞ»)
```

**2. Validating Admission Controllers**
```
Ğ¤Ğ£ĞĞšĞ¦Ğ˜Ğ¯: ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑÑÑ‚ Ğ¾Ğ±ÑŠĞµĞºÑ‚Ñ‹ Ğ¸ Ğ¼Ğ¾Ğ³ÑƒÑ‚ Ğ¾Ñ‚ĞºĞ»Ğ¾Ğ½Ğ¸Ñ‚ÑŒ Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ

ĞŸÑ€Ğ¸Ğ¼ĞµÑ€Ñ‹ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€Ğ¾Ğº:
â”œâ”€ Ğ¡Ğ¾Ğ¾Ñ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²Ğ¸Ğµ Ğ¿Ğ¾Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ°Ğ¼ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚Ğ¸
â”œâ”€ Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ resource quotas
â”œâ”€ ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° naming conventions
â”œâ”€ Compliance Ñ‚Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
â””â”€ Custom business rules

ĞŸĞ¾ÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ: Ğ¿Ğ°Ñ€Ğ°Ğ»Ğ»ĞµĞ»ÑŒĞ½Ğ¾
```

---

### ğŸ—ï¸ Ğ’ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ½Ñ‹Ğµ Admission Controllers

**ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ğ²ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ½Ñ‹Ğµ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»Ğ»ĞµÑ€Ñ‹:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Ğ’ĞĞ–ĞĞ«Ğ• Ğ’Ğ¡Ğ¢Ğ ĞĞ•ĞĞĞ«Ğ• ĞšĞĞĞ¢Ğ ĞĞ›Ğ›Ğ•Ğ Ğ«            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   MUTATING          â”‚         VALIDATING            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ServiceAccount      â”‚ NamespaceLifecycle           â”‚
â”‚ DefaultTolerations  â”‚ LimitRanger                  â”‚
â”‚ DefaultStorageClass â”‚ ResourceQuota                â”‚
â”‚ PodNodeSelector     â”‚ PodSecurityPolicy (deprecated)â”‚
â”‚ PersistentVolume    â”‚ NodeRestriction              â”‚
â”‚ Label               â”‚ DenyServiceExternalIPs       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ServiceAccount Admission Controller:**
```
ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸:
â”œâ”€ Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµÑ‚ service account Ğº Ğ¿Ğ¾Ğ´Ñƒ (ĞµÑĞ»Ğ¸ Ğ½Ğµ ÑƒĞºĞ°Ğ·Ğ°Ğ½)
â”œâ”€ ĞœĞ¾Ğ½Ñ‚Ğ¸Ñ€ÑƒĞµÑ‚ API credentials ĞºĞ°Ğº volume
â”œâ”€ Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµÑ‚ image pull secrets
â””â”€ ĞĞ±ĞµÑĞ¿ĞµÑ‡Ğ¸Ğ²Ğ°ĞµÑ‚ Ğ½Ğ°Ğ»Ğ¸Ñ‡Ğ¸Ğµ default SA Ğ² namespace
```

**ResourceQuota Admission Controller:**
```
ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµÑ‚:
â”œâ”€ ĞĞµ Ğ¿Ñ€ĞµĞ²Ñ‹ÑˆĞµĞ½Ğ° Ğ»Ğ¸ ĞºĞ²Ğ¾Ñ‚Ğ° CPU/Memory
â”œâ”€ ĞšĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ¾Ğ±ÑŠĞµĞºÑ‚Ğ¾Ğ² (pods, services, etc.)
â”œâ”€ Storage requests
â””â”€ Ğ‘Ğ»Ğ¾ĞºĞ¸Ñ€ÑƒĞµÑ‚ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¿Ñ€Ğ¸ Ğ¿Ñ€ĞµĞ²Ñ‹ÑˆĞµĞ½Ğ¸Ğ¸ Ğ»Ğ¸Ğ¼Ğ¸Ñ‚Ğ¾Ğ²
```

---

### ğŸ¯ Custom Admission Webhooks

**ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° Webhook:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  HTTP POST  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  HTTP POST  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Kubernetes   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚   Your Webhook  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚  External   â”‚
â”‚ API Server   â”‚             â”‚    Service      â”‚             â”‚  Validator  â”‚
â”‚              â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  Response   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  Response   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â–¼
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚   Business      â”‚
                              â”‚     Logic       â”‚
                              â”‚   Database      â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Mutating Webhook:**
```yaml
# ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ°Ñ Ğ¸Ğ½ÑŠĞµĞºÑ†Ğ¸Ñ sidecar
apiVersion: admissionregistration.k8s.io/v1
kind: MutatingAdmissionWebhook
metadata:
  name: sidecar-injector
webhooks:
- name: sidecar.example.com
  clientConfig:
    service:
      name: sidecar-injector
      namespace: system
      path: /mutate
  rules:
  - operations: ["CREATE"]
    apiGroups: [""]
    apiVersions: ["v1"]
    resources: ["pods"]
  admissionReviewVersions: ["v1", "v1beta1"]
```

---

### ğŸ›¡ï¸ Open Policy Agent (OPA) Gatekeeper

**OPA Gatekeeper = Kubernetes + Policy as Code**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                OPA GATEKEEPER                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   CONSTRAINT        â”‚      CONSTRAINT TEMPLATE      â”‚
â”‚   (Instances)       â”‚         (Rules)               â”‚  
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ ĞšĞ¾Ğ½ĞºÑ€ĞµÑ‚Ğ½Ñ‹Ğµ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»Ğ°â”‚ â€¢ Rego policy language       â”‚
â”‚ â€¢ ĞŸĞ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹         â”‚ â€¢ Reusable logic             â”‚
â”‚ â€¢ Scope (namespaces)â”‚ â€¢ Validation + Mutation      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ĞŸÑ€Ğ¸Ğ¼ĞµÑ€: Ğ·Ğ°Ğ¿Ñ€ĞµÑ‚ Ğ¿Ñ€Ğ¸Ğ²Ğ¸Ğ»ĞµĞ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ñ… ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ¾Ğ²**

1. **ConstraintTemplate (ÑˆĞ°Ğ±Ğ»Ğ¾Ğ½ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»Ğ°):**
```yaml
apiVersion: templates.gatekeeper.sh/v1beta1
kind: ConstraintTemplate
metadata:
  name: k8srequiredsecuritycontext
spec:
  crd:
    spec:
      names:
        kind: K8sRequiredSecurityContext
      validation:
        properties:
          runAsNonRoot:
            type: boolean
  targets:
    - target: admission.k8s.gatekeeper.sh
      rego: |
        package k8srequiredsecuritycontext
        
        violation[{"msg": msg}] {
          container := input.review.object.spec.containers[_]
          not container.securityContext.runAsNonRoot
          msg := "Container must run as non-root user"
        }
```

2. **Constraint (Ğ¿Ñ€Ğ¸Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»Ğ°):**
```yaml
apiVersion: constraints.gatekeeper.sh/v1beta1
kind: K8sRequiredSecurityContext
metadata:
  name: must-run-as-nonroot
spec:
  match:
    kinds:
      - apiGroups: [""]
        kinds: ["Pod"]
    namespaces: ["production", "staging"]
  parameters:
    runAsNonRoot: true
```

---

## 4.5 ĞŸĞ¾Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ¸ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚Ğ¸

### ğŸ¯ ĞšĞ¾Ğ¼Ğ¿Ğ»ĞµĞºÑĞ½Ñ‹Ğ¹ Ğ¿Ğ¾Ğ´Ñ…Ğ¾Ğ´ Ğº Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚Ğ¸

ĞŸĞ¾Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ¸ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚Ğ¸ Ğ² Kubernetes â€” ÑÑ‚Ğ¾ Ğ½Ğµ Ğ¾Ñ‚Ğ´ĞµĞ»ÑŒĞ½Ñ‹Ğµ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ñ‹, Ğ° **ÑĞ¸ÑÑ‚ĞµĞ¼Ğ½Ñ‹Ğ¹ Ğ¿Ğ¾Ğ´Ñ…Ğ¾Ğ´** Ğº Ğ¾Ğ±ĞµÑĞ¿ĞµÑ‡ĞµĞ½Ğ¸Ñ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚Ğ¸ Ğ½Ğ° Ğ²ÑĞµÑ… ÑƒÑ€Ğ¾Ğ²Ğ½ÑÑ….

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           LAYERS OF SECURITY POLICIES              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    PREVENTIVE       â”‚         DETECTIVE             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Network Policies    â”‚ Audit Logging                â”‚
â”‚ Pod Security        â”‚ Runtime Monitoring           â”‚
â”‚ RBAC               â”‚ Anomaly Detection            â”‚
â”‚ Resource Quotas     â”‚ Compliance Scanning          â”‚
â”‚ Admission Control   â”‚ Vulnerability Assessment     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### ğŸŒ Network Policies: ĞœĞ¸ĞºÑ€Ğ¾ÑĞµĞ³Ğ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ

**ĞšĞ¾Ğ½Ñ†ĞµĞ¿Ñ†Ğ¸Ñ Network Policies:**
```
DEFAULT KUBERNETES NETWORKING:
â”Œâ”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”
â”‚ Pod â”‚â—„â”€â”€â–ºâ”‚ Pod â”‚â—„â”€â”€â–ºâ”‚ Pod â”‚  â† Ğ’ÑĞµ Ğ¼Ğ¾Ğ³ÑƒÑ‚ Ğ¾Ğ±Ñ‰Ğ°Ñ‚ÑŒÑÑ
â”‚  A  â”‚    â”‚  B  â”‚    â”‚  C  â”‚    ÑĞ¾ Ğ²ÑĞµĞ¼Ğ¸
â””â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”˜

WITH NETWORK POLICIES:
â”Œâ”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”
â”‚ Pod â”‚â”€â”€â”€â–ºâ”‚ Pod â”‚ âœ—  â”‚ Pod â”‚  â† ĞĞ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ½Ğ°Ñ ÑĞ²ÑĞ·ÑŒ
â”‚  A  â”‚    â”‚  B  â”‚    â”‚  C  â”‚    Ğ¿Ğ¾ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»Ğ°Ğ¼
â””â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”˜
```

**Ğ¢Ğ¸Ğ¿Ñ‹ Network Policies:**

1. **Ingress Policies (Ğ²Ñ…Ğ¾Ğ´ÑÑ‰Ğ¸Ğ¹ Ñ‚Ñ€Ğ°Ñ„Ğ¸Ğº)**
```yaml
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: deny-all-ingress
spec:
  podSelector: {}  # ĞŸÑ€Ğ¸Ğ¼ĞµĞ½ÑĞµÑ‚ÑÑ ĞºĞ¾ Ğ²ÑĞµĞ¼ Ğ¿Ğ¾Ğ´Ğ°Ğ¼
  policyTypes:
  - Ingress
  # ĞĞµÑ‚ ingress Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ» = Ğ·Ğ°Ğ¿Ñ€ĞµÑ‚ Ğ²ÑĞµĞ³Ğ¾ Ğ²Ñ…Ğ¾Ğ´ÑÑ‰ĞµĞ³Ğ¾ Ñ‚Ñ€Ğ°Ñ„Ğ¸ĞºĞ°
```

2. **Egress Policies (Ğ¸ÑÑ…Ğ¾Ğ´ÑÑ‰Ğ¸Ğ¹ Ñ‚Ñ€Ğ°Ñ„Ğ¸Ğº)**
```yaml
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: web-app-egress
spec:
  podSelector:
    matchLabels:
      app: web-app
  policyTypes:
  - Egress
  egress:
  - to:
    - podSelector:
        matchLabels:
          app: database
    ports:
    - protocol: TCP
      port: 5432
  # Ğ Ğ°Ğ·Ñ€ĞµÑˆĞµĞ½ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ¸ÑÑ…Ğ¾Ğ´ÑÑ‰Ğ¸Ğ¹ Ñ‚Ñ€Ğ°Ñ„Ğ¸Ğº Ğº Ğ‘Ğ” Ğ½Ğ° Ğ¿Ğ¾Ñ€Ñ‚ 5432
```

**Ğ¡Ñ‚Ñ€Ğ°Ñ‚ĞµĞ³Ğ¸Ğ¸ ÑĞµĞ³Ğ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ğ¸:**
```
Ğ¡Ğ¢Ğ ĞĞ¢Ğ•Ğ“Ğ˜Ğ¯ "DEFAULT DENY":
â”œâ”€ Ğ—Ğ°Ğ¿Ñ€ĞµÑ‚Ğ¸Ñ‚ÑŒ Ğ²ĞµÑÑŒ Ñ‚Ñ€Ğ°Ñ„Ğ¸Ğº Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ
â”œâ”€ Ğ¯Ğ²Ğ½Ğ¾ Ñ€Ğ°Ğ·Ñ€ĞµÑˆĞ¸Ñ‚ÑŒ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ½ĞµĞ¾Ğ±Ñ…Ğ¾Ğ´Ğ¸Ğ¼Ñ‹Ğµ ÑĞ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ñ
â”œâ”€ ĞŸÑ€Ğ¸Ğ½Ñ†Ğ¸Ğ¿ Ğ¼Ğ¸Ğ½Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ñ… Ğ¿Ñ€Ğ¸Ğ²Ğ¸Ğ»ĞµĞ³Ğ¸Ğ¹
â””â”€ Ğ›ĞµĞ³Ñ‡Ğµ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¸ Ğ°ÑƒĞ´Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ

Ğ¡Ğ¢Ğ ĞĞ¢Ğ•Ğ“Ğ˜Ğ¯ "PROGRESSIVE LOCKDOWN":  
â”œâ”€ ĞĞ°Ñ‡Ğ°Ñ‚ÑŒ Ñ Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³Ğ° Ñ‚Ñ€Ğ°Ñ„Ğ¸ĞºĞ°
â”œâ”€ ĞŸĞ¾ÑÑ‚ĞµĞ¿ĞµĞ½Ğ½Ğ¾ Ğ²Ğ½ĞµĞ´Ñ€ÑÑ‚ÑŒ Ğ¾Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ¸Ñ
â”œâ”€ Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ ĞºĞ°Ğ¶Ğ´Ğ¾Ğµ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğµ
â””â”€ ĞœĞ¸Ğ½Ğ¸Ğ¼Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ñ€Ğ¸ÑĞº Ğ½Ğ°Ñ€ÑƒÑˆĞµĞ½Ğ¸Ñ ÑĞµÑ€Ğ²Ğ¸ÑĞ°
```

---

### ğŸ“Š Resource Quotas: ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»ÑŒ Ñ€ĞµÑÑƒÑ€ÑĞ¾Ğ²

**Ğ—Ğ°Ñ‡ĞµĞ¼ Ğ½ÑƒĞ¶Ğ½Ñ‹ Resource Quotas:**
```
Ğ‘Ğ•Ğ— ĞšĞ’ĞĞ¢:                    Ğ¡ ĞšĞ’ĞĞ¢ĞĞœĞ˜:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Namespace A â”‚ 90% CPU     â”‚ Namespace A â”‚ 30% CPU
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  
â”‚ Namespace B â”‚ 8% CPU      â”‚ Namespace B â”‚ 30% CPU
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Namespace C â”‚ 2% CPU      â”‚ Namespace C â”‚ 30% CPU
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    ĞĞµÑĞ¿Ñ€Ğ°-                     Ğ¡Ğ¿Ñ€Ğ°Ğ²ĞµĞ´-
    Ğ²ĞµĞ´Ğ»Ğ¸Ğ²Ğ¾                     Ğ»Ğ¸Ğ²Ğ¾
```

**Ğ¢Ğ¸Ğ¿Ñ‹ ĞºĞ²Ğ¾Ñ‚:**

1. **Compute Resources (Ğ²Ñ‹Ñ‡Ğ¸ÑĞ»Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğµ Ñ€ĞµÑÑƒÑ€ÑÑ‹)**
```yaml
apiVersion: v1
kind: ResourceQuota
metadata:
  name: compute-quota
spec:
  hard:
    requests.cpu: "4"      # Ğ¡ÑƒĞ¼Ğ¼Ğ° Ğ²ÑĞµÑ… CPU requests
    requests.memory: 8Gi   # Ğ¡ÑƒĞ¼Ğ¼Ğ° Ğ²ÑĞµÑ… Memory requests
    limits.cpu: "8"        # Ğ¡ÑƒĞ¼Ğ¼Ğ° Ğ²ÑĞµÑ… CPU limits
    limits.memory: 16Gi    # Ğ¡ÑƒĞ¼Ğ¼Ğ° Ğ²ÑĞµÑ… Memory limits
```

2. **Object Count Quotas (ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ¾Ğ±ÑŠĞµĞºÑ‚Ğ¾Ğ²)**
```yaml
apiVersion: v1
kind: ResourceQuota
metadata:
  name: object-quota
spec:
  hard:
    pods: "10"                    # ĞœĞ°ĞºÑĞ¸Ğ¼ÑƒĞ¼ 10 Ğ¿Ğ¾Ğ´Ğ¾Ğ²
    services: "5"                 # ĞœĞ°ĞºÑĞ¸Ğ¼ÑƒĞ¼ 5 ÑĞµÑ€Ğ²Ğ¸ÑĞ¾Ğ²
    secrets: "10"                 # ĞœĞ°ĞºÑĞ¸Ğ¼ÑƒĞ¼ 10 ÑĞµĞºÑ€ĞµÑ‚Ğ¾Ğ²
    configmaps: "10"              # ĞœĞ°ĞºÑĞ¸Ğ¼ÑƒĞ¼ 10 ConfigMaps
    persistentvolumeclaims: "4"   # ĞœĞ°ĞºÑĞ¸Ğ¼ÑƒĞ¼ 4 PVC
```

3. **Storage Quotas (ĞºĞ²Ğ¾Ñ‚Ñ‹ Ğ½Ğ° Ñ…Ñ€Ğ°Ğ½Ğ¸Ğ»Ğ¸Ñ‰Ğµ)**
```yaml
apiVersion: v1
kind: ResourceQuota
metadata:
  name: storage-quota
spec:
  hard:
    requests.storage: 100Gi              # ĞĞ±Ñ‰Ğ¸Ğ¹ Ğ¾Ğ±ÑŠĞµĞ¼ storage
    persistentvolumeclaims: "4"          # ĞšĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ PVC
    requests.storage/ssd: 50Gi           # ĞšĞ²Ğ¾Ñ‚Ğ° Ğ½Ğ° SSD storage class
    requests.storage/hdd: 50Gi           # ĞšĞ²Ğ¾Ñ‚Ğ° Ğ½Ğ° HDD storage class
```

---

### ğŸš« PodDisruptionBudgets: Ğ¾Ğ±ĞµÑĞ¿ĞµÑ‡ĞµĞ½Ğ¸Ğµ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾ÑÑ‚Ğ¸

**ĞšĞ¾Ğ½Ñ†ĞµĞ¿Ñ†Ğ¸Ñ PDB:**
```
Ğ‘Ğ•Ğ— PDB:                     Ğ¡ PDB:
Maintenance Event            Maintenance Event
â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”
â”‚Pod 1â”‚ â”‚Pod 2â”‚ â”‚Pod 3â”‚     â”‚Pod 1â”‚ â”‚Pod 2â”‚ â”‚Pod 3â”‚
â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜
   â†“       â†“       â†“           â†“       â†“       â†“
  âŒ      âŒ      âŒ         âŒ      âœ…      âœ…
Ğ’ÑĞµ Ğ¿Ğ¾Ğ´Ñ‹ ÑƒĞ´Ğ°Ğ»ĞµĞ½Ñ‹            ĞœĞ¸Ğ½Ğ¸Ğ¼ÑƒĞ¼ 2 Ğ¿Ğ¾Ğ´Ğ° Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ÑÑ‚
= ĞĞµĞ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾ÑÑ‚ÑŒ ÑĞµÑ€Ğ²Ğ¸ÑĞ°     = Ğ¡ĞµÑ€Ğ²Ğ¸Ñ Ğ¿Ñ€Ğ¾Ğ´Ğ¾Ğ»Ğ¶Ğ°ĞµÑ‚ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ñ‚ÑŒ
```

**Ğ¡Ñ‚Ñ€Ğ°Ñ‚ĞµĞ³Ğ¸Ğ¸ PDB:**
```yaml
# Ğ¡Ñ‚Ñ€Ğ°Ñ‚ĞµĞ³Ğ¸Ñ 1: Ğ¼Ğ¸Ğ½Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹Ñ… Ğ¿Ğ¾Ğ´Ğ¾Ğ²
apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  name: web-app-pdb
spec:
  minAvailable: 2          # ĞœĞ¸Ğ½Ğ¸Ğ¼ÑƒĞ¼ 2 Ğ¿Ğ¾Ğ´Ğ° Ğ´Ğ¾Ğ»Ğ¶Ğ½Ñ‹ Ğ±Ñ‹Ñ‚ÑŒ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹
  selector:
    matchLabels:
      app: web-app

# Ğ¡Ñ‚Ñ€Ğ°Ñ‚ĞµĞ³Ğ¸Ñ 2: Ğ¼Ğ°ĞºÑĞ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ½ĞµĞ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹Ñ… Ğ¿Ğ¾Ğ´Ğ¾Ğ²  
apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  name: database-pdb
spec:
  maxUnavailable: 1        # ĞœĞ°ĞºÑĞ¸Ğ¼ÑƒĞ¼ 1 Ğ¿Ğ¾Ğ´ Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ±Ñ‹Ñ‚ÑŒ Ğ½ĞµĞ´Ğ¾ÑÑ‚ÑƒĞ¿ĞµĞ½
  selector:
    matchLabels:
      app: database

# Ğ¡Ñ‚Ñ€Ğ°Ñ‚ĞµĞ³Ğ¸Ñ 3: Ğ¿Ñ€Ğ¾Ñ†ĞµĞ½Ñ‚Ğ½Ğ¾Ğµ ÑĞ¾Ğ¾Ñ‚Ğ½Ğ¾ÑˆĞµĞ½Ğ¸Ğµ
apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  name: worker-pdb
spec:
  minAvailable: 50%        # ĞœĞ¸Ğ½Ğ¸Ğ¼ÑƒĞ¼ 50% Ğ¿Ğ¾Ğ´Ğ¾Ğ² Ğ´Ğ¾Ğ»Ğ¶Ğ½Ñ‹ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ñ‚ÑŒ
  selector:
    matchLabels:
      app: worker
```

---

### ğŸ” Secrets Management Best Practices

**Ğ˜ĞµÑ€Ğ°Ñ€Ñ…Ğ¸Ñ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ ÑĞµĞºÑ€ĞµÑ‚Ğ°Ğ¼Ğ¸:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              SECRETS MANAGEMENT                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    AT REST          â”‚        IN TRANSIT             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ etcd encryption     â”‚ TLS everywhere               â”‚
â”‚ External key mgmt   â”‚ Service mesh mTLS            â”‚
â”‚ Sealed secrets      â”‚ Pod-to-pod encryption        â”‚
â”‚ CSI secret drivers  â”‚ Network policies             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**1. Encryption at Rest**
```yaml
# ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ ÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ etcd
apiVersion: apiserver.config.k8s.io/v1
kind: EncryptionConfiguration
resources:
- resources:
  - secrets
  providers:
  - aescbc:
      keys:
      - name: key1
        secret: <32-byte key>
  - identity: {}  # fallback Ğ´Ğ»Ñ Ğ½ĞµĞ·Ğ°ÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
```

**2. External Secrets Operator**
```yaml
# Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ñ AWS Secrets Manager
apiVersion: external-secrets.io/v1beta1
kind: SecretStore
metadata:
  name: aws-secrets-manager
spec:
  provider:
    aws:
      service: SecretsManager
      region: us-east-1
      auth:
        secretRef:
          accessKeyID:
            name: aws-creds
            key: access-key-id
---
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: database-credentials
spec:
  refreshInterval: 1h
  secretStoreRef:
    name: aws-secrets-manager
    kind: SecretStore
  target:
    name: database-secret
    creationPolicy: Owner
  data:
  - secretKey: username
    remoteRef:
      key: prod/database
      property: username
  - secretKey: password
    remoteRef:
      key: prod/database
      property: password
```

**3. Runtime Security Ñ Secrets**
```yaml
# Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ secrets Ğ² Ğ¿Ğ¾Ğ´Ğµ
apiVersion: v1
kind: Pod
spec:
  containers:
  - name: app
    image: myapp:latest
    env:
    - name: DB_PASSWORD
      valueFrom:
        secretKeyRef:
          name: database-secret
          key: password
    volumeMounts:
    - name: tls-certs
      mountPath: /etc/ssl/certs
      readOnly: true
  volumes:
  - name: tls-certs
    secret:
      secretName: tls-secret
      defaultMode: 0400  # Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ Ğ²Ğ»Ğ°Ğ´ĞµĞ»ĞµÑ† Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ñ‡Ğ¸Ñ‚Ğ°Ñ‚ÑŒ
```

---

## ğŸ¯ ĞŸÑ€Ğ°ĞºÑ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ñ€ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´Ğ°Ñ†Ğ¸Ğ¸ Ğ¿Ğ¾ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚Ğ¸

### ğŸ“‹ Security Checklist Ğ´Ğ»Ñ Production

**ğŸ” ĞÑƒĞ´Ğ¸Ñ‚ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚Ğ¸ ĞºĞ»Ğ°ÑÑ‚ĞµÑ€Ğ°:**
```
â–¡ RBAC Ğ½Ğ°ÑÑ‚Ñ€Ğ¾ĞµĞ½ Ñ Ğ¿Ñ€Ğ¸Ğ½Ñ†Ğ¸Ğ¿Ğ¾Ğ¼ Ğ¼Ğ¸Ğ½Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ñ… Ğ¿Ñ€Ğ¸Ğ²Ğ¸Ğ»ĞµĞ³Ğ¸Ğ¹
â–¡ Pod Security Standards Ğ²ĞºĞ»ÑÑ‡ĞµĞ½Ñ‹ (Ğ¼Ğ¸Ğ½Ğ¸Ğ¼ÑƒĞ¼ Baseline)
â–¡ Network Policies Ğ¾Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ‡Ğ¸Ğ²Ğ°ÑÑ‚ Ñ‚Ñ€Ğ°Ñ„Ğ¸Ğº Ğ¼ĞµĞ¶Ğ´Ñƒ Ğ¿Ğ¾Ğ´Ğ°Ğ¼Ğ¸
â–¡ Resource Quotas Ğ¿Ñ€ĞµĞ´Ğ¾Ñ‚Ğ²Ñ€Ğ°Ñ‰Ğ°ÑÑ‚ resource exhaustion
â–¡ Secrets Ğ·Ğ°ÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½Ñ‹ Ğ² etcd
â–¡ Admission Controllers Ğ½Ğ°ÑÑ‚Ñ€Ğ¾ĞµĞ½Ñ‹ Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ»Ğ¸Ñ‚Ğ¸Ğº Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚Ğ¸
â–¡ Audit logging Ğ²ĞºĞ»ÑÑ‡ĞµĞ½ Ğ¸ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾ĞµĞ½
â–¡ Node security patching Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½
â–¡ Image scanning Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½ Ğ² CI/CD
â–¡ Runtime security monitoring Ğ½Ğ°ÑÑ‚Ñ€Ğ¾ĞµĞ½
```

**ğŸš¨ Ğ˜Ğ½Ğ´Ğ¸ĞºĞ°Ñ‚Ğ¾Ñ€Ñ‹ ĞºĞ¾Ğ¼Ğ¿Ñ€Ğ¾Ğ¼ĞµÑ‚Ğ°Ñ†Ğ¸Ğ¸ (IoC):**
```
Ğ¡Ğ•Ğ¢Ğ•Ğ’ĞĞ¯ ĞĞšĞ¢Ğ˜Ğ’ĞĞĞ¡Ğ¢Ğ¬:
â”œâ”€ ĞĞµĞ¾Ğ±Ñ‹Ñ‡Ğ½Ñ‹Ğµ Ğ¸ÑÑ…Ğ¾Ğ´ÑÑ‰Ğ¸Ğµ ÑĞ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ñ
â”œâ”€ Ğ¡Ğ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ñ Ñ Ğ¸Ğ·Ğ²ĞµÑÑ‚Ğ½Ñ‹Ğ¼Ğ¸ Ğ²Ñ€ĞµĞ´Ğ¾Ğ½Ğ¾ÑĞ½Ñ‹Ğ¼Ğ¸ IP
â”œâ”€ Ğ’Ñ‹ÑĞ¾ĞºĞ¸Ğ¹ Ğ¾Ğ±ÑŠĞµĞ¼ DNS Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²
â””â”€ ĞšÑ€Ğ¸Ğ¿Ñ‚Ğ¾Ğ¼Ğ°Ğ¹Ğ½Ğ¸Ğ½Ğ³ Ñ‚Ñ€Ğ°Ñ„Ğ¸Ğº

ĞŸĞĞ’Ğ•Ğ”Ğ•ĞĞ˜Ğ• ĞŸĞĞ”ĞĞ’:
â”œâ”€ Pods Ñ Ğ¿Ñ€Ğ¸Ğ²Ğ¸Ğ»ĞµĞ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¼Ğ¸ Ğ¿Ñ€Ğ°Ğ²Ğ°Ğ¼Ğ¸
â”œâ”€ ĞĞµĞ¾Ğ±Ñ‹Ñ‡Ğ½Ğ¾Ğµ Ğ¿Ğ¾Ñ‚Ñ€ĞµĞ±Ğ»ĞµĞ½Ğ¸Ğµ Ñ€ĞµÑÑƒÑ€ÑĞ¾Ğ²  
â”œâ”€ Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´ Ğ² runtime
â””â”€ ĞœĞ¾Ğ´Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ½Ñ‹Ñ… Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²

RBAC ĞĞĞ Ğ£Ğ¨Ğ•ĞĞ˜Ğ¯:
â”œâ”€ Ğ§Ğ°ÑÑ‚Ñ‹Ğµ Ğ¾Ñ‚ĞºĞ°Ğ·Ñ‹ Ğ² Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğµ
â”œâ”€ Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ deprecated API
â”œâ”€ ĞĞ¾Ğ²Ñ‹Ğµ ServiceAccounts Ñ ÑˆĞ¸Ñ€Ğ¾ĞºĞ¸Ğ¼Ğ¸ Ğ¿Ñ€Ğ°Ğ²Ğ°Ğ¼Ğ¸
â””â”€ Ğ˜Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ Ğ² ClusterRoles
```

---

## ğŸ“ Ğ—Ğ°ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğ±Ğ»Ğ¾ĞºĞ°

ĞŸĞ¾ÑĞ»Ğµ Ğ¸Ğ·ÑƒÑ‡ĞµĞ½Ğ¸Ñ ÑÑ‚Ğ¾Ğ³Ğ¾ Ğ±Ğ»Ğ¾ĞºĞ° Ğ²Ñ‹ Ğ´Ğ¾Ğ»Ğ¶Ğ½Ñ‹ Ğ¿Ğ¾Ğ½Ğ¸Ğ¼Ğ°Ñ‚ÑŒ:

âœ… **ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ñƒ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚Ğ¸ Kubernetes** Ğ¸ Ğ¿Ñ€Ğ¸Ğ½Ñ†Ğ¸Ğ¿Ñ‹ defense in depth  
âœ… **RBAC ÑĞ¸ÑÑ‚ĞµĞ¼Ñƒ** Ğ¸ ÑƒĞ¼ĞµĞ½Ğ¸Ğµ ÑĞ¾Ğ·Ğ´Ğ°Ğ²Ğ°Ñ‚ÑŒ Ğ³Ñ€Ğ°Ğ½ÑƒĞ»ÑÑ€Ğ½Ñ‹Ğµ Ñ€Ğ¾Ğ»Ğ¸  
âœ… **Service Accounts** Ğ¸ Ñ€Ğ°Ğ·Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ğµ Ğ¼ĞµÑ‚Ğ¾Ğ´Ñ‹ Ğ°ÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸  
âœ… **Pod Security Standards** Ğ¸ Ğ¸Ñ… Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ Ğ¿Ñ€Ğ¸Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğµ  
âœ… **Admission Controllers** Ğ¸ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ custom policies  
âœ… **ĞšĞ¾Ğ¼Ğ¿Ğ»ĞµĞºÑĞ½Ñ‹Ğµ Ğ¿Ğ¾Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ¸ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚Ğ¸** Ğ´Ğ»Ñ production-Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ğ¹

**ğŸ¯ Ğ¡Ğ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ ÑˆĞ°Ğ³:** ĞŸÑ€Ğ¸Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ½Ñ‹Ğµ Ğ·Ğ½Ğ°Ğ½Ğ¸Ñ Ğ½Ğ° Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞµ, ÑĞ¾Ğ·Ğ´Ğ°Ğ² secure by default ĞºĞ»Ğ°ÑÑ‚ĞµÑ€ Ñ comprehensive security policies.

---

## ğŸ“š Ğ”Ğ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğµ Ñ€ĞµÑÑƒÑ€ÑÑ‹

**Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ:**
- [Kubernetes Security Best Practices](https://kubernetes.io/docs/concepts/security/)
- [Pod Security Standards](https://kubernetes.io/docs/concepts/security/pod-security-standards/)
- [RBAC Documentation](https://kubernetes.io/docs/reference/access-authn-authz/rbac/)

**Ğ˜Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ñ‹:**
- [OPA Gatekeeper](https://open-policy-agent.github.io/gatekeeper/)
- [Falco Runtime Security](https://falco.org/)
- [kube-bench](https://github.com/aquasecurity/kube-bench) Ğ´Ğ»Ñ CIS benchmarks

**ĞŸÑ€Ğ°ĞºÑ‚Ğ¸ĞºĞ°:**
- [Kubernetes Goat](https://madhuakula.com/kubernetes-goat/) - vulnerable cluster Ğ´Ğ»Ñ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ¸
- [OWASP Kubernetes Security Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Kubernetes_Security_Cheat_Sheet.html)