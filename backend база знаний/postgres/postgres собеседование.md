# Техническое собеседование: PostgreSQL и SQL
## 80 вопросов с углублением для Backend разработчика

---

## 1. Основы SQL и PostgreSQL (10 вопросов)

### 1. Объясните разницу между INNER JOIN, LEFT JOIN, RIGHT JOIN и FULL OUTER JOIN
**Углубляющие вопросы:**
1. В каких случаях LEFT JOIN может вернуть NULL значения?
2. Как будет работать JOIN с составным ключом?
3. Что произойдет, если в условии JOIN использовать неиндексированные поля?
4. Объясните разницу в производительности между разными типами JOIN
5. Как PostgreSQL оптимизирует запросы с множественными JOIN?

### 2. Что такое ACID свойства и как они реализованы в PostgreSQL?
**Углубляющие вопросы:**
1. Как PostgreSQL обеспечивает Atomicity на уровне транзакций?
2. Какие уровни изоляции поддерживает PostgreSQL и чем они отличаются?
3. Как работает механизм WAL (Write-Ahead Logging) для Durability?
4. Что такое MVCC и как это связано с Consistency?
5. Приведите пример нарушения каждого из ACID свойств

### 3. Объясните концепцию MVCC (Multi-Version Concurrency Control) в PostgreSQL
**Углубляющие вопросы:**
1. Как PostgreSQL хранит разные версии строк?
2. Что такое xmin и xmax в контексте MVCC?
3. Как MVCC влияет на производительность читающих операций?
4. Когда и как происходит очистка старых версий строк (VACUUM)?
5. Какие проблемы может вызвать длительная транзакция в контексте MVCC?

### 4. В чем разница между TRUNCATE, DELETE и DROP?
**Углубляющие вопросы:**
1. Какая команда быстрее для удаления всех записей и почему?
2. Как каждая команда влияет на AUTO_INCREMENT/SERIAL счетчики?
3. Можно ли откатить каждую из этих операций в транзакции?
4. Как эти команды взаимодействуют с внешними ключами?
5. Какие привилегии нужны для выполнения каждой команды?

### 5. Что такое stored procedures и функции в PostgreSQL? В чем разница?
**Углубляющие вопросы:**
1. На каких языках можно писать функции в PostgreSQL?
2. Что такое SECURITY DEFINER vs SECURITY INVOKER?
3. Как обрабатывать исключения в PL/pgSQL функциях?
4. В чем разница между VOLATILE, STABLE и IMMUTABLE функций?
5. Как PostgreSQL кэширует результаты функций?

### 6. Объясните разницу между первичным, уникальным и внешним ключами
**Углубляющие вопросы:**
1. Может ли таблица иметь несколько первичных ключей?
2. Как PostgreSQL реализует проверку внешних ключей?
3. Что происходит с производительностью при добавлении внешнего ключа?
4. Какие действия доступны для ON DELETE и ON UPDATE?
5. Можно ли создать внешний ключ на частичный индекс?

### 7. Что такое нормализация базы данных? Объясните 1NF, 2NF, 3NF
**Углубляющие вопросы:**
1. Приведите пример денормализации и обоснуйте ее необходимость
2. Что такое BCNF и чем отличается от 3NF?
3. Как нормализация влияет на производительность JOIN операций?
4. В каких случаях стоит нарушить принципы нормализации?
5. Как связаны нормализация и индексирование?

### 8. Объясните работу оператора EXPLAIN и EXPLAIN ANALYZE
**Углубляющие вопросы:**
1. В чем разница между cost, rows и width в плане выполнения?
2. Как интерпретировать Nested Loop vs Hash Join в плане?
3. Что означает "buffers" в выводе EXPLAIN ANALYZE?
4. Как использовать EXPLAIN для оптимизации медленных запросов?
5. Какие дополнительные опции есть у EXPLAIN в PostgreSQL?

### 9. Что такое представления (Views) и материализованные представления?
**Углубляющие вопросы:**
1. Можно ли обновлять данные через представление?
2. Как PostgreSQL оптимизирует запросы к представлениям?
3. Когда следует использовать материализованные представления?
4. Как обновляются материализованные представления?
5. Какие ограничения существуют для представлений?

### 10. Объясните концепцию схем (schemas) в PostgreSQL
**Углубляющие вопросы:**
1. Что такое search_path и как он работает?
2. Как схемы влияют на безопасность данных?
3. Можно ли перемещать объекты между схемами?
4. Как работают права доступа на уровне схем?
5. Зачем нужна схема public по умолчанию?

---

## 2. Индексы и оптимизация (15 вопросов)

### 11. Какие типы индексов поддерживает PostgreSQL?
**Углубляющие вопросы:**
1. В каких случаях лучше использовать Hash индекс вместо B-tree?
2. Как работает GIN индекс для полнотекстового поиска?
3. Когда использовать BRIN индексы?
4. Что такое SP-GiST и для каких данных он подходит?
5. Как выбрать оптимальный тип индекса для конкретной задачи?

### 12. Что такое составные (композитные) индексы?
**Углубляющие вопросы:**
1. Влияет ли порядок колонок в составном индексе на производительность?
2. Может ли PostgreSQL использовать часть составного индекса?
3. Как составные индексы влияют на размер базы данных?
4. В каких случаях лучше создать несколько одиночных индексов?
5. Как PostgreSQL объединяет несколько индексов в одном запросе?

### 13. Объясните концепцию частичных индексов (partial indexes)
**Углубляющие вопросы:**
1. Приведите практический пример использования частичного индекса
2. Как PostgreSQL определяет, можно ли использовать частичный индекс?
3. Влияют ли частичные индексы на производительность UPDATE операций?
4. Можно ли создать частичный индекс на выражении?
5. Как частичные индексы экономят дисковое пространство?

### 14. Что такое индексы по выражениям (expression indexes)?
**Углубляющие вопросы:**
1. Как создать индекс для поиска без учета регистра?
2. Влияют ли функциональные индексы на производительность вставки?
3. Можно ли использовать пользовательские функции в индексах?
4. Как PostgreSQL обновляет индексы по выражениям?
5. Какие ограничения существуют для функций в индексах?

### 15. Как определить, нужен ли индекс для конкретного запроса?
**Углубляющие вопросы:**
1. Какие системные представления помогают анализировать использование индексов?
2. Как pg_stat_user_indexes помогает в оптимизации?
3. При каком проценте селективности индекс становится неэффективным?
4. Как определить дублирующиеся или неиспользуемые индексы?
5. Какие метрики указывают на необходимость индексирования?

### 16. Объясните процесс создания индекса CONCURRENTLY
**Углубляющие вопросы:**
1. Почему создание индекса CONCURRENTLY занимает больше времени?
2. Какие ограничения существуют при использовании CONCURRENTLY?
3. Что происходит, если создание индекса CONCURRENTLY прерывается?
4. Как обнаружить и удалить некорректные индексы?
5. Можно ли пересоздать индекс CONCURRENTLY?

### 17. Что такое кластеризация таблиц (CLUSTER) в PostgreSQL?
**Углубляющие вопросы:**
1. Как кластеризация влияет на производительность диапазонных запросов?
2. Сохраняется ли порядок после кластеризации при новых вставках?
3. Можно ли кластеризовать таблицу по нескольким индексам?
4. Как часто нужно перекластеризовывать таблицы?
5. Какие альтернативы кластеризации существуют?

### 18. Объясните работу статистики в PostgreSQL (pg_stats)
**Углубляющие вопросы:**
1. Как PostgreSQL собирает статистику по таблицам?
2. Что такое default_statistics_target и как его настроить?
3. Как статистика влияет на выбор плана выполнения?
4. Когда нужно вручную обновлять статистику (ANALYZE)?
5. Как статистика коррелирует с гистограммами значений?

### 19. Что такое bitmap scan и когда он используется?
**Углубляющие вопросы:**
1. В чем разница между Bitmap Index Scan и Index Scan?
2. Как PostgreSQL объединяет несколько bitmap scan?
3. При каких условиях bitmap scan эффективнее index scan?
4. Как размер shared_buffers влияет на bitmap scan?
5. Можно ли форсировать использование bitmap scan?

### 20. Объясните концепцию заполняемости (fill factor) индексов
**Углубляющие вопросы:**
1. Как fill factor влияет на производительность UPDATE операций?
2. Какой оптимальный fill factor для разных типов нагрузки?
3. Как fill factor связан с page splits в B-tree индексах?
4. Влияет ли fill factor на размер индекса?
5. Как определить оптимальный fill factor для конкретной таблицы?

### 21. Что такое HOT (Heap-Only Tuples) обновления?
**Углубляющие вопросы:**
1. При каких условиях возможны HOT обновления?
2. Как HOT обновления влияют на производительность?
3. Что происходит с индексами при HOT обновлениях?
4. Как настройка fillfactor влияет на HOT обновления?
5. Как мониторить эффективность HOT обновлений?

### 22. Объясните работу автовакуума (autovacuum) в PostgreSQL
**Углубляющие вопросы:**
1. Как настроить пороги срабатывания автовакуума?
2. В чем разница между VACUUM и VACUUM FULL?
3. Как автовакуум влияет на производительность системы?
4. Что такое vacuum_cost_delay и как его настроить?
5. Как определить, что таблице нужен внеплановый VACUUM?

### 23. Что такое индексы покрытия (covering indexes) в PostgreSQL?
**Углубляющие вопросы:**
1. Как создать индекс с INCLUDE колонками?
2. В чем преимущество covering индексов перед обычными?
3. Как covering индексы влияют на Index-Only Scan?
4. Какие ограничения есть у INCLUDE колонок?
5. Как выбрать колонки для включения в covering индекс?

### 24. Объясните концепцию visibility map в PostgreSQL
**Углубляющие вопросы:**
1. Как visibility map ускоряет Index-Only Scan?
2. Что происходит с visibility map при UPDATE операциях?
3. Как VACUUM обновляет visibility map?
4. Можно ли восстановить поврежденную visibility map?
5. Как мониторить состояние visibility map?

### 25. Что такое parallel query execution в PostgreSQL?
**Углубляющие вопросы:**
1. Какие операции поддерживают параллельное выполнение?
2. Как настроить количество parallel workers?
3. При каких условиях PostgreSQL не использует параллелизм?
4. Как параллельные запросы влияют на нагрузку системы?
5. Можно ли принудительно отключить параллельное выполнение?

---

## 3. Транзакции и блокировки (10 вопросов)

### 26. Объясните уровни изоляции транзакций в PostgreSQL
**Углубляющие вопросы:**
1. Какие аномалии чтения предотвращает каждый уровень изоляции?
2. Как Serializable Snapshot Isolation работает в PostgreSQL?
3. В чем разница между Repeatable Read и Serializable?
4. Какой уровень изоляции используется по умолчанию?
5. Как выбрать оптимальный уровень изоляции для приложения?

### 27. Что такое deadlock и как их предотвратить?
**Углубляющие вопросы:**
1. Как PostgreSQL обнаруживает deadlock?
2. Какая транзакция будет отменена при deadlock?
3. Как логировать и мониторить deadlock?
4. Какие стратегии кодирования помогают избежать deadlock?
5. Как timeout влияет на обнаружение deadlock?

### 28. Объясните разные типы блокировок в PostgreSQL
**Углубляющие вопросы:**
1. В чем разница между row-level и table-level блокировками?
2. Что такое advisory locks и когда их использовать?
3. Как работают блокировки FOR UPDATE и FOR SHARE?
4. Что такое блокировка AccessExclusiveLock?
5. Как мониторить текущие блокировки в системе?

### 29. Что происходит при длительных транзакциях?
**Углубляющие вопросы:**
1. Как длительные транзакции влияют на VACUUM?
2. Что такое transaction wraparound и как его избежать?
3. Как длительные транзакции влияют на размер базы данных?
4. Какие инструменты помогают найти долгие транзакции?
5. Как gracefully прервать зависшую транзакцию?

### 30. Объясните работу SAVEPOINT в PostgreSQL
**Углубляющие вопросы:**
1. Можно ли создавать вложенные savepoint?
2. Как savepoint влияют на производительность?
3. Что происходит с блокировками при rollback to savepoint?
4. Как использовать savepoint в процедурах?
5. Есть ли ограничения на количество savepoint?

### 31. Что такое two-phase commit (2PC)?
**Углубляющие вопросы:**
1. Как реализован 2PC в PostgreSQL?
2. Какие риски связаны с использованием prepared transactions?
3. Как мониторить prepared transactions?
4. Что происходит с prepared transaction при сбое системы?
5. Когда стоит использовать 2PC в распределенных системах?

### 32. Объясните концепцию snapshot в PostgreSQL
**Углубляющие вопросы:**
1. Как PostgreSQL создает snapshot для транзакции?
2. Что такое xmin, xmax в контексте snapshot?
3. Как snapshot влияет на видимость данных?
4. Можно ли использовать один snapshot в разных транзакциях?
5. Как экспортировать и импортировать snapshot?

### 33. Что такое lock escalation и происходит ли это в PostgreSQL?
**Углубляющие вопросы:**
1. Почему PostgreSQL не использует lock escalation?
2. Как PostgreSQL управляет большим количеством row locks?
3. Какие альтернативы lock escalation использует PostgreSQL?
4. Как это влияет на memory usage?
5. В каких случаях это может стать проблемой?

### 34. Объясните работу с concurrent indexing
**Углубляющие вопросы:**
1. Какие блокировки используются при CREATE INDEX CONCURRENTLY?
2. Почему нельзя создать уникальный индекс concurrently в транзакции?
3. Что такое invalid index и как его исправить?
4. Как мониторить прогресс создания индекса?
5. Какие риски связаны с concurrent indexing?

### 35. Что такое row versioning и как оно работает?
**Углубляющие вопросы:**
1. Как PostgreSQL хранит разные версии одной строки?
2. Что такое tuple header и какую информацию он содержит?
3. Как row versioning влияет на размер таблиц?
4. Когда старые версии строк удаляются?
5. Как оптимизировать систему при интенсивных UPDATE операциях?

---

## 4. Архитектура PostgreSQL (10 вопросов)

### 36. Объясните архитектуру процессов PostgreSQL
**Углубляющие вопросы:**
1. Какую роль играет postmaster процесс?
2. Как работают background writer и checkpointer?
3. Что делает WAL writer процесс?
4. Как работает autovacuum launcher?
5. Что происходит при создании нового подключения?

### 37. Что такое shared buffers и как их настроить?
**Углубляющие вопросы:**
1. Какой процент RAM стоит выделить под shared_buffers?
2. Как PostgreSQL управляет страницами в shared buffers?
3. Что такое buffer replacement алгоритм?
4. Как мониторить hit ratio для shared buffers?
5. Влияет ли размер shared_buffers на checkpoint частоту?

### 38. Объясните работу WAL (Write-Ahead Logging)
**Углубляющие вопросы:**
1. Как WAL обеспечивает durability в PostgreSQL?
2. Что такое WAL segments и как они ротируются?
3. Как настроить wal_level для разных задач?
4. Что такое WAL compression и когда его использовать?
5. Как WAL влияет на производительность системы?

### 39. Что такое checkpoint и как они работают?
**Углубляющие вопросы:**
1. Что происходит во время checkpoint?
2. Как настроить checkpoint_segments и checkpoint_completion_target?
3. Что такое checkpoint spikes и как их минимизировать?
4. Как мониторить checkpoint активность?
5. Влияют ли checkpoint на время восстановления?

### 40. Объясните концепцию tablespaces в PostgreSQL
**Углубляющие вопросы:**
1. Зачем нужны кастомные tablespaces?
2. Как переместить таблицу между tablespaces?
3. Можно ли использовать разные типы хранилища для tablespaces?
4. Как tablespaces влияют на backup и recovery?
5. Какие права нужны для создания tablespace?

### 41. Что такое connection pooling и зачем он нужен?
**Углубляющие вопросы:**
1. В чем разница между pgBouncer и встроенным pooling?
2. Какие режимы pooling существуют (session, transaction, statement)?
3. Как connection pooling влияет на prepared statements?
4. Что такое connection pool exhaustion и как его избежать?
5. Как настроить оптимальный размер connection pool?

### 42. Объясните работу PostgreSQL с памятью
**Углубляющие вопросы:**
1. Что такое work_mem и как его настроить?
2. Как PostgreSQL использует maintenance_work_mem?
3. Что происходит при превышении work_mem лимита?
4. Как разные операции используют memory?
5. Как мониторить memory usage в PostgreSQL?

### 43. Что такое PostgreSQL extensions и как они работают?
**Углубляющие вопросы:**
1. Как установить и активировать extension?
2. Что такое extension dependencies?
3. Можно ли создавать собственные extensions?
4. Как extensions влияют на безопасность?
5. Что происходит с данными при удалении extension?

### 44. Объясните концепцию roles и privileges в PostgreSQL
**Углубляющие вопросы:**
1. В чем разница между users и roles?
2. Как работает role inheritance?
3. Что такое row level security (RLS)?
4. Как настроить least privilege access?
5. Можно ли ограничить доступ на уровне колонок?

### 45. Что такое TOAST и как он работает?
**Углубляющие вопросы:**
1. При каких условиях активируется TOAST?
2. Какие стратегии TOAST существуют (PLAIN, EXTENDED, EXTERNAL, MAIN)?
3. Как TOAST влияет на производительность?
4. Можно ли настроить TOAST для конкретных колонок?
5. Как TOAST взаимодействует с VACUUM?

---

## 5. Продвинутые SQL конструкции (15 вопросов)

### 46. Объясните работу Window Functions
**Углубляющие вопросы:**
1. В чем разница между ROW_NUMBER(), RANK() и DENSE_RANK()?
2. Как использовать FRAME clauses (ROWS vs RANGE)?
3. Что такое PARTITION BY в контексте window functions?
4. Как оптимизировать производительность window functions?
5. Можно ли использовать window functions в WHERE clause?

### 47. Что такое CTE (Common Table Expressions) и рекурсивные CTE?
**Углубляющие вопросы:**
1. В чем разница между CTE и подзапросами?
2. Как работают рекурсивные CTE?
3. Есть ли ограничения на глубину рекурсии?
4. Как оптимизатор обрабатывает CTE?
5. Когда стоит использовать MATERIALIZED CTE?

### 48. Объясните концепцию LATERAL joins
**Углубляющие вопросы:**
1. Чем LATERAL отличается от обычного JOIN?
2. Как LATERAL работает с функциями?
3. Можно ли использовать LATERAL с подзапросами?
4. Как оптимизируются LATERAL joins?
5. Приведите практический пример использования LATERAL

### 49. Что такое UPSERT (INSERT ... ON CONFLICT)?
**Углубляющие вопросы:**
1. Как работает ON CONFLICT DO UPDATE?
2. Что такое conflict_target и как его указать?
3. Можно ли использовать WHERE в ON CONFLICT?
4. Как UPSERT влияет на производительность?
5. Что происходит с триггерами при UPSERT?

### 50. Объясните работу с JSON/JSONB в PostgreSQL
**Углубляющие вопросы:**
1. В чем разница между JSON и JSONB?
2. Как индексировать JSONB данные?
3. Какие операторы доступны для работы с JSON?
4. Как валидировать JSON схему?
5. Можно ли использовать JSON в WHERE условиях эффективно?

### 51. Что такое массивы в PostgreSQL и как с ними работать?
**Углубляющие вопросы:**
1. Как создать и индексировать массивы?
2. Какие операторы доступны для массивов?
3. Можно ли создавать многомерные массивы?
4. Как искать элементы в массивах?
5. Когда стоит использовать массивы вместо нормализации?

### 52. Объясните работу полнотекстового поиска (Full-Text Search)
**Углубляющие вопросы:**
1. Что такое tsvector и tsquery?
2. Как работают разные конфигурации поиска?
3. Что такое stemming и как оно работает?
4. Как ранжировать результаты поиска?
5. Можно ли настроить кастомные словари?

### 53. Что такое генерируемые колонки (Generated Columns)?
**Углубляющие вопросы:**
1. В чем разница между STORED и VIRTUAL колонками?
2. Можно ли индексировать генерируемые колонки?
3. Какие ограничения есть для выражений в генерируемых колонках?
4. Как генерируемые колонки влияют на производительность?
5. Можно ли использовать функции в генерируемых колонках?

### 54. Объясните работу с временными зонами в PostgreSQL
**Углубляющие вопросы:**
1. В чем разница между TIMESTAMP и TIMESTAMPTZ?
2. Как PostgreSQL определяет временную зону?
3. Что такое AT TIME ZONE конструкция?
4. Как работать с временными зонами в приложениях?
5. Какие функции доступны для работы с датами?

### 55. Что такое range типы данных в PostgreSQL?
**Углубляющие вопросы:**
1. Какие встроенные range типы существуют?
2. Как создать кастомный range тип?
3. Какие операторы доступны для range типов?
4. Можно ли индексировать range типы?
5. Как использовать range типы для временных интервалов?

### 56. Объясните концепцию VACUUM и его варианты
**Углубляющие вопросы:**
1. В чем разница между VACUUM, VACUUM FULL и CLUSTER?
2. Что такое VACUUM ANALYZE?
3. Как определить, когда нужен VACUUM?
4. Что такое vacuum freeze и зачем он нужен?
5. Как настроить автоматический VACUUM?

### 57. Что такое pg_stat_statements и как его использовать?
**Углубляющие вопросы:**
1. Как установить и настроить pg_stat_statements?
2. Какие метрики предоставляет это расширение?
3. Как найти самые медленные запросы?
4. Что такое normalized queries в pg_stat_statements?
5. Как очистить статистику pg_stat_statements?

### 58. Объясните работу с курсорами (CURSORS)
**Углубляющие вопросы:**
1. Когда стоит использовать курсоры?
2. В чем разница между WITH HOLD и без него?
3. Как курсоры влияют на память?
4. Можно ли обновлять данные через курсоры?
5. Что происходит с курсорами при завершении транзакции?

### 59. Что такое COPY команда и как ее оптимизировать?
**Углубляющие вопросы:**
1. В чем разница между COPY и \copy в psql?
2. Как ускорить COPY для больших объемов данных?
3. Можно ли использовать COPY с filters?
4. Как обрабатывать ошибки при COPY?
5. Что такое COPY FREEZE и когда его использовать?

### 60. Объясните работу с наследованием таблиц
**Углубляющие вопросы:**
1. Как создать иерархию наследования таблиц?
2. Как работают constraints в наследуемых таблицах?
3. Что такое constraint exclusion?
4. Можно ли наследовать от нескольких таблиц?
5. Как наследование влияет на производительность запросов?

---

## 6. Производительность и мониторинг (10 вопросов)

### 61. Как мониторить производительность PostgreSQL?
**Углубляющие вопросы:**
1. Какие системные представления помогают в мониторинге?
2. Что такое pg_stat_activity и как его использовать?
3. Как настроить логирование медленных запросов?
4. Какие внешние инструменты мониторинга рекомендуются?
5. Как мониторить I/O производительность PostgreSQL?

### 62. Что такое query planner и как он работает?
**Углубляющие вопросы:**
1. Как PostgreSQL выбирает план выполнения запроса?
2. Что такое cost-based optimization?
3. Как влияют настройки random_page_cost и seq_page_cost?
4. Можно ли принудительно изменить план выполнения?
5. Что такое genetic query optimization (GEQO)?

### 63. Объясните концепцию работы с большими таблицами
**Углубляющие вопросы:**
1. Что такое partitioning и какие типы поддерживает PostgreSQL?
2. Как работает constraint exclusion для партиций?
3. В чем разница между declarative и inheritance partitioning?
4. Как оптимизировать JOIN операции с партиционированными таблицами?
5. Можно ли автоматически создавать партиции?

### 64. Как оптимизировать медленные запросы?
**Углубляющие вопросы:**
1. Какая методология анализа медленных запросов?
2. Как использовать EXPLAIN (ANALYZE, BUFFERS) для диагностики?
3. Что такое sequential scan и когда он неэффективен?
4. Как оптимизировать запросы с подзапросами?
5. Когда стоит переписать запрос вместо добавления индексов?

### 65. Что такое connection limits и как их настроить?
**Углубляющие вопросы:**
1. Как max_connections влияет на память системы?
2. Что происходит при превышении лимита подключений?
3. Как настроить per-database или per-user лимиты?
4. Что такое reserved_connections?
5. Как мониторить использование подключений?

### 66. Объясните настройку параметров PostgreSQL для производительности
**Углубляющие вопросы:**
1. Какие параметры наиболее критичны для производительности?
2. Как настроить effective_cache_size?
3. Что такое random_page_cost и как его оптимизировать для SSD?
4. Как влияет wal_buffers на производительность записи?
5. Какие параметры нужно настроить для OLAP vs OLTP нагрузки?

### 67. Что такое bloat в PostgreSQL и как с ним бороться?
**Углубляющие вопросы:**
1. Что вызывает table и index bloat?
2. Как измерить уровень bloat в таблицах?
3. В чем разница между VACUUM и REINDEX для борьбы с bloat?
4. Что такое pg_repack и когда его использовать?
5. Как предотвратить excessive bloat?

### 68. Объясните работу autovacuum и его настройку
**Углубляющие вопросы:**
1. Как автовакуум решает, когда запускать VACUUM?
2. Что такое autovacuum_vacuum_scale_factor?
3. Как настроить агрессивность автовакуума?
4. Что делать, если автовакуум не успевает?
5. Как мониторить работу автовакуума?

### 69. Что такое I/O bottlenecks и как их диагностировать?
**Углубляющие вопросы:**
1. Как определить, что проблема в дисковой подсистеме?
2. Что такое checkpoint spikes и как их минимизировать?
3. Как настройки bgwriter влияют на I/O?
4. Что показывает pg_stat_bgwriter?
5. Как оптимизировать WAL для лучшей I/O производительности?

### 70. Объясните концепцию prepared statements
**Углубляющие вопросы:**
1. Как prepared statements влияют на производительность?
2. Что такое plan caching в prepared statements?
3. Когда prepared statements могут ухудшить производительность?
4. Как работают prepared statements в connection pooling?
5. Что такое generic vs custom plans?

---

## 7. Репликация и масштабирование (10 вопросов)

### 71. Объясните типы репликации в PostgreSQL
**Углубляющие вопросы:**
1. В чем разница между streaming и file-based репликацией?
2. Что такое synchronous vs asynchronous репликация?
3. Как работает logical репликация?
4. Что такое cascading репликация?
5. Можно ли комбинировать разные типы репликации?

### 72. Что такое WAL shipping и как его настроить?
**Углубляющие вопросы:**
1. Как настроить archive_command для WAL shipping?
2. Что такое restore_command на standby сервере?
3. Как мониторить задержку WAL shipping?
4. Что делать при потере WAL файлов?
5. Как автоматизировать failover при WAL shipping?

### 73. Объясните концепцию hot standby
**Углубляющие вопросы:**
1. Какие операции доступны на hot standby сервере?
2. Что такое recovery conflicts?
3. Как настроить max_standby_streaming_delay?
4. Можно ли создавать временные таблицы на standby?
5. Как работают vacuum conflicts на standby?

### 74. Что такое logical replication и когда его использовать?
**Углубляющие вопросы:**
1. В чем преимущества logical репликации перед physical?
2. Что такое publication и subscription?
3. Можно ли реплицировать только часть таблицы?
4. Как обрабатываются conflicts в logical репликации?
5. Как logical репликация влияет на производительность?

### 75. Объясните процесс failover и switchover
**Углубляющие вопросы:**
1. В чем разница между planned и unplanned failover?
2. Что такое promote операция?
3. Как обеспечить minimal data loss при failover?
4. Что такое timeline в контексте репликации?
5. Как автоматизировать failover процесс?

### 76. Что такое read replicas и как их масштабировать?
**Углубляющие вопросы:**
1. Как распределять read нагрузку между replicas?
2. Что такое read replica lag и как его минимизировать?
3. Можно ли использовать read replicas для backup?
4. Как обрабатывать read-after-write consistency?
5. Что происходит при недоступности master сервера?

### 77. Объясните концепцию sharding в PostgreSQL
**Углубляющие вопросы:**
1. Какие стратегии sharding существуют?
2. Что такое Postgres-XL и Citus?
3. Как реализовать application-level sharding?
4. Какие проблемы создает sharding для JOIN операций?
5. Как обеспечить referential integrity при sharding?

### 78. Что такое connection pooling на уровне proxy?
**Углубляющие вопросы:**
1. В чем разница между pgBouncer и HAProxy?
2. Как настроить load balancing для read replicas?
3. Что такое connection multiplexing?
4. Как обрабатывать connection failover?
5. Какие метрики важны для мониторинга pooling?

### 79. Объясните backup и recovery стратегии
**Углубляющие вопросы:**
1. В чем разница между logical и physical backup?
2. Что такое point-in-time recovery (PITR)?
3. Как создать consistent backup активной базы?
4. Что такое pg_basebackup и как его использовать?
5. Как тестировать backup и recovery процедуры?

### 80. Что такое high availability архитектура?
**Углубляющие вопросы:**
1. Какие компоненты входят в HA PostgreSQL кластер?
2. Что такое split-brain проблема и как ее избежать?
3. Как работают инструменты типа Patroni или repmgr?
4. Что такое witness сервер в контексте HA?
5. Как обеспечить zero-downtime maintenance?

---

## Заключение

Этот набор вопросов предназначен для комплексной оценки знаний backend разработчика в области PostgreSQL и SQL. Вопросы разделены на тематические блоки и имеют разный уровень сложности - от базовых концепций до продвинутых техник оптимизации и масштабирования.

**Рекомендации по проведению интервью:**
- Начинайте с базовых вопросов и углубляйтесь в зависимости от ответов
- Просите конкретные примеры и практические кейсы
- Обращайте внимание не только на знание теории, но и на понимание практического применения
- Адаптируйте вопросы под специфику вашего проекта и стека технологий

**Критерии оценки:**
- **Junior**: уверенные ответы на основные вопросы из разделов 1-2
- **Middle**: хорошее понимание разделов 1-4, базовые знания разделов 5-6
- **Senior**: глубокие знания всех разделов, способность объяснить сложные концепции
- **Lead/Architect**: экспертные знания, понимание trade-offs, опыт решения сложных проблем производительности и масштабирования