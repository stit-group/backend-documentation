# План изучения PostgreSQL для Backend разработчика
*От основ до экспертного уровня за 16 недель*

## Общая структура обучения

**Продолжительность:** 16 недель  
**Временные затраты:** 10-15 часов в неделю  
**Уровень:** От начинающего до продвинутого  
**Формат:** Теория + практические задания + проекты

---

## ФАЗА 1: ОСНОВЫ SQL И POSTGRESQL (Недели 1-3)

### Неделя 1: Фундаментальные концепции
**Цель:** Понимание основ реляционных БД и первое знакомство с PostgreSQL

#### Теоретический блок (4 часа)
- [ ] **Концепции СУБД**
  - Что такое СУБД и зачем она нужна
  - Проблемы, которые решает СУБД (персистентность, concurrent доступ, ACID)
  - Место PostgreSQL среди других СУБД

- [ ] **Реляционная модель**
  - Понятие таблиц, строк, столбцов
  - Первичные и внешние ключи
  - Ограничения целостности данных

- [ ] **Нормализация данных**
  - Первая нормальная форма (1NF) - атомарность значений
  - Вторая нормальная форма (2NF) - устранение дублирования
  - Третья нормальная форма (3NF) - устранение транзитивных зависимостей

#### Практический блок (6 часов)
- [ ] **Установка и настройка**
  - Установка PostgreSQL
  - Настройка psql
  - Создание первой базы данных

- [ ] **Основы DDL**
  - Создание таблиц с различными типами данных
  - Изучение ограничений (PRIMARY KEY, FOREIGN KEY, UNIQUE, CHECK)
  - Операции ALTER TABLE

#### Практические задания
- [ ] Создать схему БД для интернет-магазина (пользователи, товары, заказы)
- [ ] Добавить все необходимые ограничения и связи
- [ ] Протестировать ограничения целостности

**Материалы для изучения:**
- Документация PostgreSQL по типам данных
- Примеры нормализации БД
- Практические упражнения по DDL

---

### Неделя 2: Основные SQL операции
**Цель:** Освоение базовых операций с данными (CRUD)

#### Теоретический блок (3 часа)
- [ ] **DML операции**
  - INSERT: одиночные и множественные вставки
  - SELECT: базовые запросы и проекции
  - UPDATE: обновление с условиями
  - DELETE: безопасное удаление данных

- [ ] **Типы данных PostgreSQL**
  - Числовые типы (INTEGER, DECIMAL, SERIAL)
  - Строковые типы (VARCHAR, TEXT, CHAR)
  - Дата и время (DATE, TIMESTAMP, INTERVAL)
  - Логический тип (BOOLEAN)
  - Специальные типы (JSON, массивы)

#### Практический блок (7 часов)
- [ ] **Операции INSERT**
  - Вставка с указанием колонок
  - Множественные вставки
  - INSERT с RETURNING
  - UPSERT с ON CONFLICT

- [ ] **Запросы SELECT**
  - Выборка с вычисляемыми полями
  - Использование псевдонимов
  - Конструкция CASE WHEN

- [ ] **Работа с датами и JSON**
  - Арифметические операции с датами
  - Функции для работы с JSON/JSONB
  - Индексирование JSON полей

#### Практические задания
- [ ] Заполнить созданную схему тестовыми данными
- [ ] Написать 20 различных INSERT запросов
- [ ] Создать отчеты с использованием SELECT и вычисляемых полей
- [ ] Поработать с JSON данными (настройки пользователей)

**Контрольная точка:** Уверенное владение базовыми CRUD операциями

---

### Неделя 3: Расширенные SELECT запросы
**Цель:** Освоение фильтрации, сортировки и агрегации данных

#### Теоретический блок (3 часа)
- [ ] **Фильтрация данных**
  - Операторы сравнения
  - Логические операторы (AND, OR, NOT)
  - Паттерны поиска (LIKE, ILIKE)
  - Регулярные выражения в PostgreSQL

- [ ] **Агрегатные функции**
  - COUNT, SUM, AVG, MIN, MAX
  - Группировка данных (GROUP BY)
  - Фильтрация групп (HAVING)

#### Практический блок (7 часов)
- [ ] **Сложные условия WHERE**
  - Комбинирование условий
  - IN, NOT IN, BETWEEN
  - EXISTS, NOT EXISTS
  - IS NULL, IS NOT NULL

- [ ] **Сортировка и ограничения**
  - ORDER BY с несколькими критериями
  - LIMIT и OFFSET для пагинации
  - DISTINCT для уникальных значений

- [ ] **Аналитические запросы**
  - Группировка по датам
  - Подсчет статистик
  - Создание сводных отчетов

#### Практические задания
- [ ] Создать 15 отчетов различной сложности
- [ ] Реализовать пагинацию для списков
- [ ] Построить аналитику продаж по периодам
- [ ] Найти топ-покупателей и популярные товары

**Контрольная точка:** Создание сложных аналитических запросов

---

## ФАЗА 2: ПРОДВИНУТЫЙ SQL (Недели 4-7)

### Недели 4-5: Объединения таблиц (JOINs)
**Цель:** Мастерское владение связыванием данных из нескольких таблиц

#### Теоретический блок (4 часа)
- [ ] **Концепция JOIN операций**
  - Декартово произведение
  - Типы связей между таблицами
  - Понимание результатов различных JOIN

- [ ] **Типы JOIN**
  - INNER JOIN - пересечение
  - LEFT/RIGHT JOIN - включение всех записей
  - FULL OUTER JOIN - объединение всего
  - CROSS JOIN - декартово произведение

#### Практический блок (12 часов)
- [ ] **Простые JOIN операции**
  - Связывание пользователей и заказов
  - Получение данных о товарах в заказах
  - Подсчет статистик через JOIN

- [ ] **Сложные JOIN сценарии**
  - Самообъединения (Self JOIN)
  - Множественные JOIN в одном запросе
  - JOIN с условиями в ON vs WHERE

- [ ] **Подзапросы**
  - Скалярные подзапросы
  - Подзапросы в WHERE (EXISTS, IN)
  - Коррелированные подзапросы
  - Производные таблицы в FROM

#### Практические задания
- [ ] Создать отчет "Пользователи и их заказы" со всеми деталями
- [ ] Найти пользователей без заказов и товары без продаж
- [ ] Построить иерархию категорий товаров
- [ ] Создать сложный отчет с множественными JOIN

**Контрольная точка:** Свободное владение любыми типами JOIN

---

### Неделя 6: Функции окна (Window Functions)
**Цель:** Освоение аналитических функций для сложной обработки данных

#### Теоретический блок (4 часа)
- [ ] **Концепция оконных функций**
  - Отличие от GROUP BY
  - Компоненты: OVER, PARTITION BY, ORDER BY
  - Границы окна (ROWS, RANGE)

- [ ] **Типы оконных функций**
  - Ранжирующие функции
  - Агрегатные функции как оконные
  - Функции доступа к строкам

#### Практический блок (8 часов)
- [ ] **Ранжирование данных**
  - ROW_NUMBER, RANK, DENSE_RANK
  - NTILE для разбивки на группы
  - Процентили и квартили

- [ ] **Аналитические вычисления**
  - Накопительные суммы
  - Скользящие средние
  - Сравнение с предыдущими/следующими значениями

- [ ] **Сложные аналитические запросы**
  - LAG/LEAD для трендового анализа
  - FIRST_VALUE/LAST_VALUE
  - Комбинирование различных оконных функций

#### Практические задания
- [ ] Ранжировать товары по популярности в каждой категории
- [ ] Рассчитать накопительные продажи по месяцам
- [ ] Найти изменения цен товаров во времени
- [ ] Создать дашборд продаж с трендами

**Контрольная точка:** Создание сложных аналитических отчетов

---

### Неделя 7: Общие табличные выражения (CTE)
**Цель:** Структурирование сложных запросов и работа с рекурсией

#### Теоретический блок (3 часа)
- [ ] **Концепция CTE**
  - Преимущества перед подзапросами
  - Читаемость и переиспользование
  - Ограничения CTE

- [ ] **Рекурсивные CTE**
  - Структура рекурсивного запроса
  - Якорная часть и рекурсивная часть
  - Условия остановки рекурсии

#### Практический блок (9 часов)
- [ ] **Простые CTE**
  - Разбивка сложных запросов на этапы
  - Множественные CTE в одном запросе
  - Переиспользование результатов

- [ ] **Рекурсивные структуры**
  - Иерархии организации
  - Категории и подкатегории
  - Генерация последовательностей

- [ ] **Практические применения**
  - Многоуровневые агрегации
  - Построение отчетов сложной структуры
  - Обход графов в базе данных

#### Практические задания
- [ ] Переписать сложные запросы с подзапросами через CTE
- [ ] Построить дерево категорий товаров
- [ ] Создать отчет по структуре организации
- [ ] Сгенерировать календарь для отчетности

**Контрольная точка:** Владение структурированием сложных запросов

---

## ФАЗА 3: POSTGRESQL-СПЕЦИФИЧНЫЕ ВОЗМОЖНОСТИ (Недели 8-10)

### Неделя 8: Индексы и производительность
**Цель:** Оптимизация производительности запросов

#### Теоретический блок (5 часов)
- [ ] **Концепция индексов**
  - Как работают индексы
  - Стоимость и преимущества
  - Когда нужны индексы

- [ ] **Типы индексов PostgreSQL**
  - B-tree (по умолчанию)
  - Hash индексы
  - GIN для составных данных
  - GiST для геометрических данных

#### Практический блок (8 часов)
- [ ] **Создание и управление индексами**
  - Простые и композитные индексы
  - Функциональные индексы
  - Частичные индексы
  - Уникальные индексы

- [ ] **Анализ производительности**
  - EXPLAIN и EXPLAIN ANALYZE
  - Чтение планов выполнения
  - Поиск узких мест

- [ ] **Оптимизация запросов**
  - Переписывание неэффективных запросов
  - Использование статистики
  - Настройка конфигурации

#### Практические задания
- [ ] Проанализировать производительность существующих запросов
- [ ] Создать необходимые индексы
- [ ] Оптимизировать медленные запросы
- [ ] Провести нагрузочное тестирование

**Контрольная точка:** Умение оптимизировать производительность БД

---

### Неделя 9: Транзакции и конкурентность
**Цель:** Обеспечение целостности данных в многопользовательской среде

#### Теоретический блок (4 часа)
- [ ] **ACID свойства**
  - Atomicity (Атомарность)
  - Consistency (Согласованность)
  - Isolation (Изолированность)
  - Durability (Долговечность)

- [ ] **Уровни изоляции**
  - Read Uncommitted
  - Read Committed
  - Repeatable Read
  - Serializable

#### Практический блок (8 часа)
- [ ] **Управление транзакциями**
  - BEGIN, COMMIT, ROLLBACK
  - Savepoints для частичных откатов
  - Автоматические транзакции

- [ ] **Блокировки и конкурентность**
  - Типы блокировок
  - Deadlock и их предотвращение
  - Оптимистичные vs пессимистичные блокировки

- [ ] **Практические сценарии**
  - Обработка банковских переводов
  - Резервирование товаров
  - Многопользовательские обновления

#### Практические задания
- [ ] Реализовать систему переводов между счетами
- [ ] Создать механизм резервирования товаров
- [ ] Протестировать различные уровни изоляции
- [ ] Обработать ситуации с deadlock

**Контрольная точка:** Понимание принципов работы с транзакциями

---

### Неделя 10: Хранимые процедуры и триггеры
**Цель:** Перенос бизнес-логики на уровень базы данных

#### Теоретический блок (3 часа)
- [ ] **Хранимые процедуры и функции**
  - Различия между процедурами и функциями
  - Языки программирования (PL/pgSQL, SQL)
  - Управление параметрами

- [ ] **Триггеры**
  - Типы триггеров (BEFORE, AFTER, INSTEAD OF)
  - События триггеров (INSERT, UPDATE, DELETE)
  - Использование NEW и OLD

#### Практический блок (9 часов)
- [ ] **Создание функций**
  - Простые функции на SQL
  - Функции на PL/pgSQL
  - Функции с различными типами возврата

- [ ] **Работа с триггерами**
  - Аудит изменений данных
  - Автоматическое обновление полей
  - Валидация данных

- [ ] **Сложные сценарии**
  - Каскадные операции
  - Кэширование агрегатных данных
  - Логирование действий пользователей

#### Практические задания
- [ ] Создать систему аудита всех изменений
- [ ] Реализовать автоматический расчет итогов заказа
- [ ] Написать функции для сложных бизнес-расчетов
- [ ] Создать систему уведомлений через триггеры

**Контрольная точка:** Владение серверным программированием

---

## ФАЗА 4: РАСШИРЕННЫЕ ВОЗМОЖНОСТИ (Недели 11-13)

### Неделя 11: JSON и NoSQL возможности
**Цель:** Работа с неструктурированными данными

#### Теоретический блок (3 часа)
- [ ] **JSON vs JSONB**
  - Различия в хранении и производительности
  - Когда использовать каждый тип
  - Ограничения и возможности

- [ ] **Индексирование JSON**
  - GIN индексы для JSONB
  - Индексирование конкретных путей
  - Производительность JSON запросов

#### Практический блок (9 часов)
- [ ] **Операторы и функции JSON**
  - Извлечение данных (->>, ->, #>)
  - Проверка существования (??, @>)
  - Модификация JSON (||, -, #-)

- [ ] **Сложные JSON запросы**
  - Поиск по вложенным структурам
  - Агрегация JSON данных
  - Построение JSON из реляционных данных

- [ ] **Практические применения**
  - Настройки пользователей
  - Логирование событий
  - Гибкие схемы данных

#### Практические задания
- [ ] Создать систему гибких настроек
- [ ] Реализовать журнал событий в JSON
- [ ] Построить аналитику по JSON данным
- [ ] Мигрировать часть реляционных данных в JSON

---

### Неделя 12: Полнотекстовый поиск
**Цель:** Реализация поисковых возможностей

#### Теоретический блок (4 часа)
- [ ] **Концепция полнотекстового поиска**
  - tsvector и tsquery
  - Языковые конфигурации
  - Ранжирование результатов

- [ ] **Словари и парсеры**
  - Стемминг и лемматизация
  - Стоп-слова
  - Настройка для русского языка

#### Практический блок (8 часов)
- [ ] **Настройка поиска**
  - Создание поисковых индексов
  - Конфигурация языков
  - Оптимизация производительности

- [ ] **Сложные поисковые запросы**
  - Булевые операторы
  - Поиск по фразам
  - Нечеткий поиск

- [ ] **Интеграция с приложением**
  - API для поиска
  - Автодополнение
  - Поиск с фильтрами

#### Практические задания
- [ ] Реализовать поиск по товарам
- [ ] Создать систему автодополнения
- [ ] Добавить поиск по содержимому статей
- [ ] Построить рейтинг релевантности

---

### Неделя 13: Партиционирование и масштабирование
**Цель:** Подготовка к работе с большими данными

#### Теоретический блок (4 часа)
- [ ] **Типы партиционирования**
  - Range партиционирование
  - List партиционирование
  - Hash партиционирование

- [ ] **Стратегии масштабирования**
  - Вертикальное масштабирование
  - Горизонтальное масштабирование
  - Шардирование

#### Практический блок (8 часов)
- [ ] **Настройка партиций**
  - Создание партиционированных таблиц
  - Автоматическое создание партиций
  - Переход от обычных таблиц к партиционированным

- [ ] **Репликация**
  - Настройка master-slave репликации
  - Мониторинг репликации
  - Переключение между серверами

#### Практические задания
- [ ] Партиционировать таблицу заказов по датам
- [ ] Настроить репликацию для чтения
- [ ] Протестировать производительность партиций
- [ ] Создать план миграции больших таблиц

---

## ФАЗА 5: АДМИНИСТРИРОВАНИЕ И ПРОДАКШН (Недели 14-16)

### Неделя 14: Безопасность и права доступа
**Цель:** Обеспечение безопасности данных

#### Теоретический блок (4 часа)
- [ ] **Модель безопасности PostgreSQL**
  - Роли и пользователи
  - Уровни доступа
  - Наследование прав

- [ ] **Шифрование и защита**
  - SSL соединения
  - Шифрование данных
  - Аудит доступа

#### Практический блок (8 часов)
- [ ] **Управление пользователями**
  - Создание ролей
  - Назначение прав
  - Политики безопасности

- [ ] **Row Level Security**
  - Настройка RLS
  - Политики доступа к строкам
  - Многопользовательские приложения

#### Практические задания
- [ ] Создать иерархию ролей для приложения
- [ ] Настроить RLS для изоляции данных клиентов
- [ ] Реализовать аудит доступа к данным
- [ ] Протестировать безопасность системы

---

### Неделя 15: Мониторинг и диагностика
**Цель:** Обеспечение стабильной работы системы

#### Теоретический блок (3 часа)
- [ ] **Системы мониторинга**
  - Встроенная статистика PostgreSQL
  - Внешние системы мониторинга
  - Ключевые метрики

- [ ] **Диагностика проблем**
  - Анализ логов
  - Профилирование запросов
  - Поиск узких мест

#### Практический блок (9 часов)
- [ ] **Настройка мониторинга**
  - pg_stat_* представления
  - Настройка логирования
  - Автоматические уведомления

- [ ] **Оптимизация конфигурации**
  - Настройка памяти
  - Параметры производительности
  - Конфигурация для продакшна

#### Практические задания
- [ ] Настроить комплексный мониторинг
- [ ] Создать дашборд производительности
- [ ] Оптимизировать конфигурацию сервера
- [ ] Подготовить план реагирования на инциденты

---

### Неделя 16: Резервное копирование и восстановление
**Цель:** Обеспечение сохранности данных

#### Теоретический блок (3 часа)
- [ ] **Стратегии резервного копирования**
  - Логические бэкапы (pg_dump)
  - Физические бэкапы
  - Point-in-time recovery

- [ ] **Планирование катастроф**
  - RTO и RPO цели
  - Процедуры восстановления
  - Тестирование бэкапов

#### Практический блок (9 часов)
- [ ] **Автоматизация бэкапов**
  - Скрипты резервного копирования
  - Ротация бэкапов
  - Мониторинг процесса

- [ ] **Процедуры восстановления**
  - Восстановление из бэкапов
  - Point-in-time recovery
  - Репликация для отказоустойчивости

#### Итоговый проект
- [ ] Создать полноценное приложение с использованием всех изученных возможностей
- [ ] Настроить продакшн-окружение
- [ ] Подготовить документацию и процедуры обслуживания

---

## Критерии успешного завершения

### По завершении курса студент должен уметь:

**Базовый уровень:**
- [ ] Создавать и модифицировать структуру БД
- [ ] Писать эффективные SQL запросы любой сложности
- [ ] Использовать индексы для оптимизации производительности
- [ ] Работать с транзакциями и обеспечивать целостность данных

**Продвинутый уровень:**
- [ ] Оптимизировать производительность БД
- [ ] Настраивать безопасность и права доступа
- [ ] Работать с большими объемами данных
- [ ] Проектировать масштабируемые решения

**Экспертный уровень:**
- [ ] Администрировать PostgreSQL в продакшне
- [ ] Решать сложные проблемы производительности
- [ ] Проектировать отказоустойчивые системы
- [ ] Автоматизировать процессы обслуживания

---

## Дополнительные ресурсы

### Обязательные материалы:
- Официальная документация PostgreSQL
- PostgreSQL: Up and Running (Regina Ose, Leo Hsu)
- High Performance PostgreSQL for Rails (Andrew Atkinson)

### Дополнительные материалы:
- PostgreSQL wiki и community
- Блоги разработчиков PostgreSQL
- Курсы и вебинары по продвинутым темам

### Инструменты для практики:
- pgAdmin для графического интерфейса
- DBeaver для работы с данными
- pgBench для нагрузочного тестирования
- Grafana + Prometheus для мониторинга