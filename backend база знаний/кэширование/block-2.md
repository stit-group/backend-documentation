# Ğ‘Ğ»Ğ¾Ğº 2: ĞĞ¿Ğ¿Ğ°Ñ€Ğ°Ñ‚Ğ½Ğ¾Ğµ ĞºÑÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
**â±ï¸ ĞŸÑ€Ğ¾Ğ´Ğ¾Ğ»Ğ¶Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ:** 2-3 Ğ½ĞµĞ´ĞµĞ»Ğ¸  
**ğŸ¯ Ğ¦ĞµĞ»ÑŒ:** Ğ˜Ğ·ÑƒÑ‡Ğ¸Ñ‚ÑŒ ĞºÑÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ½Ğ° ÑƒÑ€Ğ¾Ğ²Ğ½Ğµ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ñ€Ğ° Ğ¸ Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸, Ğ½Ğ°ÑƒÑ‡Ğ¸Ñ‚ÑŒÑÑ Ğ¿Ğ¸ÑĞ°Ñ‚ÑŒ cache-friendly ĞºĞ¾Ğ´

---

## ğŸ“– Ğ“Ğ»Ğ°Ğ²Ğ° 1: Ğ˜ĞµÑ€Ğ°Ñ€Ñ…Ğ¸Ñ Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸

### ĞĞ±Ğ·Ğ¾Ñ€ Ğ¸ĞµÑ€Ğ°Ñ€Ñ…Ğ¸Ğ¸ Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸

Ğ¡Ğ¾Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ ĞºĞ¾Ğ¼Ğ¿ÑŒÑÑ‚ĞµÑ€Ñ‹ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒÑÑ‚ Ğ¼Ğ½Ğ¾Ğ³Ğ¾ÑƒÑ€Ğ¾Ğ²Ğ½ĞµĞ²ÑƒÑ Ğ¸ĞµÑ€Ğ°Ñ€Ñ…Ğ¸Ñ Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸ Ğ´Ğ»Ñ Ğ±Ğ°Ğ»Ğ°Ğ½ÑĞ° Ğ¼ĞµĞ¶Ğ´Ñƒ ÑĞºĞ¾Ñ€Ğ¾ÑÑ‚ÑŒÑ, Ğ¾Ğ±ÑŠĞµĞ¼Ğ¾Ğ¼ Ğ¸ ÑÑ‚Ğ¾Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒÑ.

```
                    Ğ˜Ğ•Ğ ĞĞ Ğ¥Ğ˜Ğ¯ ĞŸĞĞœĞ¯Ğ¢Ğ˜
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                        â–² Ğ¡ĞºĞ¾Ñ€Ğ¾ÑÑ‚ÑŒ
                        â”‚ â–¼ ĞĞ±ÑŠĞµĞ¼  
                        â”‚ â–¼ Ğ¡Ñ‚Ğ¾Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ Ğ·Ğ° Ğ±Ğ°Ğ¹Ñ‚

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â† Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ñ‹ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ñ€Ğ°
â”‚   REGISTERS     â”‚   â€¢ 32-64 Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ° Ã— 64 Ğ±Ğ¸Ñ‚Ğ°
â”‚   ~0.25ns       â”‚   â€¢ Ğ’ÑÑ‚Ñ€Ğ¾ĞµĞ½Ñ‹ Ğ² Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ñ€
â”‚   ~256 Ğ±Ğ°Ğ¹Ñ‚     â”‚   â€¢ ĞŸÑ€ÑĞ¼Ğ¾Ğ¹ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ñ€Ğ°
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â† L1 ĞºÑÑˆ (Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ + Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ğ¸Ğ¸)
â”‚   L1 CACHE      â”‚   â€¢ 32-64 KB (Ğ¾Ğ±Ñ‹Ñ‡Ğ½Ğ¾ Ñ€Ğ°Ğ·Ğ´ĞµĞ»ĞµĞ½)
â”‚   ~1ns          â”‚   â€¢ L1d (Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ) + L1i (Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ğ¸Ğ¸)
â”‚   32-64 KB      â”‚   â€¢ ĞĞ´Ğ¸Ğ½ ĞºÑÑˆ Ğ½Ğ° ÑĞ´Ñ€Ğ¾
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â† L2 ĞºÑÑˆ (Ğ¾Ğ±ÑŠĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ½Ñ‹Ğ¹)
â”‚   L2 CACHE      â”‚   â€¢ 256KB - 1MB
â”‚   ~3-5ns        â”‚   â€¢ ĞĞ±ÑŠĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¸ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ğ¸Ğ¸
â”‚   256KB-1MB     â”‚   â€¢ ĞĞ´Ğ¸Ğ½ ĞºÑÑˆ Ğ½Ğ° ÑĞ´Ñ€Ğ¾ Ğ¸Ğ»Ğ¸ Ğ¿Ğ°Ñ€Ñƒ ÑĞ´ĞµÑ€
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â† L3 ĞºÑÑˆ (Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ğ¹ ÑƒÑ€Ğ¾Ğ²ĞµĞ½ÑŒ)
â”‚   L3 CACHE      â”‚   â€¢ 8-32 MB
â”‚   ~10-20ns      â”‚   â€¢ Ğ Ğ°Ğ·Ğ´ĞµĞ»ÑĞµÑ‚ÑÑ Ğ¼ĞµĞ¶Ğ´Ñƒ Ğ²ÑĞµĞ¼Ğ¸ ÑĞ´Ñ€Ğ°Ğ¼Ğ¸
â”‚   8-32 MB       â”‚   â€¢ Last Level Cache (LLC)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â† ĞÑĞ½Ğ¾Ğ²Ğ½Ğ°Ñ Ğ¿Ğ°Ğ¼ÑÑ‚ÑŒ
â”‚   MAIN MEMORY   â”‚   â€¢ 8-128 GB (DDR4/DDR5)
â”‚   ~100-300ns    â”‚   â€¢ DRAM Ñ‚ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ñ
â”‚   8-128 GB      â”‚   â€¢ Ğ­Ğ½ĞµÑ€Ğ³Ğ¾Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ°Ñ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â† Ğ”Ğ¸ÑĞºĞ¾Ğ²Ğ¾Ğµ Ñ…Ñ€Ğ°Ğ½Ğ¸Ğ»Ğ¸Ñ‰Ğµ
â”‚   STORAGE       â”‚   â€¢ 256GB - 8TB+
â”‚   ~0.1-10ms     â”‚   â€¢ SSD: ~0.1ms, HDD: ~10ms
â”‚   256GB-8TB+    â”‚   â€¢ Ğ­Ğ½ĞµÑ€Ğ³Ğ¾Ğ½ĞµĞ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ°Ñ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Ğ¥Ğ°Ñ€Ğ°ĞºÑ‚ĞµÑ€Ğ¸ÑÑ‚Ğ¸ĞºĞ¸ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ ÑƒÑ€Ğ¾Ğ²Ğ½Ñ

#### Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ñ‹ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ñ€Ğ°
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Ğ Ğ•Ğ“Ğ˜Ğ¡Ğ¢Ğ Ğ«                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚ ĞĞ±Ñ‰ĞµĞ³Ğ¾ Ğ½Ğ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ (x86-64):                             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”       â”‚
â”‚ â”‚ RAX â”‚ RBX â”‚ RCX â”‚ RDX â”‚ RSI â”‚ RDI â”‚ RSP â”‚ RBP â”‚       â”‚
â”‚ â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                                         â”‚
â”‚ Ğ’ĞµĞºÑ‚Ğ¾Ñ€Ğ½Ñ‹Ğµ Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ñ‹ (AVX-512):                           â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚               ZMM0 (512 Ğ±Ğ¸Ñ‚)                      â”‚   â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚ â”‚               ZMM1 (512 Ğ±Ğ¸Ñ‚)                      â”‚   â”‚
â”‚ â”‚               ...                                 â”‚   â”‚
â”‚ â”‚               ZMM31 (512 Ğ±Ğ¸Ñ‚)                     â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                         â”‚
â”‚ Ğ¥Ğ°Ñ€Ğ°ĞºÑ‚ĞµÑ€Ğ¸ÑÑ‚Ğ¸ĞºĞ¸:                                         â”‚
â”‚ â€¢ Ğ›Ğ°Ñ‚ĞµĞ½Ñ‚Ğ½Ğ¾ÑÑ‚ÑŒ: 0.25-0.5 ns                             â”‚
â”‚ â€¢ ĞŸÑ€Ğ¾Ğ¿ÑƒÑĞºĞ½Ğ°Ñ ÑĞ¿Ğ¾ÑĞ¾Ğ±Ğ½Ğ¾ÑÑ‚ÑŒ: >1TB/s                       â”‚
â”‚ â€¢ ĞŸÑ€ÑĞ¼Ğ¾Ğµ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ ĞºĞ¾Ğ¼Ğ¿Ğ¸Ğ»ÑÑ‚Ğ¾Ñ€Ğ¾Ğ¼                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

### Memory Barriers Ğ¸ Ğ¸Ñ… Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   MEMORY BARRIERS                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚ ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°: Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ñ€Ñ‹ Ğ¼Ğ¾Ğ³ÑƒÑ‚ Ğ¿ĞµÑ€ĞµÑƒĞ¿Ğ¾Ñ€ÑĞ´Ğ¾Ñ‡Ğ¸Ğ²Ğ°Ñ‚ÑŒ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸   â”‚
â”‚ Ğ´Ğ»Ñ Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸                      â”‚
â”‚                                                         â”‚
â”‚ ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼Ñ‹ (Ğ±ĞµĞ· Ğ±Ğ°Ñ€ÑŒĞµÑ€Ğ¾Ğ²):                         â”‚
â”‚                                                         â”‚
â”‚ // Thread 1                // Thread 2                 â”‚
â”‚ data = 42;                 while (!ready);              â”‚
â”‚ ready = true;              printf("%d", data);          â”‚
â”‚                                                         â”‚
â”‚ ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°: Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ñ€ Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ¿Ğ¾Ğ¼ĞµĞ½ÑÑ‚ÑŒ Ğ¿Ğ¾Ñ€ÑĞ´Ğ¾Ğº Ğ·Ğ°Ğ¿Ğ¸ÑĞµĞ¹:     â”‚
â”‚ ready = true;  â† Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¾ Ğ¿ĞµÑ€Ğ²Ñ‹Ğ¼!                      â”‚
â”‚ data = 42;     â† Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¾ Ğ²Ñ‚Ğ¾Ñ€Ñ‹Ğ¼                       â”‚
â”‚                                                         â”‚
â”‚ Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚: Thread 2 Ğ¼Ğ¾Ğ¶ĞµÑ‚ ÑƒĞ²Ğ¸Ğ´ĞµÑ‚ÑŒ ready=true,           â”‚
â”‚ Ğ½Ğ¾ data ĞµÑ‰Ğµ Ğ½Ğµ Ğ·Ğ°Ğ¿Ğ¸ÑĞ°Ğ½!                                 â”‚
â”‚                                                         â”‚
â”‚ Ğ¢Ğ¸Ğ¿Ñ‹ memory barriers:                                   â”‚
â”‚                                                         â”‚
â”‚ 1. COMPILER BARRIERS                                    â”‚
â”‚    Ğ—Ğ°Ğ¿Ñ€ĞµÑ‰Ğ°ÑÑ‚ ĞºĞ¾Ğ¼Ğ¿Ğ¸Ğ»ÑÑ‚Ğ¾Ñ€Ñƒ Ğ¿ĞµÑ€ĞµÑƒĞ¿Ğ¾Ñ€ÑĞ´Ğ¾Ñ‡Ğ¸Ğ²Ğ°Ñ‚ÑŒ ĞºĞ¾Ğ´          â”‚
â”‚                                                         â”‚
â”‚    asm volatile("" : : : "memory");  // GCC             â”‚
â”‚    std::atomic_signal_fence();       // C++11          â”‚
â”‚                                                         â”‚
â”‚ 2. CPU BARRIERS                                         â”‚
â”‚    Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ÑÑÑ‚ Ğ¿Ğ¾Ñ€ÑĞ´ĞºĞ¾Ğ¼ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ Ğ½Ğ° Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ñ€Ğµ         â”‚
â”‚                                                         â”‚
â”‚    // x86-64                                            â”‚
â”‚    asm volatile("mfence" : : : "memory");  // Full      â”‚
â”‚    asm volatile("sfence" : : : "memory");  // Store     â”‚
â”‚    asm volatile("lfence" : : : "memory");  // Load      â”‚
â”‚                                                         â”‚
â”‚    // ARM                                               â”‚
â”‚    asm volatile("dmb sy" : : : "memory");  // Full      â”‚
â”‚    asm volatile("dmb st" : : : "memory");  // Store     â”‚
â”‚    asm volatile("dmb ld" : : : "memory");  // Load      â”‚
â”‚                                                         â”‚
â”‚ 3. ACQUIRE/RELEASE SEMANTICS                            â”‚
â”‚                                                         â”‚
â”‚    std::atomic<bool> ready{false};                      â”‚
â”‚    std::atomic<int> data{0};                            â”‚
â”‚                                                         â”‚
â”‚    // Thread 1                                          â”‚
â”‚    data.store(42, std::memory_order_relaxed);           â”‚
â”‚    ready.store(true, std::memory_order_release);        â”‚
â”‚                                                         â”‚
â”‚    // Thread 2                                          â”‚
â”‚    while (!ready.load(std::memory_order_acquire));      â”‚
â”‚    int value = data.load(std::memory_order_relaxed);    â”‚
â”‚                                                         â”‚
â”‚ Ğ’Ğ¸Ğ·ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ acquire/release:                           â”‚
â”‚                                                         â”‚
â”‚ Thread 1:                   Thread 2:                   â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚ â”‚ data = 42   â”‚             â”‚             â”‚            â”‚
â”‚ â”‚     â†“       â”‚             â”‚    â†“        â”‚            â”‚
â”‚ â”‚ RELEASE     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ ACQUIRE     â”‚            â”‚
â”‚ â”‚ ready=true  â”‚  synchronize â”‚ read ready  â”‚            â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚     â†“       â”‚            â”‚
â”‚                             â”‚ read data   â”‚            â”‚
â”‚                             â”‚ (sees 42)   â”‚            â”‚
â”‚                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                         â”‚
â”‚ Ğ“Ğ°Ñ€Ğ°Ğ½Ñ‚Ğ¸Ğ¸:                                               â”‚
â”‚ â€¢ Ğ’ÑĞµ Ğ·Ğ°Ğ¿Ğ¸ÑĞ¸ Ğ¿ĞµÑ€ĞµĞ´ RELEASE Ğ²Ğ¸Ğ´Ğ½Ñ‹ Ğ¿Ğ¾ÑĞ»Ğµ ACQUIRE          â”‚
â”‚ â€¢ ĞĞµÑ‚ Ğ¿ĞµÑ€ĞµÑƒĞ¿Ğ¾Ñ€ÑĞ´Ğ¾Ñ‡Ğ¸Ğ²Ğ°Ğ½Ğ¸Ñ Ñ‡ĞµÑ€ĞµĞ· Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ†Ñƒ                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ› ï¸ ĞŸÑ€Ğ°ĞºÑ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ

### Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ 1: Ğ˜Ğ·Ğ¼ĞµÑ€ĞµĞ½Ğ¸Ğµ Ğ»Ğ°Ñ‚ĞµĞ½Ñ‚Ğ½Ğ¾ÑÑ‚Ğ¸ ĞºÑÑˆĞµĞ¹

**Ğ¦ĞµĞ»ÑŒ:** Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ñƒ Ğ´Ğ»Ñ Ğ¸Ğ·Ğ¼ĞµÑ€ĞµĞ½Ğ¸Ñ Ñ…Ğ°Ñ€Ğ°ĞºÑ‚ĞµÑ€Ğ¸ÑÑ‚Ğ¸Ğº ĞºÑÑˆĞµĞ¹

```c
#include <stdio.h>
#include <stdlib.h>
#include <time.h>
#include <stdint.h>

#define KB (1024)
#define MB (1024 * KB)

// Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ´Ğ»Ñ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ¾Ğ²
struct cache_info {
    size_t size;
    double latency_ns;
    double bandwidth_gbps;
};

/**
 * Ğ˜Ğ·Ğ¼ĞµÑ€ĞµĞ½Ğ¸Ğµ Ğ»Ğ°Ñ‚ĞµĞ½Ñ‚Ğ½Ğ¾ÑÑ‚Ğ¸ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ° Ğº Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸
 * array_size - Ñ€Ğ°Ğ·Ğ¼ĞµÑ€ Ğ¼Ğ°ÑÑĞ¸Ğ²Ğ° Ğ´Ğ»Ñ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
 * iterations - ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ¸Ñ‚ĞµÑ€Ğ°Ñ†Ğ¸Ğ¹
 */
double measure_latency(size_t array_size, int iterations) {
    // TODO: Ğ ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¸Ğ·Ğ¼ĞµÑ€ĞµĞ½Ğ¸Ğµ Ğ»Ğ°Ñ‚ĞµĞ½Ñ‚Ğ½Ğ¾ÑÑ‚Ğ¸
    // 1. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ¼Ğ°ÑÑĞ¸Ğ² ÑƒĞºĞ°Ğ·Ğ°Ğ½Ğ½Ğ¾Ğ³Ğ¾ Ñ€Ğ°Ğ·Ğ¼ĞµÑ€Ğ°
    // 2. Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ğ°Ñ‚Ñ‚ĞµÑ€Ğ½ pointer chasing
    // 3. Ğ˜Ğ·Ğ¼ĞµÑ€Ğ¸Ñ‚ÑŒ Ğ²Ñ€ĞµĞ¼Ñ Ğ¿Ñ€Ğ¾Ñ…Ğ¾Ğ´Ğ° Ğ¿Ğ¾ Ğ²ÑĞµĞ¼Ñƒ Ğ¼Ğ°ÑÑĞ¸Ğ²Ñƒ
    // 4. Ğ’ĞµÑ€Ğ½ÑƒÑ‚ÑŒ ÑÑ€ĞµĞ´Ğ½ĞµĞµ Ğ²Ñ€ĞµĞ¼Ñ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ° Ğº Ğ¾Ğ´Ğ½Ğ¾Ğ¼Ñƒ ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚Ñƒ
    
    uint8_t *array = malloc(array_size);
    if (!array) return -1;
    
    // Ğ—Ğ°Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ ÑĞ»ÑƒÑ‡Ğ°Ğ¹Ğ½Ñ‹Ğ¼ Ğ¿Ğ°Ñ‚Ñ‚ĞµÑ€Ğ½Ğ¾Ğ¼ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ°
    // Ğ´Ğ»Ñ Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ prefetcher'Ğ°
    
    // Ğ’Ğ°Ñˆ ĞºĞ¾Ğ´ Ğ·Ğ´ĞµÑÑŒ...
    
    free(array);
    return 0.0; // placeholder
}

/**
 * ĞĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ñ€Ğ°Ğ·Ğ¼ĞµÑ€Ğ¾Ğ² ĞºÑÑˆĞµĞ¹ Ğ¿Ğ¾ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ Ğ»Ğ°Ñ‚ĞµĞ½Ñ‚Ğ½Ğ¾ÑÑ‚Ğ¸
 */
void detect_cache_sizes() {
    printf("Ğ Ğ°Ğ·Ğ¼ĞµÑ€ Ğ¼Ğ°ÑÑĞ¸Ğ²Ğ°\tĞ›Ğ°Ñ‚ĞµĞ½Ñ‚Ğ½Ğ¾ÑÑ‚ÑŒ (Ğ½Ñ)\tĞŸÑ€ĞµĞ´Ğ¿Ğ¾Ğ»Ğ°Ğ³Ğ°ĞµĞ¼Ñ‹Ğ¹ ÑƒÑ€Ğ¾Ğ²ĞµĞ½ÑŒ\n");
    printf("â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n");
    
    for (size_t size = 1*KB; size <= 64*MB; size *= 2) {
        double latency = measure_latency(size, 1000000);
        
        const char* level = "Unknown";
        if (latency < 2.0) level = "L1 Cache";
        else if (latency < 8.0) level = "L2 Cache";
        else if (latency < 25.0) level = "L3 Cache";
        else level = "Main Memory";
        
        printf("%8zu KB\t%10.2f ns\t%s\n", 
               size/KB, latency, level);
    }
}

int main() {
    detect_cache_sizes();
    return 0;
}
```

**ĞĞ¶Ğ¸Ğ´Ğ°ĞµĞ¼Ñ‹Ğµ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹:**
```
Ğ Ğ°Ğ·Ğ¼ĞµÑ€ Ğ¼Ğ°ÑÑĞ¸Ğ²Ğ°    Ğ›Ğ°Ñ‚ĞµĞ½Ñ‚Ğ½Ğ¾ÑÑ‚ÑŒ (Ğ½Ñ)    ĞŸÑ€ĞµĞ´Ğ¿Ğ¾Ğ»Ğ°Ğ³Ğ°ĞµĞ¼Ñ‹Ğ¹ ÑƒÑ€Ğ¾Ğ²ĞµĞ½ÑŒ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       4 KB              1.2 ns       L1 Cache
       8 KB              1.3 ns       L1 Cache
      16 KB              1.5 ns       L1 Cache
      32 KB              1.8 ns       L1 Cache
      64 KB              4.5 ns       L2 Cache
     128 KB              5.2 ns       L2 Cache
     256 KB              6.1 ns       L2 Cache
     512 KB              7.8 ns       L2 Cache
       1 MB             18.5 ns       L3 Cache
       2 MB             19.2 ns       L3 Cache
       4 MB             20.1 ns       L3 Cache
       8 MB             22.5 ns       L3 Cache
      16 MB            120.0 ns       Main Memory
      32 MB            125.0 ns       Main Memory
```

### Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ 2: ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ ÑƒĞ¼Ğ½Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ Ğ¼Ğ°Ñ‚Ñ€Ğ¸Ñ†

**Ğ¦ĞµĞ»ÑŒ:** Ğ ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¸ ÑÑ€Ğ°Ğ²Ğ½Ğ¸Ñ‚ÑŒ Ñ€Ğ°Ğ·Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ğµ Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼Ñ‹ Ğ¼Ğ°Ñ‚Ñ€Ğ¸Ñ‡Ğ½Ğ¾Ğ³Ğ¾ ÑƒĞ¼Ğ½Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ

```c
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>

#define MATRIX_SIZE 1024

typedef double matrix_t[MATRIX_SIZE][MATRIX_SIZE];

/**
 * Ğ¡Ñ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ½Ğ¾Ğµ ÑƒĞ¼Ğ½Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ Ğ¼Ğ°Ñ‚Ñ€Ğ¸Ñ† (ijk)
 */
void multiply_standard(matrix_t A, matrix_t B, matrix_t C) {
    for (int i = 0; i < MATRIX_SIZE; i++) {
        for (int j = 0; j < MATRIX_SIZE; j++) {
            C[i][j] = 0.0;
            for (int k = 0; k < MATRIX_SIZE; k++) {
                C[i][j] += A[i][k] * B[k][j];
            }
        }
    }
}

/**
 * Ğ‘Ğ»Ğ¾Ñ‡Ğ½Ğ¾Ğµ ÑƒĞ¼Ğ½Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ Ğ¼Ğ°Ñ‚Ñ€Ğ¸Ñ†
 */
void multiply_blocked(matrix_t A, matrix_t B, matrix_t C, int block_size) {
    // TODO: Ğ ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ±Ğ»Ğ¾Ñ‡Ğ½Ñ‹Ğ¹ Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼
    // 1. Ğ Ğ°Ğ·Ğ±Ğ¸Ñ‚ÑŒ Ğ¼Ğ°Ñ‚Ñ€Ğ¸Ñ†Ñ‹ Ğ½Ğ° Ğ±Ğ»Ğ¾ĞºĞ¸ Ñ€Ğ°Ğ·Ğ¼ĞµÑ€Ğ¾Ğ¼ block_size
    // 2. Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ÑŒ ÑƒĞ¼Ğ½Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ Ğ±Ğ»Ğ¾ĞºĞ¾Ğ²
    // 3. Ğ’Ğ½ÑƒÑ‚Ñ€Ğ¸ Ğ±Ğ»Ğ¾ĞºĞ¾Ğ² Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ½Ñ‹Ğ¹ Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼
    
    memset(C, 0, sizeof(matrix_t));
    
    for (int ii = 0; ii < MATRIX_SIZE; ii += block_size) {
        for (int jj = 0; jj < MATRIX_SIZE; jj += block_size) {
            for (int kk = 0; kk < MATRIX_SIZE; kk += block_size) {
                // Ğ£Ğ¼Ğ½Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ Ğ±Ğ»Ğ¾ĞºĞ¾Ğ²
                for (int i = ii; i < ii + block_size && i < MATRIX_SIZE; i++) {
                    for (int j = jj; j < jj + block_size && j < MATRIX_SIZE; j++) {
                        for (int k = kk; k < kk + block_size && k < MATRIX_SIZE; k++) {
                            C[i][j] += A[i][k] * B[k][j];
                        }
                    }
                }
            }
        }
    }
}

/**
 * Ğ¢Ñ€Ğ°Ğ½ÑĞ¿Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğµ ÑƒĞ¼Ğ½Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ (Ğ´Ğ»Ñ Ğ»ÑƒÑ‡ÑˆĞµĞ³Ğ¾ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ° Ğº B)
 */
void multiply_transposed(matrix_t A, matrix_t B, matrix_t C) {
    // TODO: Ğ ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼ Ñ Ñ‚Ñ€Ğ°Ğ½ÑĞ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸ĞµĞ¹ Ğ¼Ğ°Ñ‚Ñ€Ğ¸Ñ†Ñ‹ B
    // 1. Ğ¢Ñ€Ğ°Ğ½ÑĞ¿Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¼Ğ°Ñ‚Ñ€Ğ¸Ñ†Ñƒ B
    // 2. Ğ˜Ğ·Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ Ğ¿Ğ¾Ñ€ÑĞ´Ğ¾Ğº Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ° Ğ´Ğ»Ñ Ğ»ÑƒÑ‡ÑˆĞµĞ¹ Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸
    
    // Ğ’Ğ°Ñˆ ĞºĞ¾Ğ´ Ğ·Ğ´ĞµÑÑŒ...
}

/**
 * Ğ‘ĞµĞ½Ñ‡Ğ¼Ğ°Ñ€Ğº Ñ€Ğ°Ğ·Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ñ… Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼Ğ¾Ğ²
 */
void benchmark_algorithms() {
    matrix_t *A = malloc(sizeof(matrix_t));
    matrix_t *B = malloc(sizeof(matrix_t));
    matrix_t *C = malloc(sizeof(matrix_t));
    
    // Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¼Ğ°Ñ‚Ñ€Ğ¸Ñ†
    for (int i = 0; i < MATRIX_SIZE; i++) {
        for (int j = 0; j < MATRIX_SIZE; j++) {
            (*A)[i][j] = (double)rand() / RAND_MAX;
            (*B)[i][j] = (double)rand() / RAND_MAX;
        }
    }
    
    printf("ĞĞ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼\t\tĞ’Ñ€ĞµĞ¼Ñ (ÑĞµĞº)\tGFLOPS\tĞ£ÑĞºĞ¾Ñ€ĞµĞ½Ğ¸Ğµ\n");
    printf("â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n");
    
    // Ğ¡Ñ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ½Ñ‹Ğ¹ Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼
    clock_t start = clock();
    multiply_standard(*A, *B, *C);
    clock_t end = clock();
    double time_standard = (double)(end - start) / CLOCKS_PER_SEC;
    double gflops_standard = (2.0 * MATRIX_SIZE * MATRIX_SIZE * MATRIX_SIZE) / (time_standard * 1e9);
    
    printf("Ğ¡Ñ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ½Ñ‹Ğ¹\t%.3f\t\t%.2f\t1.00x\n", time_standard, gflops_standard);
    
    // Ğ‘Ğ»Ğ¾Ñ‡Ğ½Ñ‹Ğµ Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼Ñ‹ Ñ Ñ€Ğ°Ğ·Ğ½Ñ‹Ğ¼Ğ¸ Ñ€Ğ°Ğ·Ğ¼ĞµÑ€Ğ°Ğ¼Ğ¸ Ğ±Ğ»Ğ¾ĞºĞ¾Ğ²
    int block_sizes[] = {32, 64, 128, 256};
    for (int i = 0; i < 4; i++) {
        start = clock();
        multiply_blocked(*A, *B, *C, block_sizes[i]);
        end = clock();
        double time_blocked = (double)(end - start) / CLOCKS_PER_SEC;
        double gflops_blocked = (2.0 * MATRIX_SIZE * MATRIX_SIZE * MATRIX_SIZE) / (time_blocked * 1e9);
        double speedup = time_standard / time_blocked;
        
        printf("Ğ‘Ğ»Ğ¾Ñ‡Ğ½Ñ‹Ğ¹ %d\t\t%.3f\t\t%.2f\t%.2fx\n", 
               block_sizes[i], time_blocked, gflops_blocked, speedup);
    }
    
    free(A);
    free(B);
    free(C);
}
```

**ĞšÑ€Ğ¸Ñ‚ĞµÑ€Ğ¸Ğ¸ Ğ¾Ñ†ĞµĞ½ĞºĞ¸:**
- âœ… ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ°Ñ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ²ÑĞµÑ… Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼Ğ¾Ğ²
- âœ… Ğ˜Ğ·Ğ¼ĞµÑ€ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸ Ğ² GFLOPS
- âœ… ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ğ²Ğ»Ğ¸ÑĞ½Ğ¸Ñ Ñ€Ğ°Ğ·Ğ¼ĞµÑ€Ğ° Ğ±Ğ»Ğ¾ĞºĞ°
- âœ… ĞĞ±ÑŠÑÑĞ½ĞµĞ½Ğ¸Ğµ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ¾Ğ² Ñ Ñ‚Ğ¾Ñ‡ĞºĞ¸ Ğ·Ñ€ĞµĞ½Ğ¸Ñ ĞºÑÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ

### Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ 3: Ğ˜ÑÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ False Sharing

**Ğ¦ĞµĞ»ÑŒ:** ĞŸÑ€Ğ¾Ğ´ĞµĞ¼Ğ¾Ğ½ÑÑ‚Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ²Ğ»Ğ¸ÑĞ½Ğ¸Ğµ false sharing Ğ¸ ÑĞ¿Ğ¾ÑĞ¾Ğ±Ñ‹ ĞµĞ³Ğ¾ ÑƒÑÑ‚Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ñ

```c
#include <pthread.h>
#include <stdio.h>
#include <stdlib.h>
#include <time.h>
#include <unistd.h>

#define NUM_THREADS 4
#define ITERATIONS 10000000
#define CACHE_LINE_SIZE 64

// ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ½Ñ‹Ğ¹ Ğ²Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚ - false sharing
struct bad_counters {
    volatile long counter[NUM_THREADS];
};

// Ğ¥Ğ¾Ñ€Ğ¾ÑˆĞ¸Ğ¹ Ğ²Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚ - padding
struct good_counters {
    volatile long counter;
    char padding[CACHE_LINE_SIZE - sizeof(long)];
};

// Ğ“Ğ»Ğ¾Ğ±Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ Ğ¿ĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ Ğ´Ğ»Ñ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
struct bad_counters bad_data;
struct good_counters good_data[NUM_THREADS];

/**
 * Ğ’Ğ¾Ñ€ĞºĞµÑ€ Ğ´Ğ»Ñ false sharing Ñ‚ĞµÑÑ‚Ğ°
 */
void* worker_bad(void* arg) {
    int thread_id = *(int*)arg;
    
    for (int i = 0; i < ITERATIONS; i++) {
        bad_data.counter[thread_id]++;
    }
    
    return NULL;
}

/**
 * Ğ’Ğ¾Ñ€ĞºĞµÑ€ Ğ´Ğ»Ñ Ñ‚ĞµÑÑ‚Ğ° Ğ±ĞµĞ· false sharing
 */
void* worker_good(void* arg) {
    int thread_id = *(int*)arg;
    
    for (int i = 0; i < ITERATIONS; i++) {
        good_data[thread_id].counter++;
    }
    
    return NULL;
}

/**
 * Ğ‘ĞµĞ½Ñ‡Ğ¼Ğ°Ñ€Ğº false sharing
 */
void benchmark_false_sharing() {
    pthread_t threads[NUM_THREADS];
    int thread_ids[NUM_THREADS];
    struct timespec start, end;
    
    printf("False Sharing Benchmark\n");
    printf("Threads: %d, Iterations per thread: %d\n\n", NUM_THREADS, ITERATIONS);
    
    // Ğ¢ĞµÑÑ‚ Ñ false sharing
    for (int i = 0; i < NUM_THREADS; i++) {
        bad_data.counter[i] = 0;
        thread_ids[i] = i;
    }
    
    clock_gettime(CLOCK_MONOTONIC, &start);
    
    for (int i = 0; i < NUM_THREADS; i++) {
        pthread_create(&threads[i], NULL, worker_bad, &thread_ids[i]);
    }
    
    for (int i = 0; i < NUM_THREADS; i++) {
        pthread_join(threads[i], NULL);
    }
    
    clock_gettime(CLOCK_MONOTONIC, &end);
    double time_bad = (end.tv_sec - start.tv_sec) + 
                      (end.tv_nsec - start.tv_nsec) / 1e9;
    
    // Ğ¢ĞµÑÑ‚ Ğ±ĞµĞ· false sharing
    for (int i = 0; i < NUM_THREADS; i++) {
        good_data[i].counter = 0;
    }
    
    clock_gettime(CLOCK_MONOTONIC, &start);
    
    for (int i = 0; i < NUM_THREADS; i++) {
        pthread_create(&threads[i], NULL, worker_good, &thread_ids[i]);
    }
    
    for (int i = 0; i < NUM_THREADS; i++) {
        pthread_join(threads[i], NULL);
    }
    
    clock_gettime(CLOCK_MONOTONIC, &end);
    double time_good = (end.tv_sec - start.tv_sec) + 
                       (end.tv_nsec - start.tv_nsec) / 1e9;
    
    // Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹
    printf("Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹:\n");
    printf("Ğ¡ false sharing:    %.3f ÑĞµĞº\n", time_bad);
    printf("Ğ‘ĞµĞ· false sharing:  %.3f ÑĞµĞº\n", time_good);
    printf("Ğ—Ğ°Ğ¼ĞµĞ´Ğ»ĞµĞ½Ğ¸Ğµ:         %.2fx\n", time_bad / time_good);
    
    // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ğ¾ÑÑ‚Ğ¸
    long total_bad = 0, total_good = 0;
    for (int i = 0; i < NUM_THREADS; i++) {
        total_bad += bad_data.counter[i];
        total_good += good_data[i].counter;
    }
    printf("\nĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ğ¾ÑÑ‚Ğ¸:\n");
    printf("Ğ¡ÑƒĞ¼Ğ¼Ğ° (false sharing): %ld\n", total_bad);
    printf("Ğ¡ÑƒĞ¼Ğ¼Ğ° (Ğ±ĞµĞ· false sharing): %ld\n", total_good);
    printf("ĞĞ¶Ğ¸Ğ´Ğ°ĞµĞ¼Ğ°Ñ ÑÑƒĞ¼Ğ¼Ğ°: %ld\n", (long)NUM_THREADS * ITERATIONS);
}

int main() {
    benchmark_false_sharing();
    return 0;
}
```

### Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ 4: ĞŸÑ€Ğ¾Ñ„Ğ°Ğ¹Ğ»ĞµÑ€ cache miss'Ğ¾Ğ²

**Ğ¦ĞµĞ»ÑŒ:** Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚ Ğ´Ğ»Ñ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ° cache miss'Ğ¾Ğ²

```bash
#!/bin/bash
# cache_profiler.sh - ÑĞºÑ€Ğ¸Ğ¿Ñ‚ Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ ĞºÑÑˆĞ°

if [ $# -eq 0 ]; then
    echo "Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ: $0 <Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ°> [Ğ°Ñ€Ğ³ÑƒĞ¼ĞµĞ½Ñ‚Ñ‹]"
    exit 1
fi

PROGRAM="$1"
shift
ARGS="$@"

echo "ĞŸÑ€Ğ¾Ñ„Ğ¸Ğ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ ĞºÑÑˆĞ° Ğ´Ğ»Ñ: $PROGRAM $ARGS"
echo "========================================"

# ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ½Ğ°Ğ»Ğ¸Ñ‡Ğ¸Ñ perf
if ! command -v perf &> /dev/null; then
    echo "ĞÑˆĞ¸Ğ±ĞºĞ°: perf Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½. Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚Ğµ linux-tools."
    exit 1
fi

# ĞÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸ ĞºÑÑˆĞ°
echo "1. ĞĞ±Ñ‰Ğ°Ñ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° ĞºÑÑˆĞ°:"
perf stat -e cache-references,cache-misses,L1-dcache-loads,L1-dcache-load-misses,L1-icache-loads,L1-icache-load-misses \
    "$PROGRAM" $ARGS

echo -e "\n2. Ğ”ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ğ°Ñ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° Ğ¿Ğ¾ ÑƒÑ€Ğ¾Ğ²Ğ½ÑĞ¼:"
perf stat -e L1-dcache-loads,L1-dcache-load-misses,L1-dcache-stores,L1-dcache-store-misses,\
L1-icache-loads,L1-icache-load-misses,\
LLC-loads,LLC-load-misses,LLC-stores,LLC-store-misses \
    "$PROGRAM" $ARGS

echo -e "\n3. ĞĞ½Ğ°Ğ»Ğ¸Ğ· TLB (Translation Lookaside Buffer):"
perf stat -e dTLB-loads,dTLB-load-misses,dTLB-stores,dTLB-store-misses,\
iTLB-loads,iTLB-load-misses \
    "$PROGRAM" $ARGS

# Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»Ñ Ğ´Ğ»Ñ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ° hotspots
echo -e "\n4. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»Ñ (perf record)..."
perf record -e cache-misses "$PROGRAM" $ARGS

echo -e "\n5. Ğ¢Ğ¾Ğ¿ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¹ Ğ¿Ğ¾ cache miss'Ğ°Ğ¼:"
perf report --stdio | head -20

# Cleanup
rm -f perf.data
```

**ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ:**
```bash
# ĞšĞ¾Ğ¼Ğ¿Ğ¸Ğ»ÑÑ†Ğ¸Ñ Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ğ¾Ğ¹ Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ñ‹
gcc -O2 -o matrix_mult matrix_mult.c

# ĞŸÑ€Ğ¾Ñ„Ğ¸Ğ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
./cache_profiler.sh ./matrix_mult

# ĞĞ¶Ğ¸Ğ´Ğ°ĞµĞ¼Ñ‹Ğ¹ Ğ²Ñ‹Ğ²Ğ¾Ğ´:
# ========================================
# 1. ĞĞ±Ñ‰Ğ°Ñ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° ĞºÑÑˆĞ°:
#    cache-references:     124,567,890
#    cache-misses:          12,456,789  (10.00%)
#    L1-dcache-loads:      987,654,321
#    L1-dcache-load-misses: 45,678,901  (4.63%)
```

---

## âœ… ĞšĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»ÑŒĞ½Ñ‹Ğµ Ğ²Ğ¾Ğ¿Ñ€Ğ¾ÑÑ‹

### Ğ¢ĞµĞ¾Ñ€ĞµÑ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ²Ğ¾Ğ¿Ñ€Ğ¾ÑÑ‹:

1. **ĞĞ±ÑŠÑÑĞ½Ğ¸Ñ‚Ğµ Ñ€Ğ°Ğ·Ğ½Ğ¸Ñ†Ñƒ Ğ¼ĞµĞ¶Ğ´Ñƒ direct-mapped, set-associative Ğ¸ fully associative ĞºÑÑˆĞ°Ğ¼Ğ¸. ĞšĞ¾Ğ³Ğ´Ğ° ĞºĞ°Ğ¶Ğ´Ñ‹Ğ¹ Ñ‚Ğ¸Ğ¿ Ğ¿Ñ€ĞµĞ´Ğ¿Ğ¾Ñ‡Ñ‚Ğ¸Ñ‚ĞµĞ»ĞµĞ½?**

2. **Ğ§Ñ‚Ğ¾ Ñ‚Ğ°ĞºĞ¾Ğµ Ğ¿Ñ€Ğ¾Ñ‚Ğ¾ĞºĞ¾Ğ» MESI Ğ¸ Ğ·Ğ°Ñ‡ĞµĞ¼ Ğ¾Ğ½ Ğ½ÑƒĞ¶ĞµĞ½? ĞĞ¿Ğ¸ÑˆĞ¸Ñ‚Ğµ Ğ¿ĞµÑ€ĞµÑ…Ğ¾Ğ´Ñ‹ Ğ¼ĞµĞ¶Ğ´Ñƒ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸ÑĞ¼Ğ¸.**

3. **Ğ§Ñ‚Ğ¾ Ñ‚Ğ°ĞºĞ¾Ğµ false sharing Ğ¸ Ğ¿Ğ¾Ñ‡ĞµĞ¼Ñƒ ÑÑ‚Ğ¾ Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ° Ğ´Ğ»Ñ Ğ¼Ğ½Ğ¾Ğ³Ğ¾Ğ¿Ğ¾Ñ‚Ğ¾Ñ‡Ğ½Ñ‹Ñ… Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¹?**

4. **ĞĞ±ÑŠÑÑĞ½Ğ¸Ñ‚Ğµ Ñ€Ğ°Ğ·Ğ½Ğ¸Ñ†Ñƒ Ğ¼ĞµĞ¶Ğ´Ñƒ memory barriers, compiler barriers Ğ¸ acquire/release semantics.**

### ĞŸÑ€Ğ°ĞºÑ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸:

1. **Ğ Ğ°ÑÑ‡ĞµÑ‚ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸ ĞºÑÑˆĞ°:**
   ```
   Ğ”Ğ°Ğ½Ğ¾:
   - L1 cache: 32KB, 8-way, Ğ»Ğ°Ñ‚ĞµĞ½Ñ‚Ğ½Ğ¾ÑÑ‚ÑŒ 1ns
   - L2 cache: 256KB, 8-way, Ğ»Ğ°Ñ‚ĞµĞ½Ñ‚Ğ½Ğ¾ÑÑ‚ÑŒ 5ns  
   - L3 cache: 8MB, 16-way, Ğ»Ğ°Ñ‚ĞµĞ½Ñ‚Ğ½Ğ¾ÑÑ‚ÑŒ 15ns
   - Memory: Ğ»Ğ°Ñ‚ĞµĞ½Ñ‚Ğ½Ğ¾ÑÑ‚ÑŒ 100ns
   - ĞŸÑ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ°: 90% L1 hits, 8% L2 hits, 1.5% L3 hits, 0.5% memory
   
   ĞĞ°Ğ¹Ñ‚Ğ¸ ÑÑ€ĞµĞ´Ğ½ĞµĞµ Ğ²Ñ€ĞµĞ¼Ñ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ° Ğº Ğ´Ğ°Ğ½Ğ½Ñ‹Ğ¼.
   ```

2. **ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼Ğ°:**
   ```c
   // ĞšĞ°ĞºĞ¸Ğµ Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼Ñ‹ Ñ ĞºÑÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸ĞµĞ¼ Ğ² ÑÑ‚Ğ¾Ğ¼ ĞºĞ¾Ğ´Ğµ?
   void process_matrix(int matrix[1000][1000]) {
       for (int j = 0; j < 1000; j++) {
           for (int i = 0; i < 1000; i++) {
               matrix[i][j] = matrix[i][j] * 2;
           }
       }
   }
   
   // ĞšĞ°Ğº ĞµĞ³Ğ¾ Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ?
   ```

3. **Ğ Ğ°Ğ·Ğ¼ĞµÑ€ Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ Ğ±Ğ»Ğ¾ĞºĞ°:**
   ```
   Ğ”Ğ»Ñ Ğ¼Ğ°Ñ‚Ñ€Ğ¸Ñ‡Ğ½Ğ¾Ğ³Ğ¾ ÑƒĞ¼Ğ½Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ Ñ ĞºÑÑˆĞµĞ¼ L1 = 32KB:
   - ĞšĞ°ĞºĞ¾Ğ¹ Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ñ€Ğ°Ğ·Ğ¼ĞµÑ€ Ğ±Ğ»Ğ¾ĞºĞ° Ğ´Ğ»Ñ Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼Ğ° C = A Ã— B?
   - Ğ¡ĞºĞ¾Ğ»ÑŒĞºĞ¾ ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚Ğ¾Ğ² double Ğ¿Ğ¾Ğ¼ĞµÑÑ‚Ğ¸Ñ‚ÑÑ Ğ² Ğ±Ğ»Ğ¾Ğº?
   - ĞĞ±Ğ¾ÑĞ½ÑƒĞ¹Ñ‚Ğµ ÑĞ²Ğ¾Ğ¹ Ñ€Ğ°ÑÑ‡ĞµÑ‚.
   ```

---

## ğŸ“š Ğ”Ğ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğµ Ğ¼Ğ°Ñ‚ĞµÑ€Ğ¸Ğ°Ğ»Ñ‹

### Ğ˜Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ñ‹ Ğ´Ğ»Ñ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ° ĞºÑÑˆĞ°:

**1. Intel VTune Profiler**
- Ğ“Ñ€Ğ°Ñ„Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ Ğ´Ğ»Ñ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ° Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸
- Ğ”ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾ cache miss'Ğ°Ñ…
- Hotspot analysis Ğ¸ bottleneck detection

**2. Linux perf**
```bash
# ĞÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹
perf stat -e cache-misses ./program
perf record -e cache-misses ./program
perf report

# Ğ”ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·
perf mem record ./program
perf mem report
```

**3. Valgrind/Cachegrind**
```bash
# Ğ¡Ğ¸Ğ¼ÑƒĞ»ÑÑ†Ğ¸Ñ ĞºÑÑˆĞ°
valgrind --tool=cachegrind ./program

# ĞĞ½Ğ½Ğ¾Ñ‚Ğ°Ñ†Ğ¸Ñ Ğ¸ÑÑ…Ğ¾Ğ´Ğ½Ğ¾Ğ³Ğ¾ ĞºĞ¾Ğ´Ğ°
cg_annotate cachegrind.out.pid
```

**4. CPU-specific PMU events**
```bash
# Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹Ñ… ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹
perf list cache

# Ğ¡Ğ¿ĞµÑ†Ğ¸Ñ„Ğ¸Ñ‡Ğ½Ñ‹Ğµ Ğ´Ğ»Ñ Intel
perf stat -e cpu/event=0x24,umask=0x21/ ./program
```

### Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµĞ¼Ğ¾Ğµ Ñ‡Ñ‚ĞµĞ½Ğ¸Ğµ:

**ĞšĞ½Ğ¸Ğ³Ğ¸:**
- "Computer Architecture: A Quantitative Approach" - Hennessy & Patterson
- "What Every Programmer Should Know About Memory" - Ulrich Drepper
- "Systems Performance" - Brendan Gregg

**Ğ¡Ñ‚Ğ°Ñ‚ÑŒĞ¸:**
- IntelÂ® 64 and IA-32 Architectures Optimization Reference Manual
- ARM Cortex-A Series Programmer's Guide
- "Cache-Conscious Programming" research papers

**ĞĞ½Ğ»Ğ°Ğ¹Ğ½ Ñ€ĞµÑÑƒÑ€ÑÑ‹:**
- Intel Performance Analysis Guide
- Agner Fog's optimization manuals
- Linux kernel documentation on CPU caches

### Ğ¡Ğ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ Ğ±Ğ»Ğ¾Ğº:
**Ğ‘Ğ»Ğ¾Ğº 3: ĞšÑÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ² Ğ²ĞµĞ±-Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞµ** - Ğ¸Ğ·ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ±Ñ€Ğ°ÑƒĞ·ĞµÑ€Ğ½Ğ¾Ğ³Ğ¾ ĞºÑÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ, CDN, HTTP Ğ·Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²ĞºĞ¾Ğ² Ğ¸ ÑĞµÑ€Ğ²ĞµÑ€Ğ½Ñ‹Ñ… ĞºÑÑˆĞ¸Ñ€ÑƒÑÑ‰Ğ¸Ñ… ÑÑ‚Ñ€Ğ°Ñ‚ĞµĞ³Ğ¸Ğ¹.

---

## ğŸ¯ Ğ§ĞµĞº-Ğ»Ğ¸ÑÑ‚ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¸Ñ Ğ±Ğ»Ğ¾ĞºĞ°

- [ ] ĞŸĞ¾Ğ½Ğ¸Ğ¼Ğ°Ñ Ğ¸ĞµÑ€Ğ°Ñ€Ñ…Ğ¸Ñ Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸ ÑĞ¾Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ñ… ĞºĞ¾Ğ¼Ğ¿ÑŒÑÑ‚ĞµÑ€Ğ¾Ğ²
- [ ] Ğ—Ğ½Ğ°Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ñƒ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ñ€Ğ½Ñ‹Ñ… ĞºÑÑˆĞµĞ¹ (direct-mapped, set-associative, fully associative)
- [ ] Ğ£Ğ¼ĞµÑ Ğ¿Ğ¸ÑĞ°Ñ‚ÑŒ cache-friendly ĞºĞ¾Ğ´
- [ ] ĞŸĞ¾Ğ½Ğ¸Ğ¼Ğ°Ñ Ğ±Ğ»Ğ¾Ñ‡Ğ½Ñ‹Ğµ Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼Ñ‹ Ğ¸ Ğ¸Ñ… Ğ¿Ñ€Ğ¸Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğµ
- [ ] Ğ—Ğ½Ğ°Ñ Ğ¿Ñ€Ğ¸Ğ½Ñ†Ğ¸Ğ¿Ñ‹ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹ prefetching
- [ ] ĞŸĞ¾Ğ½Ğ¸Ğ¼Ğ°Ñ Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼Ñ‹ ĞºĞ¾Ğ³ĞµÑ€ĞµĞ½Ñ‚Ğ½Ğ¾ÑÑ‚Ğ¸ ĞºÑÑˆĞ° Ğ¸ Ğ¿Ñ€Ğ¾Ñ‚Ğ¾ĞºĞ¾Ğ»Ñ‹ MESI/MOESI
- [ ] Ğ£Ğ¼ĞµÑ Ğ¸Ğ·Ğ±ĞµĞ³Ğ°Ñ‚ÑŒ false sharing Ğ² Ğ¼Ğ½Ğ¾Ğ³Ğ¾Ğ¿Ğ¾Ñ‚Ğ¾Ñ‡Ğ½Ğ¾Ğ¼ ĞºĞ¾Ğ´Ğµ
- [ ] Ğ—Ğ½Ğ°Ñ, ĞºĞ¾Ğ³Ğ´Ğ° Ğ¸ ĞºĞ°Ğº Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ memory barriers
- [ ] Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ» Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ñ‹ Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ ĞºÑÑˆĞ°
- [ ] ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ» Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼Ñ‹ Ñ ÑƒÑ‡ĞµÑ‚Ğ¾Ğ¼ Ğ°Ğ¿Ğ¿Ğ°Ñ€Ğ°Ñ‚Ğ½Ğ¾Ğ³Ğ¾ ĞºÑÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ

**ĞÑ‚Ğ»Ğ¸Ñ‡Ğ½Ğ¾! Ğ¢ĞµĞ¿ĞµÑ€ÑŒ Ğ²Ñ‹ Ğ¿Ğ¾Ğ½Ğ¸Ğ¼Ğ°ĞµÑ‚Ğµ Ğ°Ğ¿Ğ¿Ğ°Ñ€Ğ°Ñ‚Ğ½Ğ¾Ğµ ĞºÑÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ½Ğ° ÑĞºÑĞ¿ĞµÑ€Ñ‚Ğ½Ğ¾Ğ¼ ÑƒÑ€Ğ¾Ğ²Ğ½Ğµ! ğŸš€**
```

#### L1 ĞºÑÑˆ (Level 1)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      L1 ĞšĞ­Ğ¨Ğ«                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚ ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° Ñ€Ğ°Ğ·Ğ´ĞµĞ»ĞµĞ½Ğ¸Ñ:                                 â”‚
â”‚                                                         â”‚
â”‚   CPU Core                                              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚ â”‚
â”‚ â”‚ â”‚   L1i       â”‚    â”‚    L1d      â”‚                  â”‚ â”‚
â”‚ â”‚ â”‚(Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ğ¸Ğ¸) â”‚    â”‚  (Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ)   â”‚                  â”‚ â”‚
â”‚ â”‚ â”‚   32 KB     â”‚    â”‚   32 KB     â”‚                  â”‚ â”‚
â”‚ â”‚ â”‚   4-way     â”‚    â”‚   8-way     â”‚                  â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚ â”‚
â”‚ â”‚           â”‚              â”‚                          â”‚ â”‚
â”‚ â”‚           â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚ â”‚
â”‚ â”‚                  â”‚                                  â”‚ â”‚
â”‚ â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚ â”‚
â”‚ â”‚            â”‚  L2 Cache   â”‚                          â”‚ â”‚
â”‚ â”‚            â”‚   256 KB    â”‚                          â”‚ â”‚
â”‚ â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                         â”‚
â”‚ Ğ¥Ğ°Ñ€Ğ°ĞºÑ‚ĞµÑ€Ğ¸ÑÑ‚Ğ¸ĞºĞ¸ L1:                                      â”‚
â”‚ â€¢ Ğ Ğ°Ğ·Ğ¼ĞµÑ€: 32-64 KB ĞºĞ°Ğ¶Ğ´Ñ‹Ğ¹                               â”‚
â”‚ â€¢ Ğ›Ğ°Ñ‚ĞµĞ½Ñ‚Ğ½Ğ¾ÑÑ‚ÑŒ: 1-2 Ñ‚Ğ°ĞºÑ‚Ğ° (~1ns)                        â”‚
â”‚ â€¢ ĞÑÑĞ¾Ñ†Ğ¸Ğ°Ñ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ: 4-8 way                             â”‚
â”‚ â€¢ Ğ Ğ°Ğ·Ğ¼ĞµÑ€ ÑÑ‚Ñ€Ğ¾ĞºĞ¸: 64 Ğ±Ğ°Ğ¹Ñ‚Ğ°                               â”‚
â”‚ â€¢ Write policy: Ğ¾Ğ±Ñ‹Ñ‡Ğ½Ğ¾ write-through Ğ² L2              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### L2 Ğ¸ L3 ĞºÑÑˆĞ¸
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   L2 Ğ¸ L3 ĞšĞ­Ğ¨Ğ˜                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚ ĞœĞ½Ğ¾Ğ³Ğ¾ÑĞ´ĞµÑ€Ğ½Ğ°Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°:                               â”‚
â”‚                                                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚ â”‚ Core 0  â”‚ â”‚ Core 1  â”‚ â”‚ Core 2  â”‚ â”‚ Core 3  â”‚         â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â” â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â” â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â” â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â” â”‚         â”‚
â”‚ â”‚ â”‚ L1  â”‚ â”‚ â”‚ â”‚ L1  â”‚ â”‚ â”‚ â”‚ L1  â”‚ â”‚ â”‚ â”‚ L1  â”‚ â”‚         â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”˜ â”‚         â”‚
â”‚ â”‚    â”‚    â”‚ â”‚    â”‚    â”‚ â”‚    â”‚    â”‚ â”‚    â”‚    â”‚         â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â” â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â” â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â” â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â” â”‚         â”‚
â”‚ â”‚ â”‚ L2  â”‚ â”‚ â”‚ â”‚ L2  â”‚ â”‚ â”‚ â”‚ L2  â”‚ â”‚ â”‚ â”‚ L2  â”‚ â”‚         â”‚
â”‚ â”‚ â”‚256KBâ”‚ â”‚ â”‚ â”‚256KBâ”‚ â”‚ â”‚ â”‚256KBâ”‚ â”‚ â”‚ â”‚256KBâ”‚ â”‚         â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”˜ â”‚         â”‚
â”‚ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜         â”‚
â”‚      â”‚           â”‚           â”‚           â”‚              â”‚
â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                  â”‚           â”‚                          â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚              â”‚      L3 Cache       â”‚                     â”‚
â”‚              â”‚      16-32 MB       â”‚                     â”‚
â”‚              â”‚    16-20 way        â”‚                     â”‚
â”‚              â”‚   (Ñ€Ğ°Ğ·Ğ´ĞµĞ»ÑĞµĞ¼Ñ‹Ğ¹)     â”‚                     â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                         â”‚                               â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚              â”‚    Main Memory      â”‚                     â”‚
â”‚              â”‚      8-128 GB       â”‚                     â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                                                         â”‚
â”‚ L2 Ñ…Ğ°Ñ€Ğ°ĞºÑ‚ĞµÑ€Ğ¸ÑÑ‚Ğ¸ĞºĞ¸:                                      â”‚
â”‚ â€¢ Ğ Ğ°Ğ·Ğ¼ĞµÑ€: 256KB - 1MB                                   â”‚
â”‚ â€¢ Ğ›Ğ°Ñ‚ĞµĞ½Ñ‚Ğ½Ğ¾ÑÑ‚ÑŒ: 3-5 Ğ½Ñ (~10-15 Ñ‚Ğ°ĞºÑ‚Ğ¾Ğ²)                  â”‚
â”‚ â€¢ ĞĞ±ÑŠĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ½Ñ‹Ğ¹ (Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ + Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ğ¸Ğ¸)                    â”‚
â”‚                                                         â”‚
â”‚ L3 Ñ…Ğ°Ñ€Ğ°ĞºÑ‚ĞµÑ€Ğ¸ÑÑ‚Ğ¸ĞºĞ¸:                                      â”‚
â”‚ â€¢ Ğ Ğ°Ğ·Ğ¼ĞµÑ€: 8-32 MB                                       â”‚
â”‚ â€¢ Ğ›Ğ°Ñ‚ĞµĞ½Ñ‚Ğ½Ğ¾ÑÑ‚ÑŒ: 10-20 Ğ½Ñ (~30-60 Ñ‚Ğ°ĞºÑ‚Ğ¾Ğ²)                â”‚
â”‚ â€¢ Ğ Ğ°Ğ·Ğ´ĞµĞ»ÑĞµÑ‚ÑÑ Ğ¼ĞµĞ¶Ğ´Ñƒ Ğ²ÑĞµĞ¼Ğ¸ ÑĞ´Ñ€Ğ°Ğ¼Ğ¸                        â”‚
â”‚ â€¢ Inclusive Ğ¸Ğ»Ğ¸ Non-inclusive                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ĞŸÑ€Ğ¸Ğ½Ñ†Ğ¸Ğ¿Ñ‹ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹ Ğ¸ĞµÑ€Ğ°Ñ€Ñ…Ğ¸Ğ¸

#### ĞŸÑ€Ğ¸Ğ½Ñ†Ğ¸Ğ¿ Ğ²ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ (Inclusion)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                ĞŸĞĞ›Ğ˜Ğ¢Ğ˜ĞšĞ˜ Ğ’ĞšĞ›Ğ®Ğ§Ğ•ĞĞ˜Ğ¯                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚ 1. INCLUSIVE HIERARCHY (Ğ²ĞºĞ»ÑÑ‡Ğ°ÑÑ‰Ğ°Ñ)                     â”‚
â”‚    L3 âŠƒ L2 âŠƒ L1                                        â”‚
â”‚                                                         â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚    â”‚              L3 Cache                           â”‚   â”‚
â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚    â”‚ â”‚            L2 Cache                         â”‚ â”‚   â”‚
â”‚    â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚   â”‚
â”‚    â”‚ â”‚ â”‚          L1 Cache                       â”‚ â”‚ â”‚   â”‚
â”‚    â”‚ â”‚ â”‚ [A] [B] [C] [D]                         â”‚ â”‚ â”‚   â”‚
â”‚    â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚   â”‚
â”‚    â”‚ â”‚ [A] [B] [C] [D] [E] [F] [G] [H]             â”‚ â”‚   â”‚
â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚    â”‚ [A] [B] [C] [D] [E] [F] [G] [H] ... [P]         â”‚   â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                         â”‚
â”‚ 2. NON-INCLUSIVE HIERARCHY (Ğ¸ÑĞºĞ»ÑÑ‡Ğ°ÑÑ‰Ğ°Ñ)                â”‚
â”‚    L1 âˆ© L2 âˆ© L3 = âˆ… (Ğ½ĞµÑ‚ Ğ´ÑƒĞ±Ğ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ)                â”‚
â”‚                                                         â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚    â”‚ L3: [I] [J] [K] [L] [M] [N] [O] [P]             â”‚   â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚    â”‚ L2: [E] [F] [G] [H]                             â”‚   â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚    â”‚ L1: [A] [B] [C] [D]                             â”‚   â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                         â”‚
â”‚ 3. VICTIM CACHE (ĞºÑÑˆ Ğ¶ĞµÑ€Ñ‚Ğ²)                             â”‚
â”‚    Ğ¡Ğ¿ĞµÑ†Ğ¸Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ±ÑƒÑ„ĞµÑ€ Ğ´Ğ»Ñ Ğ½ĞµĞ´Ğ°Ğ²Ğ½Ğ¾ Ğ²Ñ‹Ñ‚ĞµÑĞ½ĞµĞ½Ğ½Ñ‹Ñ… Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…     â”‚
â”‚                                                         â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚    â”‚ Main Cache: [A] [B] [C] [D]                     â”‚   â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚             â†“ (Ğ²Ñ‹Ñ‚ĞµÑĞ½ĞµĞ½Ğ¸Ğµ)                              â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚    â”‚ Victim Cache: [E] [F]                           â”‚   â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—ï¸ Ğ“Ğ»Ğ°Ğ²Ğ° 2: ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ñ€Ğ½Ñ‹Ñ… ĞºÑÑˆĞµĞ¹

### ĞÑ€Ğ³Ğ°Ğ½Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ ĞºÑÑˆ-Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸

#### ĞŸÑ€ÑĞ¼Ğ¾Ğµ Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ (Direct-Mapped)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               DIRECT-MAPPED CACHE                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚ 32-Ğ±Ğ¸Ñ‚Ğ½Ñ‹Ğ¹ Ğ°Ğ´Ñ€ĞµÑ Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸:                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚ â”‚ Tag (18)    â”‚ Index (8)   â”‚ Offset (6)  â”‚             â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚  Ğ±Ğ¸Ñ‚Ñ‹ 31-14    Ğ±Ğ¸Ñ‚Ñ‹ 13-6     Ğ±Ğ¸Ñ‚Ñ‹ 5-0                   â”‚
â”‚                                                         â”‚
â”‚ Index Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ÑĞµÑ‚ ÑÑ‚Ñ€Ğ¾ĞºÑƒ ĞºÑÑˆĞ°:                           â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚Indexâ”‚   Valid     â”‚        Tag        â”‚    Data     â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚ 0   â”‚     1       â”‚    0x12345        â”‚ [64 bytes]  â”‚ â”‚
â”‚ â”‚ 1   â”‚     0       â”‚    0x00000        â”‚ [64 bytes]  â”‚ â”‚
â”‚ â”‚ 2   â”‚     1       â”‚    0xABCDE        â”‚ [64 bytes]  â”‚ â”‚
â”‚ â”‚ ... â”‚    ...      â”‚     ...           â”‚    ...      â”‚ â”‚
â”‚ â”‚255  â”‚     1       â”‚    0x67890        â”‚ [64 bytes]  â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                         â”‚
â”‚ ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ğ¿Ğ¾Ğ¸ÑĞºĞ° Ğ°Ğ´Ñ€ĞµÑĞ° 0x12345180:                        â”‚
â”‚ â€¢ Tag = 0x12345                                         â”‚
â”‚ â€¢ Index = 0x06 (ÑÑ‚Ñ€Ğ¾ĞºĞ° 6)                              â”‚
â”‚ â€¢ Offset = 0x00 (Ğ±Ğ°Ğ¹Ñ‚ 0 Ğ² ÑÑ‚Ñ€Ğ¾ĞºĞµ)                      â”‚
â”‚                                                         â”‚
â”‚ ĞŸÑ€ĞµĞ¸Ğ¼ÑƒÑ‰ĞµÑÑ‚Ğ²Ğ°:                                           â”‚
â”‚ âœ“ ĞŸÑ€Ğ¾ÑÑ‚Ğ°Ñ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ                                    â”‚
â”‚ âœ“ Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ Ğ¿Ğ¾Ğ¸ÑĞº                                         â”‚
â”‚ âœ“ ĞĞ¸Ğ·ĞºĞ¸Ğµ Ğ°Ğ¿Ğ¿Ğ°Ñ€Ğ°Ñ‚Ğ½Ñ‹Ğµ Ğ·Ğ°Ñ‚Ñ€Ğ°Ñ‚Ñ‹                             â”‚
â”‚                                                         â”‚
â”‚ ĞĞµĞ´Ğ¾ÑÑ‚Ğ°Ñ‚ĞºĞ¸:                                             â”‚
â”‚ âœ— ĞšĞ¾Ğ½Ñ„Ğ»Ğ¸ĞºÑ‚Ñ‹ Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ                                 â”‚
â”‚ âœ— ĞŸĞ»Ğ¾Ñ…Ğ°Ñ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ Ğ¿Ñ€Ğ¸ ĞºĞ¾Ğ½Ñ„Ğ»Ğ¸ĞºÑ‚Ğ°Ñ… Ğ°Ğ´Ñ€ĞµÑĞ¾Ğ²     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ĞœĞ½Ğ¾Ğ¶ĞµÑÑ‚Ğ²ĞµĞ½Ğ½Ğ¾-Ğ°ÑÑĞ¾Ñ†Ğ¸Ğ°Ñ‚Ğ¸Ğ²Ğ½Ñ‹Ğµ ĞºÑÑˆĞ¸
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              N-WAY SET-ASSOCIATIVE CACHE                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚ 4-way Set-Associative (Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€):                         â”‚
â”‚                                                         â”‚
â”‚ 32-Ğ±Ğ¸Ñ‚Ğ½Ñ‹Ğ¹ Ğ°Ğ´Ñ€ĞµÑ:                                        â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚ â”‚ Tag (20)    â”‚ Set (6)     â”‚ Offset (6)  â”‚             â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                         â”‚
â”‚ Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° ĞºÑÑˆĞ°:                                         â”‚
â”‚                Way 0    Way 1    Way 2    Way 3         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚Set 0â”‚Vâ”‚Tagâ”‚Data  â”‚Vâ”‚Tagâ”‚Data  â”‚Vâ”‚Tagâ”‚Data  â”‚Vâ”‚..â”‚  â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚Set 1â”‚1â”‚0x1â”‚[64B] â”‚0â”‚0x0â”‚[64B] â”‚1â”‚0x5â”‚[64B] â”‚1â”‚..â”‚  â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚Set 2â”‚1â”‚0x2â”‚[64B] â”‚1â”‚0x3â”‚[64B] â”‚0â”‚0x0â”‚[64B] â”‚1â”‚..â”‚  â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚ ... â”‚ ... â”‚ ...  â”‚ ... â”‚ ...  â”‚ ... â”‚ ...  â”‚ ..â”‚..â”‚  â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚Set63â”‚1â”‚0xFâ”‚[64B] â”‚1â”‚0xAâ”‚[64B] â”‚1â”‚0xBâ”‚[64B] â”‚0â”‚..â”‚  â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                         â”‚
â”‚ ĞŸÑ€Ğ¾Ñ†ĞµÑÑ Ğ¿Ğ¾Ğ¸ÑĞºĞ°:                                         â”‚
â”‚ 1. Set index â†’ Ğ²Ñ‹Ğ±Ğ¾Ñ€ ÑÑ‚Ñ€Ğ¾ĞºĞ¸ (Set)                      â”‚
â”‚ 2. ĞŸĞ°Ñ€Ğ°Ğ»Ğ»ĞµĞ»ÑŒĞ½Ğ¾Ğµ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ Ñ‚ĞµĞ³Ğ¾Ğ² Ğ²Ğ¾ Ğ²ÑĞµÑ… Ways            â”‚
â”‚ 3. Ğ’Ñ‹Ğ±Ğ¾Ñ€ Ğ¿Ğ¾Ğ´Ñ…Ğ¾Ğ´ÑÑ‰ĞµĞ³Ğ¾ Way (ĞµÑĞ»Ğ¸ ĞµÑÑ‚ÑŒ ÑĞ¾Ğ²Ğ¿Ğ°Ğ´ĞµĞ½Ğ¸Ğµ)        â”‚
â”‚ 4. Ğ˜Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ¿Ğ¾ offset                          â”‚
â”‚                                                         â”‚
â”‚ ĞŸÑ€ĞµĞ¸Ğ¼ÑƒÑ‰ĞµÑÑ‚Ğ²Ğ° Ğ¿Ğ¾ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ Ñ Direct-Mapped:              â”‚
â”‚ âœ“ ĞœĞµĞ½ÑŒÑˆĞµ ĞºĞ¾Ğ½Ñ„Ğ»Ğ¸ĞºÑ‚Ğ¾Ğ² Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ                         â”‚
â”‚ âœ“ Ğ›ÑƒÑ‡ÑˆĞ¸Ğ¹ hit rate                                       â”‚
â”‚ âœ“ Ğ‘Ğ¾Ğ»ĞµĞµ Ğ³Ğ¸Ğ±ĞºĞ¾Ğµ Ñ€Ğ°Ğ·Ğ¼ĞµÑ‰ĞµĞ½Ğ¸Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…                        â”‚
â”‚                                                         â”‚
â”‚ ĞĞµĞ´Ğ¾ÑÑ‚Ğ°Ñ‚ĞºĞ¸:                                             â”‚
â”‚ âœ— Ğ¡Ğ»Ğ¾Ğ¶Ğ½ĞµĞµ Ğ°Ğ¿Ğ¿Ğ°Ñ€Ğ°Ñ‚ÑƒÑ€Ğ°                                    â”‚
â”‚ âœ— Ğ‘Ğ¾Ğ»ÑŒÑˆĞµ ÑĞ½ĞµÑ€Ğ³Ğ¾Ğ¿Ğ¾Ñ‚Ñ€ĞµĞ±Ğ»ĞµĞ½Ğ¸Ğµ                              â”‚
â”‚ âœ— ĞÑƒĞ¶ĞµĞ½ Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼ Ğ·Ğ°Ğ¼ĞµÑ‰ĞµĞ½Ğ¸Ñ                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ĞŸĞ¾Ğ»Ğ½Ğ¾ÑÑ‚ÑŒÑ Ğ°ÑÑĞ¾Ñ†Ğ¸Ğ°Ñ‚Ğ¸Ğ²Ğ½Ñ‹Ğµ ĞºÑÑˆĞ¸
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              FULLY ASSOCIATIVE CACHE                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚ 32-Ğ±Ğ¸Ñ‚Ğ½Ñ‹Ğ¹ Ğ°Ğ´Ñ€ĞµÑ:                                        â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚ â”‚      Tag (26)           â”‚ Offset (6)  â”‚               â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                         â”‚
â”‚ Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° ĞºÑÑˆĞ° (Ğ»ÑĞ±Ğ°Ñ ÑÑ‚Ñ€Ğ¾ĞºĞ° Ğ¼Ğ¾Ğ¶ĞµÑ‚ ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ°Ñ‚ÑŒ Ğ»ÑĞ±Ñ‹Ğµ      â”‚
â”‚ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ):                                                â”‚
â”‚                                                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚Line â”‚ V â”‚   Tag    â”‚             Data               â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚  0  â”‚ 1 â”‚0x1234567 â”‚ [â”€â”€â”€â”€â”€â”€ 64 bytes â”€â”€â”€â”€â”€â”€]      â”‚ â”‚
â”‚ â”‚  1  â”‚ 1 â”‚0xABCDEF0 â”‚ [â”€â”€â”€â”€â”€â”€ 64 bytes â”€â”€â”€â”€â”€â”€]      â”‚ â”‚
â”‚ â”‚  2  â”‚ 0 â”‚0x0000000 â”‚ [â”€â”€â”€â”€â”€â”€ 64 bytes â”€â”€â”€â”€â”€â”€]      â”‚ â”‚
â”‚ â”‚  3  â”‚ 1 â”‚0x9876543 â”‚ [â”€â”€â”€â”€â”€â”€ 64 bytes â”€â”€â”€â”€â”€â”€]      â”‚ â”‚
â”‚ â”‚ ... â”‚...â”‚   ...    â”‚           ...                 â”‚ â”‚
â”‚ â”‚ 63  â”‚ 1 â”‚0x1111111 â”‚ [â”€â”€â”€â”€â”€â”€ 64 bytes â”€â”€â”€â”€â”€â”€]      â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                         â”‚
â”‚ ĞŸÑ€Ğ¾Ñ†ĞµÑÑ Ğ¿Ğ¾Ğ¸ÑĞºĞ°:                                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ 1. ĞŸĞ°Ñ€Ğ°Ğ»Ğ»ĞµĞ»ÑŒĞ½Ğ¾Ğµ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ ÑĞ¾ Ğ’Ğ¡Ğ•ĞœĞ˜ Ñ‚ĞµĞ³Ğ°Ğ¼Ğ¸          â”‚ â”‚
â”‚ â”‚ 2. Ğ•ÑĞ»Ğ¸ ÑĞ¾Ğ²Ğ¿Ğ°Ğ´ĞµĞ½Ğ¸Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ¾ â†’ HIT                   â”‚ â”‚
â”‚ â”‚ 3. Ğ•ÑĞ»Ğ¸ Ğ½ĞµÑ‚ ÑĞ¾Ğ²Ğ¿Ğ°Ğ´ĞµĞ½Ğ¸Ğ¹ â†’ MISS                      â”‚ â”‚
â”‚ â”‚ 4. ĞŸÑ€Ğ¸ MISS â†’ Ğ²Ñ‹Ğ±Ğ¾Ñ€ Ğ¶ĞµÑ€Ñ‚Ğ²Ñ‹ Ğ¿Ğ¾ Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼Ñƒ LRU        â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                         â”‚
â”‚ CAM (Content Addressable Memory) Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ:            â”‚
â”‚                                                         â”‚
â”‚ Input Tag: 0x1234567                                    â”‚
â”‚      â†“                                                  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚ â”‚Comparatorâ”‚ â”‚Comparatorâ”‚ â”‚Comparatorâ”‚ â”‚Comparatorâ”‚       â”‚
â”‚ â”‚    0    â”‚ â”‚    1    â”‚ â”‚    2    â”‚ â”‚    3    â”‚        â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚      â”‚            â”‚            â”‚            â”‚           â”‚
â”‚   Match=1      Match=0      Match=0      Match=0        â”‚
â”‚      â”‚            â”‚            â”‚            â”‚           â”‚
â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                   â”‚            â”‚                        â”‚
â”‚              Hit Signal    Line Select                  â”‚
â”‚                                                         â”‚
â”‚ ĞŸÑ€ĞµĞ¸Ğ¼ÑƒÑ‰ĞµÑÑ‚Ğ²Ğ°:                                           â”‚
â”‚ âœ“ ĞœĞ°ĞºÑĞ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ğ³Ğ¸Ğ±ĞºĞ¾ÑÑ‚ÑŒ Ñ€Ğ°Ğ·Ğ¼ĞµÑ‰ĞµĞ½Ğ¸Ñ                      â”‚
â”‚ âœ“ ĞĞ°Ğ¸Ğ»ÑƒÑ‡ÑˆĞ¸Ğ¹ hit rate                                    â”‚
â”‚ âœ“ ĞĞµÑ‚ ĞºĞ¾Ğ½Ñ„Ğ»Ğ¸ĞºÑ‚Ğ¾Ğ² Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ                            â”‚
â”‚                                                         â”‚
â”‚ ĞĞµĞ´Ğ¾ÑÑ‚Ğ°Ñ‚ĞºĞ¸:                                             â”‚
â”‚ âœ— ĞÑ‡ĞµĞ½ÑŒ Ğ´Ğ¾Ñ€Ğ¾Ğ³Ğ°Ñ Ğ°Ğ¿Ğ¿Ğ°Ñ€Ğ°Ñ‚ÑƒÑ€Ğ°                              â”‚
â”‚ âœ— Ğ’Ñ‹ÑĞ¾ĞºĞ¾Ğµ ÑĞ½ĞµÑ€Ğ³Ğ¾Ğ¿Ğ¾Ñ‚Ñ€ĞµĞ±Ğ»ĞµĞ½Ğ¸Ğµ                             â”‚
â”‚ âœ— Ğ¡Ğ»Ğ¾Ğ¶Ğ½Ğ°Ñ ÑÑ…ĞµĞ¼Ğ° ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ                               â”‚
â”‚ âœ— ĞŸÑ€Ğ¸Ğ¼ĞµĞ½Ğ¸Ğ¼ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ´Ğ»Ñ Ğ¼Ğ°Ğ»Ñ‹Ñ… ĞºÑÑˆĞµĞ¹                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ĞĞ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼Ñ‹ Ğ·Ğ°Ğ¼ĞµÑ‰ĞµĞ½Ğ¸Ñ Ğ² Ğ°Ğ¿Ğ¿Ğ°Ñ€Ğ°Ñ‚Ğ½Ñ‹Ñ… ĞºÑÑˆĞ°Ñ…

#### CLOCK Algorithm (Ğ°Ğ¿Ğ¿Ğ°Ñ€Ğ°Ñ‚Ğ½Ğ°Ñ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   CLOCK ALGORITHM                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚ ĞšĞ¾Ğ»ÑŒÑ†ĞµĞ²Ğ°Ñ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ñ ÑƒĞºĞ°Ğ·Ğ°Ñ‚ĞµĞ»ĞµĞ¼:                       â”‚
â”‚                                                         â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”‚
â”‚        â”Œâ”€â”€â”‚ Block 0 â”‚â—„â”€â”€â”€ Clock Hand                    â”‚
â”‚        â”‚  â”‚ Use=1   â”‚                                   â”‚
â”‚        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                   â”‚
â”‚        â”‚                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Block 7 â”‚                             â”‚ Block 1 â”‚    â”‚
â”‚  â”‚ Use=0   â”‚                             â”‚ Use=0   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚        â”‚                                        â”‚       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Block 6 â”‚                             â”‚ Block 2 â”‚    â”‚
â”‚  â”‚ Use=1   â”‚                             â”‚ Use=1   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚        â”‚                                        â”‚       â”‚
â”‚        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚       â”‚
â”‚        â””â”€â”€â”‚ Block 5 â”‚     â”‚ Block 3 â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚           â”‚ Use=0   â”‚     â”‚ Use=1   â”‚                  â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                  â”‚               â”‚                     â”‚
â”‚                  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                     â”‚
â”‚                  â””â”€â”€â”‚ Block 4 â”‚â”€â”€â”˜                     â”‚
â”‚                     â”‚ Use=0   â”‚                        â”‚
â”‚                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                                                         â”‚
â”‚ ĞĞ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼ Ğ·Ğ°Ğ¼ĞµÑ‰ĞµĞ½Ğ¸Ñ:                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ 1. Clock hand ÑƒĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ Ğ½Ğ° Ñ‚ĞµĞºÑƒÑ‰Ğ¸Ğ¹ Ğ±Ğ»Ğ¾Ğº            â”‚ â”‚
â”‚ â”‚ 2. Ğ•ÑĞ»Ğ¸ Use bit = 0 â†’ Ğ²Ñ‹Ğ±Ğ¸Ñ€Ğ°ĞµĞ¼ Ğ´Ğ»Ñ Ğ·Ğ°Ğ¼ĞµÑ‰ĞµĞ½Ğ¸Ñ       â”‚ â”‚
â”‚ â”‚ 3. Ğ•ÑĞ»Ğ¸ Use bit = 1 â†’ ÑĞ±Ñ€Ğ°ÑÑ‹Ğ²Ğ°ĞµĞ¼ Ğ² 0, Ğ¸Ğ´ĞµĞ¼ Ğ´Ğ°Ğ»ÑŒÑˆĞµ  â”‚ â”‚
â”‚ â”‚ 4. ĞŸĞ¾Ğ²Ğ¾Ñ€Ğ°Ñ‡Ğ¸Ğ²Ğ°ĞµĞ¼ clock hand Ğ¿Ğ¾ Ñ‡Ğ°ÑĞ¾Ğ²Ğ¾Ğ¹ ÑÑ‚Ñ€ĞµĞ»ĞºĞµ      â”‚ â”‚
â”‚ â”‚ 5. ĞŸĞ¾Ğ²Ñ‚Ğ¾Ñ€ÑĞµĞ¼ Ğ´Ğ¾ Ğ½Ğ°Ñ…Ğ¾Ğ¶Ğ´ĞµĞ½Ğ¸Ñ Ğ±Ğ»Ğ¾ĞºĞ° Ñ Use=0           â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                         â”‚
â”‚ ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ (Ğ¿Ğ¾Ğ¸ÑĞº Ğ¶ĞµÑ€Ñ‚Ğ²Ñ‹):                       â”‚
â”‚ Ğ¡Ğ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ: Hand Ğ½Ğ° Block 0                             â”‚
â”‚ Block 0: Use=1 â†’ ÑĞ±Ñ€Ğ¾Ñ Ğ² 0, Hand â†’ Block 1             â”‚
â”‚ Block 1: Use=0 â†’ Ğ’Ğ«Ğ‘Ğ ĞĞ Ğ´Ğ»Ñ Ğ·Ğ°Ğ¼ĞµÑ‰ĞµĞ½Ğ¸Ñ!                 â”‚
â”‚                                                         â”‚
â”‚ ĞĞ¿Ğ¿Ğ°Ñ€Ğ°Ñ‚Ğ½Ğ°Ñ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Use bit:                         â”‚
â”‚ â€¢ Ğ£ÑÑ‚Ğ°Ğ½Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°ĞµÑ‚ÑÑ Ğ² 1 Ğ¿Ñ€Ğ¸ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ¼ Ğ¾Ğ±Ñ€Ğ°Ñ‰ĞµĞ½Ğ¸Ğ¸            â”‚
â”‚ â€¢ ĞŸĞµÑ€Ğ¸Ğ¾Ğ´Ğ¸Ñ‡ĞµÑĞºĞ¸ ÑĞ±Ñ€Ğ°ÑÑ‹Ğ²Ğ°ĞµÑ‚ÑÑ Ñ‚Ğ°Ğ¹Ğ¼ĞµÑ€Ğ¾Ğ¼                   â”‚
â”‚ â€¢ Ğ˜Ğ»Ğ¸ ÑĞ±Ñ€Ğ°ÑÑ‹Ğ²Ğ°ĞµÑ‚ÑÑ Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼Ğ¾Ğ¼ Clock                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ’» Ğ“Ğ»Ğ°Ğ²Ğ° 3: Cache-friendly Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ

### ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ° Ğº Ğ¼Ğ°ÑÑĞ¸Ğ²Ğ°Ğ¼

#### Ğ’Ğ»Ğ¸ÑĞ½Ğ¸Ğµ Ğ¿Ğ¾Ñ€ÑĞ´ĞºĞ° Ğ¾Ğ±Ñ…Ğ¾Ğ´Ğ° Ğ½Ğ° Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            PATTERNS OF MEMORY ACCESS                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚ Ğ”Ğ²ÑƒĞ¼ĞµÑ€Ğ½Ñ‹Ğ¹ Ğ¼Ğ°ÑÑĞ¸Ğ² Ğ² Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸ (row-major order):            â”‚
â”‚                                                         â”‚
â”‚ int matrix[4][4] Ğ² Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸:                              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”               â”‚
â”‚ â”‚[0,0]â”‚[0,1]â”‚[0,2]â”‚[0,3]â”‚[1,0]â”‚[1,1]â”‚[1,2]â”‚[1,3]â”‚      â”‚
â”‚ â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜               â”‚
â”‚ â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”               â”‚
â”‚ â”‚[2,0]â”‚[2,1]â”‚[2,2]â”‚[2,3]â”‚[3,0]â”‚[3,1]â”‚[3,2]â”‚[3,3]â”‚      â”‚
â”‚ â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜               â”‚
â”‚                                                         â”‚
â”‚ Ğ¥ĞĞ ĞĞ¨Ğ - Row-major Ğ¾Ğ±Ñ…Ğ¾Ğ´ (cache-friendly):              â”‚
â”‚ for (i = 0; i < N; i++)                                 â”‚
â”‚     for (j = 0; j < N; j++)                             â”‚
â”‚         sum += matrix[i][j];                            â”‚
â”‚                                                         â”‚
â”‚ ĞŸĞ°Ñ‚Ñ‚ĞµÑ€Ğ½ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ°: â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”                                   â”‚
â”‚ â”‚ 1â†’ â”‚ 2â†’ â”‚ 3â†’ â”‚ 4â†’ â”‚  â† Ğ¾Ğ´Ğ½Ğ° cache line              â”‚
â”‚ â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤                                   â”‚
â”‚ â”‚ 5â†’ â”‚ 6â†’ â”‚ 7â†’ â”‚ 8â†’ â”‚  â† ÑĞ»ĞµĞ´ÑƒÑÑ‰Ğ°Ñ cache line         â”‚
â”‚ â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜                                   â”‚
â”‚                                                         â”‚
â”‚ ĞŸĞ›ĞĞ¥Ğ - Column-major Ğ¾Ğ±Ñ…Ğ¾Ğ´ (cache-unfriendly):          â”‚
â”‚ for (j = 0; j < N; j++)                                 â”‚
â”‚     for (i = 0; i < N; i++)                             â”‚
â”‚         sum += matrix[i][j];                            â”‚
â”‚                                                         â”‚
â”‚ ĞŸĞ°Ñ‚Ñ‚ĞµÑ€Ğ½ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ°: â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”                                   â”‚
â”‚ â”‚ 1  â”‚ 5  â”‚ 9  â”‚13  â”‚  â† Ñ€Ğ°Ğ·Ğ½Ñ‹Ğµ cache lines            â”‚
â”‚ â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤                                   â”‚
â”‚ â”‚ 2  â”‚ 6  â”‚10  â”‚14  â”‚  â† Ñ€Ğ°Ğ·Ğ½Ñ‹Ğµ cache lines            â”‚
â”‚ â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤                                   â”‚
â”‚ â”‚ 3  â”‚ 7  â”‚11  â”‚15  â”‚  â† Ñ€Ğ°Ğ·Ğ½Ñ‹Ğµ cache lines            â”‚
â”‚ â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤                                   â”‚
â”‚ â”‚ 4  â”‚ 8  â”‚12  â”‚16  â”‚  â† Ñ€Ğ°Ğ·Ğ½Ñ‹Ğµ cache lines            â”‚
â”‚ â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜                                   â”‚
â”‚                                                         â”‚
â”‚ Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ Ğ±ĞµĞ½Ñ‡Ğ¼Ğ°Ñ€ĞºĞ° (1000x1000 Ğ¼Ğ°Ñ‚Ñ€Ğ¸Ñ†Ğ°):               â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚ â”‚    ĞŸĞ°Ñ‚Ñ‚ĞµÑ€Ğ½      â”‚    Ğ’Ñ€ĞµĞ¼Ñ    â”‚ Cache missesâ”‚         â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”‚
â”‚ â”‚ Row-major       â”‚   45ms      â”‚     15%     â”‚         â”‚
â”‚ â”‚ Column-major    â”‚  180ms      â”‚     85%     â”‚         â”‚
â”‚ â”‚ Ğ Ğ°Ğ·Ğ½Ğ¸Ñ†Ğ°         â”‚   4x        â”‚    5.7x     â”‚         â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Ğ‘Ğ»Ğ¾Ñ‡Ğ½Ñ‹Ğµ Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼Ñ‹ Ğ´Ğ»Ñ Ğ¼Ğ°Ñ‚Ñ€Ğ¸Ñ‡Ğ½Ñ‹Ñ… Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¹
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              MATRIX MULTIPLICATION BLOCKING              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚ Ğ¡Ñ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ½Ñ‹Ğ¹ Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼ (Ğ¿Ğ»Ğ¾Ñ…Ğ¾ Ğ´Ğ»Ñ ĞºÑÑˆĞ°):                  â”‚
â”‚ for (i = 0; i < N; i++)                                 â”‚
â”‚     for (j = 0; j < N; j++)                             â”‚
â”‚         for (k = 0; k < N; k++)                         â”‚
â”‚             C[i][j] += A[i][k] * B[k][j];               â”‚
â”‚                                                         â”‚
â”‚ ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°: Ğ¼Ğ°Ñ‚Ñ€Ğ¸Ñ†Ğ° B Ğ¾Ğ±Ñ…Ğ¾Ğ´Ğ¸Ñ‚ÑÑ Ğ¿Ğ¾ ÑÑ‚Ğ¾Ğ»Ğ±Ñ†Ğ°Ğ¼               â”‚
â”‚                                                         â”‚
â”‚ Ğ‘Ğ»Ğ¾Ñ‡Ğ½Ñ‹Ğ¹ Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼ (cache-friendly):                      â”‚
â”‚                                                         â”‚
â”‚ #define BLOCK_SIZE 64  // Ğ¿Ğ¾Ğ´Ğ±Ğ¸Ñ€Ğ°ĞµÑ‚ÑÑ Ğ¿Ğ¾Ğ´ L1 cache     â”‚
â”‚                                                         â”‚
â”‚ for (ii = 0; ii < N; ii += BLOCK_SIZE)                  â”‚
â”‚   for (jj = 0; jj < N; jj += BLOCK_SIZE)                â”‚
â”‚     for (kk = 0; kk < N; kk += BLOCK_SIZE)              â”‚
â”‚       // Ğ£Ğ¼Ğ½Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ Ğ±Ğ»Ğ¾ĞºĞ¾Ğ²                              â”‚
â”‚       for (i = ii; i < min(ii+BLOCK_SIZE, N); i++)      â”‚
â”‚         for (j = jj; j < min(jj+BLOCK_SIZE, N); j++)    â”‚
â”‚           for (k = kk; k < min(kk+BLOCK_SIZE, N); k++)  â”‚
â”‚             C[i][j] += A[i][k] * B[k][j];               â”‚
â”‚                                                         â”‚
â”‚ Ğ’Ğ¸Ğ·ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ±Ğ»Ğ¾Ñ‡Ğ½Ğ¾Ğ³Ğ¾ ÑƒĞ¼Ğ½Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ:                        â”‚
â”‚                                                         â”‚
â”‚     Matrix A        Matrix B        Matrix C            â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”          â”‚
â”‚ â”‚ A11 â”‚ A12 â”‚ Ã— â”‚ B11 â”‚ B12 â”‚ = â”‚ C11 â”‚ C12 â”‚          â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤          â”‚
â”‚ â”‚ A21 â”‚ A22 â”‚   â”‚ B21 â”‚ B22 â”‚   â”‚ C21 â”‚ C22 â”‚          â”‚
â”‚ â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                         â”‚
â”‚ C11 = A11Ã—B11 + A12Ã—B21  (Ğ±Ğ»Ğ¾ĞºĞ¸ Ğ¾ÑÑ‚Ğ°ÑÑ‚ÑÑ Ğ² ĞºÑÑˆĞµ)       â”‚
â”‚                                                         â”‚
â”‚ Ğ Ğ°Ğ·Ğ¼ĞµÑ€ Ğ±Ğ»Ğ¾ĞºĞ° Ğ´Ğ»Ñ Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¹ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸:        â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Block Size = âˆš(Cache_Size / 3)                      â”‚ â”‚
â”‚ â”‚                                                     â”‚ â”‚
â”‚ â”‚ Ğ”Ğ»Ñ L1 cache 32KB:                                  â”‚ â”‚
â”‚ â”‚ Block Size = âˆš(32768 / 3) â‰ˆ 104 ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚Ğ¾Ğ²          â”‚ â”‚
â”‚ â”‚ Ğ”Ğ»Ñ double: 104 Ã— 8 Ğ±Ğ°Ğ¹Ñ‚ = 832 Ğ±Ğ°Ğ¹Ñ‚Ğ° Ğ½Ğ° ÑÑ‚Ñ€Ğ¾ĞºÑƒ     â”‚ â”‚
â”‚ â”‚ ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ñ€Ğ°Ğ·Ğ¼ĞµÑ€: 64Ã—64 Ğ¸Ğ»Ğ¸ 128Ã—128               â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                         â”‚
â”‚ Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸:                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚   ĞĞ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼      â”‚   Ğ’Ñ€ĞµĞ¼Ñ     â”‚    Ğ£ÑĞºĞ¾Ñ€ĞµĞ½Ğ¸Ğµ       â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚ Ğ¡Ñ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ½Ñ‹Ğ¹     â”‚   2.4s      â”‚        1x          â”‚ â”‚
â”‚ â”‚ Ğ‘Ğ»Ğ¾Ñ‡Ğ½Ñ‹Ğ¹ 64Ã—64   â”‚   0.8s      â”‚        3x          â”‚ â”‚
â”‚ â”‚ Ğ‘Ğ»Ğ¾Ñ‡Ğ½Ñ‹Ğ¹ 128Ã—128 â”‚   0.6s      â”‚        4x          â”‚ â”‚
â”‚ â”‚ + SIMD          â”‚   0.2s      â”‚       12x          â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Prefetching Ğ¸ ĞµĞ³Ğ¾ Ğ²Ğ»Ğ¸ÑĞ½Ğ¸Ğµ

#### ĞĞ¿Ğ¿Ğ°Ñ€Ğ°Ñ‚Ğ½Ñ‹Ğ¹ prefetching
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                HARDWARE PREFETCHING                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚ Ğ¢Ğ¸Ğ¿Ñ‹ Ğ°Ğ¿Ğ¿Ğ°Ñ€Ğ°Ñ‚Ğ½Ñ‹Ñ… prefetcher'Ğ¾Ğ²:                          â”‚
â”‚                                                         â”‚
â”‚ 1. STREAM PREFETCHER                                    â”‚
â”‚    ĞĞ±Ğ½Ğ°Ñ€ÑƒĞ¶Ğ¸Ğ²Ğ°ĞµÑ‚ Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğ¹ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿                â”‚
â”‚                                                         â”‚
â”‚    ĞŸĞ°Ñ‚Ñ‚ĞµÑ€Ğ½ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ°: 0x1000, 0x1040, 0x1080, 0x10C0...  â”‚
â”‚    Ğ¨Ğ°Ğ³: +64 Ğ±Ğ°Ğ¹Ñ‚Ğ° (Ñ€Ğ°Ğ·Ğ¼ĞµÑ€ cache line)                  â”‚
â”‚                                                         â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚ ĞĞ±Ğ½Ğ°Ñ€ÑƒĞ¶ĞµĞ½ Ğ¿Ğ°Ñ‚Ñ‚ĞµÑ€Ğ½ â†’ Ğ—Ğ°Ğ¿Ñ€Ğ¾Ñ ÑĞ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ñ… lines:     â”‚ â”‚
â”‚    â”‚ 0x1100, 0x1140, 0x1180, 0x11C0                 â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                         â”‚
â”‚ 2. STRIDE PREFETCHER                                    â”‚
â”‚    ĞĞ±Ğ½Ğ°Ñ€ÑƒĞ¶Ğ¸Ğ²Ğ°ĞµÑ‚ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ Ñ Ğ¿Ğ¾ÑÑ‚Ğ¾ÑĞ½Ğ½Ñ‹Ğ¼ ÑˆĞ°Ğ³Ğ¾Ğ¼              â”‚
â”‚                                                         â”‚
â”‚    ĞŸĞ°Ñ‚Ñ‚ĞµÑ€Ğ½: 0x1000, 0x1100, 0x1200, 0x1300...          â”‚
â”‚    Ğ¨Ğ°Ğ³: +256 Ğ±Ğ°Ğ¹Ñ‚                                      â”‚
â”‚                                                         â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚ ĞŸÑ€ĞµĞ´ÑĞºĞ°Ğ·Ğ°Ğ½Ğ¸Ğµ: 0x1400, 0x1500, 0x1600...        â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                         â”‚
â”‚ 3. INDIRECT PREFETCHER                                  â”‚
â”‚    ĞĞ±Ğ½Ğ°Ñ€ÑƒĞ¶Ğ¸Ğ²Ğ°ĞµÑ‚ pointer chasing                        â”‚
â”‚                                                         â”‚
â”‚    struct node *p = head;                              â”‚
â”‚    while (p) {                                         â”‚
â”‚        process(p->data);                               â”‚
â”‚        p = p->next;  â† Ğ¿Ñ€ĞµĞ´ÑĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ÑÑ                 â”‚
â”‚    }                                                   â”‚
â”‚                                                         â”‚
â”‚ Ğ­Ñ„Ñ„ĞµĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ prefetching:                              â”‚
â”‚                                                         â”‚
â”‚    Performance â†‘                                       â”‚
â”‚         â”‚                                              â”‚
â”‚    100% â”‚    â–ˆâ–ˆâ–ˆâ–ˆ                                      â”‚
â”‚         â”‚   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                                     â”‚
â”‚     80% â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                                    â”‚
â”‚         â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                                   â”‚
â”‚     60% â”‚â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â† ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ğ·Ğ¾Ğ½Ğ°              â”‚
â”‚         â”‚â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                                 â”‚
â”‚     40% â”‚â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                                 â”‚
â”‚         â”‚â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                                 â”‚
â”‚     20% â”‚â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                                 â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Prefetch Distance  â”‚
â”‚         0   2   4   6   8  10  12                     â”‚
â”‚                                                         â”‚
â”‚         â†‘            â†‘             â†‘                   â”‚
â”‚    Too little   Optimal      Too much                  â”‚
â”‚    (late)       zone          (pollution)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ĞŸÑ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ½Ñ‹Ğ¹ prefetching
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               SOFTWARE PREFETCHING                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚ ĞšĞ¾Ğ¼Ğ¿Ğ¸Ğ»ÑÑ‚Ğ¾Ñ€Ğ½Ñ‹Ğµ Ğ´Ğ¸Ñ€ĞµĞºÑ‚Ğ¸Ğ²Ñ‹ Ğ¸ intrinsics:                   â”‚
â”‚                                                         â”‚
â”‚ // GCC builtin                                          â”‚
â”‚ __builtin_prefetch(addr, rw, locality);                 â”‚
â”‚ //                 â†‘    â†‘   â†‘                          â”‚
â”‚ //              Ğ°Ğ´Ñ€ĞµÑ  R/W  ÑƒÑ€Ğ¾Ğ²ĞµĞ½ÑŒ                     â”‚
â”‚                                                         â”‚
â”‚ // Intel intrinsics                                     â”‚
â”‚ #include <xmmintrin.h>                                  â”‚
â”‚ _mm_prefetch(addr, _MM_HINT_T0);  // Ğ² L1              â”‚
â”‚ _mm_prefetch(addr, _MM_HINT_T1);  // Ğ² L2              â”‚
â”‚ _mm_prefetch(addr, _MM_HINT_T2);  // Ğ² L3              â”‚
â”‚ _mm_prefetch(addr, _MM_HINT_NTA); // non-temporal      â”‚
â”‚                                                         â”‚
â”‚ ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸ Ñ†Ğ¸ĞºĞ»Ğ°:                               â”‚
â”‚                                                         â”‚
â”‚ // Ğ‘Ğ•Ğ— prefetch                                         â”‚
â”‚ for (i = 0; i < N; i++) {                              â”‚
â”‚     result += expensive_function(array[i]);            â”‚
â”‚ }                                                       â”‚
â”‚                                                         â”‚
â”‚ // Ğ¡ prefetch                                           â”‚
â”‚ for (i = 0; i < N; i++) {                              â”‚
â”‚     // ĞŸÑ€ĞµĞ´Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°ĞµĞ¼ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ½Ğ° Ğ½ĞµÑĞºĞ¾Ğ»ÑŒĞºĞ¾ Ğ¸Ñ‚ĞµÑ€Ğ°Ñ†Ğ¸Ğ¹      â”‚
â”‚     // Ğ²Ğ¿ĞµÑ€ĞµĞ´                                          â”‚
â”‚     if (i + PREFETCH_DISTANCE < N) {                   â”‚
â”‚         __builtin_prefetch(&array[i + PREFETCH_DISTANCE], â”‚
â”‚                           0, 3);                       â”‚
â”‚     }                                                  â”‚
â”‚     result += expensive_function(array[i]);            â”‚
â”‚ }                                                       â”‚
â”‚                                                         â”‚
â”‚ ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ Ñ€Ğ°ÑÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ prefetch:                        â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ PREFETCH_DISTANCE = Memory_Latency / Loop_Time      â”‚ â”‚
â”‚ â”‚                                                     â”‚ â”‚
â”‚ â”‚ ĞŸÑ€Ğ¸Ğ¼ĞµÑ€:                                             â”‚ â”‚
â”‚ â”‚ Memory_Latency = 300 cycles                         â”‚ â”‚
â”‚ â”‚ Loop_Time = 50 cycles                               â”‚ â”‚
â”‚ â”‚ PREFETCH_DISTANCE = 300/50 = 6 Ğ¸Ñ‚ĞµÑ€Ğ°Ñ†Ğ¸Ğ¹            â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                         â”‚
â”‚ Non-temporal prefetch Ğ´Ğ»Ñ Ğ±Ğ¾Ğ»ÑŒÑˆĞ¸Ñ… Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…:               â”‚
â”‚                                                         â”‚
â”‚ // Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒÑÑ‚ÑÑ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ¾Ğ´Ğ¸Ğ½ Ñ€Ğ°Ğ·                  â”‚
â”‚ for (i = 0; i < HUGE_N; i++) {                         â”‚
â”‚     _mm_prefetch(&huge_array[i + 8], _MM_HINT_NTA);    â”‚
â”‚     process_once(huge_array[i]);                       â”‚
â”‚ }                                                       â”‚
â”‚ // NTA = Not To All cache levels                       â”‚
â”‚ // Ğ˜Ğ·Ğ±ĞµĞ³Ğ°ĞµÑ‚ Ğ·Ğ°Ğ³Ñ€ÑĞ·Ğ½ĞµĞ½Ğ¸Ñ ĞºÑÑˆĞ°                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Ğ“Ğ»Ğ°Ğ²Ğ° 4: ĞšĞ¾Ğ³ĞµÑ€ĞµĞ½Ñ‚Ğ½Ğ¾ÑÑ‚ÑŒ ĞºÑÑˆĞ°

### ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ° ĞºĞ¾Ğ³ĞµÑ€ĞµĞ½Ñ‚Ğ½Ğ¾ÑÑ‚Ğ¸ Ğ² Ğ¼Ğ½Ğ¾Ğ³Ğ¾Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ñ€Ğ½Ñ‹Ñ… ÑĞ¸ÑÑ‚ĞµĞ¼Ğ°Ñ…

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                CACHE COHERENCE PROBLEM                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚ ĞĞ°Ñ‡Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ (X = 5 Ğ² Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸):                   â”‚
â”‚                                                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚ â”‚   CPU 0     â”‚              â”‚   CPU 1     â”‚            â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚              â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚            â”‚
â”‚ â”‚ â”‚ Cache 0 â”‚ â”‚              â”‚ â”‚ Cache 1 â”‚ â”‚            â”‚
â”‚ â”‚ â”‚    -    â”‚ â”‚              â”‚ â”‚    -    â”‚ â”‚            â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚              â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚            â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚       â”‚                              â”‚                 â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                      â”‚                                 â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚              â”‚   Memory    â”‚                           â”‚
â”‚              â”‚    X = 5    â”‚                           â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚                                                         â”‚
â”‚ Ğ¨Ğ°Ğ³ 1: CPU 0 Ñ‡Ğ¸Ñ‚Ğ°ĞµÑ‚ X                                  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚ â”‚   CPU 0     â”‚              â”‚   CPU 1     â”‚            â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚              â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚            â”‚
â”‚ â”‚ â”‚ Cache 0 â”‚ â”‚              â”‚ â”‚ Cache 1 â”‚ â”‚            â”‚
â”‚ â”‚ â”‚  X = 5  â”‚ â”‚              â”‚ â”‚    -    â”‚ â”‚            â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚              â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚            â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                         â”‚
â”‚ Ğ¨Ğ°Ğ³ 2: CPU 1 Ñ‡Ğ¸Ñ‚Ğ°ĞµÑ‚ X                                  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚ â”‚   CPU 0     â”‚              â”‚   CPU 1     â”‚            â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚              â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚            â”‚
â”‚ â”‚ â”‚ Cache 0 â”‚ â”‚              â”‚ â”‚ Cache 1 â”‚ â”‚            â”‚
â”‚ â”‚ â”‚  X = 5  â”‚ â”‚              â”‚ â”‚  X = 5  â”‚ â”‚            â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚              â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚            â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                         â”‚
â”‚ Ğ¨Ğ°Ğ³ 3: CPU 0 Ğ·Ğ°Ğ¿Ğ¸ÑÑ‹Ğ²Ğ°ĞµÑ‚ X = 10                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚ â”‚   CPU 0     â”‚              â”‚   CPU 1     â”‚            â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚              â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚            â”‚
â”‚ â”‚ â”‚ Cache 0 â”‚ â”‚              â”‚ â”‚ Cache 1 â”‚ â”‚            â”‚
â”‚ â”‚ â”‚  X = 10 â”‚ â”‚              â”‚ â”‚  X = 5  â”‚ â”‚ â† ĞŸĞ ĞĞ‘Ğ›Ğ•ĞœĞ!â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚              â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚            â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                         â”‚
â”‚ Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚: CPU 1 Ğ²Ğ¸Ğ´Ğ¸Ñ‚ ÑÑ‚Ğ°Ñ€Ğ¾Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ X = 5           â”‚
â”‚ Ğ¢Ñ€ĞµĞ±ÑƒĞµÑ‚ÑÑ Ğ¿Ñ€Ğ¾Ñ‚Ğ¾ĞºĞ¾Ğ» ĞºĞ¾Ğ³ĞµÑ€ĞµĞ½Ñ‚Ğ½Ğ¾ÑÑ‚Ğ¸!                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ĞŸÑ€Ğ¾Ñ‚Ğ¾ĞºĞ¾Ğ» MESI

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     MESI PROTOCOL                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚ Ğ§ĞµÑ‚Ñ‹Ñ€Ğµ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ñ cache line:                            â”‚
â”‚                                                         â”‚
â”‚ M = Modified   (Ğ“Ñ€ÑĞ·Ğ½Ğ°Ñ, ÑĞºÑĞºĞ»ÑĞ·Ğ¸Ğ²Ğ½Ğ°Ñ)                  â”‚
â”‚ E = Exclusive  (Ğ§Ğ¸ÑÑ‚Ğ°Ñ, ÑĞºÑĞºĞ»ÑĞ·Ğ¸Ğ²Ğ½Ğ°Ñ)                   â”‚
â”‚ S = Shared     (Ğ Ğ°Ğ·Ğ´ĞµĞ»ÑĞµĞ¼Ğ°Ñ Ğ¼ĞµĞ¶Ğ´Ñƒ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ñ€Ğ°Ğ¼Ğ¸)         â”‚
â”‚ I = Invalid    (ĞĞµĞ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ°Ñ)                       â”‚
â”‚                                                         â”‚
â”‚ Ğ”Ğ¸Ğ°Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ° ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğ¹:                                    â”‚
â”‚                                                         â”‚
â”‚                    Local Read                           â”‚
â”‚             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚             â–¼                          â”‚                â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” Local Write â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚    â”‚      E      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚      M      â”‚          â”‚
â”‚    â”‚ (Exclusive) â”‚              â”‚ (Modified)  â”‚          â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚             â”‚                          â”‚                â”‚
â”‚             â”‚ Remote Read             â”‚ Eviction/      â”‚
â”‚             â–¼                          â”‚ Remote Read    â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â–¼                â”‚
â”‚    â”‚      S      â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚    â”‚  (Shared)   â”‚ Write-back                           â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                      â”‚
â”‚             â”‚                                           â”‚
â”‚             â”‚ Local/Remote Write                        â”‚
â”‚             â–¼                                           â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                      â”‚
â”‚    â”‚      I      â”‚                                      â”‚
â”‚    â”‚ (Invalid)   â”‚                                      â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                      â”‚
â”‚                                                         â”‚
â”‚ ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ Ğ¿Ñ€Ğ¾Ñ‚Ğ¾ĞºĞ¾Ğ»Ğ°:                            â”‚
â”‚                                                         â”‚
â”‚ ĞĞ°Ñ‡Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ: Ğ²ÑĞµ ĞºÑÑˆĞ¸ Ğ¿ÑƒÑÑ‚Ñ‹                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚  CPU    â”‚ Action  â”‚ State   â”‚      ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ          â”‚â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
â”‚ â”‚ CPU 0   â”‚ Read X  â”‚ E       â”‚ Exclusive, loaded from â”‚â”‚
â”‚ â”‚         â”‚         â”‚         â”‚ memory                 â”‚â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
â”‚ â”‚ CPU 1   â”‚ Read X  â”‚ S       â”‚ CPU 0: Eâ†’S, CPU 1: S  â”‚â”‚
â”‚ â”‚         â”‚         â”‚         â”‚ Shared Ğ¼ĞµĞ¶Ğ´Ñƒ ĞºÑÑˆĞ°Ğ¼Ğ¸    â”‚â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
â”‚ â”‚ CPU 0   â”‚ Write X â”‚ M       â”‚ CPU 0: Sâ†’M, CPU 1: Sâ†’Iâ”‚â”‚
â”‚ â”‚         â”‚         â”‚         â”‚ CPU 0 Ğ¸Ğ½Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ¸Ñ€ÑƒĞµÑ‚    â”‚â”‚
â”‚ â”‚         â”‚         â”‚         â”‚ ĞºĞ¾Ğ¿Ğ¸Ñ Ğ² CPU 1          â”‚â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
â”‚ â”‚ CPU 1   â”‚ Read X  â”‚ S       â”‚ CPU 0: Mâ†’S (write-back)â”‚â”‚
â”‚ â”‚         â”‚         â”‚         â”‚ CPU 1: Iâ†’S, Ğ¾Ğ±Ğ° Sharedâ”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ĞŸÑ€Ğ¾Ñ‚Ğ¾ĞºĞ¾Ğ» MOESI

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MOESI PROTOCOL                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚ ĞŸÑÑ‚ÑŒ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğ¹ (Ñ€Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ¸Ğµ MESI):                       â”‚
â”‚                                                         â”‚
â”‚ M = Modified   (Ğ“Ñ€ÑĞ·Ğ½Ğ°Ñ, ÑĞºÑĞºĞ»ÑĞ·Ğ¸Ğ²Ğ½Ğ°Ñ)                  â”‚
â”‚ O = Owned      (ĞÑ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²ĞµĞ½Ğ½Ğ°Ñ Ğ·Ğ° Ğ¿Ğ¾ÑÑ‚Ğ°Ğ²ĞºÑƒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…)       â”‚
â”‚ E = Exclusive  (Ğ§Ğ¸ÑÑ‚Ğ°Ñ, ÑĞºÑĞºĞ»ÑĞ·Ğ¸Ğ²Ğ½Ğ°Ñ)                   â”‚
â”‚ S = Shared     (Ğ Ğ°Ğ·Ğ´ĞµĞ»ÑĞµĞ¼Ğ°Ñ)                            â”‚
â”‚ I = Invalid    (ĞĞµĞ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ°Ñ)                       â”‚
â”‚                                                         â”‚
â”‚ ĞšĞ»ÑÑ‡ĞµĞ²Ğ¾Ğµ ÑƒĞ»ÑƒÑ‡ÑˆĞµĞ½Ğ¸Ğµ - ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ O (Owned):               â”‚
â”‚                                                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Ğ’ MESI: Ğ¿Ñ€Ğ¸ Ğ¿ĞµÑ€ĞµÑ…Ğ¾Ğ´Ğµ Mâ†’S Ñ‚Ñ€ĞµĞ±ÑƒĞµÑ‚ÑÑ write-back       â”‚ â”‚
â”‚ â”‚ Ğ² Ğ¿Ğ°Ğ¼ÑÑ‚ÑŒ, Ğ´Ğ°Ğ¶Ğµ ĞµÑĞ»Ğ¸ Ğ´Ñ€ÑƒĞ³Ğ¾Ğ¹ CPU ÑÑ€Ğ°Ğ·Ñƒ ÑÑ‡Ğ¸Ñ‚Ğ°ĞµÑ‚        â”‚ â”‚
â”‚ â”‚                                                     â”‚ â”‚
â”‚ â”‚ Ğ’ MOESI: Mâ†’O, Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¾ÑÑ‚Ğ°ÑÑ‚ÑÑ Ğ² ĞºÑÑˆĞµ Ğ¸ Ğ¿Ğ¾ÑÑ‚Ğ°Ğ²Ğ»ÑÑÑ‚ÑÑâ”‚ â”‚
â”‚ â”‚ Ğ½Ğ°Ğ¿Ñ€ÑĞ¼ÑƒÑ Ğ´Ñ€ÑƒĞ³Ğ¸Ğ¼ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ñ€Ğ°Ğ¼ (cache-to-cache        â”‚ â”‚
â”‚ â”‚ transfer)                                           â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                         â”‚
â”‚ ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸:                                     â”‚
â”‚                                                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚ Step    â”‚ CPU 0   â”‚ CPU 1   â”‚       Ğ”ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğµ          â”‚â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
â”‚ â”‚ 1       â”‚ Read X  â”‚   -     â”‚ CPU 0: Iâ†’E (from mem)  â”‚â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
â”‚ â”‚ 2       â”‚Write X=10â”‚   -     â”‚ CPU 0: Eâ†’M             â”‚â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
â”‚ â”‚ 3       â”‚ X=10(O) â”‚ Read X  â”‚ CPU 0: Mâ†’O, CPU 1: Iâ†’S â”‚â”‚
â”‚ â”‚         â”‚         â”‚ X=10(S) â”‚ Cache-to-cache transfer â”‚â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
â”‚ â”‚ 4       â”‚ X=10(O) â”‚ Read X  â”‚ CPU 0 Ğ¿Ğ¾ÑÑ‚Ğ°Ğ²Ğ»ÑĞµÑ‚       â”‚â”‚
â”‚ â”‚         â”‚ X=10(S) â”‚ X=10(S) â”‚ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ½Ğ°Ğ¿Ñ€ÑĞ¼ÑƒÑ        â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                         â”‚
â”‚ ĞŸÑ€ĞµĞ¸Ğ¼ÑƒÑ‰ĞµÑÑ‚Ğ²Ğ° MOESI:                                     â”‚
â”‚ âœ“ ĞœĞµĞ½ÑŒÑˆĞµ Ğ¾Ğ±Ñ€Ğ°Ñ‰ĞµĞ½Ğ¸Ğ¹ Ğº Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸                             â”‚
â”‚ âœ“ Ğ‘Ñ‹ÑÑ‚Ñ€ĞµĞµ cache-to-cache transfers                      â”‚
â”‚ âœ“ Ğ›ÑƒÑ‡ÑˆĞ°Ñ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ Ğ´Ğ»Ñ read-heavy workloads    â”‚
â”‚                                                         â”‚
â”‚ Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚: AMD Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ñ€Ñ‹, Ğ½ĞµĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğµ ARM               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### False Sharing

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     FALSE SHARING                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚ ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°: Ñ€Ğ°Ğ·Ğ½Ñ‹Ğµ Ğ¿ĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ Ğ² Ğ¾Ğ´Ğ½Ğ¾Ğ¹ cache line          â”‚
â”‚                                                         â”‚
â”‚ ĞŸĞ°Ğ¼ÑÑ‚ÑŒ (Ğ¾Ğ´Ğ½Ğ° cache line = 64 Ğ±Ğ°Ğ¹Ñ‚Ğ°):                    â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚  var_a   â”‚  var_b   â”‚  var_c   â”‚  var_d   â”‚ ...   â”‚  â”‚
â”‚ â”‚ (8 Ğ±Ğ°Ğ¹Ñ‚) â”‚ (8 Ğ±Ğ°Ğ¹Ñ‚) â”‚ (8 Ğ±Ğ°Ğ¹Ñ‚) â”‚ (8 Ğ±Ğ°Ğ¹Ñ‚) â”‚       â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                         â”‚
â”‚ Ğ¡Ñ†ĞµĞ½Ğ°Ñ€Ğ¸Ğ¹ false sharing:                                 â”‚
â”‚                                                         â”‚
â”‚ Thread 1: Ğ¿Ğ¾ÑÑ‚Ğ¾ÑĞ½Ğ½Ğ¾ Ğ¿Ğ¸ÑˆĞµÑ‚ Ğ² var_a                       â”‚
â”‚ Thread 2: Ğ¿Ğ¾ÑÑ‚Ğ¾ÑĞ½Ğ½Ğ¾ Ğ¿Ğ¸ÑˆĞµÑ‚ Ğ² var_b                       â”‚
â”‚                                                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚ â”‚   CPU 0     â”‚              â”‚   CPU 1     â”‚            â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚              â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚            â”‚
â”‚ â”‚ â”‚ Cache 0 â”‚ â”‚              â”‚ â”‚ Cache 1 â”‚ â”‚            â”‚
â”‚ â”‚ â”‚ [a,b,c,d]â”‚ â”‚              â”‚ â”‚ [a,b,c,d]â”‚ â”‚            â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚              â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚            â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                         â”‚
â”‚ ĞŸĞ¾ÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹:                             â”‚
â”‚ 1. CPU 0 Ğ¸Ğ·Ğ¼ĞµĞ½ÑĞµÑ‚ var_a â†’ cache line Ğ¿ĞµÑ€ĞµÑ…Ğ¾Ğ´Ğ¸Ñ‚ Ğ² M     â”‚
â”‚ 2. CPU 1 Ğ¸Ğ·Ğ¼ĞµĞ½ÑĞµÑ‚ var_b â†’ Ğ½ÑƒĞ¶Ğ½Ğ° ĞºĞ¾Ğ¿Ğ¸Ñ cache line       â”‚
â”‚ 3. CPU 0 Ğ¾Ñ‚Ğ´Ğ°ĞµÑ‚ cache line (Mâ†’S)                       â”‚
â”‚ 4. CPU 1 Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ°ĞµÑ‚ Ğ¸ Ğ¸Ğ·Ğ¼ĞµĞ½ÑĞµÑ‚ (Sâ†’M)                     â”‚
â”‚ 5. CPU 0 Ğ¾Ğ¿ÑÑ‚ÑŒ Ñ…Ğ¾Ñ‡ĞµÑ‚ Ğ¸Ğ·Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ var_a â†’ miss!            â”‚
â”‚                                                         â”‚
â”‚ â–¼ Ğ Ğ•Ğ—Ğ£Ğ›Ğ¬Ğ¢ĞĞ¢: Ğ¿Ğ¾ÑÑ‚Ğ¾ÑĞ½Ğ½Ğ°Ñ Ğ¸Ğ½Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ ĞºÑÑˆĞµĞ¹!              â”‚
â”‚                                                         â”‚
â”‚ ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ½Ğ¾Ğ³Ğ¾ ĞºĞ¾Ğ´Ğ°:                                â”‚
â”‚                                                         â”‚
â”‚ struct {                                                â”‚
â”‚     int counter1;  // Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ Thread 1            â”‚
â”‚     int counter2;  // Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ Thread 2            â”‚
â”‚ } shared_data;                                          â”‚
â”‚                                                         â”‚
â”‚ // Thread 1                                             â”‚
â”‚ while (running) {                                       â”‚
â”‚     shared_data.counter1++;  // False sharing!         â”‚
â”‚ }                                                       â”‚
â”‚                                                         â”‚
â”‚ // Thread 2                                             â”‚
â”‚ while (running) {                                       â”‚
â”‚     shared_data.counter2++;  // False sharing!         â”‚
â”‚ }                                                       â”‚
â”‚                                                         â”‚
â”‚ Ğ˜Ğ·Ğ¼ĞµÑ€ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸:                           â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚   Ğ¡Ñ†ĞµĞ½Ğ°Ñ€Ğ¸Ğ¹      â”‚Operations/s â”‚   Penalty           â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚ Ğ‘ĞµĞ· false shar. â”‚ 100M ops/s  â”‚        -            â”‚ â”‚
â”‚ â”‚ Ğ¡ false sharing â”‚  10M ops/s  â”‚       10x           â”‚ â”‚
â”‚ â”‚ Ğ¡ padding       â”‚  95M ops/s  â”‚       5%            â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Ğ¡Ğ¿Ğ¾ÑĞ¾Ğ±Ñ‹ Ğ¸Ğ·Ğ±ĞµĞ¶Ğ°Ñ‚ÑŒ False Sharing

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              AVOIDING FALSE SHARING                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚ 1. PADDING (Ğ²Ñ‹Ñ€Ğ°Ğ²Ğ½Ğ¸Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ğ¾ cache line)                â”‚
â”‚                                                         â”‚
â”‚ // ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ½Ñ‹Ğ¹ ĞºĞ¾Ğ´                                       â”‚
â”‚ struct bad_struct {                                     â”‚
â”‚     int counter1;    // 4 Ğ±Ğ°Ğ¹Ñ‚Ğ°                        â”‚
â”‚     int counter2;    // 4 Ğ±Ğ°Ğ¹Ñ‚Ğ° - Ğ² Ñ‚Ğ¾Ğ¹ Ğ¶Ğµ cache line! â”‚
â”‚ };                                                      â”‚
â”‚                                                         â”‚
â”‚ // Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ Ñ padding                                    â”‚
â”‚ struct good_struct {                                    â”‚
â”‚     int counter1;                                       â”‚
â”‚     char padding[60];  // Ğ—Ğ°Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ Ğ´Ğ¾ 64 Ğ±Ğ°Ğ¹Ñ‚        â”‚
â”‚     int counter2;      // Ğ¢ĞµĞ¿ĞµÑ€ÑŒ Ğ² Ğ¾Ñ‚Ğ´ĞµĞ»ÑŒĞ½Ğ¾Ğ¹ cache lineâ”‚
â”‚ };                                                      â”‚
â”‚                                                         â”‚
â”‚ // ĞĞ»ÑŒÑ‚ĞµÑ€Ğ½Ğ°Ñ‚Ğ¸Ğ²Ğ° Ñ Ğ°Ñ‚Ñ€Ğ¸Ğ±ÑƒÑ‚Ğ°Ğ¼Ğ¸ ĞºĞ¾Ğ¼Ğ¿Ğ¸Ğ»ÑÑ‚Ğ¾Ñ€Ğ°                â”‚
â”‚ struct aligned_struct {                                 â”‚
â”‚     int counter1;                                       â”‚
â”‚     int counter2 __attribute__((aligned(64)));          â”‚
â”‚ };                                                      â”‚
â”‚                                                         â”‚
â”‚ 2. CACHE LINE SIZE MACRO                                â”‚
â”‚                                                         â”‚
â”‚ #define CACHE_LINE_SIZE 64                              â”‚
â”‚ #define CACHE_ALIGNED __attribute__((aligned(CACHE_LINE_SIZE)))â”‚
â”‚                                                         â”‚
â”‚ struct optimized_struct {                               â”‚
â”‚     int counter1 CACHE_ALIGNED;                         â”‚
â”‚     int counter2 CACHE_ALIGNED;                         â”‚
â”‚ };                                                      â”‚
â”‚                                                         â”‚
â”‚ 3. ĞĞ¢Ğ”Ğ•Ğ›Ğ¬ĞĞ«Ğ• ĞŸĞ•Ğ Ğ•ĞœĞ•ĞĞĞ«Ğ•                                 â”‚
â”‚                                                         â”‚
â”‚ // Ğ’Ğ¼ĞµÑÑ‚Ğ¾ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñ‹                                     â”‚
â”‚ static int counter1 CACHE_ALIGNED;                      â”‚
â”‚ static int counter2 CACHE_ALIGNED;                      â”‚
â”‚                                                         â”‚
â”‚ 4. THREAD-LOCAL STORAGE                                 â”‚
â”‚                                                         â”‚
â”‚ __thread int local_counter;  // ĞšĞ°Ğ¶Ğ´Ñ‹Ğ¹ Ğ¿Ğ¾Ñ‚Ğ¾Ğº ÑĞ²Ğ¾Ğ¹      â”‚
â”‚                                                         â”‚
â”‚ // ĞŸĞµÑ€Ğ¸Ğ¾Ğ´Ğ¸Ñ‡ĞµÑĞºĞ°Ñ ÑĞ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ                          â”‚
â”‚ void sync_counters() {                                  â”‚
â”‚     atomic_add(&global_counter, local_counter);         â”‚
â”‚     local_counter = 0;                                  â”‚
â”‚ }                                                       â”‚
â”‚                                                         â”‚
â”‚ Ğ’Ğ¸Ğ·ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ñ€ĞµÑˆĞµĞ½Ğ¸Ñ:                                   â”‚
â”‚                                                         â”‚
â”‚ Ğ”Ğ (false sharing):                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ â”‚ counter1 â”‚ counter2 â”‚ other_data â”‚ ...           â”‚    â”‚
â”‚ â”‚(Thread1) â”‚(Thread2) â”‚            â”‚               â”‚    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚   â† Cache Line 1 (64 Ğ±Ğ°Ğ¹Ñ‚Ğ°) â†’                          â”‚
â”‚                                                         â”‚
â”‚ ĞŸĞĞ¡Ğ›Ğ• (padding):                                        â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ â”‚ counter1 â”‚ padding...                            â”‚    â”‚
â”‚ â”‚(Thread1) â”‚                                       â”‚    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚   â† Cache Line 1 â†’                                      â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ â”‚ counter2 â”‚ other_data â”‚ ...                      â”‚    â”‚
â”‚ â”‚(Thread2) â”‚            â”‚                          â”‚    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚   â† Cache Line 2 â†’                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜