**Python –ø—Ä–∏–º–µ—Ä Hexagonal Architecture:**
```python
# –ü–æ—Ä—Ç—ã (–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã)
from abc import ABC, abstractmethod
from typing import List, Optional

class UserRepository(ABC):
    @abstractmethod
    def save(self, user: User) -> User:
        pass
    
    @abstractmethod
    def find_by_id(self, user_id: int) -> Optional[User]:
        pass
    
    @abstractmethod
    def find_by_email(self, email: str) -> Optional[User]:
        pass

class EmailService(ABC):
    @abstractmethod
    def send_welcome_email(self, email: str, name: str) -> bool:
        pass

class NotificationService(ABC):
    @abstractmethod
    def send_notification(self, user_id: int, message: str) -> bool:
        pass

# –î–æ–º–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å (—è–¥—Ä–æ)
class User:
    def __init__(self, email: str, name: str, user_id: int = None):
        self.id = user_id
        self.email = email
        self.name = name
        self.is_active = True
        self.created_at = None
    
    def deactivate(self):
        """–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏–∏"""
        if not self.is_active:
            raise ValueError("User is already inactive")
        self.is_active = False
    
    def update_profile(self, name: str = None, email: str = None):
        """–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è"""
        if name:
            if len(name.strip()) < 2:
                raise ValueError("Name must be at least 2 characters")
            self.name = name.strip()
        
        if email:
            if "@" not in email:
                raise ValueError("Invalid email format")
            self.email = email.lower()

# –°–µ—Ä–≤–∏—Å—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (use cases)
class UserService:
    def __init__(self, 
                 user_repository: UserRepository,
                 email_service: EmailService,
                 notification_service: NotificationService):
        self._user_repository = user_repository
        self._email_service = email_service
        self._notification_service = notification_service
    
    def register_user(self, email: str, name: str) -> User:
        """Use case: —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
        existing_user = self._user_repository.find_by_email(email)
        if existing_user:
            raise ValueError("User with this email already exists")
        
        # –°–æ–∑–¥–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        user = User(email=email, name=name)
        
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
        saved_user = self._user_repository.save(user)
        
        # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º welcome email
        self._email_service.send_welcome_email(saved_user.email, saved_user.name)
        
        # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        self._notification_service.send_notification(
            saved_user.id, 
            "Welcome to our platform!"
        )
        
        return saved_user
    
    def update_user_profile(self, user_id: int, name: str = None, email: str = None) -> User:
        """Use case: –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
        user = self._user_repository.find_by_id(user_id)
        if not user:
            raise ValueError("User not found")
        
        # –ï—Å–ª–∏ –º–µ–Ω—è–µ—Ç—Å—è email, –ø—Ä–æ–≤–µ—Ä—è–µ–º —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å
        if email and email != user.email:
            existing_user = self._user_repository.find_by_email(email)
            if existing_user:
                raise ValueError("Email already taken")
        
        # –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ—Ñ–∏–ª—å (–±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –≤ –¥–æ–º–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏)
        user.update_profile(name=name, email=email)
        
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
        updated_user = self._user_repository.save(user)
        
        return updated_user
    
    def deactivate_user(self, user_id: int) -> User:
        """Use case: –¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
        user = self._user_repository.find_by_id(user_id)
        if not user:
            raise ValueError("User not found")
        
        # –î–µ–∞–∫—Ç–∏–≤–∏—Ä—É–µ–º (–±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –≤ –¥–æ–º–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏)
        user.deactivate()
        
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
        updated_user = self._user_repository.save(user)
        
        # –£–≤–µ–¥–æ–º–ª—è–µ–º –æ –¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏–∏
        self._notification_service.send_notification(
            user.id,
            "Your account has been deactivated"
        )
        
        return updated_user

# –ê–¥–∞–ø—Ç–µ—Ä—ã (–≤–Ω–µ—à–Ω–∏–π —Å–ª–æ–π)
class SqlUserRepository(UserRepository):
    def __init__(self, db_session):
        self.db_session = db_session
    
    def save(self, user: User) -> User:
        # SQL –ª–æ–≥–∏–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
        if user.id:
            # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ
            db_user = self.db_session.query(UserModel).filter_by(id=user.id).first()
            db_user.email = user.email
            db_user.name = user.name
            db_user.is_active = user.is_active
        else:
            # –°–æ–∑–¥–∞–Ω–∏–µ
            db_user = UserModel(
                email=user.email,
                name=user.name,
                is_active=user.is_active
            )
            self.db_session.add(db_user)
        
        self.db_session.commit()
        
        # –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –æ–±—Ä–∞—Ç–Ω–æ –≤ –¥–æ–º–µ–Ω–Ω—É—é –º–æ–¥–µ–ª—å
        return User(
            email=db_user.email,
            name=db_user.name,
            user_id=db_user.id
        )
    
    def find_by_id(self, user_id: int) -> Optional[User]:
        db_user = self.db_session.query(UserModel).filter_by(id=user_id).first()
        if not db_user:
            return None
        
        return User(
            email=db_user.email,
            name=db_user.name,
            user_id=db_user.id
        )
    
    def find_by_email(self, email: str) -> Optional[User]:
        db_user = self.db_session.query(UserModel).filter_by(email=email).first()
        if not db_user:
            return None
        
        return User(
            email=db_user.email,
            name=db_user.name,
            user_id=db_user.id
        )

class SmtpEmailService(EmailService):
    def __init__(self, smtp_config):
        self.smtp_config = smtp_config
    
    def send_welcome_email(self, email: str, name: str) -> bool:
        try:
            # SMTP –ª–æ–≥–∏–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏
            subject = f"Welcome, {name}!"
            body = f"Hello {name}, welcome to our platform!"
            
            # –ó–¥–µ—Å—å –∫–æ–¥ –æ—Ç–ø—Ä–∞–≤–∫–∏ —á–µ—Ä–µ–∑ SMTP
            return True
        except Exception:
            return False

class PushNotificationService(NotificationService):
    def __init__(self, push_service_url):
        self.push_service_url = push_service_url
    
    def send_notification(self, user_id: int, message: str) -> bool:
        try:
            # –õ–æ–≥–∏–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ push —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
            payload = {
                "user_id": user_id,
                "message": message
            }
            # HTTP –∑–∞–ø—Ä–æ—Å –∫ —Å–µ—Ä–≤–∏—Å—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
            return True
        except Exception:
            return False

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ–º–µ–Ω–Ω–æ–π –ª–æ–≥–∏–∫–∏ (–∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ)
class TestUserDomainLogic:
    def test_user_deactivation(self):
        """–¢–µ—Å—Ç–∏—Ä—É–µ–º —á–∏—Å—Ç—É—é –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É –±–µ–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π"""
        user = User(email="test@example.com", name="Test User", user_id=1)
        
        # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–∫—Ç–∏–≤–µ–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
        assert user.is_active is True
        
        # –î–µ–∞–∫—Ç–∏–≤–∏—Ä—É–µ–º
        user.deactivate()
        assert user.is_active is False
        
        # –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –≤—ã–∑–≤–∞—Ç—å –æ—à–∏–±–∫—É
        with pytest.raises(ValueError, match="already inactive"):
            user.deactivate()
    
    def test_user_profile_update_validation(self):
        """–¢–µ—Å—Ç–∏—Ä—É–µ–º –≤–∞–ª–∏–¥–∞—Ü–∏—é –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è"""
        user = User(email="test@example.com", name="Test User")
        
        # –í–∞–ª–∏–¥–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
        user.update_profile(name="New Name", email="new@example.com")
        assert user.name == "New Name"
        assert user.email == "new@example.com"
        
        # –ù–µ–≤–∞–ª–∏–¥–Ω–æ–µ –∏–º—è
        with pytest.raises(ValueError, match="at least 2 characters"):
            user.update_profile(name="A")
        
        # –ù–µ–≤–∞–ª–∏–¥–Ω—ã–π email
        with pytest.raises(ValueError, match="Invalid email format"):
            user.update_profile(email="invalid-email")

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å –º–æ–∫–∞–º–∏
class TestUserService:
    @pytest.fixture
    def mock_dependencies(self):
        return {
            'user_repository': Mock(spec=UserRepository),
            'email_service': Mock(spec=EmailService), 
            'notification_service': Mock(spec=NotificationService)
        }
    
    @pytest.fixture
    def user_service(self, mock_dependencies):
        return UserService(**mock_dependencies)
    
    def test_register_user_success(self, user_service, mock_dependencies):
        """–¢–µ—Å—Ç–∏—Ä—É–µ–º —É—Å–ø–µ—à–Ω—É—é —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
        # Arrange
        mock_dependencies['user_repository'].find_by_email.return_value = None
        mock_dependencies['user_repository'].save.return_value = User(
            email="test@example.com", 
            name="Test User", 
            user_id=1
        )
        mock_dependencies['email_service'].send_welcome_email.return_value = True
        mock_dependencies['notification_service'].send_notification.return_value = True
        
        # Act
        user = user_service.register_user("test@example.com", "Test User")
        
        # Assert
        assert user.email == "test@example.com"
        assert user.name == "Test User"
        assert user.id == 1
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—ã–∑–æ–≤—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
        mock_dependencies['user_repository'].find_by_email.assert_called_once_with("test@example.com")
        mock_dependencies['user_repository'].save.assert_called_once()
        mock_dependencies['email_service'].send_welcome_email.assert_called_once_with("test@example.com", "Test User")
        mock_dependencies['notification_service'].send_notification.assert_called_once()
    
    def test_register_user_duplicate_email(self, user_service, mock_dependencies):
        """–¢–µ—Å—Ç–∏—Ä—É–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º email"""
        # Arrange
        existing_user = User(email="test@example.com", name="Existing User", user_id=999)
        mock_dependencies['user_repository'].find_by_email.return_value = existing_user
        
        # Act & Assert
        with pytest.raises(ValueError, match="already exists"):
            user_service.register_user("test@example.com", "Test User")
        
        # Email —Å–µ—Ä–≤–∏—Å –Ω–µ –¥–æ–ª–∂–µ–Ω –≤—ã–∑—ã–≤–∞—Ç—å—Å—è
        mock_dependencies['email_service'].send_welcome_email.assert_not_called()
    
    def test_update_user_profile_success(self, user_service, mock_dependencies):
        """–¢–µ—Å—Ç–∏—Ä—É–µ–º —É—Å–ø–µ—à–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è"""
        # Arrange
        existing_user = User(email="old@example.com", name="Old Name", user_id=1)
        mock_dependencies['user_repository'].find_by_id.return_value = existing_user
        mock_dependencies['user_repository'].find_by_email.return_value = None  # Email —Å–≤–æ–±–æ–¥–µ–Ω
        
        updated_user = User(email="new@example.com", name="New Name", user_id=1)
        mock_dependencies['user_repository'].save.return_value = updated_user
        
        # Act
        result = user_service.update_user_profile(1, name="New Name", email="new@example.com")
        
        # Assert
        assert result.name == "New Name"
        assert result.email == "new@example.com"
        mock_dependencies['user_repository'].save.assert_called_once()

# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –∞–¥–∞–ø—Ç–µ—Ä–∞–º–∏
class TestUserServiceIntegration:
    @pytest.fixture
    def real_dependencies(self, db_session):
        return {
            'user_repository': SqlUserRepository(db_session),
            'email_service': Mock(spec=EmailService),  # –ú–æ–∫–∞–µ–º –≤–Ω–µ—à–Ω–∏–µ —Å–µ—Ä–≤–∏—Å—ã
            'notification_service': Mock(spec=NotificationService)
        }
    
    @pytest.fixture
    def user_service(self, real_dependencies):
        return UserService(**real_dependencies)
    
    def test_user_registration_end_to_end(self, user_service, real_dependencies):
        """–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Å —Ä–µ–∞–ª—å–Ω–æ–π –ë–î"""
        # Arrange
        real_dependencies['email_service'].send_welcome_email.return_value = True
        real_dependencies['notification_service'].send_notification.return_value = True
        
        # Act
        user = user_service.register_user("integration@example.com", "Integration User")
        
        # Assert
        assert user.id is not None
        assert user.email == "integration@example.com"
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ –ë–î
        found_user = real_dependencies['user_repository'].find_by_id(user.id)
        assert found_user is not None
        assert found_user.email == "integration@example.com"
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –≤–Ω–µ—à–Ω–∏–µ —Å–µ—Ä–≤–∏—Å—ã –±—ã–ª–∏ –≤—ã–∑–≤–∞–Ω—ã
        real_dependencies['email_service'].send_welcome_email.assert_called_once()
```

**Go –ø—Ä–∏–º–µ—Ä —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã:**
```go
// –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã (–ø–æ—Ä—Ç—ã)
package domain

import "context"

type User struct {
    ID       int    `json:"id"`
    Email    string `json:"email"`
    Name     string `json:"name"`
    IsActive bool   `json:"is_active"`
}

type UserRepository interface {
    Save(ctx context.Context, user *User) (*User, error)
    FindByID(ctx context.Context, id int) (*User, error)
    FindByEmail(ctx context.Context, email string) (*User, error)
}

type EmailService interface {
    SendWelcomeEmail(ctx context.Context, email, name string) error
}

type NotificationService interface {
    SendNotification(ctx context.Context, userID int, message string) error
}

// –î–æ–º–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞
func (u *User) Deactivate() error {
    if !u.IsActive {
        return errors.New("user is already inactive")
    }
    u.IsActive = false
    return nil
}

func (u *User) UpdateProfile(name, email string) error {
    if name != "" {
        if len(strings.TrimSpace(name)) < 2 {
            return errors.New("name must be at least 2 characters")
        }
        u.Name = strings.TrimSpace(name)
    }
    
    if email != "" {
        if !strings.Contains(email, "@") {
            return errors.New("invalid email format")
        }
        u.Email = strings.ToLower(email)
    }
    
    return nil
}

// –°–µ—Ä–≤–∏—Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
type UserService struct {
    userRepo     UserRepository
    emailSvc     EmailService
    notifSvc     NotificationService
}

func NewUserService(userRepo UserRepository, emailSvc EmailService, notifSvc NotificationService) *UserService {
    return &UserService{
        userRepo: userRepo,
        emailSvc: emailSvc,
        notifSvc: notifSvc,
    }
}

func (s *UserService) RegisterUser(ctx context.Context, email, name string) (*User, error) {
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    existingUser, err := s.userRepo.FindByEmail(ctx, email)
    if err != nil {
        return nil, fmt.Errorf("failed to check existing user: %w", err)
    }
    if existingUser != nil {
        return nil, errors.New("user with this email already exists")
    }
    
    // –°–æ–∑–¥–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    user := &User{
        Email:    email,
        Name:     name,
        IsActive: true,
    }
    
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º
    savedUser, err := s.userRepo.Save(ctx, user)
    if err != nil {
        return nil, fmt.Errorf("failed to save user: %w", err)
    }
    
    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º welcome email (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è —É—Å–ø–µ—Ö–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏)
    if err := s.emailSvc.SendWelcomeEmail(ctx, savedUser.Email, savedUser.Name); err != nil {
        // –õ–æ–≥–∏—Ä—É–µ–º –æ—à–∏–±–∫—É, –Ω–æ –Ω–µ –ø—Ä–µ—Ä—ã–≤–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
        log.Printf("Failed to send welcome email: %v", err)
    }
    
    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
    if err := s.notifSvc.SendNotification(ctx, savedUser.ID, "Welcome to our platform!"); err != nil {
        log.Printf("Failed to send notification: %v", err)
    }
    
    return savedUser, nil
}

func (s *UserService) UpdateUserProfile(ctx context.Context, userID int, name, email string) (*User, error) {
    user, err := s.userRepo.FindByID(ctx, userID)
    if err != nil {
        return nil, fmt.Errorf("failed to find user: %w", err)
    }
    if user == nil {
        return nil, errors.New("user not found")
    }
    
    // –ï—Å–ª–∏ –º–µ–Ω—è–µ—Ç—Å—è email, –ø—Ä–æ–≤–µ—Ä—è–µ–º —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å
    if email != "" && email != user.Email {
        existingUser, err := s.userRepo.FindByEmail(ctx, email)
        if err != nil {
            return nil, fmt.Errorf("failed to check email uniqueness: %w", err)
        }
        if existingUser != nil {
            return nil, errors.New("email already taken")
        }
    }
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ—Ñ–∏–ª—å (–¥–æ–º–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞)
    if err := user.UpdateProfile(name, email); err != nil {
        return nil, fmt.Errorf("profile update failed: %w", err)
    }
    
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
    updatedUser, err := s.userRepo.Save(ctx, user)
    if err != nil {
        return nil, fmt.Errorf("failed to save updated user: %w", err)
    }
    
    return updatedUser, nil
}

// –¢–µ—Å—Ç—ã –¥–æ–º–µ–Ω–Ω–æ–π –ª–æ–≥–∏–∫–∏
func TestUserDomainLogic(t *testing.T) {
    t.Run("User deactivation", func(t *testing.T) {
        user := &User{
            ID:       1,
            Email:    "test@example.com",
            Name:     "Test User",
            IsActive: true,
        }
        
        // –î–µ–∞–∫—Ç–∏–≤–∏—Ä—É–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        err := user.Deactivate()
        assert.NoError(t, err)
        assert.False(t, user.IsActive)
        
        // –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –≤—ã–∑–≤–∞—Ç—å –æ—à–∏–±–∫—É
        err = user.Deactivate()
        assert.Error(t, err)
        assert.Contains(t, err.Error(), "already inactive")
    })
    
    t.Run("Profile update validation", func(t *testing.T) {
        user := &User{
            Email: "test@example.com",
            Name:  "Test User",
        }
        
        // –í–∞–ª–∏–¥–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
        err := user.UpdateProfile("New Name", "new@example.com")
        assert.NoError(t, err)
        assert.Equal(t, "New Name", user.Name)
        assert.Equal(t, "new@example.com", user.Email)
        
        // –ù–µ–≤–∞–ª–∏–¥–Ω–æ–µ –∏–º—è
        err = user.UpdateProfile("A", "")
        assert.Error(t, err)
        assert.Contains(t, err.Error(), "at least 2 characters")
        
        // –ù–µ–≤–∞–ª–∏–¥–Ω—ã–π email
        err = user.UpdateProfile("", "invalid-email")
        assert.Error(t, err)
        assert.Contains(t, err.Error(), "invalid email format")
    })
}

// –ú–æ–∫–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
type MockUserRepository struct {
    mock.Mock
}

func (m *MockUserRepository) Save(ctx context.Context, user *User) (*User, error) {
    args := m.Called(ctx, user)
    if args.Get(0) == nil {
        return nil, args.Error(1)
    }
    return args.Get(0).(*User), args.Error(1)
}

func (m *MockUserRepository) FindByID(ctx context.Context, id int) (*User, error) {
    args := m.Called(ctx, id)
    if args.Get(0) == nil {
        return nil, args.Error(1)
    }
    return args.Get(0).(*User), args.Error(1)
}

func (m *MockUserRepository) FindByEmail(ctx context.Context, email string) (*User, error) {
    args := m.Called(ctx, email)
    if args.Get(0) == nil {
        return nil, args.Error(1)
    }
    return args.Get(0).(*User), args.Error(1)
}

type MockEmailService struct {
    mock.Mock
}

func (m *MockEmailService) SendWelcomeEmail(ctx context.Context, email, name string) error {
    args := m.Called(ctx, email, name)
    return args.Error(0)
}

type MockNotificationService struct {
    mock.Mock
}

func (m *MockNotificationService) SendNotification(ctx context.Context, userID int, message string) error {
    args := m.Called(ctx, userID, message)
    return args.Error(0)
}

// –¢–µ—Å—Ç—ã —Å–µ—Ä–≤–∏—Å–∞ —Å –º–æ–∫–∞–º–∏
func TestUserService(t *testing.T) {
    setup := func() (*UserService, *MockUserRepository, *MockEmailService, *MockNotificationService) {
        mockRepo := new(MockUserRepository)
        mockEmail := new(MockEmailService)
        mockNotif := new(MockNotificationService)
        
        service := NewUserService(mockRepo, mockEmail, mockNotif)
        return service, mockRepo, mockEmail, mockNotif
    }
    
    t.Run("Register user success", func(t *testing.T) {
        service, mockRepo, mockEmail, mockNotif := setup()
        ctx := context.Background()
        
        // Arrange
        mockRepo.On("FindByEmail", ctx, "test@example.com").Return((*User)(nil), nil)
        expectedUser := &User{ID: 1, Email: "test@example.com", Name: "Test User", IsActive: true}
        mockRepo.On("Save", ctx, mock.AnythingOfType("*domain.User")).Return(expectedUser, nil)
        mockEmail.On("SendWelcomeEmail", ctx, "test@example.com", "Test User").Return(nil)
        mockNotif.On("SendNotification", ctx, 1, "Welcome to our platform!").Return(nil)
        
        // Act
        user, err := service.RegisterUser(ctx, "test@example.com", "Test User")
        
        // Assert
        assert.NoError(t, err)
        assert.Equal(t, 1, user.ID)
        assert.Equal(t, "test@example.com", user.Email)
        assert.Equal(t, "Test User", user.Name)
        assert.True(t, user.IsActive)
        
        mockRepo.AssertExpectations(t)
        mockEmail.AssertExpectations(t)
        mockNotif.AssertExpectations(t)
    })
    
    t.Run("Register user with duplicate email", func(t *testing.T) {
        service, mockRepo, mockEmail, mockNotif := setup()
        ctx := context.Background()
        
        // Arrange
        existingUser := &User{ID: 999, Email: "test@example.com", Name: "Existing User"}
        mockRepo.On("FindByEmail", ctx, "test@example.com").Return(existingUser, nil)
        
        // Act
        user, err := service.RegisterUser(ctx, "test@example.com", "Test User")
        
        // Assert
        assert.Error(t, err)
        assert.Nil(t, user)
        assert.Contains(t, err.Error(), "already exists")
        
        // Email –∏ notification —Å–µ—Ä–≤–∏—Å—ã –Ω–µ –¥–æ–ª–∂–Ω—ã –≤—ã–∑—ã–≤–∞—Ç—å—Å—è
        mockEmail.AssertNotCalled(t, "SendWelcomeEmail")
        mockNotif.AssertNotCalled(t, "SendNotification")
    })
    
    t.Run("Update user profile success", func(t *testing.T) {
        service, mockRepo, mockEmail, mockNotif := setup()
        ctx := context.Background()
        
        // Arrange
        existingUser := &User{ID: 1, Email: "old@example.com", Name: "Old Name", IsActive: true}
        mockRepo.On("FindByID", ctx, 1).Return(existingUser, nil)
        mockRepo.On("FindByEmail", ctx, "new@example.com").Return((*User)(nil), nil)
        
        updatedUser := &User{ID: 1, Email: "new@example.com", Name: "New Name", IsActive: true}
        mockRepo.On("Save", ctx, mock.AnythingOfType("*domain.User")).Return(updatedUser, nil)
        
        // Act
        user, err := service.UpdateUserProfile(ctx, 1, "New Name", "new@example.com")
        
        // Assert
        assert.NoError(t, err)
        assert.Equal(t, "New Name", user.Name)
        assert.Equal(t, "new@example.com", user.Email)
        
        mockRepo.AssertExpectations(t)
    })
}

// –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
func TestUserServiceIntegration(t *testing.T) {
    // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
    testDB := setupTestDatabase(t)
    defer testDB.Cleanup(t)
    
    // –†–µ–∞–ª—å–Ω—ã–µ –∞–¥–∞–ø—Ç–µ—Ä—ã
    realRepo := NewSQLUserRepository(testDB.DB)
    mockEmail := new(MockEmailService)
    mockNotif := new(MockNotificationService)
    
    service := NewUserService(realRepo, mockEmail, mockNotif)
    
    t.Run("End-to-end user registration", func(t *testing.T) {
        ctx := context.Background()
        
        // Arrange
        mockEmail.On("SendWelcomeEmail", ctx, "integration@example.com", "Integration User").Return(nil)
        mockNotif.On("SendNotification", ctx, mock.AnythingOfType("int"), "Welcome to our platform!").Return(nil)
        
        // Act
        user, err := service.RegisterUser(ctx, "integration@example.com", "Integration User")
        
        // Assert
        assert.NoError(t, err)
        assert.NotZero(t, user.ID)
        assert.Equal(t, "integration@example.com", user.Email)
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ –ë–î
        foundUser, err := realRepo.FindByID(ctx, user.ID)
        assert.NoError(t, err)
        assert.NotNil(t, foundUser)
        assert.Equal(t, "integration@example.com", foundUser.Email)
        
        mockEmail.AssertExpectations(t)
        mockNotif.AssertExpectations(t)
    })
}
```

### üîß Legacy –∫–æ–¥ –∏ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è —Ä–∞–±–æ—Ç—ã —Å legacy –∫–æ–¥–æ–º:**
```
1. Characterization Tests ‚Üí –ü–æ–∫—Ä—ã–≤–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ
2. Seam identification ‚Üí –ù–∞—Ö–æ–¥–∏–º —Ç–æ—á–∫–∏ –¥–ª—è –≤–Ω–µ–¥—Ä–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤
3. Strangler Fig ‚Üí –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –∑–∞–º–µ–Ω—è–µ–º —Å—Ç–∞—Ä—ã–π –∫–æ–¥
4. Golden Master ‚Üí –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â–∏–π –≤—ã–≤–æ–¥ –∫–∞–∫ —ç—Ç–∞–ª–æ–Ω
```

**Python Legacy –∫–æ–¥ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
```python
# legacy_system.py - —Å—Ç–∞—Ä—ã–π –º–æ–Ω–æ–ª–∏—Ç–Ω—ã–π –∫–æ–¥ –±–µ–∑ —Ç–µ—Å—Ç–æ–≤
class LegacyOrderProcessor:
    """–°—Ç–∞—Ä—ã–π –∫–æ–¥ –±–µ–∑ —Ç–µ—Å—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–π –Ω—É–∂–Ω–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å"""
    
    def __init__(self):
        self.db_connection = None
        self.email_client = None
        self.payment_gateway = None
    
    def process_order(self, order_data):
        """–û–≥—Ä–æ–º–Ω—ã–π –º–µ—Ç–æ–¥ –∫–æ—Ç–æ—Ä—ã–π –¥–µ–ª–∞–µ—Ç –≤—Å–µ"""
        try:
            # –í–∞–ª–∏–¥–∞—Ü–∏—è –∑–∞–∫–∞–∑–∞ (—Å–º–µ—à–∞–Ω–∞ —Å –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–æ–π)
            if not order_data.get('customer_id'):
                return {'error': 'Missing customer ID', 'status': 'failed'}
            
            if not order_data.get('items') or len(order_data['items']) == 0:
                return {'error': 'No items in order', 'status': 'failed'}
            
            # –†–∞—Å—á–µ—Ç —Ü–µ–Ω—ã (—Å–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞)
            total_price = 0
            for item in order_data['items']:
                base_price = item['price'] * item['quantity']
                
                # –°–∫–∏–¥–∫–∏ (—Ö–∞—Ä–¥–∫–æ–¥)
                if item['category'] == 'electronics':
                    discount = 0.1 if base_price > 1000 else 0.05
                elif item['category'] == 'books':
                    discount = 0.15 if item['quantity'] > 5 else 0.1
                else:
                    discount = 0.05
                
                # –ù–∞–ª–æ–≥–∏ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–µ–≥–∏–æ–Ω–∞)
                customer_region = self._get_customer_region(order_data['customer_id'])
                if customer_region == 'CA':
                    tax_rate = 0.13
                elif customer_region == 'NY':
                    tax_rate = 0.08
                else:
                    tax_rate = 0.06
                
                item_total = base_price * (1 - discount) * (1 + tax_rate)
                total_price += item_total
            
            # –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–∞ (–≤–Ω–µ—à–Ω–∏–π —Å–µ—Ä–≤–∏—Å)
            payment_result = self._process_payment(order_data['customer_id'], total_price)
            if not payment_result['success']:
                return {'error': 'Payment failed', 'status': 'payment_failed'}
            
            # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –±–∞–∑—É (–ø—Ä—è–º—ã–µ SQL –∑–∞–ø—Ä–æ—Å—ã)
            order_id = self._save_order_to_database(order_data, total_price, payment_result['transaction_id'])
            
            # –û—Ç–ø—Ä–∞–≤–∫–∞ email (–∂–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–æ)
            self._send_confirmation_email(order_data['customer_id'], order_id, total_price)
            
            # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
            self._update_inventory(order_data['items'])
            
            return {
                'status': 'success',
                'order_id': order_id,
                'total_price': total_price,
                'transaction_id': payment_result['transaction_id']
            }
            
        except Exception as e:
            # –ü–ª–æ—Ö–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
            return {'error': str(e), 'status': 'error'}
    
    def _get_customer_region(self, customer_id):
        # –ü—Ä—è–º–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ –ë–î
        cursor = self.db_connection.cursor()
        cursor.execute("SELECT region FROM customers WHERE id = %s", (customer_id,))
        result = cursor.fetchone()
        return result[0] if result else 'US'
    
    def _process_payment(self, customer_id, amount):
        # –í—ã–∑–æ–≤ –≤–Ω–µ—à–Ω–µ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
        import requests
        response = requests.post('https://payment-gateway.com/charge', {
            'customer_id': customer_id,
            'amount': amount
        })
        return response.json()
    
    def _save_order_to_database(self, order_data, total_price, transaction_id):
        # –ü—Ä—è–º—ã–µ SQL –∑–∞–ø—Ä–æ—Å—ã
        cursor = self.db_connection.cursor()
        cursor.execute("""
            INSERT INTO orders (customer_id, total_price, transaction_id, status)
            VALUES (%s, %s, %s, 'confirmed')
            RETURNING id
        """, (order_data['customer_id'], total_price, transaction_id))
        
        order_id = cursor.fetchone()[0]
        
        for item in order_data['items']:
            cursor.execute("""
                INSERT INTO order_items (order_id, product_id, quantity, price)
                VALUES (%s, %s, %s, %s)
            """, (order_id, item['product_id'], item['quantity'], item['price']))
        
        self.db_connection.commit()
        return order_id
    
    def _send_confirmation_email(self, customer_id, order_id, total_price):
        # –ñ–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ email
        pass
    
    def _update_inventory(self, items):
        # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Å—Ç–∞—Ç–∫–æ–≤ —Ç–æ–≤–∞—Ä–∞
        cursor = self.db_connection.cursor()
        for item in items:
            cursor.execute("""
                UPDATE products SET stock = stock - %s WHERE id = %s
            """, (item['quantity'], item['product_id']))
        self.db_connection.commit()

# –®–∞–≥ 1: Characterization Tests (–ø–æ–∫—Ä—ã–≤–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ)
class TestLegacyOrderProcessorCharacterization:
    """–¢–µ—Å—Ç—ã –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É—é—Ç —Ç–µ–∫—É—â–µ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã"""
    
    @pytest.fixture
    def legacy_processor(self):
        processor = LegacyOrderProcessor()
        # –ú–æ–∫–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏
        processor.db_connection = Mock()
        processor.email_client = Mock()
        processor.payment_gateway = Mock()
        return processor
    
    def test_valid_order_processing_golden_master(self, legacy_processor):
        """Golden master test - —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫–∞–∫ —ç—Ç–∞–ª–æ–Ω"""
        # Arrange
        order_data = {
            'customer_id': 123,
            'items': [
                {
                    'product_id': 1,
                    'price': 100.0,
                    'quantity': 2,
                    'category': 'electronics'
                },
                {
                    'product_id': 2,
                    'price': 50.0,
                    'quantity': 1,
                    'category': 'books'
                }
            ]
        }
        
        # –ú–æ–∫–∞–µ–º –≤–Ω–µ—à–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
        legacy_processor._get_customer_region = Mock(return_value='CA')
        legacy_processor._process_payment = Mock(return_value={
            'success': True,
            'transaction_id': 'txn_12345'
        })
        legacy_processor._save_order_to_database = Mock(return_value=999)
        legacy_processor._send_confirmation_email = Mock()
        legacy_processor._update_inventory = Mock()
        
        # Act
        result = legacy_processor.process_order(order_data)
        
        # Assert - —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫–∞–∫ "–∑–æ–ª–æ—Ç–æ–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç"
        expected_result = {
            'status': 'success',
            'order_id': 999,
            'total_price': 237.825,  # –¢–æ—á–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ—Å–ª–µ –≤—Å–µ—Ö —Ä–∞—Å—á–µ—Ç–æ–≤
            'transaction_id': 'txn_12345'
        }
        
        assert result == expected_result
    
    def test_edge_cases_characterization(self, legacy_processor):
        """–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–µ–º –≥—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏"""
        test_cases = [
            # –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–π customer_id
            ({}, {'error': 'Missing customer ID', 'status': 'failed'}),
            
            # –ü—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤
            ({'customer_id': 123, 'items': []}, 
             {'error': 'No items in order', 'status': 'failed'}),
            
            # –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ —Ç–æ–≤–∞—Ä—ã
            ({'customer_id': 123}, 
             {'error': 'No items in order', 'status': 'failed'}),
        ]
        
        for order_data, expected_result in test_cases:
            result = legacy_processor.process_order(order_data)
            assert result == expected_result, f"Failed for input: {order_data}"
    
    @pytest.mark.parametrize("region,expected_tax_rate", [
        ('CA', 0.13),
        ('NY', 0.08),
        ('TX', 0.06),  # default case
        ('', 0.06),    # empty region
    ])
    def test_tax_calculation_by_region(self, legacy_processor, region, expected_tax_rate):
        """–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–µ–º –ª–æ–≥–∏–∫—É –Ω–∞–ª–æ–≥–æ–æ–±–ª–æ–∂–µ–Ω–∏—è"""
        order_data = {
            'customer_id': 123,
            'items': [{'product_id': 1, 'price': 100.0, 'quantity': 1, 'category': 'other'}]
        }
        
        legacy_processor._get_customer_region = Mock(return_value=region)
        legacy_processor._process_payment = Mock(return_value={'success': True, 'transaction_id': 'test'})
        legacy_processor._save_order_to_database = Mock(return_value=1)
        legacy_processor._send_confirmation_email = Mock()
        legacy_processor._update_inventory = Mock()
        
        result = legacy_processor.process_order(order_data)
        
        # –í—ã—á–∏—Å–ª—è–µ–º –æ–∂–∏–¥–∞–µ–º—É—é —Ü–µ–Ω—É: 100 * 0.95 (—Å–∫–∏–¥–∫–∞ 5%) * (1 + tax_rate)
        expected_price = 100 * 0.95 * (1 + expected_tax_rate)
        assert abs(result['total_price'] - expected_price) < 0.01

# –®–∞–≥ 2: –í—ã–¥–µ–ª–µ–Ω–∏–µ Seam'–æ–≤ –¥–ª—è —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞
class OrderCalculator:
    """–í—ã–¥–µ–ª—è–µ–º –ª–æ–≥–∏–∫—É —Ä–∞—Å—á–µ—Ç–æ–≤ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–ª–∞—Å—Å"""
    
    @staticmethod
    def calculate_item_discount(item):
        """–ò–∑–≤–ª–µ–∫–∞–µ–º –ª–æ–≥–∏–∫—É —Å–∫–∏–¥–æ–∫"""
        base_price = item['price'] * item['quantity']
        
        if item['category'] == 'electronics':
            return 0.1 if base_price > 1000 else 0.05
        elif item['category'] == 'books':
            return 0.15 if item['quantity'] > 5 else 0.1
        else:
            return 0.05
    
    @staticmethod
    def calculate_tax_rate(region):
        """–ò–∑–≤–ª–µ–∫–∞–µ–º –ª–æ–≥–∏–∫—É –Ω–∞–ª–æ–≥–æ–≤"""
        tax_rates = {
            'CA': 0.13,
            'NY': 0.08
        }
        return tax_rates.get(region, 0.06)
    
    @staticmethod
    def calculate_total_price(items, customer_region):
        """–ò–∑–≤–ª–µ–∫–∞–µ–º –æ–±—â—É—é –ª–æ–≥–∏–∫—É —Ä–∞—Å—á–µ—Ç–∞"""
        total_price = 0
        tax_rate = OrderCalculator.calculate_tax_rate(customer_region)
        
        for item in items:
            base_price = item['price'] * item['quantity']
            discount = OrderCalculator.calculate_item_discount(item)
            item_total = base_price * (1 - discount) * (1 + tax_rate)
            total_price += item_total
        
        return total_price

# –®–∞–≥ 3: –¢–µ—Å—Ç–∏—Ä—É–µ–º –Ω–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ
class TestOrderCalculator:
    """–¢–µ—Å—Ç–∏—Ä—É–µ–º –∏–∑–≤–ª–µ—á–µ–Ω–Ω—É—é –ª–æ–≥–∏–∫—É"""
    
    def test_item_discount_calculation(self):
        """–¢–µ—Å—Ç–∏—Ä—É–µ–º –ª–æ–≥–∏–∫—É —Å–∫–∏–¥–æ–∫"""
        test_cases = [
            # Electronics
            ({'price': 100, 'quantity': 20, 'category': 'electronics'}, 0.1),  # > 1000
            ({'price': 100, 'quantity': 5, 'category': 'electronics'}, 0.05),   # <= 1000
            
            # Books
            ({'price': 10, 'quantity': 10, 'category': 'books'}, 0.15),  # > 5 qty
            ({'price': 10, 'quantity': 3, 'category': 'books'}, 0.1),    # <= 5 qty
            
            # Other
            ({'price': 50, 'quantity': 1, 'category': 'other'}, 0.05),
        ]
        
        for item, expected_discount in test_cases:
            discount = OrderCalculator.calculate_item_discount(item)
            assert discount == expected_discount
    
    def test_tax_rate_calculation(self):
        """–¢–µ—Å—Ç–∏—Ä—É–µ–º —Ä–∞—Å—á–µ—Ç –Ω–∞–ª–æ–≥–æ–≤"""
        assert OrderCalculator.calculate_tax_rate('CA') == 0.13
        assert OrderCalculator.calculate_tax_rate('NY') == 0.08
        assert OrderCalculator.calculate_tax_rate('TX') == 0.06  # default
        assert OrderCalculator.calculate_tax_rate('') == 0.06    # default
    
    def test_total_price_calculation(self):
        """–¢–µ—Å—Ç–∏—Ä—É–µ–º –æ–±—â–∏–π —Ä–∞—Å—á–µ—Ç —Ü–µ–Ω—ã"""
        items = [
            {'price': 100, 'quantity': 1, 'category': 'electronics'},
            {'price': 20, 'quantity': 2, 'category': 'books'}
        ]
        
        total = OrderCalculator.calculate_total_price(items, 'CA')
        
        # Electronics: 100 * 0.95 * 1.13 = 107.35
        # Books: 40 * 0.9 * 1.13 = 40.68
        # Total: 148.03
        expected_total = 107.35 + 40.68
        assert abs(total - expected_total) < 0.01

# –®–∞–≥ 4: –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–∞—è –∑–∞–º–µ–Ω–∞ (Strangler Fig)
class RefactoredOrderProcessor:
    """–ù–æ–≤–∞—è –≤–µ—Ä—Å–∏—è —Å —É–ª—É—á—à–µ–Ω–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π"""
    
    def __init__(self, customer_repo, payment_service, order_repo, email_service, inventory_service):
        self.customer_repo = customer_repo
        self.payment_service = payment_service
        self.order_repo = order_repo
        self.email_service = email_service
        self.inventory_service = inventory_service
        self.calculator = OrderCalculator()
    
    def process_order(self, order_data):
        """–†–µ—Ñ–∞–∫—Ç–æ—Ä–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è —Å —á–µ—Ç–∫–∏–º —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏"""
        try:
            # –í–∞–ª–∏–¥–∞—Ü–∏—è
            validation_result = self._validate_order(order_data)
            if not validation_result['valid']:
                return {'error': validation_result['error'], 'status': 'failed'}
            
            # –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–∞
            customer = self.customer_repo.find_by_id(order_data['customer_id'])
            if not customer:
                return {'error': 'Customer not found', 'status': 'failed'}
            
            # –†–∞—Å—á–µ—Ç —Ü–µ–Ω—ã
            total_price = self.calculator.calculate_total_price(
                order_data['items'], 
                customer.region
            )
            
            # –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–∞
            payment_result = self.payment_service.process_payment(
                customer.id, 
                total_price
            )
            if not payment_result.success:
                return {'error': 'Payment failed', 'status': 'payment_failed'}
            
            # –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞
            order = self.order_repo.create_order(
                customer_id=customer.id,
                items=order_data['items'],
                total_price=total_price,
                transaction_id=payment_result.transaction_id
            )
            
            # –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
            self.email_service.send_order_confirmation(customer.email, order)
            
            # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
            self.inventory_service.reserve_items(order_data['items'])
            
            return {
                'status': 'success',
                'order_id': order.id,
                'total_price': total_price,
                'transaction_id': payment_result.transaction_id
            }
            
        except Exception as e:
            # –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
            logger.error(f"Order processing failed: {e}")
            return {'error': 'Internal error', 'status': 'error'}
    
    def _validate_order(self, order_data):
        """–í—ã–¥–µ–ª–µ–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è"""
        if not order_data.get('customer_id'):
            return {'valid': False, 'error': 'Missing customer ID'}
        
        if not order_data.get('items') or len(order_data['items']) == 0:
            return {'valid': False, 'error': 'No items in order'}
        
        return {'valid': True}

# –®–∞–≥ 5: –ú–∏–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã (–ø—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å)
class TestLegacyToRefactoredMigration:
    """–ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è –≤–µ–¥–µ—Ç —Å–µ–±—è —Ç–∞–∫–∂–µ –∫–∞–∫ —Å—Ç–∞—Ä–∞—è"""
    
    @pytest.fixture
    def comparable_processors(self):
        """–°–æ–∑–¥–∞–µ–º —Å—Ä–∞–≤–Ω–∏–º—ã–µ –≤–µ—Ä—Å–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–≤"""
        # Legacy processor —Å –º–æ–∫–∞–º–∏
        legacy = LegacyOrderProcessor()
        legacy.db_connection = Mock()
        
        # Refactored processor —Å –º–æ–∫–∞–º–∏
        customer_repo = Mock()
        customer_repo.find_by_id.return_value = Mock(id=123, region='CA', email='test@example.com')
        
        payment_service = Mock()
        payment_service.process_payment.return_value = Mock(
            success=True, 
            transaction_id='txn_12345'
        )
        
        order_repo = Mock()
        order_repo.create_order.return_value = Mock(id=999)
        
        email_service = Mock()
        inventory_service = Mock()
        
        refactored = RefactoredOrderProcessor(
            customer_repo, payment_service, order_repo, email_service, inventory_service
        )
        
        return legacy, refactored
    
    def test_behavior_parity(self, comparable_processors):
        """–ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–¥–µ–Ω—Ç–∏—á–Ω—ã"""
        legacy, refactored = comparable_processors
        
        # –ú–æ–∫–∞–µ–º –º–µ—Ç–æ–¥—ã legacy –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç–∏
        legacy._get_customer_region = Mock(return_value='CA')
        legacy._process_payment = Mock(return_value={
            'success': True,
            'transaction_id': 'txn_12345'
        })
        legacy._save_order_to_database = Mock(return_value=999)
        legacy._send_confirmation_email = Mock()
        legacy._update_inventory = Mock()
        
        order_data = {
            'customer_id': 123,
            'items': [
                {'product_id': 1, 'price': 100.0, 'quantity': 1, 'category': 'electronics'}
            ]
        }
        
        # –í—ã–ø–æ–ª–Ω—è–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É –≤ –æ–±–µ–∏—Ö –≤–µ—Ä—Å–∏—è—Ö
        legacy_result = legacy.process_order(order_data)
        refactored_result = refactored.process_order(order_data)
        
        # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∏–¥–µ–Ω—Ç–∏—á–Ω—ã–º–∏
        assert legacy_result['status'] == refactored_result['status']
        assert legacy_result['order_id'] == refactored_result['order_id']
        assert abs(legacy_result['total_price'] - refactored_result['total_price']) < 0.01
        assert legacy_result['transaction_id'] == refactored_result['transaction_id']
```

### üë• –ö–æ–º–∞–Ω–¥–Ω—ã–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**Code Review Guidelines –¥–ª—è —Ç–µ—Å—Ç–æ–≤:**
```python
# code_review_checklist.py
"""
–ß–µ–∫–ª–∏—Å—Ç –¥–ª—è Code Review —Ç–µ—Å—Ç–æ–≤:

‚úÖ –ü–æ–∫—Ä—ã—Ç–∏–µ:
   - –ü–æ–∫—Ä—ã–≤–∞—é—Ç –ª–∏ —Ç–µ—Å—Ç—ã –Ω–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª?
   - –ï—Å—Ç—å –ª–∏ —Ç–µ—Å—Ç—ã –¥–ª—è –≥—Ä–∞–Ω–∏—á–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤?
   - –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –ª–∏ –æ—à–∏–±–æ—á–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏?

‚úÖ –ß–∏—Ç–∞–µ–º–æ—Å—Ç—å:
   - –ü–æ–Ω—è—Ç–Ω—ã –ª–∏ –∏–º–µ–Ω–∞ —Ç–µ—Å—Ç–æ–≤?
   - –°–ª–µ–¥—É–µ—Ç –ª–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ AAA (Arrange-Act-Assert)?
   - –ï—Å—Ç—å –ª–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –¥–ª—è —Å–ª–æ–∂–Ω–æ–π –ª–æ–≥–∏–∫–∏?

‚úÖ –ù–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å:
   - –ú–æ–≥—É—Ç –ª–∏ —Ç–µ—Å—Ç—ã –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –≤ –ª—é–±–æ–º –ø–æ—Ä—è–¥–∫–µ?
   - –ù–µ –∑–∞–≤–∏—Å—è—Ç –ª–∏ —Ç–µ—Å—Ç—ã –¥—Ä—É–≥ –æ—Ç –¥—Ä—É–≥–∞?
   - –û—á–∏—â–∞–µ—Ç—Å—è –ª–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–æ–≤?

‚úÖ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
   - –í—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ª–∏ —Ç–µ—Å—Ç—ã –±—ã—Å—Ç—Ä–æ?
   - –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ª–∏ –º–æ–∫–∏ –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π?
   - –ù–µ—Ç –ª–∏ –∏–∑–±—ã—Ç–æ—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π?

‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç—å:
   - –õ–µ–≥–∫–æ –ª–∏ –ø–æ–Ω—è—Ç—å —á—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è?
   - –õ–µ–≥–∫–æ –ª–∏ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Ç–µ—Å—Ç—ã?
   - –ù–µ—Ç –ª–∏ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –≤ —Ç–µ—Å—Ç–∞—Ö?
"""

class TestCodeReviewExamples:
    """–ü—Ä–∏–º–µ—Ä—ã —Ö–æ—Ä–æ—à–∏—Ö –∏ –ø–ª–æ—Ö–∏—Ö –ø—Ä–∞–∫—Ç–∏–∫ –¥–ª—è Code Review"""
    
    # ‚ùå –ü–õ–û–•–û - –Ω–µ—è—Å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–µ—Å—Ç–∞
    def test_user_method(self):
        user = User("test@example.com")
        result = user.some_method()
        assert result
    
    # ‚úÖ –•–û–†–û–®–û - –æ–ø–∏—Å–∞—Ç–µ–ª—å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ
    def test_user_activation_sends_welcome_email_when_user_is_inactive(self):
        # Arrange
        user = User("test@example.com", is_active=False)
        email_service = Mock()
        user.email_service = email_service
        
        # Act
        user.activate()
        
        # Assert
        email_service.send_welcome_email.assert_called_once_with("test@example.com")
        assert user.is_active is True
    
    # ‚ùå –ü–õ–û–•–û - —Ç–µ—Å—Ç –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤–Ω–µ—à–Ω–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
    def test_user_count(self):
        # –ü–æ–ª–∞–≥–∞–µ—Ç—Å—è –Ω–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –ë–î
        count = UserService.get_user_count()
        UserService.create_user("new@example.com")
        new_count = UserService.get_user_count()
        assert new_count == count + 1
    
    # ‚úÖ –•–û–†–û–®–û - –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ—Å—Ç
    def test_user_count_increases_after_creating_user(self):
        # Arrange
        user_repo = Mock()
        user_repo.count.side_effect = [5, 6]  # –î–æ –∏ –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è
        user_repo.save.return_value = User("new@example.com", user_id=1)
        
        user_service = UserService(user_repo)
        
        # Act
        initial_count = user_service.get_user_count()
        user_service.create_user("new@example.com")
        final_count = user_service.get_user_count()
        
        # Assert
        assert final_count == initial_count + 1
    
    # ‚ùå –ü–õ–û–•–û - —Å–ª–∏—à–∫–æ–º —Å–ª–æ–∂–Ω—ã–π —Ç–µ—Å—Ç
    def test_complex_order_processing(self):
        # –°–æ–∑–¥–∞–µ–º 10 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, 20 —Ç–æ–≤–∞—Ä–æ–≤, 5 –∑–∞–∫–∞–∑–æ–≤...
        # 50 —Å—Ç—Ä–æ–∫ setup –∫–æ–¥–∞
        # –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ assertions
        pass
    
    # ‚úÖ –•–û–†–û–®–û - —Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ—Å—Ç
    def test_order_total_calculation_includes_tax(self):
        # Arrange
        items = [OrderItem(price=100, quantity=1)]
        tax_calculator = Mock()
        tax_calculator.calculate_tax.return_value = 8.0
        
        order = Order(items, tax_calculator)
        
        # Act
        total = order.calculate_total()
        
        # Assert
        assert total == 108.0
        tax_calculator.calculate_tax.assert_called_once_with(100)

# –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –∫–æ–º–∞–Ω–¥–Ω–æ–π —Ä–∞–±–æ—Ç—ã
class TestingMetrics:
    """–ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ —Ç–µ—Å—Ç–æ–≤"""
    
    @staticmethod
    def calculate_test_coverage(source_dir, test_dir):
        """–í—ã—á–∏—Å–ª—è–µ—Ç –ø–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞ —Ç–µ—Å—Ç–∞–º–∏"""
        import coverage
        
        cov = coverage.Coverage()
        cov.start()
        
        # –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Å—Ç—ã
        import subprocess
        subprocess.run(['pytest', test_dir])
        
        cov.stop()
        cov.save()
        
        # –ü–æ–ª—É—á–∞–µ–º –æ—Ç—á–µ—Ç
        report = cov.report(show_missing=True)
        return report
    
    @staticmethod
    def analyze_test_performance():
        """–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ç–µ—Å—Ç–æ–≤"""
        import time
        import pytest
        
        # –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Å—Ç—ã —Å –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ–º
        start_time = time.time()
        pytest.main(['--durations=10', '--tb=short'])
        total_time = time.time() - start_time
        
        return {
            'total_execution_time': total_time,
            'recommendation': 'fast' if total_time < 60 else 'optimize'
        }
    
    @staticmethod
    def detect_flaky_tests(test_runs=10):
        """–û–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã"""
        import subprocess
        
        results = []
        for i in range(test_runs):
            result = subprocess.run(['pytest', '--tb=no'], capture_output=True)
            results.append(result.returncode == 0)
        
        success_rate = sum(results) / len(results)
        
        if success_rate < 1.0:
            return {
                'flaky_detected': True,
                'success_rate': success_rate,
                'recommendation': 'investigate failing tests'
            }
        
        return {'flaky_detected': False, 'success_rate': 1.0}

# –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ —Ç–µ—Å—Ç–æ–≤
class TestQualityGate:
    """–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ —Ç–µ—Å—Ç–æ–≤"""
    
    def __init__(self, min_coverage=80, max_test_time=300):
        self.min_coverage = min_coverage
        self.max_test_time = max_test_time
    
    def check_quality_gates(self):
        """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Å–µ gates –∫–∞—á–µ—Å—Ç–≤–∞"""
        results = {
            'coverage': self._check_coverage(),
            'performance': self._check_performance(),
            'style': self._check_test_style(),
            'dependencies': self._check_test_dependencies()
        }
        
        all_passed = all(result['passed'] for result in results.values())
        
        return {
            'overall_status': 'PASSED' if all_passed else 'FAILED',
            'details': results
        }
    
    def _check_coverage(self):
        """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞"""
        coverage_report = TestingMetrics.calculate_test_coverage('src/', 'tests/')
        
        return {
            'passed': coverage_report >= self.min_coverage,
            'actual': coverage_report,
            'required': self.min_coverage,
            'message': f"Coverage: {coverage_report}% (required: {self.min_coverage}%)"
        }
    
    def _check_performance(self):
        """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤"""
        perf_data = TestingMetrics.analyze_test_performance()
        
        return {
            'passed': perf_data['total_execution_time'] <= self.max_test_time,
            'actual': perf_data['total_execution_time'],
            'required': self.max_test_time,
            'message': f"Test execution: {perf_data['total_execution_time']:.1f}s (max: {self.max_test_time}s)"
        }
    
    def _check_test_style(self):
        """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç–∏–ª—å –Ω–∞–ø–∏—Å–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤"""
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–≥–ª–∞—à–µ–Ω–∏—è –æ–± –∏–º–µ–Ω–æ–≤–∞–Ω–∏–∏
        import ast
        import os
        
        issues = []
        for root, dirs, files in os.walk('tests/'):
            for file in files:
                if file.endswith('.py'):
                    file_path = os.path.join(root, file)
                    issues.extend(self._analyze_test_file(file_path))
        
        return {
            'passed': len(issues) == 0,
            'issues': issues,
            'message': f"Style issues found: {len(issues)}"
        }
    
    def _analyze_test_file(self, file_path):
        """–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª —Å —Ç–µ—Å—Ç–∞–º–∏"""
        with open(file_path, 'r') as f:
            content = f.read()
        
        try:
            tree = ast.parse(content)
        except SyntaxError:
            return [f"Syntax error in {file_path}"]
        
        issues = []
        
        for node in ast.walk(tree):
            if isinstance(node, ast.FunctionDef) and node.name.startswith('test_'):
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–ª–∏–Ω—É –∏–º–µ–Ω–∏ —Ç–µ—Å—Ç–∞
                if len(node.name) < 10:
                    issues.append(f"Test name too short: {node.name} in {file_path}")
                
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ docstring
                if not ast.get_docstring(node):
                    issues.append(f"Missing docstring: {node.name} in {file_path}")
                
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–µ—Å—Ç–∞ (—Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω assert)
                has_assert = any(
                    isinstance(child, ast.Assert) 
                    for child in ast.walk(node)
                )
                if not has_assert:
                    issues.append(f"No assertions found: {node.name} in {file_path}")
        
        return issues
    
    def _check_test_dependencies(self):
        """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É —Ç–µ—Å—Ç–∞–º–∏"""
        flaky_analysis = TestingMetrics.detect_flaky_tests()
        
        return {
            'passed': not flaky_analysis['flaky_detected'],
            'success_rate': flaky_analysis['success_rate'],
            'message': f"Test stability: {flaky_analysis['success_rate']:.1%}"
        }
```

---

## üéØ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ: –ü—É—Ç—å –æ—Ç –Ω–æ–≤–∏—á–∫–∞ –∫ —ç–∫—Å–ø–µ—Ä—Ç—É

### üìä –ü—Ä–æ–≥—Ä–µ—Å—Å –ø–æ —É—Ä–æ–≤–Ω—è–º

**–£—Ä–æ–≤–µ–Ω—å –ù–æ–≤–∏—á–æ–∫ (–ù–µ–¥–µ–ª–∏ 1-6):**
```
‚úÖ –ü–æ–Ω–∏–º–∞–Ω–∏–µ –ø–∏—Ä–∞–º–∏–¥—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
‚úÖ –ù–∞–ø–∏—Å–∞–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö —é–Ω–∏—Ç-—Ç–µ—Å—Ç–æ–≤  
‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ AAA –ø–∞—Ç—Ç–µ—Ä–Ω–∞
‚úÖ –ú–æ–∫–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Å—Ç—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
‚úÖ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –≤ IDE/–∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ

–ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞:
- –ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞ >70%
- –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤ <30 —Å–µ–∫—É–Ω–¥
- –ü–æ–Ω–∏–º–∞–Ω–∏–µ –∫—Ä–∞—Å–Ω–æ–≥–æ-–∑–µ–ª–µ–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ TDD
```

**–£—Ä–æ–≤–µ–Ω—å –°—Ä–µ–¥–Ω–∏–π (–ù–µ–¥–µ–ª–∏ 7-12):**
```
‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –ë–î
‚úÖ API —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ REST/GraphQL
‚úÖ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ TDD –≤ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞–±–æ—Ç–µ
‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ CI/CD –ø–∞–π–ø–ª–∞–π–Ω–æ–≤
‚úÖ –†–∞–±–æ—Ç–∞ —Å test containers

–ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞:
- –ü–æ–∫—Ä—ã—Ç–∏–µ >85% —Å –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ —Ç–µ—Å—Ç–∞–º–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã –≤ CI/CD
- –í—Ä–µ–º—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏ <5 –º–∏–Ω—É—Ç
- –°—Ç–∞–±–∏–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã (>99% success rate)
```

**–£—Ä–æ–≤–µ–Ω—å –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π (–ù–µ–¥–µ–ª–∏ 13-18):**
```
‚úÖ –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
‚úÖ Property-based —Ç–µ—Å—Ç—ã
‚úÖ Mutation —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
‚úÖ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏

–ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞:
- –¢–µ—Å—Ç—ã –Ω–∞—Ö–æ–¥—è—Ç >90% –±–∞–≥–æ–≤ –¥–æ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
- SLA –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–æ–±–ª—é–¥–∞–µ—Ç—Å—è
- –ü–æ–∫—Ä—ã—Ç–∏–µ –º—É—Ç–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ >80%
- Zero security vulnerabilities
```

**–£—Ä–æ–≤–µ–Ω—å –≠–∫—Å–ø–µ—Ä—Ç (–ù–µ–¥–µ–ª–∏ 19-26):**
```
‚úÖ Chaos Engineering
‚úÖ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ legacy —Å–∏—Å—Ç–µ–º
‚úÖ –û–±—É—á–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã
‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤
‚úÖ –ú–µ—Ç—Ä–∏–∫–∏ –∏ —É–ª—É—á—à–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

–ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞:
- –í—Ä–µ–º—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ—Å–ª–µ —Å–±–æ–µ–≤ <10 –º–∏–Ω—É—Ç
- –ö–æ–º–∞–Ω–¥–∞ —Å–ª–µ–¥—É–µ—Ç best practices
- –¢–µ—Ö–¥–æ–ª–≥ –ø–æ —Ç–µ—Å—Ç–∞–º —Å–Ω–∏–∂–∞–µ—Ç—Å—è
- ROI –æ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è >300%
```

### üé≠ –†–æ–ª–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤—â–∏–∫–∞ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —É—Ä–æ–≤–Ω—è—Ö

```
–ù–æ–≤–∏—á–æ–∫      ‚Üí –ü–∏—à–µ—Ç —Ç–µ—Å—Ç—ã –¥–ª—è —Å–≤–æ–µ–≥–æ –∫–æ–¥–∞
–°—Ä–µ–¥–Ω–∏–π      ‚Üí –ü–æ–º–æ–≥–∞–µ—Ç –∫–æ–º–∞–Ω–¥–µ —Å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º  
–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π  ‚Üí –í–ª–∏—è–µ—Ç –Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –¥–ª—è —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏
–≠–∫—Å–ø–µ—Ä—Ç      ‚Üí –§–æ—Ä–º–∏—Ä—É–µ—Ç –∫—É–ª—å—Ç—É—Ä—É –∫–∞—á–µ—Å—Ç–≤–∞ –≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
```

### üîß –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ä–∏–π –ø–æ —è–∑—ã–∫–∞–º

**Python Ecosystem:**
```
Testing:     pytest, unittest, nose2
Mocking:     unittest.mock, responses, VCR.py
Coverage:    coverage.py, pytest-cov
API:         requests, httpx, FastAPI TestClient
Load:        locust, molotov
Property:    hypothesis
Security:    bandit, safety
CI/CD:       GitHub Actions, GitLab CI, Jenkins
```

**Go Ecosystem:**
```
Testing:     testing, testify, ginkgo
Mocking:     testify/mock, gomock, counterfeiter
Coverage:    go test -cover, gocov
API:         httptest, net/http/httptest
Load:        vegeta, hey, bombardier
Property:    gopter
Security:    gosec, nancy
Containers:  testcontainers-go
CI/CD:       GitHub Actions, GitLab CI, Drone
```

**JavaScript/Node.js Ecosystem:**
```
Testing:     Jest, Mocha, Vitest
Mocking:     sinon, jest.mock, nock
API:         supertest, axios-mock-adapter
E2E:         Playwright, Cypress, Puppeteer
Load:        k6, Artillery
Property:    fast-check
Security:    npm audit, snyk
```

### üèÜ –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —É—Ä–æ–≤–Ω—è

**–ù–æ–≤–∏—á–æ–∫ - –°–æ–∑–¥–∞–Ω–∏–µ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞:**
```python
# –ó–æ–ª–æ—Ç—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö:

1. –û–¥–∏–Ω —Ç–µ—Å—Ç = –æ–¥–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞
def test_user_creation_sets_correct_email():
    user = User("test@example.com")
    assert user.email == "test@example.com"

def test_user_creation_sets_active_status():
    user = User("test@example.com") 
    assert user.is_active is True

2. –ì–æ–≤–æ—Ä—è—â–∏–µ –∏–º–µ–Ω–∞ —Ç–µ—Å—Ç–æ–≤
‚úÖ test_calculate_total_price_with_discount_returns_discounted_amount()
‚ùå test_calculate()

3. AAA —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤—Å–µ–≥–¥–∞
def test_something():
    # Arrange - –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞
    # Act - –¥–µ–π—Å—Ç–≤–∏–µ  
    # Assert - –ø—Ä–æ–≤–µ—Ä–∫–∞
```

**–°—Ä–µ–¥–Ω–∏–π - –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –Ω–∞–≤—ã–∫–æ–≤:**
```python
# –ü–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è —Å—Ä–µ–¥–Ω–µ–≥–æ —É—Ä–æ–≤–Ω—è:

1. –§–∏–∫—Å—Ç—É—Ä—ã –¥–ª—è –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
@pytest.fixture
def sample_user():
    return User("test@example.com", "Test User")

2. –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è edge cases
@pytest.mark.parametrize("age,expected", [
    (0, False),    # –≥—Ä–∞–Ω–∏—Ü–∞
    (17, False),   # –Ω–∏–∂–µ –ª–∏–º–∏—Ç–∞
    (18, True),    # —Ç–æ—á–Ω–æ –Ω–∞ –≥—Ä–∞–Ω–∏—Ü–µ
    (25, True),    # –Ω–æ—Ä–º–∞
    (150, True),   # –≤–µ—Ä—Ö–Ω—è—è –≥—Ä–∞–Ω–∏—Ü–∞
    (151, False)   # –ø—Ä–µ–≤—ã—à–µ–Ω–∏–µ
])
def test_age_validation(age, expected):
    assert is_valid_age(age) == expected

3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã —Å cleanup
def test_user_registration_integration(db_session):
    # Test with real database
    service = UserService(db_session)
    user = service.register("test@example.com")
    
    assert user.id is not None
    # Cleanup –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —á–µ—Ä–µ–∑ —Ñ–∏–∫—Å—Ç—É—Ä—É
```

**–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π - –ú–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ:**
```python
# –¢–µ—Ö–Ω–∏–∫–∏ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–≥–æ —É—Ä–æ–≤–Ω—è:

1. Property-based —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
@given(st.text(min_size=1), st.emails())
def test_user_invariants(name, email):
    user = User(email, name)
    # –ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã –∫–æ—Ç–æ—Ä—ã–µ –í–°–ï–ì–î–ê –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å true
    assert user.email == email.lower()
    assert len(user.name.strip()) > 0
    assert user.created_at <= datetime.now()

2. Contract —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
def test_user_service_contract():
    """–¢–µ—Å—Ç –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞ –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏"""
    user_service = UserServicePact()
    
    # –û–∂–∏–¥–∞–Ω–∏—è –æ—Ç –≤–Ω–µ—à–Ω–µ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
    user_service.given("user exists") \
                .upon_receiving("get user request") \
                .with_request(method="GET", path="/users/123") \
                .will_respond_with(status=200, body=USER_SCHEMA)

3. Chaos Engineering
def test_system_resilience():
    with chaos_experiment("network_partition"):
        simulate_network_partition(duration=30)
        # –°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è
        assert health_check_passes(timeout=60)
```

**–≠–∫—Å–ø–µ—Ä—Ç - –õ–∏–¥–µ—Ä—Å—Ç–≤–æ:**
```python
# –≠–∫—Å–ø–µ—Ä—Ç–Ω—ã–µ –ø—Ä–∞–∫—Ç–∏–∫–∏:

1. –°–æ–∑–¥–∞–Ω–∏–µ DSL –¥–ª—è —Ç–µ—Å—Ç–æ–≤  
def test_complex_business_scenario():
    Given.user("john").with_balance(1000) \
         .And.product("laptop").costs(800) \
         .When.user_purchases_product() \
         .Then.user_balance_should_be(200) \
         .And.order_should_be_created() \
         .And.inventory_should_be_updated()

2. –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ —Ç–µ—Å—Ç–æ–≤
class TestMetrics:
    def mutation_score(self) -> float:
        """–ü—Ä–æ—Ü–µ–Ω—Ç —É–±–∏—Ç—ã—Ö –º—É—Ç–∞–Ω—Ç–æ–≤"""
        pass
    
    def flakiness_rate(self) -> float:
        """–ü—Ä–æ—Ü–µ–Ω—Ç –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤"""
        pass
    
    def maintenance_burden(self) -> float:
        """–°–ª–æ–∂–Ω–æ—Å—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Ç–µ—Å—Ç–æ–≤"""
        pass

3. –û–±—É—á–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã
def create_testing_workshop():
    """–°–æ–∑–¥–∞–Ω–∏–µ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤"""
    return [
        "hands_on_tdd_session.py",
        "mocking_best_practices.py", 
        "performance_testing_guide.py",
        "code_review_checklist.md"
    ]
```

### üöÄ Roadmap —Ä–∞–∑–≤–∏—Ç–∏—è –Ω–∞ 6 –º–µ—Å—è—Ü–µ–≤

**–ú–µ—Å—è—Ü 1-2: –û—Å–Ω–æ–≤—ã**
```
–ù–µ–¥–µ–ª—è 1: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏ –ø–µ—Ä–≤—ã–µ —Ç–µ—Å—Ç—ã
–ù–µ–¥–µ–ª—è 2: TDD –∫—Ä–∞—Å–Ω–æ-–∑–µ–ª–µ–Ω–æ-—Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥
–ù–µ–¥–µ–ª—è 3: –ú–æ–∫–∏ –∏ —Å—Ç–∞–±—ã
–ù–µ–¥–µ–ª—è 4: –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤ –∏ –∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ
–ù–µ–¥–µ–ª—è 5: –ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞ –∏ –º–µ—Ç—Ä–∏–∫–∏
–ù–µ–¥–µ–ª—è 6: –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
–ù–µ–¥–µ–ª—è 7: –§–∏–∫—Å—Ç—É—Ä—ã –∏ teardown
–ù–µ–¥–µ–ª—è 8: –ü–µ—Ä–≤—ã–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
```

**–ú–µ—Å—è—Ü 3-4: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è**
```
–ù–µ–¥–µ–ª—è 9-10: API —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ 
–ù–µ–¥–µ–ª—è 11-12: –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
–ù–µ–¥–µ–ª—è 13-14: CI/CD –ø–∞–π–ø–ª–∞–π–Ω—ã
–ù–µ–¥–µ–ª—è 15-16: –¢–µ—Å—Ç–æ–≤—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```

**–ú–µ—Å—è—Ü 5-6: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏**
```
–ù–µ–¥–µ–ª—è 17-18: –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
–ù–µ–¥–µ–ª—è 19-20: –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
–ù–µ–¥–µ–ª—è 21-22: Property-based –∏ Chaos
–ù–µ–¥–µ–ª—è 23-24: Legacy —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥
–ù–µ–¥–µ–ª—è 25-26: –≠–∫—Å–ø–µ—Ä—Ç–∏–∑–∞ –∏ –æ–±—É—á–µ–Ω–∏–µ
```

### üí° –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏ –∏ –∫–∞–∫ –∏—Ö –∏–∑–±–µ–∂–∞—Ç—å

**–û—à–∏–±–∫–∏ –Ω–æ–≤–∏—á–∫–æ–≤:**
```
‚ùå –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ implementation –≤–º–µ—Å—Ç–æ behavior
‚úÖ –§–æ–∫—É—Å –Ω–∞ —Ç–æ–º –ß–¢–û –¥–µ–ª–∞–µ—Ç –∫–æ–¥, –∞ –Ω–µ –ö–ê–ö

‚ùå –°–ª–∏—à–∫–æ–º —Å–ª–æ–∂–Ω—ã–µ —Ç–µ—Å—Ç—ã
‚úÖ –û–¥–∏–Ω —Ç–µ—Å—Ç = –æ–¥–Ω–∞ –∫–æ–Ω—Ü–µ–ø—Ü–∏—è

‚ùå –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –º–µ–∂–¥—É —Ç–µ—Å—Ç–∞–º–∏  
‚úÖ –ö–∞–∂–¥—ã–π —Ç–µ—Å—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º

‚ùå –ü–ª–æ—Ö–∏–µ –∏–º–µ–Ω–∞ —Ç–µ—Å—Ç–æ–≤
‚úÖ –ò–º—è –æ–ø–∏—Å—ã–≤–∞–µ—Ç —Å—Ü–µ–Ω–∞—Ä–∏–π –ø–æ–ª–Ω–æ—Å—Ç—å—é
```

**–û—à–∏–±–∫–∏ —Å—Ä–µ–¥–Ω–µ–≥–æ —É—Ä–æ–≤–Ω—è:**
```
‚ùå –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ production –∫–æ–¥–∞ –≤ —Ç–µ—Å—Ç–∞—Ö
‚úÖ –¢–µ—Å—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø—Ä–æ—Å—Ç—ã–º–∏

‚ùå –ú–æ–∫–∏ –¥–ª—è –≤—Å–µ–≥–æ –ø–æ–¥—Ä—è–¥
‚úÖ –ú–æ–∫–∞—Ç—å —Ç–æ–ª—å–∫–æ –≤–Ω–µ—à–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

‚ùå –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ–¥–ª–µ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
‚úÖ –ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
‚úÖ –ë–∞–ª–∞–Ω—Å –º–µ–∂–¥—É unit –∏ integration
```

**–û—à–∏–±–∫–∏ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö:**
```
‚ùå –ß—Ä–µ–∑–º–µ—Ä–Ω–æ–µ —É—Å–ª–æ–∂–Ω–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã —Ç–µ—Å—Ç–æ–≤
‚úÖ –ü—Ä–æ—Å—Ç–æ—Ç–∞ –≤–∞–∂–Ω–µ–µ —ç–ª–µ–≥–∞–Ω—Ç–Ω–æ—Å—Ç–∏

‚ùå –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ flaky —Ç–µ—Å—Ç–æ–≤
‚úÖ –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤

‚ùå –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–¥–∏ –º–µ—Ç—Ä–∏–∫ –ø–æ–∫—Ä—ã—Ç–∏—è
‚úÖ –ö–∞—á–µ—Å—Ç–≤–æ –≤–∞–∂–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞

‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
‚úÖ –û–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö –ø—Ä–∞–∫—Ç–∏–∫ –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–≤
```

### üéì –†–µ—Å—É—Ä—Å—ã –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –∏–∑—É—á–µ–Ω–∏—è

**–ö–Ω–∏–≥–∏:**
```
üìö –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ:
- "Test Driven Development" - Kent Beck
- "Working Effectively with Legacy Code" - Michael Feathers  
- "Growing Object-Oriented Software, Guided by Tests" - Freeman & Pryce
- "The Art of Unit Testing" - Roy Osherove

üìö –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ:
- "Building Microservices" - Sam Newman (—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤)
- "Release It!" - Michael Nygard (reliability testing)
- "Chaos Engineering" - Casey Rosenthal
```

**–û–Ω–ª–∞–π–Ω —Ä–µ—Å—É—Ä—Å—ã:**
```
üåê –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
- pytest.org - –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è pytest
- testcontainers.org - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- k6.io - –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

üåê –ë–ª–æ–≥–∏:
- martinfowler.com/testing - —Å—Ç–∞—Ç—å–∏ –ú–∞—Ä—Ç–∏–Ω–∞ –§–∞—É–ª–µ—Ä–∞
- testingbot.com/blog - –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã
- Ministry of Testing - —Å–æ–æ–±—â–µ—Å—Ç–≤–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤—â–∏–∫–æ–≤
```

**–ü—Ä–∞–∫—Ç–∏–∫–∞:**
```
üõ†Ô∏è –ü—Ä–æ–µ–∫—Ç—ã –¥–ª—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏:
1. Todo API —Å –ø–æ–ª–Ω—ã–º –ø–æ–∫—Ä—ã—Ç–∏–µ–º —Ç–µ—Å—Ç–∞–º–∏
2. E-commerce —Å–∏—Å—Ç–µ–º–∞ —Å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞–º–∏  
3. Chat –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å WebSocket —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º
4. Legacy –ø—Ä–æ–µ–∫—Ç –¥–ª—è —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

üõ†Ô∏è Open Source —É—á–∞—Å—Ç–∏–µ:
- –í–Ω–µ—Å–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤ –≤ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã
- –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö —É—Ç–∏–ª–∏—Ç
- –£—á–∞—Å—Ç–∏–µ –≤ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ release candidates
```

### üèÅ –ò—Ç–æ–≥–æ–≤—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

**–ó–æ–ª–æ—Ç—ã–µ –ø—Ä–∞–≤–∏–ª–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**

1. **–ù–∞—á–∏–Ω–∞–π—Ç–µ —Å –ø—Ä–æ—Å—Ç–æ–≥–æ** - –Ω–µ –ø—ã—Ç–∞–π—Ç–µ—Å—å –≤–Ω–µ–¥—Ä–∏—Ç—å –≤—Å–µ —Å—Ä–∞–∑—É
2. **–¢–µ—Å—Ç—ã - —ç—Ç–æ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏—è** - –æ–Ω–∏ –æ–∫—É–ø–∞—é—Ç—Å—è –≤ –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–π –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–µ  
3. **–ö–∞—á–µ—Å—Ç–≤–æ –≤–∞–∂–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞** - –ª—É—á—à–µ 50 —Ö–æ—Ä–æ—à–∏—Ö —Ç–µ—Å—Ç–æ–≤ —á–µ–º 500 –ø–ª–æ—Ö–∏—Ö
4. **TDD –º–µ–Ω—è–µ—Ç –¥–∏–∑–∞–π–Ω** - –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Ö–æ—Ç—è –±—ã –º–µ—Å—è—Ü –ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã –ø–µ—Ä–≤—ã–º–∏
5. **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–π—Ç–µ –≤—Å–µ** - —Ä—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è
6. **–£—á–∏—Ç–µ—Å—å —É –∫–æ–º–∞–Ω–¥—ã** - –¥–µ–ª–∏—Ç–µ—Å—å –∑–Ω–∞–Ω–∏—è–º–∏ –∏ –ø—Ä–∞–∫—Ç–∏–∫–∞–º–∏
7. **–ò–∑–º–µ—Ä—è–π—Ç–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å** - —Å–ª–µ–¥–∏—Ç–µ –∑–∞ –º–µ—Ç—Ä–∏–∫–∞–º–∏ –∏ ROI
8. **–ù–µ –±–æ–π—Ç–µ—Å—å —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å —Ç–µ—Å—Ç—ã** - –æ–Ω–∏ —Ç–æ–∂–µ –∫–æ–¥ –∏ —Ç—Ä–µ–±—É—é—Ç —É—Ö–æ–¥–∞

**–ü—É—Ç—å –∫ –º–∞—Å—Ç–µ—Ä—Å—Ç–≤—É:**
```
–ü—Ä–∞–∫—Ç–∏–∫–∞ ‚Üí –û—à–∏–±–∫–∏ ‚Üí –ê–Ω–∞–ª–∏–∑ ‚Üí –£–ª—É—á—à–µ–Ω–∏–µ ‚Üí –û–±—É—á–µ–Ω–∏–µ –¥—Ä—É–≥–∏—Ö ‚Üí –≠–∫—Å–ø–µ—Ä—Ç–∏–∑–∞
    ‚Üë                                                        ‚Üì
    ‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ ‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê‚Üê
```

**–ü–æ–º–Ω–∏—Ç–µ:** –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ - —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞, —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ª—É—á—à–µ–≥–æ –¥–∏–∑–∞–π–Ω–∞, –ø–æ–≤—ã—à–µ–Ω–∏—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º–µ –∏ —É—Å–∫–æ—Ä–µ–Ω–∏—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏. –ú–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ –ø—Ä–∏—Ö–æ–¥–∏—Ç —Å –æ–ø—ã—Ç–æ–º, –Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç –ø–æ–º–æ–∂–µ—Ç –∏–∑–±–µ–∂–∞—Ç—å –º–Ω–æ–≥–∏—Ö –æ—à–∏–±–æ–∫ –Ω–∞ –ø—É—Ç–∏.

–£–¥–∞—á–∏ –≤ –∏–∑—É—á–µ–Ω–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è! üß™‚ú®

---

*"–õ—é–±–æ–π –∫–æ–¥ –±–µ–∑ —Ç–µ—Å—Ç–æ–≤ - legacy –∫–æ–¥ —Å –º–æ–º–µ–Ω—Ç–∞ –Ω–∞–ø–∏—Å–∞–Ω–∏—è"* - Michael Feathers

*"–¢–µ—Å—Ç—ã - —ç—Ç–æ –Ω–µ –æ –ø–æ–∏—Å–∫–µ –±–∞–≥–æ–≤, —ç—Ç–æ –æ –¥–∏–∑–∞–π–Ω–µ –ü–û"* - Kent Beck

*"–õ—É—á—à–µ–µ –≤—Ä–µ–º—è –¥–ª—è –Ω–∞–ø–∏—Å–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤ - –≤—á–µ—Ä–∞. –í—Ç–æ—Ä–æ–µ –ª—É—á—à–µ–µ –≤—Ä–µ–º—è - —Å–µ–π—á–∞—Å"* - –î—Ä–µ–≤–Ω—è—è –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç—Å–∫–∞—è –º—É–¥—Ä–æ—Å—Ç—å* üòÑ# üß™ –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é –¥–ª—è Backend —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞
*–û—Ç –Ω–æ–≤–∏—á–∫–∞ –¥–æ —ç–∫—Å–ø–µ—Ä—Ç–∞ –∑–∞ 18-26 –Ω–µ–¥–µ–ª—å*

---

## üìö –ú–æ–¥—É–ª—å 1: –û—Å–Ω–æ–≤—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (2-3 –Ω–µ–¥–µ–ª–∏)

### üéØ –ó–∞—á–µ–º –Ω—É–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ?

**–°—Ç–æ–∏–º–æ—Å—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–≥–æ–≤:**
```
–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞    $1
–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ  $10  
–ü—Ä–æ–¥–∞–∫—à–µ–Ω     $100
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏  $1000
```

**–ü—Ä–æ–±–ª–µ–º–∞ –±–µ–∑ —Ç–µ—Å—Ç–æ–≤:**
```
–ò–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–¥–∞ ‚Üí –°—Ç—Ä–∞—Ö —Å–ª–æ–º–∞—Ç—å —á—Ç–æ-—Ç–æ ‚Üí –ú–µ–¥–ª–µ–Ω–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ ‚Üí –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–æ–ª–≥
```

**–° —Ç–µ—Å—Ç–∞–º–∏:**
```
–ò–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–¥–∞ ‚Üí –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ ‚Üí –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å ‚Üí –ë—ã—Å—Ç—Ä–∞—è –∏—Ç–µ—Ä–∞—Ü–∏—è ‚Üí –ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –∫–æ–¥
```

### üèóÔ∏è –ü–∏—Ä–∞–º–∏–¥–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

```
           /\
          /E2E\     ‚Üê 10% - –ú–µ–¥–ª–µ–Ω–Ω—ã–µ, –¥–æ—Ä–æ–≥–∏–µ, —Ö—Ä—É–ø–∫–∏–µ
         /------\     –ü–æ–ª–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Å—Ü–µ–Ω–∞—Ä–∏–π
        /        \
       /Integration\ ‚Üê 20% - –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π
      /------------\   –°–ª–æ–∏, API, –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
     /              \
    /   Unit Tests   \ ‚Üê 70% - –ë—ã—Å—Ç—Ä—ã–µ, –Ω–∞–¥–µ–∂–Ω—ã–µ, –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ  
   /------------------\  –§—É–Ω–∫—Ü–∏–∏, –º–µ—Ç–æ–¥—ã, –∫–ª–∞—Å—Å—ã
```

**–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ —Ç–∞–∫–∞—è –ø—Ä–æ–ø–æ—Ä—Ü–∏—è?**
- Unit —Ç–µ—Å—Ç—ã –¥–∞—é—Ç –±—ã—Å—Ç—Ä—ã–π feedback
- Integration —Ç–µ—Å—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç —Å–æ–≤–º–µ—Å—Ç–Ω—É—é —Ä–∞–±–æ—Ç—É
- E2E —Ç–µ—Å—Ç—ã –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

### üîÑ Test-Driven Development (TDD)

```
1. Red (–ö—Ä–∞—Å–Ω—ã–π)    ‚Üí –ü–∏—à–µ–º –ø–∞–¥–∞—é—â–∏–π —Ç–µ—Å—Ç
         ‚Üì
2. Green (–ó–µ–ª–µ–Ω—ã–π)  ‚Üí –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∫–æ–¥ –¥–ª—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è  
         ‚Üì
3. Refactor         ‚Üí –£–ª—É—á—à–∞–µ–º –∫–æ–¥, —Ç–µ—Å—Ç—ã –æ—Å—Ç–∞—é—Ç—Å—è –∑–µ–ª–µ–Ω—ã–º–∏
         ‚Üë
         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**Python –ø—Ä–∏–º–µ—Ä TDD:**
```python
# 1. RED - –ø–∏—à–µ–º —Ç–µ—Å—Ç (–æ–Ω –ø–∞–¥–∞–µ—Ç)
def test_calculate_age():
    person = Person(birth_year=1990)
    assert person.get_age() == 33  # –¢–µ—Å—Ç —É–ø–∞–¥–µ—Ç - –º–µ—Ç–æ–¥–∞ –Ω–µ—Ç

# 2. GREEN - –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
class Person:
    def __init__(self, birth_year):
        self.birth_year = birth_year
    
    def get_age(self):
        return 33  # –•–∞—Ä–¥–∫–æ–¥ –¥–ª—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —Ç–µ—Å—Ç–∞

# 3. REFACTOR - –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
class Person:
    def __init__(self, birth_year):
        self.birth_year = birth_year
    
    def get_age(self):
        from datetime import datetime
        return datetime.now().year - self.birth_year
```

**Go –ø—Ä–∏–º–µ—Ä TDD:**
```go
// 1. RED - —Ç–µ—Å—Ç –ø–∞–¥–∞–µ—Ç
func TestCalculateAge(t *testing.T) {
    person := Person{BirthYear: 1990}
    got := person.GetAge()
    want := 33
    
    if got != want {
        t.Errorf("GetAge() = %d, want %d", got, want)
    }
}

// 2. GREEN - –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
type Person struct {
    BirthYear int
}

func (p Person) GetAge() int {
    return 33 // –•–∞—Ä–¥–∫–æ–¥
}

// 3. REFACTOR - –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
func (p Person) GetAge() int {
    return time.Now().Year() - p.BirthYear
}
```

### üé≠ Behavior-Driven Development (BDD)

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ Given-When-Then:**
```
Given (–î–∞–Ω–æ)    ‚Üí –ù–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
When (–ö–æ–≥–¥–∞)    ‚Üí –î–µ–π—Å—Ç–≤–∏–µ
Then (–¢–æ–≥–¥–∞)    ‚Üí –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
```

**Python —Å pytest-bdd:**
```python
# features/user_registration.feature
"""
Feature: User Registration
  
Scenario: Successful user registration
  Given a user with email "test@example.com"
  When they register with valid data
  Then they should receive confirmation email
  And their account should be created
"""

# test_registration.py
from pytest_bdd import given, when, then, scenario

@scenario('features/user_registration.feature', 'Successful user registration')
def test_user_registration():
    pass

@given('a user with email "test@example.com"')
def user_email():
    return {"email": "test@example.com", "password": "secure123"}

@when('they register with valid data')
def register_user(user_email, user_service):
    return user_service.register(user_email)

@then('they should receive confirmation email')
def check_confirmation_email(email_service):
    assert email_service.sent_emails_count() == 1

@then('their account should be created') 
def check_account_created(user_repository):
    users = user_repository.find_all()
    assert len(users) == 1
    assert users[0].email == "test@example.com"
```

### üìä –ü—Ä–∏–Ω—Ü–∏–ø—ã FIRST

```
F - Fast         ‚Üí –¢–µ—Å—Ç—ã –¥–æ–ª–∂–Ω—ã –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –±—ã—Å—Ç—Ä–æ (–º—Å, —Å–µ–∫—É–Ω–¥—ã)
I - Independent  ‚Üí –¢–µ—Å—Ç—ã –Ω–µ –∑–∞–≤–∏—Å—è—Ç –¥—Ä—É–≥ –æ—Ç –¥—Ä—É–≥–∞
R - Repeatable   ‚Üí –û–¥–∏–Ω–∞–∫–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ
S - Self-validating ‚Üí –ß–µ—Ç–∫–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: pass/fail
T - Timely       ‚Üí –¢–µ—Å—Ç—ã –ø–∏—à—É—Ç—Å—è –≤–æ–≤—Ä–µ–º—è (–≤ TDD - –¥–æ –∫–æ–¥–∞)
```

**–ü—Ä–∏–º–µ—Ä –Ω–∞—Ä—É—à–µ–Ω–∏—è –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤:**
```python
# ‚ùå –ü–õ–û–•–û - —Ç–µ—Å—Ç—ã –∑–∞–≤–∏—Å—è—Ç –¥—Ä—É–≥ –æ—Ç –¥—Ä—É–≥–∞
class TestUserService:
    user_id = None
    
    def test_create_user(self):
        user = user_service.create("John")
        self.user_id = user.id  # –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è!
        assert user.name == "John"
    
    def test_get_user(self):
        # –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Ç–µ—Å—Ç–∞!
        user = user_service.get(self.user_id)
        assert user is not None

# ‚úÖ –•–û–†–û–®–û - –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ —Ç–µ—Å—Ç—ã
class TestUserService:
    def test_create_user(self):
        user = user_service.create("John")
        assert user.name == "John"
    
    def test_get_user(self):
        # –°–æ–∑–¥–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –∫–∞–∂–¥–æ–º —Ç–µ—Å—Ç–µ
        user = user_service.create("Jane") 
        found_user = user_service.get(user.id)
        assert found_user.name == "Jane"
```

### üìà –ú–µ—Ç—Ä–∏–∫–∏ –ø–æ–∫—Ä—ã—Ç–∏—è –∫–æ–¥–∞

```
Line Coverage     ‚Üí % –ø–æ–∫—Ä—ã—Ç—ã—Ö —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞
Branch Coverage   ‚Üí % –ø–æ–∫—Ä—ã—Ç—ã—Ö –≤–µ—Ç–≤–µ–π (if/else)
Function Coverage ‚Üí % –ø–æ–∫—Ä—ã—Ç—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
Condition Coverage ‚Üí % –ø–æ–∫—Ä—ã—Ç—ã—Ö —É—Å–ª–æ–≤–∏–π
```

**Python - coverage.py:**
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞
pip install coverage

# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ —Å –∏–∑–º–µ—Ä–µ–Ω–∏–µ–º –ø–æ–∫—Ä—ã—Ç–∏—è
coverage run -m pytest

# –û—Ç—á–µ—Ç –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ
coverage report

# HTML –æ—Ç—á–µ—Ç
coverage html
```

**Go - –≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞:**
```bash
# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º
go test -cover

# –î–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç
go test -coverprofile=coverage.out
go tool cover -html=coverage.out
```

---

## üß© –ú–æ–¥—É–ª—å 2: –Æ–Ω–∏—Ç-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (3-4 –Ω–µ–¥–µ–ª–∏)

### üéØ –ê–Ω–∞—Ç–æ–º–∏—è —é–Ω–∏—Ç-—Ç–µ—Å—Ç–∞

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ AAA (Arrange-Act-Assert):**
```
Arrange ‚Üí –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
Act     ‚Üí –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è
Assert  ‚Üí –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
```

**Python –ø—Ä–∏–º–µ—Ä:**
```python
import pytest
from decimal import Decimal
from shopping_cart import ShoppingCart, Product

class TestShoppingCart:
    def test_add_product_increases_total(self):
        # Arrange
        cart = ShoppingCart()
        product = Product("Laptop", Decimal("999.99"))
        
        # Act  
        cart.add_product(product, quantity=2)
        
        # Assert
        assert cart.get_total() == Decimal("1999.98")
        assert cart.get_item_count() == 2

    def test_remove_product_decreases_total(self):
        # Arrange
        cart = ShoppingCart()
        product = Product("Mouse", Decimal("29.99"))
        cart.add_product(product, quantity=3)
        
        # Act
        cart.remove_product(product, quantity=1)
        
        # Assert
        assert cart.get_total() == Decimal("59.98")
        assert cart.get_item_count() == 2

    def test_empty_cart_has_zero_total(self):
        # Arrange
        cart = ShoppingCart()
        
        # Act & Assert
        assert cart.get_total() == Decimal("0.00")
        assert cart.is_empty() is True
```

**Go –ø—Ä–∏–º–µ—Ä:**
```go
package main

import (
    "testing"
    "github.com/stretchr/testify/assert"
)

func TestShoppingCart(t *testing.T) {
    t.Run("AddProduct increases total", func(t *testing.T) {
        // Arrange
        cart := NewShoppingCart()
        product := Product{Name: "Laptop", Price: 999.99}
        
        // Act
        cart.AddProduct(product, 2)
        
        // Assert
        assert.Equal(t, 1999.98, cart.GetTotal())
        assert.Equal(t, 2, cart.GetItemCount())
    })
    
    t.Run("RemoveProduct decreases total", func(t *testing.T) {
        // Arrange
        cart := NewShoppingCart()
        product := Product{Name: "Mouse", Price: 29.99}
        cart.AddProduct(product, 3)
        
        // Act
        cart.RemoveProduct(product, 1)
        
        // Assert
        assert.Equal(t, 59.98, cart.GetTotal())
        assert.Equal(t, 2, cart.GetItemCount())
    })
    
    t.Run("Empty cart has zero total", func(t *testing.T) {
        // Arrange
        cart := NewShoppingCart()
        
        // Act & Assert
        assert.Equal(t, 0.0, cart.GetTotal())
        assert.True(t, cart.IsEmpty())
    })
}
```

### üé≠ –ú–æ–∫–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

**–ó–∞—á–µ–º –Ω—É–∂–Ω—ã –º–æ–∫–∏?**
```
–ë–µ–∑ –º–æ–∫–æ–≤:
UserService ‚Üí Database ‚Üí Network ‚Üí –§–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ ‚Üí –ú–µ–¥–ª–µ–Ω–Ω–æ, –Ω–µ–Ω–∞–¥–µ–∂–Ω–æ

–° –º–æ–∫–∞–º–∏:
UserService ‚Üí Mock Database ‚Üí –ë—ã—Å—Ç—Ä–æ, –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º–æ, –Ω–∞–¥–µ–∂–Ω–æ
```

**Python —Å unittest.mock:**
```python
from unittest.mock import Mock, patch
import pytest
from user_service import UserService
from email_service import EmailService

class TestUserService:
    def test_register_user_sends_welcome_email(self):
        # Arrange
        mock_email_service = Mock(spec=EmailService)
        mock_user_repository = Mock()
        mock_user_repository.save.return_value = User(id=1, email="test@example.com")
        
        user_service = UserService(mock_user_repository, mock_email_service)
        
        # Act
        user_data = {"email": "test@example.com", "password": "secret"}
        user = user_service.register(user_data)
        
        # Assert
        mock_user_repository.save.assert_called_once()
        mock_email_service.send_welcome_email.assert_called_once_with("test@example.com")
        assert user.id == 1

    @patch('user_service.datetime')
    def test_get_user_age_calculation(self, mock_datetime):
        # Arrange
        mock_datetime.now.return_value.year = 2023
        user = User(birth_year=1990)
        
        # Act
        age = user.get_age()
        
        # Assert
        assert age == 33

    def test_user_service_handles_database_error(self):
        # Arrange
        mock_repository = Mock()
        mock_repository.save.side_effect = DatabaseError("Connection failed")
        user_service = UserService(mock_repository, Mock())
        
        # Act & Assert
        with pytest.raises(UserRegistrationError):
            user_service.register({"email": "test@example.com"})
```

**Go —Å testify/mock:**
```go
package main

import (
    "testing"
    "errors"
    "github.com/stretchr/testify/assert"
    "github.com/stretchr/testify/mock"
)

// Mock –æ–±—ä–µ–∫—Ç—ã
type MockUserRepository struct {
    mock.Mock
}

func (m *MockUserRepository) Save(user User) (User, error) {
    args := m.Called(user)
    return args.Get(0).(User), args.Error(1)
}

type MockEmailService struct {
    mock.Mock
}

func (m *MockEmailService) SendWelcomeEmail(email string) error {
    args := m.Called(email)
    return args.Error(0)
}

func TestUserService(t *testing.T) {
    t.Run("Register user sends welcome email", func(t *testing.T) {
        // Arrange
        mockRepo := new(MockUserRepository)
        mockEmail := new(MockEmailService)
        
        expectedUser := User{ID: 1, Email: "test@example.com"}
        mockRepo.On("Save", mock.AnythingOfType("User")).Return(expectedUser, nil)
        mockEmail.On("SendWelcomeEmail", "test@example.com").Return(nil)
        
        userService := NewUserService(mockRepo, mockEmail)
        
        // Act
        userData := UserData{Email: "test@example.com", Password: "secret"}
        user, err := userService.Register(userData)
        
        // Assert
        assert.NoError(t, err)
        assert.Equal(t, 1, user.ID)
        mockRepo.AssertExpectations(t)
        mockEmail.AssertExpectations(t)
    })
    
    t.Run("Register handles database error", func(t *testing.T) {
        // Arrange
        mockRepo := new(MockUserRepository)
        mockEmail := new(MockEmailService)
        
        mockRepo.On("Save", mock.AnythingOfType("User")).Return(User{}, errors.New("DB connection failed"))
        
        userService := NewUserService(mockRepo, mockEmail)
        
        // Act
        userData := UserData{Email: "test@example.com"}
        _, err := userService.Register(userData)
        
        // Assert
        assert.Error(t, err)
        assert.Contains(t, err.Error(), "failed to save user")
        mockRepo.AssertExpectations(t)
    })
}
```

### üéØ –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã

**Python —Å pytest.mark.parametrize:**
```python
import pytest
from password_validator import PasswordValidator

class TestPasswordValidator:
    @pytest.mark.parametrize("password,expected", [
        ("password123", False),     # –°–ª–∏—à–∫–æ–º –ø—Ä–æ—Å—Ç–æ–π
        ("12345678", False),        # –¢–æ–ª—å–∫–æ —Ü–∏—Ñ—Ä—ã
        ("Password!", True),        # –•–æ—Ä–æ—à–∏–π –ø–∞—Ä–æ–ª—å
        ("Sup3rStr0ng!", True),     # –û—Ç–ª–∏—á–Ω—ã–π –ø–∞—Ä–æ–ª—å  
        ("weak", False),            # –°–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π
        ("ALLCAPS123!", False),     # –ë–µ–∑ —Å—Ç—Ä–æ—á–Ω—ã—Ö –±—É–∫–≤
        ("alllower123!", False),    # –ë–µ–∑ –∑–∞–≥–ª–∞–≤–Ω—ã—Ö –±—É–∫–≤
    ])
    def test_password_strength(self, password, expected):
        validator = PasswordValidator()
        result = validator.is_strong(password)
        assert result == expected

    @pytest.mark.parametrize("email", [
        "valid@example.com",
        "user.name@domain.co.uk",
        "test+tag@gmail.com",
        "user123@sub.domain.org"
    ])
    def test_valid_emails(self, email):
        validator = EmailValidator()
        assert validator.is_valid(email) is True

    @pytest.mark.parametrize("invalid_email", [
        "invalid-email",
        "@domain.com",
        "user@",
        "spaces in@email.com",
        "user@domain",
    ])
    def test_invalid_emails(self, invalid_email):
        validator = EmailValidator()
        assert validator.is_valid(invalid_email) is False
```

**Go —Å table-driven tests:**
```go
func TestPasswordValidator(t *testing.T) {
    tests := []struct {
        name     string
        password string
        expected bool
    }{
        {"weak password", "password123", false},
        {"only numbers", "12345678", false},
        {"good password", "Password!", true},
        {"excellent password", "Sup3rStr0ng!", true},
        {"too short", "weak", false},
        {"all caps", "ALLCAPS123!", false},
        {"all lowercase", "alllower123!", false},
    }

    validator := NewPasswordValidator()
    
    for _, tt := range tests {
        t.Run(tt.name, func(t *testing.T) {
            result := validator.IsStrong(tt.password)
            assert.Equal(t, tt.expected, result)
        })
    }
}

func TestEmailValidator(t *testing.T) {
    validEmails := []string{
        "valid@example.com",
        "user.name@domain.co.uk", 
        "test+tag@gmail.com",
        "user123@sub.domain.org",
    }
    
    invalidEmails := []string{
        "invalid-email",
        "@domain.com",
        "user@",
        "spaces in@email.com",
        "user@domain",
    }
    
    validator := NewEmailValidator()
    
    for _, email := range validEmails {
        t.Run("valid: "+email, func(t *testing.T) {
            assert.True(t, validator.IsValid(email))
        })
    }
    
    for _, email := range invalidEmails {
        t.Run("invalid: "+email, func(t *testing.T) {
            assert.False(t, validator.IsValid(email))
        })
    }
}
```

### üö® –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–π

**Python:**
```python
import pytest
from bank_account import BankAccount, InsufficientFundsError

class TestBankAccount:
    def test_withdraw_more_than_balance_raises_error(self):
        # Arrange
        account = BankAccount(initial_balance=100.0)
        
        # Act & Assert
        with pytest.raises(InsufficientFundsError) as exc_info:
            account.withdraw(150.0)
        
        assert "Insufficient funds" in str(exc_info.value)
        assert exc_info.value.available_balance == 100.0
        assert exc_info.value.requested_amount == 150.0

    def test_negative_deposit_raises_error(self):
        account = BankAccount(initial_balance=0.0)
        
        with pytest.raises(ValueError, match="Amount must be positive"):
            account.deposit(-50.0)

    def test_successful_withdrawal(self):
        # Arrange
        account = BankAccount(initial_balance=200.0)
        
        # Act
        account.withdraw(50.0)
        
        # Assert
        assert account.get_balance() == 150.0
```

**Go:**
```go
func TestBankAccount(t *testing.T) {
    t.Run("Withdraw more than balance returns error", func(t *testing.T) {
        // Arrange
        account := NewBankAccount(100.0)
        
        // Act
        err := account.Withdraw(150.0)
        
        // Assert
        assert.Error(t, err)
        assert.Contains(t, err.Error(), "insufficient funds")
        assert.Equal(t, 100.0, account.GetBalance())
    })
    
    t.Run("Negative deposit returns error", func(t *testing.T) {
        account := NewBankAccount(0.0)
        
        err := account.Deposit(-50.0)
        
        assert.Error(t, err)
        assert.Contains(t, err.Error(), "amount must be positive")
    })
    
    t.Run("Successful withdrawal", func(t *testing.T) {
        // Arrange
        account := NewBankAccount(200.0)
        
        // Act
        err := account.Withdraw(50.0)
        
        // Assert
        assert.NoError(t, err)
        assert.Equal(t, 150.0, account.GetBalance())
    })
}
```

---

## üîó –ú–æ–¥—É–ª—å 3: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (2-3 –Ω–µ–¥–µ–ª–∏)

### üéØ –£—Ä–æ–≤–Ω–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

```
Application Level     ‚Üê –ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
       ‚Üì
Service Level        ‚Üê –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤ –∏ –≤–Ω–µ—à–Ω–∏—Ö API  
       ‚Üì
Component Level      ‚Üê –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å–ª–æ–µ–≤ –≤–Ω—É—Ç—Ä–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
       ‚Üì
Module Level         ‚Üê –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∫–ª–∞—Å—Å–æ–≤ –∏ –º–æ–¥—É–ª–µ–π
```

### üóÑÔ∏è –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ª–æ—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

**Python —Å pytest –∏ SQLAlchemy:**
```python
import pytest
from sqlalchemy import create_engine
from sqlalchemy.orm import sessionmaker
from models import Base, User, Order
from repositories import UserRepository, OrderRepository

@pytest.fixture
def db_session():
    # –ò—Å–ø–æ–ª—å–∑—É–µ–º in-memory SQLite –¥–ª—è —Ç–µ—Å—Ç–æ–≤
    engine = create_engine("sqlite:///:memory:")
    Base.metadata.create_all(engine)
    
    Session = sessionmaker(bind=engine)
    session = Session()
    
    yield session
    
    session.close()

class TestUserRepository:
    def test_save_and_find_user(self, db_session):
        # Arrange
        repo = UserRepository(db_session)
        user_data = {
            "email": "john@example.com",
            "name": "John Doe",
            "age": 30
        }
        
        # Act
        saved_user = repo.save(user_data)
        found_user = repo.find_by_email("john@example.com")
        
        # Assert
        assert saved_user.id is not None
        assert found_user.email == "john@example.com"
        assert found_user.name == "John Doe"
        assert found_user.age == 30

    def test_find_users_by_age_range(self, db_session):
        # Arrange
        repo = UserRepository(db_session)
        users_data = [
            {"email": "young@test.com", "name": "Young User", "age": 25},
            {"email": "middle@test.com", "name": "Middle User", "age": 35},
            {"email": "old@test.com", "name": "Old User", "age": 65},
        ]
        
        for user_data in users_data:
            repo.save(user_data)
        
        # Act
        middle_aged_users = repo.find_by_age_range(30, 40)
        
        # Assert
        assert len(middle_aged_users) == 1
        assert middle_aged_users[0].name == "Middle User"

    def test_user_orders_relationship(self, db_session):
        # Arrange
        user_repo = UserRepository(db_session)
        order_repo = OrderRepository(db_session)
        
        user = user_repo.save({"email": "customer@test.com", "name": "Customer"})
        
        # Act
        order1 = order_repo.save({"user_id": user.id, "total": 99.99, "status": "pending"})
        order2 = order_repo.save({"user_id": user.id, "total": 149.99, "status": "completed"})
        
        user_orders = order_repo.find_by_user_id(user.id)
        
        # Assert
        assert len(user_orders) == 2
        total_amount = sum(order.total for order in user_orders)
        assert total_amount == 249.98
```

**Go —Å database/sql –∏ testcontainers:**
```go
package main

import (
    "database/sql"
    "testing"
    "context"
    "github.com/testcontainers/testcontainers-go"
    "github.com/testcontainers/testcontainers-go/modules/postgres"
    "github.com/stretchr/testify/assert"
    "github.com/stretchr/testify/require"
    _ "github.com/lib/pq"
)

func setupTestDB(t *testing.T) (*sql.DB, func()) {
    ctx := context.Background()
    
    // –ó–∞–ø—É—Å–∫–∞–µ–º PostgreSQL –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
    postgresContainer, err := postgres.RunContainer(ctx,
        testcontainers.WithImage("postgres:13"),
        postgres.WithDatabase("testdb"),
        postgres.WithUsername("test"),
        postgres.WithPassword("test"),
    )
    require.NoError(t, err)
    
    connStr, err := postgresContainer.ConnectionString(ctx, "sslmode=disable")
    require.NoError(t, err)
    
    db, err := sql.Open("postgres", connStr)
    require.NoError(t, err)
    
    // –°–æ–∑–¥–∞–µ–º —Å—Ö–µ–º—É
    schema := `
        CREATE TABLE users (
            id SERIAL PRIMARY KEY,
            email VARCHAR(255) UNIQUE NOT NULL,
            name VARCHAR(255) NOT NULL,
            age INTEGER
        );
        
        CREATE TABLE orders (
            id SERIAL PRIMARY KEY,
            user_id INTEGER REFERENCES users(id),
            total DECIMAL(10,2),
            status VARCHAR(50)
        );
    `
    _, err = db.Exec(schema)
    require.NoError(t, err)
    
    cleanup := func() {
        db.Close()
        postgresContainer.Terminate(ctx)
    }
    
    return db, cleanup
}

func TestUserRepository(t *testing.T) {
    db, cleanup := setupTestDB(t)
    defer cleanup()
    
    repo := NewUserRepository(db)
    
    t.Run("Save and find user", func(t *testing.T) {
        // Arrange
        userData := User{
            Email: "john@example.com",
            Name:  "John Doe",
            Age:   30,
        }
        
        // Act
        savedUser, err := repo.Save(userData)
        require.NoError(t, err)
        
        foundUser, err := repo.FindByEmail("john@example.com")
        require.NoError(t, err)
        
        // Assert
        assert.NotZero(t, savedUser.ID)
        assert.Equal(t, "john@example.com", foundUser.Email)
        assert.Equal(t, "John Doe", foundUser.Name)
        assert.Equal(t, 30, foundUser.Age)
    })
    
    t.Run("Find users by age range", func(t *testing.T) {
        // Arrange
        users := []User{
            {Email: "young@test.com", Name: "Young User", Age: 25},
            {Email: "middle@test.com", Name: "Middle User", Age: 35},
            {Email: "old@test.com", Name: "Old User", Age: 65},
        }
        
        for _, user := range users {
            _, err := repo.Save(user)
            require.NoError(t, err)
        }
        
        // Act
        middleAgedUsers, err := repo.FindByAgeRange(30, 40)
        require.NoError(t, err)
        
        // Assert
        assert.Len(t, middleAgedUsers, 1)
        assert.Equal(t, "Middle User", middleAgedUsers[0].Name)
    })
}
```

### üåê –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ HTTP –∫–ª–∏–µ–Ω—Ç–æ–≤

**Python —Å responses –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π:**
```python
import responses
import requests
from weather_service import WeatherService

class TestWeatherService:
    @responses.activate
    def test_get_weather_success(self):
        # Arrange
        responses.add(
            responses.GET,
            "https://api.weather.com/v1/current",
            json={
                "temperature": 22.5,
                "humidity": 65,
                "description": "Partly cloudy"
            },
            status=200
        )
        
        service = WeatherService(api_key="test-key")
        
        # Act
        weather = service.get_current_weather("London")
        
        # Assert
        assert weather.temperature == 22.5
        assert weather.humidity == 65
        assert weather.description == "Partly cloudy"

    @responses.activate
    def test_get_weather_api_error(self):
        # Arrange
        responses.add(
            responses.GET,
            "https://api.weather.com/v1/current",
            json={"error": "City not found"},
            status=404
        )
        
        service = WeatherService(api_key="test-key")
        
        # Act & Assert
        with pytest.raises(WeatherServiceError) as exc_info:
            service.get_current_weather("InvalidCity")
        
        assert "City not found" in str(exc_info.value)

    @responses.activate
    def test_get_weather_with_retry(self):
        # Arrange - –ø–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å –ø–∞–¥–∞–µ—Ç, –≤—Ç–æ—Ä–æ–π —É—Å–ø–µ—à–µ–Ω
        responses.add(responses.GET, "https://api.weather.com/v1/current", 
                     status=500)
        responses.add(responses.GET, "https://api.weather.com/v1/current",
                     json={"temperature": 20.0}, status=200)
        
        service = WeatherService(api_key="test-key", retry_count=2)
        
        # Act
        weather = service.get_current_weather("London")
        
        # Assert
        assert weather.temperature == 20.0
        assert len(responses.calls) == 2  # –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –±—ã–ª–æ 2 –∑–∞–ø—Ä–æ—Å–∞
```

**Go —Å httptest:**
```go
func TestWeatherService(t *testing.T) {
    t.Run("Get weather success", func(t *testing.T) {
        // Arrange
        server := httptest.NewServer(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
            assert.Equal(t, "/v1/current", r.URL.Path)
            assert.Equal(t, "London", r.URL.Query().Get("city"))
            assert.Equal(t, "test-key", r.URL.Query().Get("api_key"))
            
            response := `{
                "temperature": 22.5,
                "humidity": 65,
                "description": "Partly cloudy"
            }`
            w.Header().Set("Content-Type", "application/json")
            w.WriteHeader(http.StatusOK)
            w.Write([]byte(response))
        }))
        defer server.Close()
        
        service := NewWeatherService("test-key")
        service.BaseURL = server.URL  // –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ–º URL –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã–π
        
        // Act
        weather, err := service.GetCurrentWeather("London")
        
        // Assert
        require.NoError(t, err)
        assert.Equal(t, 22.5, weather.Temperature)
        assert.Equal(t, 65, weather.Humidity)
        assert.Equal(t, "Partly cloudy", weather.Description)
    })
    
    t.Run("Get weather API error", func(t *testing.T) {
        // Arrange
        server := httptest.NewServer(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
            w.WriteHeader(http.StatusNotFound)
            w.Write([]byte(`{"error": "City not found"}`))
        }))
        defer server.Close()
        
        service := NewWeatherService("test-key")
        service.BaseURL = server.URL
        
        // Act
        _, err := service.GetCurrentWeather("InvalidCity")
        
        // Assert
        assert.Error(t, err)
        assert.Contains(t, err.Error(), "City not found")
    })
}
```

### üì® –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—á–µ—Ä–µ–¥–µ–π —Å–æ–æ–±—â–µ–Ω–∏–π

**Python —Å pika (RabbitMQ):**
```python
import pytest
import pika
from unittest.mock import Mock, patch
from notification_service import NotificationService

class TestNotificationService:
    @patch('pika.BlockingConnection')
    def test_send_email_notification(self, mock_connection):
        # Arrange
        mock_channel = Mock()
        mock_connection.return_value.channel.return_value = mock_channel
        
        service = NotificationService()
        notification = {
            "type": "email",
            "recipient": "user@example.com",
            "subject": "Welcome!",
            "body": "Welcome to our service"
        }
        
        # Act
        service.send_notification(notification)
        
        # Assert
        mock_channel.queue_declare.assert_called_with(queue='email_notifications', durable=True)
        mock_channel.basic_publish.assert_called_once()
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å–æ–æ–±—â–µ–Ω–∏—è
        call_args = mock_channel.basic_publish.call_args
        assert call_args[1]['routing_key'] == 'email_notifications'
        
    def test_process_notification_message(self):
        # Arrange
        mock_email_sender = Mock()
        processor = NotificationProcessor(mock_email_sender)
        
        message_body = '''
        {
            "type": "email",
            "recipient": "test@example.com", 
            "subject": "Test",
            "body": "Test message"
        }
        '''
        
        # Act
        processor.process_message(message_body)
        
        # Assert
        mock_email_sender.send.assert_called_once_with(
            to="test@example.com",
            subject="Test", 
            body="Test message"
        )

# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç —Å —Ä–µ–∞–ª—å–Ω—ã–º RabbitMQ
@pytest.mark.integration 
def test_end_to_end_notification_flow():
    # –¢—Ä–µ–±—É–µ—Ç –∑–∞–ø—É—â–µ–Ω–Ω–æ–≥–æ RabbitMQ (–º–æ–∂–Ω–æ —á–µ—Ä–µ–∑ docker-compose)
    connection = pika.BlockingConnection(
        pika.ConnectionParameters('localhost')
    )
    channel = connection.channel()
    
    # –û—á–∏—â–∞–µ–º –æ—á–µ—Ä–µ–¥—å –ø–µ—Ä–µ–¥ —Ç–µ—Å—Ç–æ–º
    channel.queue_delete(queue='test_notifications')
    channel.queue_declare(queue='test_notifications', durable=True)
    
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
    notification = {
        "type": "email",
        "recipient": "integration@test.com",
        "subject": "Integration Test"
    }
    
    channel.basic_publish(
        exchange='',
        routing_key='test_notifications',
        body=json.dumps(notification)
    )
    
    # –ß–∏—Ç–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
    method_frame, header_frame, body = channel.basic_get(queue='test_notifications')
    
    assert method_frame is not None
    received_notification = json.loads(body)
    assert received_notification['recipient'] == "integration@test.com"
    
    connection.close()
```

---

## üåê –ú–æ–¥—É–ª—å 4: API —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (2-3 –Ω–µ–¥–µ–ª–∏)

### üéØ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã API —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

```
HTTP Request Testing:
‚îú‚îÄ‚îÄ Methods (GET, POST, PUT, DELETE, PATCH)
‚îú‚îÄ‚îÄ Status Codes (200, 201, 400, 401, 404, 500)
‚îú‚îÄ‚îÄ Headers (Content-Type, Authorization, Cache-Control)  
‚îú‚îÄ‚îÄ Body (JSON, XML, Form Data)
‚îú‚îÄ‚îÄ Query Parameters
‚îî‚îÄ‚îÄ Path Parameters

API Contract Testing:
‚îú‚îÄ‚îÄ Request Schema Validation
‚îú‚îÄ‚îÄ Response Schema Validation
‚îú‚îÄ‚îÄ API Versioning
‚îî‚îÄ‚îÄ Backward Compatibility
```

### üì° REST API —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**Python —Å pytest –∏ requests:**
```python
import pytest
import requests
from fastapi.testclient import TestClient
from main import app

client = TestClient(app)

class TestUserAPI:
    def test_create_user_success(self):
        # Arrange
        user_data = {
            "email": "newuser@example.com",
            "name": "New User",
            "age": 25
        }
        
        # Act
        response = client.post("/users", json=user_data)
        
        # Assert
        assert response.status_code == 201
        response_data = response.json()
        assert response_data["email"] == "newuser@example.com"
        assert response_data["name"] == "New User"
        assert "id" in response_data
        assert "created_at" in response_data

    def test_create_user_validation_error(self):
        # Arrange
        invalid_user_data = {
            "email": "invalid-email",  # –ù–µ–≤–∞–ª–∏–¥–Ω—ã–π email
            "name": "",               # –ü—É—Å—Ç–æ–µ –∏–º—è
            "age": -5                 # –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π –≤–æ–∑—Ä–∞—Å—Ç
        }
        
        # Act
        response = client.post("/users", json=invalid_user_data)
        
        # Assert
        assert response.status_code == 422
        error_data = response.json()
        assert "detail" in error_data
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –æ—à–∏–±–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
        errors = error_data["detail"]
        email_errors = [e for e in errors if e["loc"] == ["email"]]
        name_errors = [e for e in errors if e["loc"] == ["name"]]
        age_errors = [e for e in errors if e["loc"] == ["age"]]
        
        assert len(email_errors) > 0
        assert len(name_errors) > 0  
        assert len(age_errors) > 0

    def test_get_user_by_id(self):
        # Arrange - —Å–æ–∑–¥–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        user_data = {"email": "gettest@example.com", "name": "Get Test User"}
        create_response = client.post("/users", json=user_data)
        user_id = create_response.json()["id"]
        
        # Act
        response = client.get(f"/users/{user_id}")
        
        # Assert
        assert response.status_code == 200
        user = response.json()
        assert user["id"] == user_id
        assert user["email"] == "gettest@example.com"

    def test_get_nonexistent_user(self):
        # Act
        response = client.get("/users/99999")
        
        # Assert
        assert response.status_code == 404
        error_data = response.json()
        assert "User not found" in error_data["detail"]

    def test_update_user(self):
        # Arrange
        user_data = {"email": "update@example.com", "name": "Update User"}
        create_response = client.post("/users", json=user_data)
        user_id = create_response.json()["id"]
        
        update_data = {"name": "Updated Name", "age": 30}
        
        # Act
        response = client.put(f"/users/{user_id}", json=update_data)
        
        # Assert
        assert response.status_code == 200
        updated_user = response.json()
        assert updated_user["name"] == "Updated Name"
        assert updated_user["age"] == 30
        assert updated_user["email"] == "update@example.com"  # –ù–µ –∏–∑–º–µ–Ω–∏–ª—Å—è

    def test_delete_user(self):
        # Arrange
        user_data = {"email": "delete@example.com", "name": "Delete User"}
        create_response = client.post("/users", json=user_data)
        user_id = create_response.json()["id"]
        
        # Act
        delete_response = client.delete(f"/users/{user_id}")
        
        # Assert
        assert delete_response.status_code == 204
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —É–¥–∞–ª–µ–Ω
        get_response = client.get(f"/users/{user_id}")
        assert get_response.status_code == 404

    def test_list_users_with_pagination(self):
        # Arrange - —Å–æ–∑–¥–∞–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        for i in range(15):
            user_data = {"email": f"user{i}@example.com", "name": f"User {i}"}
            client.post("/users", json=user_data)
        
        # Act
        response = client.get("/users?page=1&limit=10")
        
        # Assert
        assert response.status_code == 200
        data = response.json()
        assert "users" in data
        assert "total" in data
        assert "page" in data
        assert "limit" in data
        
        assert len(data["users"]) == 10
        assert data["page"] == 1
        assert data["limit"] == 10
        assert data["total"] >= 15

    def test_search_users_by_name(self):
        # Arrange
        client.post("/users", json={"email": "john@example.com", "name": "John Doe"})
        client.post("/users", json={"email": "jane@example.com", "name": "Jane Smith"}) 
        client.post("/users", json={"email": "bob@example.com", "name": "Bob Johnson"})
        
        # Act
        response = client.get("/users?search=john")
        
        # Assert
        assert response.status_code == 200
        users = response.json()["users"]
        
        # –î–æ–ª–∂–Ω—ã –Ω–∞–π—Ç–∏ John Doe –∏ Bob Johnson
        names = [user["name"] for user in users]
        assert "John Doe" in names
        assert "Bob Johnson" in names
        assert "Jane Smith" not in names
```

**Go —Å Gin –∏ httptest:**
```go
package main

import (
    "bytes"
    "encoding/json"
    "net/http"
    "net/http/httptest"
    "testing"
    "strconv"
    
    "github.com/gin-gonic/gin"
    "github.com/stretchr/testify/assert"
    "github.com/stretchr/testify/require"
)

func setupRouter() *gin.Engine {
    gin.SetMode(gin.TestMode)
    r := gin.Default()
    
    // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —Ä–æ—É—Ç—ã
    r.POST("/users", createUser)
    r.GET("/users/:id", getUser)
    r.PUT("/users/:id", updateUser)
    r.DELETE("/users/:id", deleteUser)
    r.GET("/users", listUsers)
    
    return r
}

func TestUserAPI(t *testing.T) {
    router := setupRouter()
    
    t.Run("Create user success", func(t *testing.T) {
        // Arrange
        userData := User{
            Email: "newuser@example.com",
            Name:  "New User",
            Age:   25,
        }
        
        jsonData, _ := json.Marshal(userData)
        
        // Act
        req, _ := http.NewRequest("POST", "/users", bytes.NewBuffer(jsonData))
        req.Header.Set("Content-Type", "application/json")
        
        w := httptest.NewRecorder()
        router.ServeHTTP(w, req)
        
        // Assert
        assert.Equal(t, http.StatusCreated, w.Code)
        
        var response User
        err := json.Unmarshal(w.Body.Bytes(), &response)
        require.NoError(t, err)
        
        assert.Equal(t, "newuser@example.com", response.Email)
        assert.Equal(t, "New User", response.Name)
        assert.NotZero(t, response.ID)
        assert.NotZero(t, response.CreatedAt)
    })
    
    t.Run("Create user validation error", func(t *testing.T) {
        // Arrange
        invalidData := map[string]interface{}{
            "email": "invalid-email",
            "name":  "",
            "age":   -5,
        }
        
        jsonData, _ := json.Marshal(invalidData)
        
        // Act
        req, _ := http.NewRequest("POST", "/users", bytes.NewBuffer(jsonData))
        req.Header.Set("Content-Type", "application/json")
        
        w := httptest.NewRecorder()
        router.ServeHTTP(w, req)
        
        // Assert
        assert.Equal(t, http.StatusBadRequest, w.Code)
        
        var errorResponse map[string]interface{}
        err := json.Unmarshal(w.Body.Bytes(), &errorResponse)
        require.NoError(t, err)
        
        assert.Contains(t, errorResponse, "error")
    })
    
    t.Run("Get user by ID", func(t *testing.T) {
        // Arrange - —Å–æ–∑–¥–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        userData := User{Email: "gettest@example.com", Name: "Get Test User"}
        jsonData, _ := json.Marshal(userData)
        
        req, _ := http.NewRequest("POST", "/users", bytes.NewBuffer(jsonData))
        req.Header.Set("Content-Type", "application/json")
        w := httptest.NewRecorder()
        router.ServeHTTP(w, req)
        
        var createdUser User
        json.Unmarshal(w.Body.Bytes(), &createdUser)
        
        // Act
        req, _ = http.NewRequest("GET", "/users/"+strconv.Itoa(createdUser.ID), nil)
        w = httptest.NewRecorder()
        router.ServeHTTP(w, req)
        
        // Assert
        assert.Equal(t, http.StatusOK, w.Code)
        
        var response User
        err := json.Unmarshal(w.Body.Bytes(), &response)
        require.NoError(t, err)
        
        assert.Equal(t, createdUser.ID, response.ID)
        assert.Equal(t, "gettest@example.com", response.Email)
    })
    
    t.Run("Get nonexistent user", func(t *testing.T) {
        // Act
        req, _ := http.NewRequest("GET", "/users/99999", nil)
        w := httptest.NewRecorder()
        router.ServeHTTP(w, req)
        
        // Assert
        assert.Equal(t, http.StatusNotFound, w.Code)
    })
    
    t.Run("Update user", func(t *testing.T) {
        // Arrange - —Å–æ–∑–¥–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        userData := User{Email: "update@example.com", Name: "Update User"}
        jsonData, _ := json.Marshal(userData)
        
        req, _ := http.NewRequest("POST", "/users", bytes.NewBuffer(jsonData))
        req.Header.Set("Content-Type", "application/json")
        w := httptest.NewRecorder()
        router.ServeHTTP(w, req)
        
        var createdUser User
        json.Unmarshal(w.Body.Bytes(), &createdUser)
        
        // Act - –æ–±–Ω–æ–≤–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        updateData := map[string]interface{}{
            "name": "Updated Name",
            "age":  30,
        }
        jsonData, _ = json.Marshal(updateData)
        
        req, _ = http.NewRequest("PUT", "/users/"+strconv.Itoa(createdUser.ID), bytes.NewBuffer(jsonData))
        req.Header.Set("Content-Type", "application/json")
        w = httptest.NewRecorder()
        router.ServeHTTP(w, req)
        
        // Assert
        assert.Equal(t, http.StatusOK, w.Code)
        
        var response User
        err := json.Unmarshal(w.Body.Bytes(), &response)
        require.NoError(t, err)
        
        assert.Equal(t, "Updated Name", response.Name)
        assert.Equal(t, 30, response.Age)
        assert.Equal(t, "update@example.com", response.Email) // –ù–µ –∏–∑–º–µ–Ω–∏–ª—Å—è
    })
    
    t.Run("List users with pagination", func(t *testing.T) {
        // Act
        req, _ := http.NewRequest("GET", "/users?page=1&limit=5", nil)
        w := httptest.NewRecorder()
        router.ServeHTTP(w, req)
        
        // Assert
        assert.Equal(t, http.StatusOK, w.Code)
        
        var response map[string]interface{}
        err := json.Unmarshal(w.Body.Bytes(), &response)
        require.NoError(t, err)
        
        assert.Contains(t, response, "users")
        assert.Contains(t, response, "total")
        assert.Contains(t, response, "page")
        assert.Contains(t, response, "limit")
    })
}
```

### üîí –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

**Python JWT —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
```python
import jwt
from datetime import datetime, timedelta

class TestAuthAPI:
    def test_login_with_valid_credentials(self):
        # Arrange
        credentials = {
            "email": "user@example.com",
            "password": "correct_password"
        }
        
        # Act
        response = client.post("/auth/login", json=credentials)
        
        # Assert
        assert response.status_code == 200
        data = response.json()
        assert "access_token" in data
        assert "refresh_token" in data
        assert data["token_type"] == "bearer"
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ —Ç–æ–∫–µ–Ω –≤–∞–ª–∏–¥–µ–Ω
        token = data["access_token"]
        payload = jwt.decode(token, options={"verify_signature": False})
        assert payload["email"] == "user@example.com"

    def test_login_with_invalid_credentials(self):
        # Arrange
        credentials = {
            "email": "user@example.com", 
            "password": "wrong_password"
        }
        
        # Act
        response = client.post("/auth/login", json=credentials)
        
        # Assert
        assert response.status_code == 401
        assert "Invalid credentials" in response.json()["detail"]

    def test_access_protected_endpoint_with_token(self):
        # Arrange - –ø–æ–ª—É—á–∞–µ–º —Ç–æ–∫–µ–Ω
        credentials = {"email": "user@example.com", "password": "correct_password"}
        login_response = client.post("/auth/login", json=credentials)
        token = login_response.json()["access_token"]
        
        # Act
        headers = {"Authorization": f"Bearer {token}"}
        response = client.get("/protected/profile", headers=headers)
        
        # Assert
        assert response.status_code == 200
        profile = response.json()
        assert profile["email"] == "user@example.com"

    def test_access_protected_endpoint_without_token(self):
        # Act
        response = client.get("/protected/profile")
        
        # Assert
        assert response.status_code == 401
        assert "Not authenticated" in response.json()["detail"]

    def test_access_protected_endpoint_with_expired_token(self):
        # Arrange - —Å–æ–∑–¥–∞–µ–º –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–π —Ç–æ–∫–µ–Ω
        payload = {
            "email": "user@example.com",
            "exp": datetime.utcnow() - timedelta(hours=1)  # –ü—Ä–æ—Å—Ä–æ—á–µ–Ω –Ω–∞ —á–∞—Å
        }
        expired_token = jwt.encode(payload, "secret", algorithm="HS256")
        
        # Act
        headers = {"Authorization": f"Bearer {expired_token}"}
        response = client.get("/protected/profile", headers=headers)
        
        # Assert
        assert response.status_code == 401
        assert "Token expired" in response.json()["detail"]

    def test_refresh_token_endpoint(self):
        # Arrange
        credentials = {"email": "user@example.com", "password": "correct_password"}
        login_response = client.post("/auth/login", json=credentials)
        refresh_token = login_response.json()["refresh_token"]
        
        # Act
        response = client.post("/auth/refresh", 
                              json={"refresh_token": refresh_token})
        
        # Assert
        assert response.status_code == 200
        data = response.json()
        assert "access_token" in data
        assert data["token_type"] == "bearer"

    def test_role_based_access_control(self):
        # Arrange - –ª–æ–≥–∏–Ω–∏–º—Å—è –∫–∞–∫ –æ–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
        user_credentials = {"email": "user@example.com", "password": "password"}
        user_login = client.post("/auth/login", json=user_credentials)
        user_token = user_login.json()["access_token"]
        
        # Act - –ø—ã—Ç–∞–µ–º—Å—è –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω —ç–Ω–¥–ø–æ–∏–Ω—Ç—É
        headers = {"Authorization": f"Bearer {user_token}"}
        response = client.get("/admin/users", headers=headers)
        
        # Assert
        assert response.status_code == 403
        assert "Insufficient permissions" in response.json()["detail"]

    def test_admin_access_control(self):
        # Arrange - –ª–æ–≥–∏–Ω–∏–º—Å—è –∫–∞–∫ –∞–¥–º–∏–Ω
        admin_credentials = {"email": "admin@example.com", "password": "admin_password"}
        admin_login = client.post("/auth/login", json=admin_credentials)
        admin_token = admin_login.json()["access_token"]
        
        # Act
        headers = {"Authorization": f"Bearer {admin_token}"}
        response = client.get("/admin/users", headers=headers)
        
        # Assert
        assert response.status_code == 200
        users_data = response.json()
        assert "users" in users_data
```

### üìä Schema Validation —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**Python —Å jsonschema:**
```python
import jsonschema
from jsonschema import validate

# –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å—Ö–µ–º—ã –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
USER_SCHEMA = {
    "type": "object",
    "properties": {
        "id": {"type": "integer", "minimum": 1},
        "email": {"type": "string", "format": "email"},
        "name": {"type": "string", "minLength": 1, "maxLength": 100},
        "age": {"type": "integer", "minimum": 0, "maximum": 150},
        "created_at": {"type": "string", "format": "date-time"},
        "updated_at": {"type": "string", "format": "date-time"}
    },
    "required": ["id", "email", "name", "created_at"],
    "additionalProperties": False
}

USER_LIST_SCHEMA = {
    "type": "object", 
    "properties": {
        "users": {
            "type": "array",
            "items": USER_SCHEMA
        },
        "total": {"type": "integer", "minimum": 0},
        "page": {"type": "integer", "minimum": 1},
        "limit": {"type": "integer", "minimum": 1, "maximum": 100}
    },
    "required": ["users", "total", "page", "limit"]
}

class TestAPISchemaValidation:
    def test_create_user_response_schema(self):
        # Arrange
        user_data = {"email": "schema@example.com", "name": "Schema User"}
        
        # Act
        response = client.post("/users", json=user_data)
        
        # Assert
        assert response.status_code == 201
        response_data = response.json()
        
        # –í–∞–ª–∏–¥–∏—Ä—É–µ–º —Å—Ö–µ–º—É –æ—Ç–≤–µ—Ç–∞
        try:
            validate(instance=response_data, schema=USER_SCHEMA)
        except jsonschema.exceptions.ValidationError as e:
            pytest.fail(f"Response schema validation failed: {e}")

    def test_list_users_response_schema(self):
        # Act
        response = client.get("/users?page=1&limit=10")
        
        # Assert
        assert response.status_code == 200
        response_data = response.json()
        
        # –í–∞–ª–∏–¥–∏—Ä—É–µ–º —Å—Ö–µ–º—É —Å–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        try:
            validate(instance=response_data, schema=USER_LIST_SCHEMA)
        except jsonschema.exceptions.ValidationError as e:
            pytest.fail(f"User list schema validation failed: {e}")

    def test_error_response_schema(self):
        # Arrange
        ERROR_SCHEMA = {
            "type": "object",
            "properties": {
                "detail": {"type": "string"},
                "error_code": {"type": "string"}
            },
            "required": ["detail"]
        }
        
        # Act
        response = client.get("/users/99999")  # –ù–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
        
        # Assert
        assert response.status_code == 404
        error_data = response.json()
        
        try:
            validate(instance=error_data, schema=ERROR_SCHEMA)
        except jsonschema.exceptions.ValidationError as e:
            pytest.fail(f"Error response schema validation failed: {e}")
```

---

## ‚ö° –ú–æ–¥—É–ª—å 5: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (2 –Ω–µ–¥–µ–ª–∏)

### üéØ –¢–∏–ø—ã –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

```
Load Testing      ‚îÇ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚îÇ     –û–±—ã—á–Ω–∞—è —Ä–∞–±–æ—á–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞
                  ‚îÇ            ‚îÇ     –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å
                  
Stress Testing    ‚îÇ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚îÇ –ü–∏–∫–æ–≤–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞
                  ‚îÇ                ‚îÇ –ò—â–µ–º —Ç–æ—á–∫—É –æ—Ç–∫–∞–∑–∞
                  
Spike Testing     ‚îÇ‚ñà‚ñà‚îÇ    ‚îÇ‚ñà‚ñà‚ñà‚ñà‚îÇ    –†–µ–∑–∫–∏–µ —Å–∫–∞—á–∫–∏ –Ω–∞–≥—Ä—É–∑–∫–∏
                  ‚îÇ  ‚îÇ    ‚îÇ    ‚îÇ    –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
                  
Volume Testing    ‚îÇ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚îÇ –ë–æ–ª—å—à–∏–µ –æ–±—ä–µ–º—ã –¥–∞–Ω–Ω—ã—Ö
                  ‚îÇ    Big Data    ‚îÇ –¢–µ—Å—Ç–∏—Ä—É–µ–º –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
```

### üìä –ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

```
Response Time    ‚Üí –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ (latency)
                   ‚îú‚îÄ‚îÄ P50 (–º–µ–¥–∏–∞–Ω–∞)
                   ‚îú‚îÄ‚îÄ P95 (95-–π –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª—å) 
                   ‚îî‚îÄ‚îÄ P99 (99-–π –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª—å)

Throughput       ‚Üí –ü—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å
                   ‚îú‚îÄ‚îÄ RPS (requests per second)
                   ‚îú‚îÄ‚îÄ TPS (transactions per second)
                   ‚îî‚îÄ‚îÄ Concurrent users

Error Rate       ‚Üí –ü—Ä–æ—Ü–µ–Ω—Ç –æ—à–∏–±–æ–∫
                   ‚îú‚îÄ‚îÄ HTTP errors (4xx, 5xx)
                   ‚îú‚îÄ‚îÄ Timeouts
                   ‚îî‚îÄ‚îÄ Connection errors

Resource Usage   ‚Üí –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
                   ‚îú‚îÄ‚îÄ CPU utilization
                   ‚îú‚îÄ‚îÄ Memory usage
                   ‚îú‚îÄ‚îÄ Disk I/O
                   ‚îî‚îÄ‚îÄ Network bandwidth
```

### üèãÔ∏è –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å k6

**JavaScript (k6):**
```javascript
import http from 'k6/http';
import { check, sleep } from 'k6';
import { Rate, Trend, Counter } from 'k6/metrics';

// –ö–∞—Å—Ç–æ–º–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏
export let errorRate = new Rate('errors');
export let responseTime = new Trend('response_time');
export let successfulLogins = new Counter('successful_logins');

// –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –Ω–∞–≥—Ä—É–∑–∫–∏
export let options = {
    stages: [
        { duration: '2m', target: 10 },   // –†–∞–∑–æ–≥—Ä–µ–≤: 10 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∑–∞ 2 –º–∏–Ω
        { duration: '5m', target: 50 },   // –ù–æ—Ä–º–∞–ª—å–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞: 50 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        { duration: '2m', target: 100 },  // –ü–∏–∫–æ–≤–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞: 100 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        { duration: '5m', target: 100 },  // –£–¥–µ—Ä–∂–∏–≤–∞–µ–º –ø–∏–∫ 5 –º–∏–Ω—É—Ç
        { duration: '2m', target: 0 },    // –ü–ª–∞–≤–Ω—ã–π —Å–ø—É—Å–∫
    ],
    thresholds: {
        'response_time': ['p(95)<500'],          // 95% –∑–∞–ø—Ä–æ—Å–æ–≤ –±—ã—Å—Ç—Ä–µ–µ 500–º—Å
        'errors': ['rate<0.01'],                 // –ú–µ–Ω–µ–µ 1% –æ—à–∏–±–æ–∫
        'http_req_duration': ['med<200'],        // –ú–µ–¥–∏–∞–Ω–∞ –±—ã—Å—Ç—Ä–µ–µ 200–º—Å
        'successful_logins': ['count>100'],      // –ú–∏–Ω–∏–º—É–º 100 —É—Å–ø–µ—à–Ω—ã—Ö –ª–æ–≥–∏–Ω–æ–≤
    },
};

// –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
const users = [
    { email: 'user1@example.com', password: 'password123' },
    { email: 'user2@example.com', password: 'password123' },
    { email: 'user3@example.com', password: 'password123' },
];

export function setup() {
    // –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ —Ç–µ—Å—Ç–æ–º
    console.log('Setting up test data...');
    
    // –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    users.forEach(user => {
        let response = http.post('http://api.example.com/users', JSON.stringify(user), {
            headers: { 'Content-Type': 'application/json' },
        });
        
        check(response, {
            'user created successfully': (r) => r.status === 201,
        });
    });
    
    return { baseUrl: 'http://api.example.com' };
}

export default function(data) {
    const baseUrl = data.baseUrl;
    
    // –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    const user = users[Math.floor(Math.random() * users.length)];
    
    // –°—Ü–µ–Ω–∞—Ä–∏–π 1: –õ–æ–≥–∏–Ω
    let loginResponse = http.post(`${baseUrl}/auth/login`, JSON.stringify(user), {
        headers: { 'Content-Type': 'application/json' },
    });
    
    let loginSuccess = check(loginResponse, {
        'login status is 200': (r) => r.status === 200,
        'login response time < 300ms': (r) => r.timings.duration < 300,
        'has access token': (r) => JSON.parse(r.body).access_token !== undefined,
    });
    
    errorRate.add(!loginSuccess);
    responseTime.add(loginResponse.timings.duration);
    
    if (loginSuccess) {
        successfulLogins.add(1);
        
        let token = JSON.parse(loginResponse.body).access_token;
        let headers = {
            'Authorization': `Bearer ${token}`,
            'Content-Type': 'application/json',
        };
        
        // –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        let profileResponse = http.get(`${baseUrl}/users/profile`, { headers });
        
        check(profileResponse, {
            'profile status is 200': (r) => r.status === 200,
            'profile response time < 200ms': (r) => r.timings.duration < 200,
            'profile has user data': (r) => JSON.parse(r.body).email !== undefined,
        });
        
        // –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø–æ—Å—Ç–æ–≤
        let postsResponse = http.get(`${baseUrl}/posts?limit=20`, { headers });
        
        check(postsResponse, {
            'posts status is 200': (r) => r.status === 200,
            'posts response time < 400ms': (r) => r.timings.duration < 400,
            'posts list not empty': (r) => JSON.parse(r.body).posts.length > 0,
        });
        
        // –°—Ü–µ–Ω–∞—Ä–∏–π 4: –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å—Ç–∞ (20% –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
        if (Math.random() < 0.2) {
            let postData = {
                title: `Test Post ${Math.random()}`,
                content: 'This is a test post content for load testing',
                tags: ['test', 'performance']
            };
            
            let createPostResponse = http.post(`${baseUrl}/posts`, JSON.stringify(postData), { headers });
            
            check(createPostResponse, {
                'create post status is 201': (r) => r.status === 201,
                'create post response time < 500ms': (r) => r.timings.duration < 500,
            });
        }
    }
    
    // –ü–∞—É–∑–∞ –º–µ–∂–¥—É –∏—Ç–µ—Ä–∞—Ü–∏—è–º–∏ (–∏–º–∏—Ç–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è)
    sleep(Math.random() * 3 + 1); // 1-4 —Å–µ–∫—É–Ω–¥—ã
}

export function teardown(data) {
    // –û—á–∏—Å—Ç–∫–∞ –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
    console.log('Cleaning up test data...');
}
```

**Python —Å locust:**
```python
from locust import HttpUser, task, between
import random
import json

class WebsiteUser(HttpUser):
    wait_time = between(1, 3)  # –ü–∞—É–∑–∞ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏ 1-3 —Å–µ–∫—É–Ω–¥—ã
    
    def on_start(self):
        """–í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
        # –õ–æ–≥–∏–Ω–∏–º—Å—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
        self.login()
    
    def login(self):
        """–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
        credentials = {
            "email": f"user{random.randint(1, 100)}@example.com",
            "password": "password123"
        }
        
        with self.client.post("/auth/login", 
                             json=credentials, 
                             catch_response=True) as response:
            if response.status_code == 200:
                self.token = response.json().get("access_token")
                response.success()
            else:
                response.failure(f"Login failed with status {response.status_code}")
    
    @property
    def headers(self):
        """–ó–∞–≥–æ–ª–æ–≤–∫–∏ —Å —Ç–æ–∫–µ–Ω–æ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏"""
        return {"Authorization": f"Bearer {self.token}"} if hasattr(self, 'token') else {}
    
    @task(3)  # –í–µ—Å 3 - –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —á–∞—â–µ
    def view_profile(self):
        """–ü—Ä–æ—Å–º–æ—Ç—Ä –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
        with self.client.get("/users/profile", 
                           headers=self.headers,
                           catch_response=True) as response:
            if response.status_code == 200:
                profile = response.json()
                if "email" in profile:
                    response.success()
                else:
                    response.failure("Profile data incomplete")
            else:
                response.failure(f"Profile request failed: {response.status_code}")
    
    @task(5)  # –í–µ—Å 5 - —Å–∞–º–æ–µ —á–∞—Å—Ç–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ
    def browse_posts(self):
        """–ü—Ä–æ—Å–º–æ—Ç—Ä —Å–ø–∏—Å–∫–∞ –ø–æ—Å—Ç–æ–≤"""
        params = {
            "page": random.randint(1, 10),
            "limit": random.choice([10, 20, 50])
        }
        
        with self.client.get("/posts", 
                           params=params,
                           headers=self.headers,
                           catch_response=True) as response:
            if response.status_code == 200:
                posts_data = response.json()
                if "posts" in posts_data and len(posts_data["posts"]) > 0:
                    response.success()
                else:
                    response.failure("No posts found")
            else:
                response.failure(f"Posts request failed: {response.status_code}")
    
    @task(1)  # –í–µ—Å 1 - —Ä–µ–¥–∫–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ
    def create_post(self):
        """–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–æ—Å—Ç–∞"""
        post_data = {
            "title": f"Load Test Post {random.randint(1, 1000)}",
            "content": "This is a test post created during load testing. " * 10,
            "tags": random.sample(["tech", "python", "testing", "performance", "api"], 2)
        }
        
        with self.client.post("/posts",
                            json=post_data,
                            headers=self.headers,
                            catch_response=True) as response:
            if response.status_code == 201:
                response.success()
            elif response.status_code == 429:  # Rate limiting
                response.failure("Rate limited")
            else:
                response.failure(f"Post creation failed: {response.status_code}")
    
    @task(2)
    def search_posts(self):
        """–ü–æ–∏—Å–∫ –ø–æ—Å—Ç–æ–≤"""
        search_terms = ["python", "golang", "testing", "api", "performance"]
        query = random.choice(search_terms)
        
        with self.client.get(f"/posts/search?q={query}",
                           headers=self.headers,
                           catch_response=True) as response:
            if response.status_code == 200:
                search_results = response.json()
                response.success()
            else:
                response.failure(f"Search failed: {response.status_code}")

# –ó–∞–ø—É—Å–∫:
# locust -f locustfile.py --host=http://localhost:8000
```

**Go –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
```go
package main

import (
    "bytes"
    "encoding/json"
    "fmt"
    "math/rand"
    "net/http"
    "sync"
    "time"
    "testing"
)

type LoadTestResult struct {
    TotalRequests    int
    SuccessRequests  int
    FailedRequests   int
    AverageLatency   time.Duration
    MaxLatency       time.Duration
    MinLatency       time.Duration
    RequestsPerSecond float64
}

type TestScenario struct {
    Name        string
    URL         string
    Method      string
    Body        interface{}
    Headers     map[string]string
    Weight      int // –í–µ—Å —Å—Ü–µ–Ω–∞—Ä–∏—è (—á–∞—Å—Ç–æ—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è)
}

func BenchmarkAPIEndpoints(b *testing.B) {
    baseURL := "http://localhost:8080"
    
    // –ü–æ–ª—É—á–∞–µ–º —Ç–æ–∫–µ–Ω –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
    token := getAuthToken(baseURL)
    
    scenarios := []TestScenario{
        {
            Name:   "GetProfile",
            URL:    baseURL + "/users/profile",
            Method: "GET",
            Headers: map[string]string{
                "Authorization": "Bearer " + token,
            },
            Weight: 3,
        },
        {
            Name:   "ListPosts",
            URL:    baseURL + "/posts?limit=20",
            Method: "GET", 
            Headers: map[string]string{
                "Authorization": "Bearer " + token,
            },
            Weight: 5,
        },
        {
            Name:   "CreatePost",
            URL:    baseURL + "/posts",
            Method: "POST",
            Body: map[string]interface{}{
                "title":   "Benchmark Post",
                "content": "Content for benchmark testing",
                "tags":    []string{"test", "benchmark"},
            },
            Headers: map[string]string{
                "Authorization": "Bearer " + token,
                "Content-Type":  "application/json",
            },
            Weight: 1,
        },
    }
    
    b.ResetTimer()
    
    // –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π —Ç–µ—Å—Ç
    b.RunParallel(func(pb *testing.PB) {
        client := &http.Client{Timeout: 5 * time.Second}
        
        for pb.Next() {
            scenario := selectScenario(scenarios)
            executeScenario(client, scenario)
        }
    })
}

func TestConcurrentLoad(t *testing.T) {
    const (
        concurrency = 50        // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        duration    = 30        // –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ç–µ—Å—Ç–∞ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
        baseURL     = "http://localhost:8080"
    )
    
    token := getAuthToken(baseURL)
    
    var wg sync.WaitGroup
    results := make(chan time.Duration, concurrency*duration*2)
    errors := make(chan error, concurrency*duration*2)
    
    startTime := time.Now()
    
    // –ó–∞–ø—É—Å–∫–∞–µ–º –≥–æ—Ä—É—Ç–∏–Ω—ã –¥–ª—è –∏–º–∏—Ç–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    for i := 0; i < concurrency; i++ {
        wg.Add(1)
        go func(userID int) {
            defer wg.Done()
            
            client := &http.Client{Timeout: 5 * time.Second}
            
            for time.Since(startTime) < time.Duration(duration)*time.Second {
                latency, err := makeRequest(client, baseURL+"/users/profile", token)
                
                if err != nil {
                    errors <- err
                } else {
                    results <- latency
                }
                
                // –ü–∞—É–∑–∞ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏
                time.Sleep(time.Duration(rand.Intn(1000)) * time.Millisecond)
            }
        }(i)
    }
    
    // –ñ–¥–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö –≥–æ—Ä—É—Ç–∏–Ω
    wg.Wait()
    close(results)
    close(errors)
    
    // –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
    result := analyzeResults(results, errors, duration)
    
    t.Logf("Load Test Results:")
    t.Logf("Total Requests: %d", result.TotalRequests)
    t.Logf("Success Rate: %.2f%%", float64(result.SuccessRequests)/float64(result.TotalRequests)*100)
    t.Logf("Average Latency: %v", result.AverageLatency)
    t.Logf("Max Latency: %v", result.MaxLatency)
    t.Logf("Min Latency: %v", result.MinLatency)
    t.Logf("Requests/Second: %.2f", result.RequestsPerSecond)
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –¥–æ–ø—É—Å—Ç–∏–º–æ–≥–æ
    if result.AverageLatency > 500*time.Millisecond {
        t.Errorf("Average latency too high: %v", result.AverageLatency)
    }
    
    if float64(result.SuccessRequests)/float64(result.TotalRequests) < 0.99 {
        t.Errorf("Success rate too low: %.2f%%", 
                float64(result.SuccessRequests)/float64(result.TotalRequests)*100)
    }
}

func getAuthToken(baseURL string) string {
    credentials := map[string]string{
        "email":    "test@example.com",
        "password": "password123",
    }
    
    jsonData, _ := json.Marshal(credentials)
    resp, err := http.Post(baseURL+"/auth/login", "application/json", bytes.NewBuffer(jsonData))
    if err != nil {
        panic("Failed to get auth token: " + err.Error())
    }
    defer resp.Body.Close()
    
    var result map[string]interface{}
    json.NewDecoder(resp.Body).Decode(&result)
    
    return result["access_token"].(string)
}

func makeRequest(client *http.Client, url, token string) (time.Duration, error) {
    req, err := http.NewRequest("GET", url, nil)
    if err != nil {
        return 0, err
    }
    
    req.Header.Set("Authorization", "Bearer "+token)
    
    start := time.Now()
    resp, err := client.Do(req)
    latency := time.Since(start)
    
    if err != nil {
        return latency, err
    }
    defer resp.Body.Close()
    
    if resp.StatusCode >= 400 {
        return latency, fmt.Errorf("HTTP error: %d", resp.StatusCode)
    }
    
    return latency, nil
}

func selectScenario(scenarios []TestScenario) TestScenario {
    totalWeight := 0
    for _, s := range scenarios {
        totalWeight += s.Weight
    }
    
    r := rand.Intn(totalWeight)
    for _, s := range scenarios {
        r -= s.Weight
        if r < 0 {
            return s
        }
    }
    
    return scenarios[0] // Fallback
}

func executeScenario(client *http.Client, scenario TestScenario) error {
    var body []byte
    if scenario.Body != nil {
        var err error
        body, err = json.Marshal(scenario.Body)
        if err != nil {
            return err
        }
    }
    
    req, err := http.NewRequest(scenario.Method, scenario.URL, bytes.NewBuffer(body))
    if err != nil {
        return err
    }
    
    for key, value := range scenario.Headers {
        req.Header.Set(key, value)
    }
    
    resp, err := client.Do(req)
    if err != nil {
        return err
    }
    defer resp.Body.Close()
    
    return nil
}

func analyzeResults(results chan time.Duration, errors chan error, duration int) LoadTestResult {
    var latencies []time.Duration
    errorCount := 0
    
    // –°–æ–±–∏—Ä–∞–µ–º –≤—Å–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
    for latency := range results {
        latencies = append(latencies, latency)
    }
    
    for range errors {
        errorCount++
    }
    
    if len(latencies) == 0 {
        return LoadTestResult{}
    }
    
    // –í—ã—á–∏—Å–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
    totalRequests := len(latencies) + errorCount
    successRequests := len(latencies)
    
    var totalLatency time.Duration
    minLatency := latencies[0]
    maxLatency := latencies[0]
    
    for _, latency := range latencies {
        totalLatency += latency
        if latency < minLatency {
            minLatency = latency
        }
        if latency > maxLatency {
            maxLatency = latency
        }
    }
    
    avgLatency := totalLatency / time.Duration(len(latencies))
    rps := float64(totalRequests) / float64(duration)
    
    return LoadTestResult{
        TotalRequests:     totalRequests,
        SuccessRequests:   successRequests,
        FailedRequests:    errorCount,
        AverageLatency:    avgLatency,
        MaxLatency:        maxLatency,
        MinLatency:        minLatency,
        RequestsPerSecond: rps,
    }
}
```

### üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**Python —Å –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ–º:**
```python
import cProfile
import pstats
import pytest
from memory_profiler import profile
import time
import psutil
import os

class TestPerformanceMonitoring:
    
    def test_function_execution_time(self):
        """–¢–µ—Å—Ç –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏"""
        start_time = time.time()
        
        # –¢–µ—Å—Ç–∏—Ä—É–µ–º–∞—è —Ñ—É–Ω–∫—Ü–∏—è
        result = heavy_computation_function(1000)
        
        execution_time = time.time() - start_time
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –±—ã—Å—Ç—Ä–æ
        assert execution_time < 1.0, f"Function too slow: {execution_time:.2f}s"
        assert result is not None
    
    @profile  # –î–µ–∫–æ—Ä–∞—Ç–æ—Ä –¥–ª—è –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è –ø–∞–º—è—Ç–∏
    def test_memory_usage(self):
        """–¢–µ—Å—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–∞–º—è—Ç–∏"""
        process = psutil.Process(os.getpid())
        initial_memory = process.memory_info().rss / 1024 / 1024  # MB
        
        # –í—ã–ø–æ–ª–Ω—è–µ–º –æ–ø–µ—Ä–∞—Ü–∏—é –∫–æ—Ç–æ—Ä–∞—è –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–ª—è—Ç—å –ø–∞–º—è—Ç—å
        large_data = create_large_dataset(100000)
        
        peak_memory = process.memory_info().rss / 1024 / 1024  # MB
        memory_increase = peak_memory - initial_memory
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –ø–∞–º—è—Ç—å –Ω–µ —É—Ç–µ–∫–∞–µ—Ç
        assert memory_increase < 100, f"Memory usage too high: {memory_increase:.2f}MB"
        
        # –û—á–∏—â–∞–µ–º –¥–∞–Ω–Ω—ã–µ
        del large_data
    
    def test_database_query_performance(self, db_session):
        """–¢–µ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ë–î"""
        # –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
        for i in range(1000):
            user = User(email=f"user{i}@test.com", name=f"User {i}")
            db_session.add(user)
        db_session.commit()
        
        start_time = time.time()
        
        # –¢–µ—Å—Ç–∏—Ä—É–µ–º —Å–ª–æ–∂–Ω—ã–π –∑–∞–ø—Ä–æ—Å
        users = db_session.query(User).filter(
            User.name.like('%User%')
        ).order_by(User.created_at.desc()).limit(50).all()
        
        query_time = time.time() - start_time
        
        assert len(users) == 50
        assert query_time < 0.1, f"Query too slow: {query_time:.3f}s"
    
    def test_concurrent_requests_performance(self):
        """–¢–µ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–∏ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö"""
        import threading
        import queue
        
        results = queue.Queue()
        errors = queue.Queue()
        
        def make_request():
            try:
                start = time.time()
                response = client.get("/users/profile")
                latency = time.time() - start
                
                if response.status_code == 200:
                    results.put(latency)
                else:
                    errors.put(f"HTTP {response.status_code}")
            except Exception as e:
                errors.put(str(e))
        
        # –ó–∞–ø—É—Å–∫–∞–µ–º 20 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
        threads = []
        for _ in range(20):
            thread = threading.Thread(target=make_request)
            threads.append(thread)
            thread.start()
        
        # –ñ–¥–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö –ø–æ—Ç–æ–∫–æ–≤
        for thread in threads:
            thread.join()
        
        # –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
        latencies = []
        while not results.empty():
            latencies.append(results.get())
        
        error_count = errors.qsize()
        
        assert error_count == 0, f"Found {error_count} errors"
        assert len(latencies) == 20, "Not all requests completed"
        
        avg_latency = sum(latencies) / len(latencies)
        max_latency = max(latencies)
        
        assert avg_latency < 0.5, f"Average latency too high: {avg_latency:.3f}s"
        assert max_latency < 1.0, f"Max latency too high: {max_latency:.3f}s"

def profile_function(func):
    """–î–µ–∫–æ—Ä–∞—Ç–æ—Ä –¥–ª—è –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π"""
    def wrapper(*args, **kwargs):
        pr = cProfile.Profile()
        pr.enable()
        
        result = func(*args, **kwargs)
        
        pr.disable()
        stats = pstats.Stats(pr)
        stats.sort_stats('cumulative')
        stats.print_stats(10)  # –¢–æ–ø 10 –º–µ–¥–ª–µ–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
        
        return result
    return wrapper

@profile_function
def heavy_computation_function(n):
    """–§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏"""
    total = 0
    for i in range(n):
        total += i ** 2
    return total

def create_large_dataset(size):
    """–°–æ–∑–¥–∞–µ—Ç –±–æ–ª—å—à–æ–π –¥–∞—Ç–∞—Å–µ—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–∞–º—è—Ç–∏"""
    return [{"id": i, "data": f"item_{i}" * 100} for i in range(size)]
```

---

## üõ°Ô∏è –ú–æ–¥—É–ª—å 6: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (1-2 –Ω–µ–¥–µ–ª–∏)

### üéØ –ö–∞—Ä—Ç–∞ —É–≥—Ä–æ–∑ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

```
OWASP Top 10 2021:
‚îú‚îÄ‚îÄ A01 - Broken Access Control     ‚Üí –ù–∞—Ä—É—à–µ–Ω–∏–µ –∫–æ–Ω—Ç—Ä–æ–ª—è –¥–æ—Å—Ç—É–ø–∞
‚îú‚îÄ‚îÄ A02 - Cryptographic Failures    ‚Üí –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏
‚îú‚îÄ‚îÄ A03 - Injection                 ‚Üí SQL/NoSQL/Command –∏–Ω—ä–µ–∫—Ü–∏–∏
‚îú‚îÄ‚îÄ A04 - Insecure Design          ‚Üí –ù–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–π –¥–∏–∑–∞–π–Ω
‚îú‚îÄ‚îÄ A05 - Security Misconfiguration ‚Üí –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ A06 - Vulnerable Components     ‚Üí –£—è–∑–≤–∏–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îú‚îÄ‚îÄ A07 - Auth & Session Management ‚Üí –ü—Ä–æ–±–ª–µ–º—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ A08 - Software & Data Integrity ‚Üí –¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –ü–û –∏ –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ A09 - Security Logging         ‚Üí –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îî‚îÄ‚îÄ A10 - Server-Side Request Forgery ‚Üí SSRF –∞—Ç–∞–∫–∏
```

### üíâ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ SQL Injection

**Python —Ç–µ—Å—Ç—ã –Ω–∞ SQL –∏–Ω—ä–µ–∫—Ü–∏–∏:**
```python
import pytest
from sqlalchemy.exc import SQLAlchemyError
from user_service import UserService, DatabaseError

class TestSQLInjectionPrevention:
    
    def test_user_search_prevents_sql_injection(self):
        """–ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞—â–∏—Ç—É –æ—Ç SQL –∏–Ω—ä–µ–∫—Ü–∏–∏ –≤ –ø–æ–∏—Å–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"""
        malicious_inputs = [
            "'; DROP TABLE users; --",
            "' OR '1'='1",
            "'; DELETE FROM users WHERE '1'='1'; --", 
            "' UNION SELECT password FROM users --",
            "admin'--",
            "' OR 1=1#",
            "'; EXEC xp_cmdshell('dir'); --"
        ]
        
        user_service = UserService()
        
        for malicious_input in malicious_inputs:
            # –î–æ–ª–∂–µ–Ω –ª–∏–±–æ –≤–µ—Ä–Ω—É—Ç—å –ø—É—Å—Ç–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –ª–∏–±–æ –æ—à–∏–±–∫—É –≤–∞–ª–∏–¥–∞—Ü–∏–∏
            # –ù–û –ù–ï –≤—ã–ø–æ–ª–Ω–∏—Ç—å SQL –∏–Ω—ä–µ–∫—Ü–∏—é
            try:
                result = user_service.search_users(malicious_input)
                # –ï—Å–ª–∏ –ø–æ–∏—Å–∫ –ø—Ä–æ—à–µ–ª, —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω—ã–º
                assert isinstance(result, list)
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ —Ç–∞–±–ª–∏—Ü–∞ users –≤—Å–µ –µ—â–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
                users_count = user_service.count_all_users()
                assert users_count >= 0
            except (ValueError, DatabaseError) as e:
                # –û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ - —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ
                assert "invalid" in str(e).lower() or "forbidden" in str(e).lower()
    
    def test_login_prevents_sql_injection(self):
        """–¢–µ—Å—Ç–∏—Ä—É–µ–º –∑–∞—â–∏—Ç—É –æ—Ç SQL –∏–Ω—ä–µ–∫—Ü–∏–∏ –≤ –ª–æ–≥–∏–Ω–µ"""
        malicious_credentials = [
            {"email": "admin'--", "password": "anything"},
            {"email": "' OR 1=1 --", "password": ""},
            {"email": "'; DROP TABLE users; --", "password": "test"},
        ]
        
        auth_service = AuthService()
        
        for credentials in malicious_credentials:
            # –õ–æ–≥–∏–Ω –¥–æ–ª–∂–µ–Ω –±–µ–∑–æ–ø–∞—Å–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π –≤–≤–æ–¥
            result = auth_service.authenticate(
                credentials["email"], 
                credentials["password"]
            )
            
            # –õ–æ–≥–∏–Ω –¥–æ–ª–∂–µ–Ω –ø—Ä–æ–≤–∞–ª–∏—Ç—å—Å—è
            assert result is None or result.get("success") is False
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∞
            user_count = auth_service.user_repository.count_all()
            assert user_count >= 0
    
    def test_parameterized_queries_usage(self):
        """–ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã"""
        # –≠—Ç–æ—Ç —Ç–µ—Å—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ–¥ –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
        import inspect
        from user_repository import UserRepository
        
        repo = UserRepository()
        
        # –ü–æ–ª—É—á–∞–µ–º –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –º–µ—Ç–æ–¥–æ–≤
        search_method_source = inspect.getsource(repo.search_by_name)
        find_by_email_source = inspect.getsource(repo.find_by_email)
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è —Å—Ç—Ä–æ–∫
        dangerous_patterns = [
            "SELECT * FROM users WHERE name = '" + ",",
            'SELECT * FROM users WHERE name = "' + ',
            "% " + " %",
            ".format(",
            "f\"SELECT",
            "f'SELECT"
        ]
        
        for pattern in dangerous_patterns:
            assert pattern not in search_method_source, \
                f"Dangerous pattern found: {pattern}"
            assert pattern not in find_by_email_source, \
                f"Dangerous pattern found: {pattern}"
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
        safe_patterns = [
            ".query(",
            "bindparam(",
            "text(",
            ":name",  # –ò–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
            "?",      # –ü–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
        ]
        
        has_safe_pattern = any(
            pattern in search_method_source for pattern in safe_patterns
        )
        assert has_safe_pattern, "No safe query patterns found"

    @pytest.mark.integration
    def test_stored_procedures_injection_prevention(self, db_connection):
        """–¢–µ—Å—Ç–∏—Ä—É–µ–º –∑–∞—â–∏—Ç—É –æ—Ç –∏–Ω—ä–µ–∫—Ü–∏–π –≤ —Ö—Ä–∞–Ω–∏–º—ã—Ö –ø—Ä–æ—Ü–µ–¥—É—Ä–∞—Ö"""
        cursor = db_connection.cursor()
        
        # –í—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø—Ä–æ—Ü–µ–¥—É—Ä—ã
        malicious_data = [
            "'; EXEC xp_cmdshell('rm -rf /'); --",
            "test'; DROP PROCEDURE GetUserStats; --"
        ]
        
        for malicious_input in malicious_data:
            try:
                # –í—ã–∑—ã–≤–∞–µ–º —Ö—Ä–∞–Ω–∏–º—É—é –ø—Ä–æ—Ü–µ–¥—É—Ä—É —Å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
                cursor.callproc('GetUserStats', [malicious_input])
                results = cursor.fetchall()
                
                # –ü—Ä–æ—Ü–µ–¥—É—Ä–∞ –¥–æ–ª–∂–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ
                assert isinstance(results, (list, tuple))
                
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ –≤—Å–µ –µ—â–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
                cursor.execute("SELECT COUNT(*) FROM information_schema.routines WHERE routine_name = 'GetUserStats'")
                proc_count = cursor.fetchone()[0]
                assert proc_count == 1, "Stored procedure was deleted!"
                
            except Exception as e:
                # –û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è - –ø—Ä–∏–µ–º–ª–µ–º–æ, –µ—Å–ª–∏ —ç—Ç–æ –æ—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
                assert "syntax error" not in str(e).lower(), \
                    f"SQL syntax error suggests injection vulnerability: {e}"
```

**Go —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ SQL –∏–Ω—ä–µ–∫—Ü–∏–π:**
```go
package security

import (
    "database/sql"
    "strings"
    "testing"
    
    "github.com/stretchr/testify/assert"
    "github.com/stretchr/testify/require"
)

func TestSQLInjectionPrevention(t *testing.T) {
    db := setupTestDatabase(t)
    defer db.Close()
    
    userRepo := NewUserRepository(db)
    
    maliciousInputs := []string{
        "'; DROP TABLE users; --",
        "' OR '1'='1",
        "'; DELETE FROM users; --",
        "' UNION SELECT password FROM users --",
        "admin'--",
        "' OR 1=1#",
    }
    
    // –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    testUser := User{Name: "testuser", Email: "test@example.com"}
    _, err := userRepo.Create(testUser)
    require.NoError(t, err)
    
    originalCount, err := userRepo.Count()
    require.NoError(t, err)
    
    for _, maliciousInput := range maliciousInputs {
        t.Run("Malicious input: "+maliciousInput, func(t *testing.T) {
            // –¢–µ—Å—Ç–∏—Ä—É–µ–º –ø–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
            users, err := userRepo.SearchByName(maliciousInput)
            
            // –ó–∞–ø—Ä–æ—Å –¥–æ–ª–∂–µ–Ω –ª–∏–±–æ –≤–µ—Ä–Ω—É—Ç—å –ø—É—Å—Ç–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –ª–∏–±–æ –æ—à–∏–±–∫—É –≤–∞–ª–∏–¥–∞—Ü–∏–∏
            if err != nil {
                // –û—à–∏–±–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å–≤—è–∑–∞–Ω–∞ —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π, –∞ –Ω–µ —Å SQL
                assert.NotContains(t, strings.ToLower(err.Error()), "syntax error")
                assert.NotContains(t, strings.ToLower(err.Error()), "near")
            } else {
                // –ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å –ø—Ä–æ—à–µ–ª, –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
                assert.IsType(t, []User{}, users)
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ —Ç–∞–±–ª–∏—Ü–∞ –Ω–µ –±—ã–ª–∞ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∞
            currentCount, err := userRepo.Count()
            require.NoError(t, err)
            assert.Equal(t, originalCount, currentCount, 
                "User count changed - possible injection attack succeeded")
        })
    }
}

func TestParameterizedQueries(t *testing.T) {
    db := setupTestDatabase(t)
    defer db.Close()
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –∑–∞–ø—Ä–æ—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
    testCases := []struct {
        name     string
        query    string
        args     []interface{}
        expected bool
    }{
        {
            name:     "Parameterized query",
            query:    "SELECT * FROM users WHERE name = ? AND email = ?",
            args:     []interface{}{"John", "john@example.com"},
            expected: true,
        },
        {
            name:     "Named parameters",
            query:    "SELECT * FROM users WHERE name = :name AND email = :email",
            args:     []interface{}{sql.Named("name", "John"), sql.Named("email", "john@example.com")},
            expected: true,
        },
    }
    
    for _, tc := range testCases {
        t.Run(tc.name, func(t *testing.T) {
            rows, err := db.Query(tc.query, tc.args...)
            if tc.expected {
                assert.NoError(t, err)
                if rows != nil {
                    rows.Close()
                }
            } else {
                assert.Error(t, err)
            }
        })
    }
}

func TestStoredProcedureInjection(t *testing.T) {
    db := setupTestDatabase(t)
    defer db.Close()
    
    maliciousInputs := []string{
        "'; EXEC sp_configure 'show advanced options', 1; --",
        "test'; DROP PROCEDURE GetUserStats; --",
    }
    
    for _, input := range maliciousInputs {
        t.Run("Testing stored procedure with: "+input, func(t *testing.T) {
            // –í—ã–∑—ã–≤–∞–µ–º —Ö—Ä–∞–Ω–∏–º—É—é –ø—Ä–æ—Ü–µ–¥—É—Ä—É —Å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
            rows, err := db.Query("CALL GetUserStats(?)", input)
            
            if err != nil {
                // –û—à–∏–±–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å–≤—è–∑–∞–Ω–∞ —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π, –Ω–µ —Å SQL —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–æ–º
                assert.NotContains(t, strings.ToLower(err.Error()), "syntax error")
            } else {
                // –ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å –ø—Ä–æ—à–µ–ª, –∑–∞–∫—Ä—ã–≤–∞–µ–º rows
                if rows != nil {
                    rows.Close()
                }
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ –≤—Å–µ –µ—â–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
            var procCount int
            err = db.QueryRow("SELECT COUNT(*) FROM information_schema.routines WHERE routine_name = 'GetUserStats'").Scan(&procCount)
            require.NoError(t, err)
            assert.Equal(t, 1, procCount, "Stored procedure was deleted - injection succeeded!")
        })
    }
}
```

### üîê –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

**Python —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ JWT –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:**
```python
import jwt
import pytest
from datetime import datetime, timedelta
from freezegun import freeze_time

class TestJWTSecurity:
    
    def test_jwt_token_expiration(self):
        """–ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ —Ç–æ–∫–µ–Ω—ã –∏—Å—Ç–µ–∫–∞—é—Ç"""
        auth_service = AuthService()
        
        # –°–æ–∑–¥–∞–µ–º —Ç–æ–∫–µ–Ω
        user_data = {"email": "test@example.com", "user_id": 1}
        token = auth_service.create_access_token(user_data, expires_in=3600)  # 1 —á–∞—Å
        
        # –¢–æ–∫–µ–Ω –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤–∞–ª–∏–¥–µ–Ω —Å–µ–π—á–∞—Å
        payload = auth_service.verify_token(token)
        assert payload["email"] == "test@example.com"
        
        # –ü–µ—Ä–µ–º–µ—â–∞–µ–º—Å—è –≤ –±—É–¥—É—â–µ–µ –Ω–∞ 2 —á–∞—Å–∞
        with freeze_time(datetime.utcnow() + timedelta(hours=2)):
            # –¢–æ–∫–µ–Ω –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø—Ä–æ—Å—Ä–æ—á–µ–Ω
            with pytest.raises(jwt.ExpiredSignatureError):
                auth_service.verify_token(token)
    
    def test_jwt_token_tampering_detection(self):
        """–ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞—â–∏—Ç—É –æ—Ç –ø–æ–¥–¥–µ–ª–∫–∏ —Ç–æ–∫–µ–Ω–æ–≤"""
        auth_service = AuthService()
        
        user_data = {"email": "user@example.com", "user_id": 1, "role": "user"}
        token = auth_service.create_access_token(user_data)
        
        # –ü—ã—Ç–∞–µ–º—Å—è –∏–∑–º–µ–Ω–∏—Ç—å payload —Ç–æ–∫–µ–Ω–∞
        header, payload, signature = token.split('.')
        
        # –î–µ–∫–æ–¥–∏—Ä—É–µ–º payload –∏ –∏–∑–º–µ–Ω—è–µ–º —Ä–æ–ª—å
        import base64
        import json
        
        payload_data = json.loads(base64.urlsafe_b64decode(payload + '=='))
        payload_data["role"] = "admin"  # –ü–æ–≤—ã—à–∞–µ–º –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏
        
        # –ö–æ–¥–∏—Ä—É–µ–º –æ–±—Ä–∞—Ç–Ω–æ
        modified_payload = base64.urlsafe_b64encode(
            json.dumps(payload_data).encode()
        ).decode().rstrip('=')
        
        tampered_token = f"{header}.{modified_payload}.{signature}"
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ–ª–∂–Ω–∞ –ø—Ä–æ–≤–∞–ª–∏—Ç—å—Å—è
        with pytest.raises(jwt.InvalidSignatureError):
            auth_service.verify_token(tampered_token)
    
    def test_weak_jwt_secrets_prevention(self):
        """–ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å–ª–∞–±—ã–µ —Å–µ–∫—Ä–µ—Ç—ã"""
        weak_secrets = [
            "secret",
            "123456",
            "password",
            "jwt_secret",
            "your-256-bit-secret",
            ""
        ]
        
        for weak_secret in weak_secrets:
            with pytest.raises((ValueError, AssertionError)):
                # AuthService –¥–æ–ª–∂–µ–Ω –æ—Ç–∫–ª–æ–Ω–∏—Ç—å —Å–ª–∞–±—ã–µ —Å–µ–∫—Ä–µ—Ç—ã
                AuthService(jwt_secret=weak_secret)
    
    def test_password_hashing_security(self):
        """–ü—Ä–æ–≤–µ—Ä—è–µ–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –ø–∞—Ä–æ–ª–µ–π"""
        auth_service = AuthService()
        
        password = "user_password_123"
        
        # –•–µ—à–∏—Ä—É–µ–º –ø–∞—Ä–æ–ª—å
        hashed1 = auth_service.hash_password(password)
        hashed2 = auth_service.hash_password(password)
        
        # –•–µ—à–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ä–∞–∑–Ω—ã–º–∏ (salt)
        assert hashed1 != hashed2
        
        # –ù–æ –æ–±–∞ –¥–æ–ª–∂–Ω—ã –ø—Ä–æ—Ö–æ–¥–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É
        assert auth_service.verify_password(password, hashed1)
        assert auth_service.verify_password(password, hashed2)
        
        # –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–∞—Ä–æ–ª—å –Ω–µ –¥–æ–ª–∂–µ–Ω –ø—Ä–æ—Ö–æ–¥–∏—Ç—å
        assert not auth_service.verify_password("wrong_password", hashed1)
        
        # –•–µ—à –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª–∏–Ω–Ω—ã–º (bcrypt/scrypt/argon2)
        assert len(hashed1) > 50
        
        # –•–µ—à –Ω–µ –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∏—Å—Ö–æ–¥–Ω—ã–π –ø–∞—Ä–æ–ª—å
        assert password not in hashed1
    
    def test_rate_limiting_authentication(self):
        """–¢–µ—Å—Ç–∏—Ä—É–µ–º –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞"""
        auth_service = AuthService()
        
        # –î–µ–ª–∞–µ–º –º–Ω–æ–≥–æ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞
        for attempt in range(6):  # –ü—Ä–µ–≤—ã—à–∞–µ–º –ª–∏–º–∏—Ç –≤ 5 –ø–æ–ø—ã—Ç–æ–∫
            result = auth_service.authenticate(
                "user@example.com", 
                "wrong_password"
            )
            
            if attempt < 5:
                # –ü–µ—Ä–≤—ã–µ 5 –ø–æ–ø—ã—Ç–æ–∫ –¥–æ–ª–∂–Ω—ã –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ–≤–∞–ª–∏—Ç—å—Å—è
                assert result is None or not result.get("success")
            else:
                # 6-—è –ø–æ–ø—ã—Ç–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞
                assert result is not None
                assert "rate_limited" in result or "too_many_attempts" in str(result)
    
    def test_session_fixation_prevention(self):
        """–ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞—â–∏—Ç—É –æ—Ç —Ñ–∏–∫—Å–∞—Ü–∏–∏ —Å–µ—Å—Å–∏–∏"""
        session_service = SessionService()
        
        # –°–æ–∑–¥–∞–µ–º –∞–Ω–æ–Ω–∏–º–Ω—É—é —Å–µ—Å—Å–∏—é
        anon_session_id = session_service.create_anonymous_session()
        
        # –õ–æ–≥–∏–Ω–∏–º—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
        user = {"email": "test@example.com", "user_id": 1}
        auth_session_id = session_service.login_user(user)
        
        # ID —Å–µ—Å—Å–∏–∏ –¥–æ–ª–∂–µ–Ω –∏–∑–º–µ–Ω–∏—Ç—å—Å—è –ø–æ—Å–ª–µ –ª–æ–≥–∏–Ω–∞
        assert anon_session_id != auth_session_id
        
        # –°—Ç–∞—Ä–∞—è —Å–µ—Å—Å–∏—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞
        assert not session_service.is_valid_session(anon_session_id)
        assert session_service.is_valid_session(auth_session_id)
    
    def test_privilege_escalation_prevention(self):
        """–¢–µ—Å—Ç–∏—Ä—É–µ–º –∑–∞—â–∏—Ç—É –æ—Ç –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π"""
        auth_service = AuthService()
        
        # –°–æ–∑–¥–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –æ–±—ã—á–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏
        user_token = auth_service.create_access_token({
            "email": "user@example.com",
            "user_id": 1,
            "role": "user"
        })
        
        # –ü—ã—Ç–∞–µ–º—Å—è –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω—Å–∫–∏–º —Ñ—É–Ω–∫—Ü–∏—è–º
        headers = {"Authorization": f"Bearer {user_token}"}
        
        admin_endpoints = [
            "/admin/users",
            "/admin/settings", 
            "/admin/logs",
            "/api/admin/delete_user"
        ]
        
        for endpoint in admin_endpoints:
            response = client.get(endpoint, headers=headers)
            # –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ç–∫–∞–∑ –≤ –¥–æ—Å—Ç—É–ø–µ
            assert response.status_code in [401, 403]
            assert "insufficient" in response.json().get("detail", "").lower() or \
                   "forbidden" in response.json().get("detail", "").lower()
```

### üåê –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ API

**Python —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ CORS –∏ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:**
```python
class TestAPISecurity:
    
    def test_cors_headers_configuration(self):
        """–ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –Ω–∞—Å—Ç—Ä–æ–π–∫—É CORS"""
        # –¢–µ—Å—Ç preflight –∑–∞–ø—Ä–æ—Å–∞
        response = client.options("/api/users", headers={
            "Origin": "https://example.com",
            "Access-Control-Request-Method": "POST",
            "Access-Control-Request-Headers": "Content-Type,Authorization"
        })
        
        assert response.status_code == 200
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º CORS –∑–∞–≥–æ–ª–æ–≤–∫–∏
        assert "Access-Control-Allow-Origin" in response.headers
        assert "Access-Control-Allow-Methods" in response.headers
        assert "Access-Control-Allow-Headers" in response.headers
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –Ω–µ —Ä–∞–∑—Ä–µ—à–µ–Ω –¥–æ—Å—Ç—É–ø —Å –ª—é–±—ã—Ö –¥–æ–º–µ–Ω–æ–≤
        assert response.headers["Access-Control-Allow-Origin"] != "*"
    
    def test_security_headers_presence(self):
        """–ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏"""
        response = client.get("/api/users")
        
        required_security_headers = {
            "X-Content-Type-Options": "nosniff",
            "X-Frame-Options": "DENY",
            "X-XSS-Protection": "1; mode=block",
            "Strict-Transport-Security": "max-age=31536000; includeSubDomains",
            "Content-Security-Policy": lambda val: "default-src" in val,
            "Referrer-Policy": "strict-origin-when-cross-origin"
        }
        
        for header, expected_value in required_security_headers.items():
            assert header in response.headers, f"Missing security header: {header}"
            
            if callable(expected_value):
                assert expected_value(response.headers[header]), \
                    f"Invalid {header}: {response.headers[header]}"
            else:
                assert response.headers[header] == expected_value, \
                    f"Invalid {header}: {response.headers[header]}"
    
    def test_sensitive_data_exposure_prevention(self):
        """–ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ —É—Ç–µ–∫–∞—é—Ç"""
        # –°–æ–∑–¥–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        user_data = {
            "email": "sensitive@example.com",
            "password": "secret_password_123",
            "ssn": "123-45-6789"
        }
        
        response = client.post("/users", json=user_data)
        assert response.status_code == 201
        
        user_response = response.json()
        
        # –ü–∞—Ä–æ–ª—å –Ω–µ –¥–æ–ª–∂–µ–Ω –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å—Å—è
        assert "password" not in user_response
        
        # SSN –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å
        if "ssn" in user_response:
            ssn = user_response["ssn"]
            assert "***" in ssn or "XXX" in ssn, f"SSN not masked: {ssn}"
        
        # –ü–æ–ª—É—á–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ API
        user_id = user_response["id"]
        get_response = client.get(f"/users/{user_id}")
        get_data = get_response.json()
        
        # –ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ –ø—É–±–ª–∏—á–Ω–æ–º API
        sensitive_fields = ["password", "password_hash", "secret_key"]
        for field in sensitive_fields:
            assert field not in get_data, f"Sensitive field exposed: {field}"
    
    def test_input_validation_and_sanitization(self):
        """–¢–µ—Å—Ç–∏—Ä—É–µ–º –≤–∞–ª–∏–¥–∞—Ü–∏—é –∏ —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—é –≤–≤–æ–¥–∞"""
        malicious_inputs = [
            "<script>alert('XSS')</script>",
            "javascript:alert('XSS')",
            "../../etc/passwd",
            "../../../windows/system32",
            "'; DROP TABLE users; --",
            "\x00\x01\x02",  # Null bytes
            "A" * 10000,     # –û—á–µ–Ω—å –¥–ª–∏–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞
        ]
        
        for malicious_input in malicious_inputs:
            # –¢–µ—Å—Ç–∏—Ä—É–µ–º —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
            user_data = {
                "name": malicious_input,
                "email": f"test{hash(malicious_input)}@example.com",
                "bio": malicious_input
            }
            
            response = client.post("/users", json=user_data)
            
            if response.status_code == 201:
                # –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–Ω, –¥–∞–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–∞–Ω–∏—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω—ã
                created_user = response.json()
                
                # XSS —Å–∫—Ä–∏–ø—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —É–¥–∞–ª–µ–Ω—ã –∏–ª–∏ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω—ã
                assert "<script>" not in created_user.get("name", "")
                assert "javascript:" not in created_user.get("name", "")
                
                # Path traversal –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω
                assert "../" not in created_user.get("name", "")
                
            elif response.status_code == 422:
                # –û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ - –ø—Ä–∏–µ–º–ª–µ–º–æ
                error_data = response.json()
                assert "detail" in error_data
            else:
                pytest.fail(f"Unexpected response for malicious input: {response.status_code}")
    
    def test_file_upload_security(self):
        """–¢–µ—Å—Ç–∏—Ä—É–µ–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤"""
        # –°–æ–∑–¥–∞–µ–º —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ç–∏–ø—ã —Ñ–∞–π–ª–æ–≤ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        test_files = {
            "valid_image.jpg": (b"\xFF\xD8\xFF", "image/jpeg"),
            "malicious.php": (b"<?php system($_GET['cmd']); ?>", "application/x-php"),
            "script.js": (b"alert('XSS');", "application/javascript"),
            "large_file.txt": (b"A" * (10 * 1024 * 1024), "text/plain"),  # 10MB
            "empty_file.txt": (b"", "text/plain"),
        }
        
        for filename, (content, content_type) in test_files.items():
            files = {"file": (filename, content, content_type)}
            
            response = client.post("/upload", files=files)
            
            if filename == "valid_image.jpg":
                # –í–∞–ª–∏–¥–Ω—ã–π —Ñ–∞–π–ª –¥–æ–ª–∂–µ–Ω –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è
                assert response.status_code in [200, 201]
            
            elif filename in ["malicious.php", "script.js"]:
                # –ò—Å–ø–æ–ª–Ω—è–µ–º—ã–µ —Ñ–∞–π–ª—ã –¥–æ–ª–∂–Ω—ã –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å—Å—è
                assert response.status_code in [400, 403, 422]
                error_msg = response.json().get("detail", "").lower()
                assert any(word in error_msg for word in ["forbidden", "invalid", "not allowed"])
            
            elif filename == "large_file.txt":
                # –°–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã –¥–æ–ª–∂–Ω—ã –æ—Ç–∫–ª–æ–Ω—è—Ç—å—Å—è
                assert response.status_code in [413, 422]
            
            elif filename == "empty_file.txt":
                # –ü—É—Å—Ç—ã–µ —Ñ–∞–π–ª—ã –º–æ–≥—É—Ç –±—ã—Ç—å –æ—Ç–∫–ª–æ–Ω–µ–Ω—ã –∏–ª–∏ –ø—Ä–∏–Ω—è—Ç—ã
                assert response.status_code in [200, 201, 400, 422]
    
    def test_api_rate_limiting(self):
        """–¢–µ—Å—Ç–∏—Ä—É–µ–º –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ API"""
        import time
        
        # –î–µ–ª–∞–µ–º –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ–¥—Ä—è–¥
        responses = []
        for i in range(101):  # –ü—Ä–µ–≤—ã—à–∞–µ–º –ª–∏–º–∏—Ç –≤ 100 –∑–∞–ø—Ä–æ—Å–æ–≤
            response = client.get("/api/public-endpoint")
            responses.append(response)
            
            if response.status_code == 429:  # Too Many Requests
                break
        
        # –î–æ–ª–∂–µ–Ω —Å—Ä–∞–±–æ—Ç–∞—Ç—å rate limiting
        rate_limited_responses = [r for r in responses if r.status_code == 429]
        assert len(rate_limited_responses) > 0, "Rate limiting not working"
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ rate limiting
        last_response = responses[-1]
        if last_response.status_code == 429:
            assert "Retry-After" in last_response.headers or \
                   "X-RateLimit-Reset" in last_response.headers
```

---

## üèóÔ∏è –ú–æ–¥—É–ª—å 7: –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (2-3 –Ω–µ–¥–µ–ª–∏)

### üîÑ CI/CD Pipeline —Å —Ç–µ—Å—Ç–∞–º–∏

**–°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è —Å—Ö–µ–º–∞ CI/CD:**
```
Code Push ‚Üí Pre-commit hooks ‚Üí CI Pipeline ‚Üí Deployment Pipeline
     ‚Üì            ‚Üì               ‚Üì              ‚Üì
   Linting    Unit Tests     Integration    Production
   Format     Coverage       E2E Tests      Monitoring
   Security   Build          Performance    Rollback
```

**GitHub Actions Configuration:**
```yaml
# .github/workflows/test.yml
name: Test Suite

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]

env:
  DATABASE_URL: postgresql://test:test@localhost:5432/testdb
  REDIS_URL: redis://localhost:6379
  SECRET_KEY: test-secret-key-for-ci

jobs:
  lint:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.11'
      
      - name: Install dependencies
        run: |
          pip install poetry
          poetry install --with dev
      
      - name: Lint with flake8
        run: poetry run flake8 src/ tests/
      
      - name: Format check with black
        run: poetry run black --check src/ tests/
      
      - name: Type check with mypy
        run: poetry run mypy src/
      
      - name: Security check with bandit
        run: poetry run bandit -r src/

  unit-tests:
    runs-on: ubuntu-latest
    needs: lint
    
    strategy:
      matrix:
        python-version: ['3.9', '3.10', '3.11']
    
    steps:
      - uses: actions/checkout@v3
      
      - name: Set up Python ${{ matrix.python-version }}
        uses: actions/setup-python@v4
        with:
          python-version: ${{ matrix.python-version }}
      
      - name: Install dependencies
        run: |
          pip install poetry
          poetry install
      
      - name: Run unit tests
        run: |
          poetry run pytest tests/unit/ \
            --cov=src \
            --cov-report=xml \
            --cov-report=html \
            --junit-xml=test-results.xml
      
      - name: Upload coverage to Codecov
        uses: codecov/codecov-action@v3
        with:
          file: ./coverage.xml
          fail_ci_if_error: true
      
      - name: Upload test results
        uses: actions/upload-artifact@v3
        if: always()
        with:
          name: test-results-${{ matrix.python-version }}
          path: test-results.xml

  integration-tests:
    runs-on: ubuntu-latest
    needs: unit-tests
    
    services:
      postgres:
        image: postgres:13
        env:
          POSTGRES_PASSWORD: test
          POSTGRES_USER: test
          POSTGRES_DB: testdb
        options: >-
          --health-cmd pg_isready
          --health-interval 10s
          --health-timeout 5s
          --health-retries 5
        ports:
          - 5432:5432
      
      redis:
        image: redis:7
        options: >-
          --health-cmd "redis-cli ping"
          --health-interval 10s
          --health-timeout 5s
          --health-retries 5
        ports:
          - 6379:6379
    
    steps:
      - uses: actions/checkout@v3
      
      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.11'
      
      - name: Install dependencies
        run: |
          pip install poetry
          poetry install
      
      - name: Run database migrations
        run: poetry run alembic upgrade head
      
      - name: Run integration tests
        run: |
          poetry run pytest tests/integration/ \
            --junit-xml=integration-results.xml
      
      - name: Upload integration test results
        uses: actions/upload-artifact@v3
        if: always()
        with:
          name: integration-test-results
          path: integration-results.xml

  security-tests:
    runs-on: ubuntu-latest
    needs: unit-tests
    
    steps:
      - uses: actions/checkout@v3
      
      - name: Run Trivy vulnerability scanner
        uses: aquasecurity/trivy-action@master
        with:
          scan-type: 'fs'
          scan-ref: '.'
          format: 'sarif'
          output: 'trivy-results.sarif'
      
      - name: Upload Trivy scan results
        uses: github/codeql-action/upload-sarif@v2
        with:
          sarif_file: 'trivy-results.sarif'
      
      - name: OWASP ZAP Baseline Scan
        uses: zaproxy/action-baseline@v0.7.0
        with:
          target: 'http://localhost:8000'

  performance-tests:
    runs-on: ubuntu-latest
    needs: integration-tests
    if: github.ref == 'refs/heads/main'
    
    steps:
      - uses: actions/checkout@v3
      
      - name: Set up application
        run: |
          pip install poetry
          poetry install
          poetry run python manage.py runserver &
          sleep 10
      
      - name: Run k6 performance tests
        uses: grafana/k6-action@v0.2.0
        with:
          filename: tests/performance/load_test.js
        env:
          K6_OUT: json=test-results.json
      
      - name: Upload performance results
        uses: actions/upload-artifact@v3
        with:
          name: performance-results
          path: test-results.json

  build-and-deploy:
    runs-on: ubuntu-latest
    needs: [unit-tests, integration-tests, security-tests]
    if: github.ref == 'refs/heads/main'
    
    steps:
      - uses: actions/checkout@v3
      
      - name: Build Docker image
        run: |
          docker build -t myapp:${{ github.sha }} .
          docker tag myapp:${{ github.sha }} myapp:latest
      
      - name: Run container smoke tests
        run: |
          docker run -d --name test-container -p 8000:8000 myapp:latest
          sleep 10
          curl -f http://localhost:8000/health || exit 1
          docker stop test-container
      
      - name: Deploy to staging
        if: success()
        run: |
          echo "Deploying to staging environment..."
          # –ó–¥–µ—Å—å –ª–æ–≥–∏–∫–∞ –¥–µ–ø–ª–æ—è
```

**Go CI/CD —Å GitHub Actions:**
```yaml
# .github/workflows/go-test.yml
name: Go Test Suite

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]

jobs:
  test:
    runs-on: ubuntu-latest
    
    strategy:
      matrix:
        go-version: ['1.19', '1.20', '1.21']
    
    services:
      postgres:
        image: postgres:13
        env:
          POSTGRES_PASSWORD: postgres
          POSTGRES_DB: testdb
        options: >-
          --health-cmd pg_isready
          --health-interval 10s
          --health-timeout 5s
          --health-retries 5
        ports:
          - 5432:5432
    
    steps:
      - uses: actions/checkout@v3
      
      - name: Set up Go ${{ matrix.go-version }}
        uses: actions/setup-go@v4
        with:
          go-version: ${{ matrix.go-version }}
      
      - name: Cache Go modules
        uses: actions/cache@v3
        with:
          path: ~/go/pkg/mod
          key: ${{ runner.os }}-go-${{ hashFiles('**/go.sum') }}
          restore-keys: |
            ${{ runner.os }}-go-
      
      - name: Install dependencies
        run: go mod download
      
      - name: Run linter
        uses: golangci/golangci-lint-action@v3
        with:
          version: latest
      
      - name: Run unit tests
        run: |
          go test -v -race -covermode atomic -coverprofile=coverage.out ./...
      
      - name: Run integration tests
        env:
          DATABASE_URL: postgres://postgres:postgres@localhost:5432/testdb?sslmode=disable
        run: |
          go test -v -tags=integration ./tests/integration/...
      
      - name: Upload coverage to Codecov
        uses: codecov/codecov-action@v3
        with:
          file: ./coverage.out
      
      - name: Run benchmarks
        run: |
          go test -bench=. -benchmem ./... | tee benchmark.txt
      
      - name: Upload benchmark results
        uses: actions/upload-artifact@v3
        with:
          name: benchmark-results-${{ matrix.go-version }}
          path: benchmark.txt

  security:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Set up Go
        uses: actions/setup-go@v4
        with:
          go-version: '1.21'
      
      - name: Run Gosec Security Scanner
        uses: securecodewarrior/github-action-gosec@master
        with:
          args: './...'
      
      - name: Run Nancy (dependency vulnerability check)
        run: |
          go list -json -m all | docker run --rm -i sonatypecommunity/nancy:latest sleuth

  build:
    needs: [test, security]
    runs-on: ubuntu-latest
    
    steps:
      - uses: actions/checkout@v3
      
      - name: Set up Go
        uses: actions/setup-go@v4
        with:
          go-version: '1.21'
      
      - name: Build application
        run: |
          CGO_ENABLED=0 GOOS=linux go build -a -installsuffix cgo -o main .
      
      - name: Build Docker image
        run: |
          docker build -t myapp:${{ github.sha }} .
      
      - name: Run Trivy vulnerability scanner
        uses: aquasecurity/trivy-action@master
        with:
          image-ref: 'myapp:${{ github.sha }}'
          format: 'table'
```

### üê≥ Docker —Ç–µ—Å—Ç–æ–≤—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

**Docker Compose –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**
```yaml
# docker-compose.test.yml
version: '3.8'

services:
  app:
    build:
      context: .
      dockerfile: Dockerfile.test
    environment:
      - DATABASE_URL=postgresql://test:test@postgres:5432/testdb
      - REDIS_URL=redis://redis:6379
      - ENV=test
    depends_on:
      postgres:
        condition: service_healthy
      redis:
        condition: service_healthy
    command: pytest tests/ --junit-xml=/tmp/test-results.xml
    volumes:
      - test-results:/tmp

  postgres:
    image: postgres:13
    environment:
      POSTGRES_DB: testdb
      POSTGRES_USER: test
      POSTGRES_PASSWORD: test
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U test"]
      interval: 10s
      timeout: 5s
      retries: 5
    ports:
      - "5433:5432"

  redis:
    image: redis:7-alpine
    healthcheck:
      test: ["CMD", "redis-cli", "ping"]
      interval: 10s
      timeout: 3s
      retries: 5
    ports:
      - "6380:6379"

  test-db-migration:
    image: migrate/migrate
    depends_on:
      postgres:
        condition: service_healthy
    command: [
      "-path", "/migrations",
      "-database", "postgresql://test:test@postgres:5432/testdb?sslmode=disable",
      "up"
    ]
    volumes:
      - ./migrations:/migrations

volumes:
  test-results:
```

**Dockerfile.test:**
```dockerfile
FROM python:3.11-slim

WORKDIR /app

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
RUN apt-get update && apt-get install -y \
    postgresql-client \
    curl \
    && rm -rf /var/lib/apt/lists/*

# –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
COPY requirements.txt pyproject.toml poetry.lock ./

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
RUN pip install poetry && \
    poetry config virtualenvs.create false && \
    poetry install --with dev,test

# –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
COPY . .

# –°–∫—Ä–∏–ø—Ç –¥–ª—è –æ–∂–∏–¥–∞–Ω–∏—è –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –ë–î
COPY wait-for-db.sh /usr/local/bin/
RUN chmod +x /usr/local/bin/wait-for-db.sh

# Healthcheck
HEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \
  CMD curl -f http://localhost:8000/health || exit 1

CMD ["wait-for-db.sh", "postgres:5432", "--", "pytest"]
```

### üîß –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

**Python —Ñ–∏–∫—Å—Ç—É—Ä—ã –∏ —Å–∏–¥—ã:**
```python
# conftest.py
import pytest
import asyncio
from sqlalchemy import create_engine
from sqlalchemy.orm import sessionmaker
from testcontainers.postgres import PostgresContainer

@pytest.fixture(scope="session")
def postgres_container():
    with PostgresContainer("postgres:13") as postgres:
        yield postgres

@pytest.fixture(scope="session")
def database_url(postgres_container):
    return postgres_container.get_connection_url()

@pytest.fixture(scope="session")
def engine(database_url):
    return create_engine(database_url)

@pytest.fixture(scope="function")
def db_session(engine):
    # –°–æ–∑–¥–∞–µ–º —Å–µ—Å—Å–∏—é –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–µ—Å—Ç–∞
    Session = sessionmaker(bind=engine)
    session = Session()
    
    # –ù–∞—á–∏–Ω–∞–µ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
    transaction = session.begin()
    
    yield session
    
    # –û—Ç–∫–∞—Ç—ã–≤–∞–µ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–∞
    transaction.rollback()
    session.close()

@pytest.fixture
def sample_users(db_session):
    """–°–æ–∑–¥–∞–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"""
    users = [
        User(email="john@example.com", name="John Doe", age=30),
        User(email="jane@example.com", name="Jane Smith", age=25),
        User(email="admin@example.com", name="Admin User", age=35, role="admin"),
    ]
    
    for user in users:
        db_session.add(user)
    db_session.commit()
    
    return users

@pytest.fixture
def authenticated_client(sample_users):
    """–ö–ª–∏–µ–Ω—Ç —Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º"""
    auth_service = AuthService()
    token = auth_service.create_access_token({
        "email": sample_users[0].email,
        "user_id": sample_users[0].id
    })
    
    client = TestClient(app)
    client.headers.update({"Authorization": f"Bearer {token}"})
    return client

class DatabaseSeeder:
    """–ö–ª–∞—Å—Å –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –±–æ–ª—å—à–∏—Ö –Ω–∞–±–æ—Ä–æ–≤ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö"""
    
    def __init__(self, session):
        self.session = session
    
    def seed_users(self, count=100):
        """–°–æ–∑–¥–∞–µ—Ç —É–∫–∞–∑–∞–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"""
        from faker import Faker
        fake = Faker()
        
        users = []
        for i in range(count):
            user = User(
                email=fake.email(),
                name=fake.name(),
                age=fake.random_int(min=18, max=65),
                created_at=fake.date_time_between(start_date='-1y', end_date='now')
            )
            users.append(user)
        
        self.session.add_all(users)
        self.session.commit()
        return users
    
    def seed_posts(self, users, posts_per_user=5):
        """–°–æ–∑–¥–∞–µ—Ç –ø–æ—Å—Ç—ã –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"""
        from faker import Faker
        fake = Faker()
        
        posts = []
        for user in users:
            for _ in range(posts_per_user):
                post = Post(
                    title=fake.sentence(),
                    content=fake.text(),
                    author_id=user.id,
                    created_at=fake.date_time_between(start_date='-6m', end_date='now')
                )
                posts.append(post)
        
        self.session.add_all(posts)
        self.session.commit()
        return posts
    
    def seed_comments(self, posts, comments_per_post=3):
        """–°–æ–∑–¥–∞–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫ –ø–æ—Å—Ç–∞–º"""
        from faker import Faker
        fake = Faker()
        
        comments = []
        for post in posts:
            for _ in range(comments_per_post):
                comment = Comment(
                    content=fake.text(max_nb_chars=200),
                    post_id=post.id,
                    author_id=fake.random_element(elements=[u.id for u in self.session.query(User).all()]),
                    created_at=fake.date_time_between(start_date=post.created_at, end_date='now')
                )
                comments.append(comment)
        
        self.session.add_all(comments)
        self.session.commit()
        return comments

@pytest.fixture
def large_dataset(db_session):
    """–°–æ–∑–¥–∞–µ—Ç –±–æ–ª—å—à–æ–π –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏"""
    seeder = DatabaseSeeder(db_session)
    
    users = seeder.seed_users(1000)
    posts = seeder.seed_posts(users[:100], posts_per_user=10)  # 1000 –ø–æ—Å—Ç–æ–≤
    comments = seeder.seed_comments(posts, comments_per_post=5)  # 5000 –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
    
    return {
        "users": users,
        "posts": posts,
        "comments": comments
    }

# –•–µ–ª–ø–µ—Ä—ã –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö
@pytest.fixture(autouse=True)
def cleanup_data(db_session):
    """–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—á–∏—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —Ç–µ—Å—Ç–∞"""
    yield
    # –ü–æ—Å–ª–µ —Ç–µ—Å—Ç–∞ - –æ—á–∏—â–∞–µ–º –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã
    for table in reversed(Base.metadata.sorted_tables):
        db_session.execute(table.delete())
    db_session.commit()

# –§–∏–∫—Å—Ç—É—Ä—ã –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
@pytest.fixture
def mock_email_service():
    """–ú–æ–∫ email —Å–µ—Ä–≤–∏—Å–∞"""
    with patch('app.services.email_service.EmailService') as mock:
        mock_instance = Mock()
        mock.return_value = mock_instance
        mock_instance.send_email.return_value = True
```

**Go —Ç–µ—Å—Ç–æ–≤—ã–µ —Ñ–∏–∫—Å—Ç—É—Ä—ã:**
```go
package testutils

import (
    "database/sql"
    "fmt"
    "testing"
    "context"
    "time"
    
    "github.com/testcontainers/testcontainers-go"
    "github.com/testcontainers/testcontainers-go/modules/postgres"
    "github.com/stretchr/testify/require"
    "github.com/go-faker/faker/v4"
)

// TestDatabase –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–µ—Å—Ç–æ–≤—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
type TestDatabase struct {
    Container testcontainers.Container
    DB        *sql.DB
    URL       string
}

// SetupTestDatabase —Å–æ–∑–¥–∞–µ—Ç —Ç–µ—Å—Ç–æ–≤—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
func SetupTestDatabase(t *testing.T) *TestDatabase {
    ctx := context.Background()
    
    postgresContainer, err := postgres.RunContainer(ctx,
        testcontainers.WithImage("postgres:13"),
        postgres.WithDatabase("testdb"),
        postgres.WithUsername("test"),
        postgres.WithPassword("test"),
        testcontainers.WithWaitStrategy(wait.ForLog("database system is ready to accept connections")),
    )
    require.NoError(t, err)
    
    connStr, err := postgresContainer.ConnectionString(ctx, "sslmode=disable")
    require.NoError(t, err)
    
    db, err := sql.Open("postgres", connStr)
    require.NoError(t, err)
    
    // –ü—Ä–∏–º–µ–Ω—è–µ–º –º–∏–≥—Ä–∞—Ü–∏–∏
    err = runMigrations(db)
    require.NoError(t, err)
    
    return &TestDatabase{
        Container: postgresContainer,
        DB:        db,
        URL:       connStr,
    }
}

// Cleanup –∑–∞–∫—Ä—ã–≤–∞–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∏ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
func (td *TestDatabase) Cleanup(t *testing.T) {
    td.DB.Close()
    ctx := context.Background()
    err := td.Container.Terminate(ctx)
    require.NoError(t, err)
}

// ClearAllTables –æ—á–∏—â–∞–µ—Ç –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã
func (td *TestDatabase) ClearAllTables(t *testing.T) {
    tables := []string{"comments", "posts", "users"} // –í –ø–æ—Ä—è–¥–∫–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
    
    for _, table := range tables {
        _, err := td.DB.Exec(fmt.Sprintf("DELETE FROM %s", table))
        require.NoError(t, err)
        
        // –°–±—Ä–∞—Å—ã–≤–∞–µ–º auto-increment
        _, err = td.DB.Exec(fmt.Sprintf("ALTER SEQUENCE %s_id_seq RESTART WITH 1", table))
        if err != nil {
            // –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –æ—à–∏–±–∫—É –µ—Å–ª–∏ sequence –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
            t.Logf("Warning: Could not reset sequence for table %s: %v", table, err)
        }
    }
}

// TestDataSeeder —Å–æ–∑–¥–∞–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
type TestDataSeeder struct {
    db *sql.DB
}

// NewTestDataSeeder —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π seeder
func NewTestDataSeeder(db *sql.DB) *TestDataSeeder {
    return &TestDataSeeder{db: db}
}

// SeedUsers —Å–æ–∑–¥–∞–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
func (s *TestDataSeeder) SeedUsers(count int) ([]User, error) {
    users := make([]User, count)
    
    for i := 0; i < count; i++ {
        user := User{
            Email:     faker.Email(),
            Name:      faker.Name(),
            Age:       faker.RandomInt(18, 65),
            CreatedAt: time.Now().AddDate(0, 0, -faker.RandomInt(1, 365)),
        }
        
        err := s.db.QueryRow(`
            INSERT INTO users (email, name, age, created_at) 
            VALUES ($1, $2, $3, $4) 
            RETURNING id`,
            user.Email, user.Name, user.Age, user.CreatedAt,
        ).Scan(&user.ID)
        
        if err != nil {
            return nil, err
        }
        
        users[i] = user
    }
    
    return users, nil
}

// SeedPosts —Å–æ–∑–¥–∞–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã–µ –ø–æ—Å—Ç—ã
func (s *TestDataSeeder) SeedPosts(users []User, postsPerUser int) ([]Post, error) {
    var posts []Post
    
    for _, user := range users {
        for i := 0; i < postsPerUser; i++ {
            post := Post{
                Title:     faker.Sentence(),
                Content:   faker.Paragraph(),
                AuthorID:  user.ID,
                CreatedAt: time.Now().AddDate(0, 0, -faker.RandomInt(1, 180)),
            }
            
            err := s.db.QueryRow(`
                INSERT INTO posts (title, content, author_id, created_at) 
                VALUES ($1, $2, $3, $4) 
                RETURNING id`,
                post.Title, post.Content, post.AuthorID, post.CreatedAt,
            ).Scan(&post.ID)
            
            if err != nil {
                return nil, err
            }
            
            posts = append(posts, post)
        }
    }
    
    return posts, nil
}

// TestHelpers —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ç–µ—Å—Ç–æ–≤
type TestHelpers struct {
    db *sql.DB
}

// NewTestHelpers —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π –Ω–∞–±–æ—Ä —Ö–µ–ª–ø–µ—Ä–æ–≤
func NewTestHelpers(db *sql.DB) *TestHelpers {
    return &TestHelpers{db: db}
}

// CreateTestUser —Å–æ–∑–¥–∞–µ—Ç –æ–¥–Ω–æ–≥–æ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
func (h *TestHelpers) CreateTestUser(t *testing.T, email, name string) User {
    user := User{
        Email: email,
        Name:  name,
        Age:   25,
    }
    
    err := h.db.QueryRow(`
        INSERT INTO users (email, name, age) 
        VALUES ($1, $2, $3) 
        RETURNING id, created_at`,
        user.Email, user.Name, user.Age,
    ).Scan(&user.ID, &user.CreatedAt)
    
    require.NoError(t, err)
    return user
}

// CreateTestPost —Å–æ–∑–¥–∞–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã–π –ø–æ—Å—Ç
func (h *TestHelpers) CreateTestPost(t *testing.T, authorID int, title, content string) Post {
    post := Post{
        Title:    title,
        Content:  content,
        AuthorID: authorID,
    }
    
    err := h.db.QueryRow(`
        INSERT INTO posts (title, content, author_id) 
        VALUES ($1, $2, $3) 
        RETURNING id, created_at`,
        post.Title, post.Content, post.AuthorID,
    ).Scan(&post.ID, &post.CreatedAt)
    
    require.NoError(t, err)
    return post
}

// AssertUserExists –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
func (h *TestHelpers) AssertUserExists(t *testing.T, userID int) {
    var count int
    err := h.db.QueryRow("SELECT COUNT(*) FROM users WHERE id = $1", userID).Scan(&count)
    require.NoError(t, err)
    require.Equal(t, 1, count, "User should exist")
}

// AssertUserNotExists –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
func (h *TestHelpers) AssertUserNotExists(t *testing.T, userID int) {
    var count int
    err := h.db.QueryRow("SELECT COUNT(*) FROM users WHERE id = $1", userID).Scan(&count)
    require.NoError(t, err)
    require.Equal(t, 0, count, "User should not exist")
}

// GetUserCount –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
func (h *TestHelpers) GetUserCount(t *testing.T) int {
    var count int
    err := h.db.QueryRow("SELECT COUNT(*) FROM users").Scan(&count)
    require.NoError(t, err)
    return count
}

// MockServices —Å–æ–¥–µ—Ä–∂–∏—Ç –º–æ–∫–∏ –≤–Ω–µ—à–Ω–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
type MockServices struct {
    EmailService    *MockEmailService
    PaymentGateway  *MockPaymentGateway
    NotificationSvc *MockNotificationService
}

// NewMockServices —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π –Ω–∞–±–æ—Ä –º–æ–∫–æ–≤
func NewMockServices() *MockServices {
    return &MockServices{
        EmailService:    NewMockEmailService(),
        PaymentGateway:  NewMockPaymentGateway(),
        NotificationSvc: NewMockNotificationService(),
    }
}

// MockEmailService –º–æ–∫ email —Å–µ—Ä–≤–∏—Å–∞
type MockEmailService struct {
    SentEmails []EmailMessage
    ShouldFail bool
}

type EmailMessage struct {
    To      string
    Subject string
    Body    string
    SentAt  time.Time
}

func NewMockEmailService() *MockEmailService {
    return &MockEmailService{
        SentEmails: make([]EmailMessage, 0),
    }
}

func (m *MockEmailService) SendEmail(to, subject, body string) error {
    if m.ShouldFail {
        return fmt.Errorf("mock email service failure")
    }
    
    email := EmailMessage{
        To:      to,
        Subject: subject,
        Body:    body,
        SentAt:  time.Now(),
    }
    
    m.SentEmails = append(m.SentEmails, email)
    return nil
}

func (m *MockEmailService) GetSentEmailsCount() int {
    return len(m.SentEmails)
}

func (m *MockEmailService) GetLastSentEmail() *EmailMessage {
    if len(m.SentEmails) == 0 {
        return nil
    }
    return &m.SentEmails[len(m.SentEmails)-1]
}

func (m *MockEmailService) Reset() {
    m.SentEmails = make([]EmailMessage, 0)
    m.ShouldFail = false
}

// MockPaymentGateway –º–æ–∫ –ø–ª–∞—Ç–µ–∂–Ω–æ–≥–æ —à–ª—é–∑–∞
type MockPaymentGateway struct {
    Transactions []Transaction
    ShouldFail   bool
}

type Transaction struct {
    ID     string
    Amount float64
    Status string
}

func NewMockPaymentGateway() *MockPaymentGateway {
    return &MockPaymentGateway{
        Transactions: make([]Transaction, 0),
    }
}

func (m *MockPaymentGateway) ProcessPayment(amount float64) (*Transaction, error) {
    if m.ShouldFail {
        return nil, fmt.Errorf("payment processing failed")
    }
    
    transaction := Transaction{
        ID:     fmt.Sprintf("txn_%d", time.Now().Unix()),
        Amount: amount,
        Status: "completed",
    }
    
    m.Transactions = append(m.Transactions, transaction)
    return &transaction, nil
}

func (m *MockPaymentGateway) GetTransactionCount() int {
    return len(m.Transactions)
}

func (m *MockPaymentGateway) Reset() {
    m.Transactions = make([]Transaction, 0)
    m.ShouldFail = false
}

// –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ —Ç–µ—Å—Ç–∞—Ö
func TestExample(t *testing.T) {
    // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
    testDB := SetupTestDatabase(t)
    defer testDB.Cleanup(t)
    
    // –°–æ–∑–¥–∞–Ω–∏–µ —Ö–µ–ª–ø–µ—Ä–æ–≤ –∏ —Å–µ—Ä–≤–∏—Å–æ–≤
    helpers := NewTestHelpers(testDB.DB)
    mockServices := NewMockServices()
    seeder := NewTestDataSeeder(testDB.DB)
    
    // –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    user := helpers.CreateTestUser(t, "test@example.com", "Test User")
    post := helpers.CreateTestPost(t, user.ID, "Test Post", "Test content")
    
    // –ò–ª–∏ —Å–æ–∑–¥–∞–Ω–∏–µ –±–æ–ª—å—à–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö
    users, err := seeder.SeedUsers(100)
    require.NoError(t, err)
    
    posts, err := seeder.SeedPosts(users[:10], 5) // 50 –ø–æ—Å—Ç–æ–≤
    require.NoError(t, err)
    
    // –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –º–æ–∫–∞–º–∏
    userService := NewUserService(testDB.DB, mockServices.EmailService)
    
    err = userService.RegisterUser("newuser@example.com", "New User")
    require.NoError(t, err)
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ email –±—ã–ª –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω
    assert.Equal(t, 1, mockServices.EmailService.GetSentEmailsCount())
    
    lastEmail := mockServices.EmailService.GetLastSentEmail()
    assert.Equal(t, "newuser@example.com", lastEmail.To)
    assert.Contains(t, lastEmail.Subject, "Welcome")
    
    // –û—á–∏—Å—Ç–∫–∞ –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–∞
    testDB.ClearAllTables(t)
    mockServices.EmailService.Reset()
}

func runMigrations(db *sql.DB) error {
    // –ó–¥–µ—Å—å –≤—ã–ø–æ–ª–Ω—è–µ–º SQL –º–∏–≥—Ä–∞—Ü–∏–∏
    schema := `
        CREATE TABLE IF NOT EXISTS users (
            id SERIAL PRIMARY KEY,
            email VARCHAR(255) UNIQUE NOT NULL,
            name VARCHAR(255) NOT NULL,
            age INTEGER,
            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
        );
        
        CREATE TABLE IF NOT EXISTS posts (
            id SERIAL PRIMARY KEY,
            title VARCHAR(255) NOT NULL,
            content TEXT,
            author_id INTEGER REFERENCES users(id),
            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
        );
        
        CREATE TABLE IF NOT EXISTS comments (
            id SERIAL PRIMARY KEY,
            content TEXT NOT NULL,
            post_id INTEGER REFERENCES posts(id),
            author_id INTEGER REFERENCES users(id),
            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
        );
    `
    
    _, err := db.Exec(schema)
    return err
}

@pytest.fixture
def mock_payment_gateway():
    """–ú–æ–∫ –ø–ª–∞—Ç–µ–∂–Ω–æ–≥–æ —à–ª—é–∑–∞"""
    with patch('app.services.payment.PaymentGateway') as mock:
        mock_instance = Mock()
        mock.return_value = mock_instance
        mock_instance.charge.return_value = {
            "success": True,
            "transaction_id": "txn_123456",
            "amount": 100.00
        }
```

### üìä –û—Ç—á–µ—Ç–Ω–æ—Å—Ç—å –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ç–µ—Å—Ç–æ–≤

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ coverage –∏ –æ—Ç—á–µ—Ç–æ–≤:**
```python
# setup.cfg
[coverage:run]
source = src/
omit = 
    */tests/*
    */venv/*
    */migrations/*
    */settings/*
    */manage.py

[coverage:report]
exclude_lines =
    pragma: no cover
    def __repr__
    raise AssertionError
    raise NotImplementedError
    if __name__ == .__main__.:
    if TYPE_CHECKING:

[coverage:html]
directory = htmlcov

[tool:pytest]
testpaths = tests
python_files = test_*.py
python_classes = Test*
python_functions = test_*
addopts = 
    --strict-markers
    --strict-config
    --verbose
    --tb=short
    --cov=src
    --cov-report=term-missing
    --cov-report=html
    --cov-report=xml
    --junit-xml=test-results.xml
markers =
    unit: Unit tests
    integration: Integration tests
    slow: Slow tests
    security: Security tests
    performance: Performance tests
```

**Makefile –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏:**
```makefile
# Makefile
.PHONY: test test-unit test-integration test-performance test-security
.PHONY: coverage lint format type-check clean

# –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
PYTHON = poetry run python
PYTEST = poetry run pytest
COVERAGE = poetry run coverage
FLAKE8 = poetry run flake8
BLACK = poetry run black
MYPY = poetry run mypy

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
install:
	poetry install --with dev,test

# –í—Å–µ —Ç–µ—Å—Ç—ã
test: test-unit test-integration

# –Æ–Ω–∏—Ç —Ç–µ—Å—Ç—ã
test-unit:
	$(PYTEST) tests/unit/ -v --tb=short

# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
test-integration:
	$(PYTEST) tests/integration/ -v --tb=short --maxfail=5

# –¢–µ—Å—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
test-performance:
	$(PYTEST) tests/performance/ -v --tb=short -m "not slow"

# –ú–µ–¥–ª–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
test-performance-full:
	$(PYTEST) tests/performance/ -v --tb=short

# –¢–µ—Å—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
test-security:
	$(PYTEST) tests/security/ -v --tb=short
	poetry run bandit -r src/
	poetry run safety check

# –ë—ã—Å—Ç—Ä—ã–µ —Ç–µ—Å—Ç—ã (–±–µ–∑ –º–µ–¥–ª–µ–Ω–Ω—ã—Ö)
test-fast:
	$(PYTEST) tests/ -v -m "not slow and not integration"

# –ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞
coverage:
	$(COVERAGE) run -m pytest tests/
	$(COVERAGE) report
	$(COVERAGE) html
	@echo "Coverage report generated in htmlcov/index.html"

# –õ–∏–Ω—Ç–∏–Ω–≥
lint:
	$(FLAKE8) src/ tests/
	$(BLACK) --check src/ tests/
	$(MYPY) src/

# –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
format:
	$(BLACK) src/ tests/
	poetry run isort src/ tests/

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤
type-check:
	$(MYPY) src/ --strict

# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ –∫–∞—á–µ—Å—Ç–≤–∞
quality: lint type-check test-unit

# –û—á–∏—Å—Ç–∫–∞
clean:
	find . -type f -name "*.pyc" -delete
	find . -type d -name "__pycache__" -delete
	find . -type d -name "*.egg-info" -exec rm -rf {} +
	rm -rf .coverage htmlcov/ .pytest_cache/ dist/ build/

# CI –ø–∞–π–ø–ª–∞–π–Ω –ª–æ–∫–∞–ª—å–Ω–æ
ci: clean install quality test coverage

# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –≤ Docker
test-docker:
	docker-compose -f docker-compose.test.yml up --build --abort-on-container-exit
	docker-compose -f docker-compose.test.yml down

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ç–µ—Å—Ç–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
test-watch:
	poetry run ptw tests/ src/ --runner "$(PYTEST) tests/unit/"

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞ –ø–æ flaky —Ç–µ—Å—Ç–∞–º
test-flaky:
	$(PYTEST) tests/ --flaky-report=flaky-report.html

# –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤
test-profile:
	$(PYTEST) tests/unit/ --profile --profile-svg

# –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã
test-parallel:
	$(PYTEST) tests/ -n auto --dist=worksteal
```

---

## üöÄ –ú–æ–¥—É–ª—å 8: –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ (2-3 –Ω–µ–¥–µ–ª–∏)

### üé≤ Property-based —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**–§–∏–ª–æ—Å–æ—Ñ–∏—è Property-based Testing:**
```
–û–±—ã—á–Ω—ã–µ —Ç–µ—Å—Ç—ã:    –î–ª—è –≤—Ö–æ–¥–∞ X ‚Üí –æ–∂–∏–¥–∞–µ–º –≤—ã—Ö–æ–¥ Y
Property —Ç–µ—Å—Ç—ã:   –î–ª—è –õ–Æ–ë–û–ì–û –≤—Ö–æ–¥–∞ ‚Üí –¥–æ–ª–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è —Å–≤–æ–π—Å—Ç–≤–æ Z

–ü—Ä–∏–º–µ—Ä:
–û–±—ã—á–Ω—ã–π:     reverse("hello") == "olleh"
Property:    reverse(reverse(s)) == s  (–¥–ª—è –ª—é–±–æ–π —Å—Ç—Ä–æ–∫–∏ s)
```

**Python —Å Hypothesis:**
```python
from hypothesis import given, strategies as st, assume, example
from hypothesis.stateful import RuleBasedStateMachine, rule, Bundle, initialize
import pytest

class TestStringFunctions:
    
    @given(s=st.text())
    def test_reverse_is_involution(self, s):
        """–¢–µ—Å—Ç–∏—Ä—É–µ–º —á—Ç–æ –¥–≤–æ–π–Ω–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏ –¥–∞–µ—Ç –∏—Å—Ö–æ–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É"""
        assert reverse(reverse(s)) == s
    
    @given(s=st.text())
    def test_reverse_length_preserved(self, s):
        """–î–ª–∏–Ω–∞ —Å—Ç—Ä–æ–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏"""
        assert len(reverse(s)) == len(s)
    
    @given(s1=st.text(), s2=st.text())
    def test_reverse_concatenation_property(self, s1, s2):
        """reverse(s1 + s2) == reverse(s2) + reverse(s1)"""
        assert reverse(s1 + s2) == reverse(s2) + reverse(s1)
    
    @given(lst=st.lists(st.integers()))
    def test_sort_is_idempotent(self, lst):
        """–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–∞"""
        sorted_once = sorted(lst)
        sorted_twice = sorted(sorted_once)
        assert sorted_once == sorted_twice
    
    @given(lst=st.lists(st.integers()))
    def test_sort_preserves_length(self, lst):
        """–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –¥–ª–∏–Ω—É"""
        assert len(sorted(lst)) == len(lst)
    
    @given(lst=st.lists(st.integers(), min_size=1))
    def test_max_element_in_sorted_list(self, lst):
        """–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –≤ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º —Å–ø–∏—Å–∫–µ - –ø–æ—Å–ª–µ–¥–Ω–∏–π"""
        sorted_lst = sorted(lst)
        assert max(lst) == sorted_lst[-1]

class TestUserService:
    
    @given(email=st.emails(), name=st.text(min_size=1, max_size=100))
    def test_user_creation_properties(self, email, name):
        """–¢–µ—Å—Ç–∏—Ä—É–µ–º —Å–≤–æ–π—Å—Ç–≤–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
        # –ò—Å–∫–ª—é—á–∞–µ–º –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–µ –∏–º–µ–Ω–∞
        assume(name.strip() != "")
        assume(not any(char in name for char in ['<', '>', '"', "'"]))
        
        user_service = UserService()
        user = user_service.create_user(email, name)
        
        # –°–≤–æ–π—Å—Ç–≤–∞ –∫–æ—Ç–æ—Ä—ã–µ –≤—Å–µ–≥–¥–∞ –¥–æ–ª–∂–Ω—ã –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è
        assert user.email == email.lower()  # Email –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω
        assert user.name == name.strip()    # –ò–º—è –æ–±—Ä–µ–∑–∞–Ω–æ
        assert user.id > 0                  # ID –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π
        assert user.created_at is not None  # –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞
        assert user.is_active is True       # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∞–∫—Ç–∏–≤–Ω—ã–π
    
    @given(age=st.integers())
    def test_age_validation_property(self, age):
        """–¢–µ—Å—Ç–∏—Ä—É–µ–º –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤–æ–∑—Ä–∞—Å—Ç–∞"""
        user_service = UserService()
        
        if 0 <= age <= 150:
            # –í–∞–ª–∏–¥–Ω—ã–π –≤–æ–∑—Ä–∞—Å—Ç –¥–æ–ª–∂–µ–Ω –ø—Ä–∏–Ω–∏–º–∞—Ç—å—Å—è
            user = user_service.create_user("test@example.com", "Test", age=age)
            assert user.age == age
        else:
            # –ù–µ–≤–∞–ª–∏–¥–Ω—ã–π –≤–æ–∑—Ä–∞—Å—Ç –¥–æ–ª–∂–µ–Ω –≤—ã–∑—ã–≤–∞—Ç—å –æ—à–∏–±–∫—É
            with pytest.raises(ValueError):
                user_service.create_user("test@example.com", "Test", age=age)
    
    @given(
        data=st.dictionaries(
            keys=st.sampled_from(['name', 'email', 'bio', 'website']),
            values=st.text(max_size=200),
            min_size=1
        )
    )
    def test_user_update_properties(self, data):
        """–¢–µ—Å—Ç–∏—Ä—É–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏"""
        user_service = UserService()
        user = user_service.create_user("test@example.com", "Test User")
        
        original_id = user.id
        original_created_at = user.created_at
        
        updated_user = user_service.update_user(user.id, data)
        
        # –ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç–Ω—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞
        assert updated_user.id == original_id
        assert updated_user.created_at == original_created_at
        assert updated_user.updated_at >= original_created_at
        
        # –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø–æ–ª—è
        for field, value in data.items():
            if hasattr(updated_user, field):
                assert getattr(updated_user, field) == value

# Stateful —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
class ShoppingCartStateMachine(RuleBasedStateMachine):
    """–¢–µ—Å—Ç–∏—Ä—É–µ–º –∫–æ—Ä–∑–∏–Ω—É –ø–æ–∫—É–ø–æ–∫ –∫–∞–∫ state machine"""
    
    def __init__(self):
        super().__init__()
        self.cart = ShoppingCart()
        self.products = Bundle('products')
    
    @initialize()
    def setup(self):
        """–ù–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ"""
        assert self.cart.is_empty()
        assert self.cart.total() == 0
    
    @rule(target=products, name=st.text(min_size=1, max_size=50), 
          price=st.floats(min_value=0.01, max_value=1000.0))
    def add_product(self, name, price):
        """–î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–æ–¥—É–∫—Ç –≤ –∫–∞—Ç–∞–ª–æ–≥"""
        product = Product(name=name, price=price)
        return product
    
    @rule(product=products, quantity=st.integers(min_value=1, max_value=10))
    def add_to_cart(self, product, quantity):
        """–î–æ–±–∞–≤–ª—è–µ–º —Ç–æ–≤–∞—Ä –≤ –∫–æ—Ä–∑–∏–Ω—É"""
        old_total = self.cart.total()
        old_count = self.cart.item_count()
        
        self.cart.add_item(product, quantity)
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã
        assert self.cart.total() >= old_total
        assert self.cart.item_count() >= old_count
        assert not self.cart.is_empty()
    
    @rule(product=products, quantity=st.integers(min_value=1, max_value=5))
    def remove_from_cart(self, product, quantity):
        """–£–¥–∞–ª—è–µ–º —Ç–æ–≤–∞—Ä –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã"""
        if self.cart.has_item(product):
            old_total = self.cart.total()
            old_count = self.cart.item_count()
            
            self.cart.remove_item(product, quantity)
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã
            assert self.cart.total() <= old_total
            assert self.cart.item_count() <= old_count
    
    @rule()
    def clear_cart(self):
        """–û—á–∏—â–∞–µ–º –∫–æ—Ä–∑–∏–Ω—É"""
        self.cart.clear()
        
        assert self.cart.is_empty()
        assert self.cart.total() == 0
        assert self.cart.item_count() == 0

# –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
@st.composite
def user_data(draw):
    """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –≤–∞–ª–∏–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
    name = draw(st.text(
        alphabet=st.characters(whitelist_categories=['L', 'N', ' ']),
        min_size=2, max_size=50
    ))
    email = draw(st.emails())
    age = draw(st.integers(min_value=13, max_value=120))
    
    return {
        "name": name.strip(),
        "email": email,
        "age": age
    }

@given(user=user_data())
def test_with_custom_user_strategy(user):
    """–¢–µ—Å—Ç —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–µ–π"""
    service = UserService()
    created_user = service.create_user(**user)
    
    assert created_user.name == user["name"]
    assert created_user.email == user["email"]
    assert created_user.age == user["age"]

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∏–º–µ—Ä–æ–≤
class TestWithExamples:
    
    @given(x=st.integers())
    @example(x=0)  # –í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º –≥—Ä–∞–Ω–∏—á–Ω—ã–π —Å–ª—É—á–∞–π
    @example(x=-1)
    @example(x=1)
    def test_absolute_value_properties(self, x):
        """–¢–µ—Å—Ç–∏—Ä—É–µ–º —Å–≤–æ–π—Å—Ç–≤–∞ –º–æ–¥—É–ª—è —á–∏—Å–ª–∞"""
        abs_x = abs(x)
        
        # –ú–æ–¥—É–ª—å –≤—Å–µ–≥–¥–∞ –Ω–µ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π
        assert abs_x >= 0
        
        # |x| = |-x|
        assert abs_x == abs(-x)
        
        # |x|¬≤ = x¬≤
        assert abs_x ** 2 == x ** 2

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Hypothesis
from hypothesis import settings, HealthCheck

@settings(
    max_examples=1000,  # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å–ª—É—á–∞–µ–≤
    deadline=None,      # –û—Ç–∫–ª—é—á–∞–µ–º –¥–µ–¥–ª–∞–π–Ω –¥–ª—è –º–µ–¥–ª–µ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
    suppress_health_check=[HealthCheck.too_slow]
)
@given(data=st.data())
def test_complex_scenario(data):
    """–°–ª–æ–∂–Ω—ã–π —Ç–µ—Å—Ç —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏"""
    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –≤–Ω—É—Ç—Ä–∏ —Ç–µ—Å—Ç–∞
    num_users = data.draw(st.integers(min_value=1, max_value=100))
    users = data.draw(st.lists(
        user_data(), 
        min_size=num_users, 
        max_size=num_users,
        unique_by=lambda u: u["email"]
    ))
    
    user_service = UserService()
    created_users = []
    
    for user_data in users:
        created_user = user_service.create_user(**user_data)
        created_users.append(created_user)
    
    # –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ –ø–æ email
    emails = [u.email for u in created_users]
    assert len(emails) == len(set(emails))
    
    # –í—Å–µ ID –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏
    ids = [u.id for u in created_users]
    assert len(ids) == len(set(ids))

# –ó–∞–ø—É—Å–∫ stateful —Ç–µ—Å—Ç–æ–≤
TestShoppingCart = ShoppingCartStateMachine.TestCase
```

**Go Property-based —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å gopter:**
```go
package main

import (
    "testing"
    "github.com/leanovate/gopter"
    "github.com/leanovate/gopter/gen"
    "github.com/leanovate/gopter/prop"
    "github.com/stretchr/testify/assert"
)

func TestStringProperties(t *testing.T) {
    properties := gopter.NewProperties(nil)
    
    // –°–≤–æ–π—Å—Ç–≤–æ: reverse(reverse(s)) == s
    properties.Property("reverse is involution", prop.ForAll(
        func(s string) bool {
            return Reverse(Reverse(s)) == s
        },
        gen.AnyString(),
    ))
    
    // –°–≤–æ–π—Å—Ç–≤–æ: –¥–ª–∏–Ω–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø—Ä–∏ reverse
    properties.Property("reverse preserves length", prop.ForAll(
        func(s string) bool {
            return len(Reverse(s)) == len(s)
        },
        gen.AnyString(),
    ))
    
    // –°–≤–æ–π—Å—Ç–≤–æ: reverse(s1 + s2) == reverse(s2) + reverse(s1)  
    properties.Property("reverse concatenation", prop.ForAll(
        func(s1, s2 string) bool {
            return Reverse(s1+s2) == Reverse(s2)+Reverse(s1)
        },
        gen.AnyString(),
        gen.AnyString(),
    ))
    
    properties.TestingRun(t)
}

func TestSortProperties(t *testing.T) {
    properties := gopter.NewProperties(nil)
    
    // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–∞
    properties.Property("sort is idempotent", prop.ForAll(
        func(slice []int) bool {
            sorted1 := SortInts(slice)
            sorted2 := SortInts(sorted1)
            return slicesEqual(sorted1, sorted2)
        },
        gen.SliceOf(gen.Int()),
    ))
    
    // –î–ª–∏–Ω–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
    properties.Property("sort preserves length", prop.ForAll(
        func(slice []int) bool {
            sorted := SortInts(slice)
            return len(sorted) == len(slice)
        },
        gen.SliceOf(gen.Int()),
    ))
    
    // –†–µ–∑—É–ª—å—Ç–∞—Ç –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω
    properties.Property("result is sorted", prop.ForAll(
        func(slice []int) bool {
            sorted := SortInts(slice)
            return isSorted(sorted)
        },
        gen.SliceOf(gen.Int()),
    ))
    
    properties.TestingRun(t)
}

func TestUserServiceProperties(t *testing.T) {
    properties := gopter.NewProperties(nil)
    
    // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –¥–ª—è –≤–∞–ª–∏–¥–Ω—ã—Ö email
    emailGen := gen.RegexMatch(`[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}`)
    nameGen := gen.RegexMatch(`[A-Za-z ]{2,50}`)
    ageGen := gen.IntRange(13, 120)
    
    properties.Property("user creation properties", prop.ForAll(
        func(email, name string, age int) bool {
            service := NewUserService()
            user, err := service.CreateUser(email, name, age)
            
            if err != nil {
                return false
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã
            return user.ID > 0 &&
                   user.Email == strings.ToLower(email) &&
                   user.Name == strings.TrimSpace(name) &&
                   user.Age == age &&
                   !user.CreatedAt.IsZero() &&
                   user.IsActive
        },
        emailGen,
        nameGen, 
        ageGen,
    ))
    
    // –í–∞–ª–∏–¥–∞—Ü–∏—è –≤–æ–∑—Ä–∞—Å—Ç–∞
    properties.Property("age validation", prop.ForAll(
        func(age int) bool {
            service := NewUserService()
            _, err := service.CreateUser("test@example.com", "Test User", age)
            
            if age >= 0 && age <= 150 {
                return err == nil
            } else {
                return err != nil
            }
        },
        gen.Int(),
    ))
    
    properties.TestingRun(t)
}

// Stateful —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ—Ä–∑–∏–Ω—ã –ø–æ–∫—É–ø–æ–∫
func TestShoppingCartStateful(t *testing.T) {
    commands := &gopter.Commands{
        NewSystemUnderTest: func(initialState gopter.State) gopter.SystemUnderTest {
            return &ShoppingCartSUT{
                Cart: NewShoppingCart(),
            }
        },
        InitialState: func() gopter.State {
            return &CartState{
                Items: make(map[string]int),
                Total: 0,
            }
        },
        Commands: map[string]gopter.Command{
            "addItem": &AddItemCommand{},
            "removeItem": &RemoveItemCommand{},
            "clear": &ClearCartCommand{},
        },
    }
    
    properties := gopter.NewProperties(nil)
    properties.Property("shopping cart stateful", prop.ForAllCommands(commands))
    properties.TestingRun(t)
}

// –°–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è stateful —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
type CartState struct {
    Items map[string]int
    Total float64
}

type ShoppingCartSUT struct {
    Cart *ShoppingCart
}

// –ö–æ–º–∞–Ω–¥–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞
type AddItemCommand struct{}

func (cmd *AddItemCommand) Run(sut gopter.SystemUnderTest, state gopter.State) gopter.Result {
    s := state.(*CartState)
    cartSUT := sut.(*ShoppingCartSUT)
    
    product := Product{Name: "test-item", Price: 10.0}
    quantity := 1
    
    // –í—ã–ø–æ–ª–Ω—è–µ–º –∫–æ–º–∞–Ω–¥—É
    cartSUT.Cart.AddItem(product, quantity)
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    s.Items[product.Name] += quantity
    s.Total += float64(quantity) * product.Price
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ —Ä–µ–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –º–æ–¥–µ–ª—å–Ω—ã–º
    if cartSUT.Cart.Total() != s.Total {
        return &gopter.PropResult{
            Status: gopter.PropFalse,
            Error:  fmt.Errorf("total mismatch: got %f, expected %f", 
                              cartSUT.Cart.Total(), s.Total),
        }
    }
    
    return &gopter.PropResult{Status: gopter.PropTrue}
}

func (cmd *AddItemCommand) Pre(state gopter.State) bool {
    return true // –ö–æ–º–∞–Ω–¥–∞ –≤—Å–µ–≥–¥–∞ –¥–æ—Å—Ç—É–ø–Ω–∞
}

func (cmd *AddItemCommand) Post(state gopter.State, result gopter.Result) *gopter.PropResult {
    return &gopter.PropResult{Status: gopter.PropTrue}
}

func (cmd *AddItemCommand) String() string {
    return "AddItem"
}

// –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
func slicesEqual(a, b []int) bool {
    if len(a) != len(b) {
        return false
    }
    for i := range a {
        if a[i] != b[i] {
            return false
        }
    }
    return true
}

func isSorted(slice []int) bool {
    for i := 1; i < len(slice); i++ {
        if slice[i-1] > slice[i] {
            return false
        }
    }
    return true
}
```

### üß¨ Mutation —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**–ö–æ–Ω—Ü–µ–ø—Ü–∏—è Mutation Testing:**
```
–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –∫–æ–¥:    if (x > 0) return "positive"
                           ‚Üì
–ú—É—Ç–∞–Ω—Ç—ã:             if (x >= 0) return "positive"  ‚Üê Mutant 1
                     if (x < 0) return "positive"   ‚Üê Mutant 2  
                     if (x > 1) return "positive"   ‚Üê Mutant 3
                           ‚Üì
–ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–æ–ª–∂–Ω—ã "—É–±–∏—Ç—å" –≤—Å–µ –º—É—Ç–∞–Ω—Ç—ã
```

**Python —Å mutmut:**
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞
pip install mutmut

# –ó–∞–ø—É—Å–∫ mutation —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
mutmut run

# –ü—Ä–æ—Å–º–æ—Ç—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
mutmut results

# –ü–æ–∫–∞–∑–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –º—É—Ç–∞–Ω—Ç
mutmut show 42

# HTML –æ—Ç—á–µ—Ç
mutmut html
```

**–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞ –¥–ª—è mutation —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**
```python
# calculator.py
def add(a, b):
    return a + b  # –ú—É—Ç–∞–Ω—Ç: a - b, a * b, a / b

def is_positive(x):
    return x > 0  # –ú—É—Ç–∞–Ω—Ç: x >= 0, x < 0, x != 0

def max_of_three(a, b, c):
    if a > b and a > c:  # –ú—É—Ç–∞–Ω—Ç—ã: a >= b, a < b, and ‚Üí or
        return a
    elif b > c:  # –ú—É—Ç–∞–Ω—Ç: b >= c, b < c
        return b
    else:
        return c

def calculate_discount(price, discount_percent):
    if discount_percent < 0 or discount_percent > 100:  # –ú—É—Ç–∞–Ω—Ç—ã: <=, >=, and
        raise ValueError("Invalid discount")
    
    discount = price * (discount_percent / 100)  # –ú—É—Ç–∞–Ω—Ç—ã: -, +, *
    return price - discount  # –ú—É—Ç–∞–Ω—Ç: price + discount

# –¢–µ—Å—Ç—ã –∫–æ—Ç–æ—Ä—ã–µ —É–±–∏–≤–∞—é—Ç –º—É—Ç–∞–Ω—Ç–æ–≤
class TestCalculator:
    def test_add_positive_numbers(self):
        assert add(2, 3) == 5  # –£–±–∏–≤–∞–µ—Ç –º—É—Ç–∞–Ω—Ç a - b
    
    def test_add_with_zero(self):
        assert add(5, 0) == 5  # –£–±–∏–≤–∞–µ—Ç –º—É—Ç–∞–Ω—Ç a * b
        assert add(0, 5) == 5
    
    def test_add_negative_numbers(self):
        assert add(-2, -3) == -5  # –£–±–∏–≤–∞–µ—Ç –¥—Ä—É–≥–∏–µ –º—É—Ç–∞–Ω—Ç—ã
    
    def test_is_positive_boundary_cases(self):
        assert is_positive(1) is True    # –£–±–∏–≤–∞–µ—Ç x != 0
        assert is_positive(0) is False   # –£–±–∏–≤–∞–µ—Ç x >= 0  
        assert is_positive(-1) is False  # –£–±–∏–≤–∞–µ—Ç x < 0
    
    def test_max_of_three_all_cases(self):
        # –ü–µ—Ä–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π
        assert max_of_three(3, 1, 2) == 3  # –£–±–∏–≤–∞–µ—Ç a >= b
        assert max_of_three(3, 3, 2) == 3  # –£–±–∏–≤–∞–µ—Ç a > b (–≥—Ä–∞–Ω–∏—Ü–∞)
        
        # –í—Ç–æ—Ä–æ–π —ç–ª–µ–º–µ–Ω—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π  
        assert max_of_three(1, 3, 2) == 3  # –£–±–∏–≤–∞–µ—Ç and ‚Üí or
        assert max_of_three(2, 3, 3) == 3  # –£–±–∏–≤–∞–µ—Ç b >= c
        
        # –¢—Ä–µ—Ç–∏–π —ç–ª–µ–º–µ–Ω—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π
        assert max_of_three(1, 2, 3) == 3
        
        # –í—Å–µ —Ä–∞–≤–Ω—ã
        assert max_of_three(2, 2, 2) == 2
    
    def test_calculate_discount_boundary_cases(self):
        # –í–∞–ª–∏–¥–Ω—ã–µ —Å–ª—É—á–∞–∏
        assert calculate_discount(100, 10) == 90
        assert calculate_discount(100, 0) == 100   # –£–±–∏–≤–∞–µ—Ç –º—É—Ç–∞–Ω—Ç <=
        assert calculate_discount(100, 100) == 0   # –£–±–∏–≤–∞–µ—Ç –º—É—Ç–∞–Ω—Ç >=
        
        # –ù–µ–≤–∞–ª–∏–¥–Ω—ã–µ —Å–ª—É—á–∞–∏
        with pytest.raises(ValueError):
            calculate_discount(100, -1)    # –£–±–∏–≤–∞–µ—Ç –º—É—Ç–∞–Ω—Ç <=
        
        with pytest.raises(ValueError): 
            calculate_discount(100, 101)   # –£–±–∏–≤–∞–µ—Ç –º—É—Ç–∞–Ω—Ç >=
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–æ—á–Ω–æ—Å—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω–∏–π
        assert abs(calculate_discount(100, 25) - 75) < 0.01
```

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ mutmut:**
```python
# setup.cfg
[mutmut]
paths_to_mutate = src/
backup = False
runner = python -m pytest tests/unit/
tests_dir = tests/
cache_only = False

[mutmut:python]
# –ò—Å–∫–ª—é—á–∞–µ–º —Ñ–∞–π–ª—ã
skip_paths = migrations/,settings/,manage.py

# –ò—Å–∫–ª—é—á–∞–µ–º —Å—Ç—Ä–æ–∫–∏ —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
skip_lines_with = # pragma: no mutate
```

### üå™Ô∏è Chaos Engineering

**–ü—Ä–∏–Ω—Ü–∏–ø—ã Chaos Engineering:**
```
1. –ì–∏–ø–æ—Ç–µ–∑–∞ ‚Üí –°–∏—Å—Ç–µ–º–∞ —É—Å—Ç–æ–π—á–∏–≤–∞ –∫ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º—É —Ç–∏–ø—É —Å–±–æ–µ–≤
2. –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç ‚Üí –í–≤–æ–¥–∏–º –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—ã–π —Ö–∞–æ—Å –≤ –ø—Ä–æ–¥–∞–∫—à–Ω
3. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ ‚Üí –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º –ø–æ–≤–µ–¥–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã  
4. –ê–Ω–∞–ª–∏–∑ ‚Üí –°–∏—Å—Ç–µ–º–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏–ª–∞—Å—å –∏–ª–∏ —Å–ª–æ–º–∞–ª–∞—Å—å?
5. –£–ª—É—á—à–µ–Ω–∏–µ ‚Üí –ò—Å–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞–π–¥–µ–Ω–Ω—ã–µ —Å–ª–∞–±–æ—Å—Ç–∏
```

**Python Chaos Engineering —Ç–µ—Å—Ç—ã:**
```python
import random
import time
import requests
import threading
from contextlib import contextmanager

class ChaosEngineer:
    """–ö–ª–∞—Å—Å –¥–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è chaos engineering —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤"""
    
    def __init__(self, base_url="http://localhost:8000"):
        self.base_url = base_url
        self.running = False
    
    @contextmanager 
    def chaos_experiment(self, name):
        """–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è chaos —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤"""
        print(f"Starting chaos experiment: {name}")
        self.running = True
        
        try:
            yield self
        except Exception as e:
            print(f"Chaos experiment failed: {e}")
            raise
        finally:
            self.running = False
            print(f"Chaos experiment completed: {name}")
    
    def simulate_high_cpu_load(self, duration=30):
        """–ò–º–∏—Ç–∏—Ä—É–µ—Ç –≤—ã—Å–æ–∫—É—é –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ CPU"""
        def cpu_stress():
            end_time = time.time() + duration
            while time.time() < end_time and self.running:
                # –°–æ–∑–¥–∞–µ–º –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ CPU
                [i**2 for i in range(10000)]
        
        threads = []
        for _ in range(4):  # 4 –ø–æ—Ç–æ–∫–∞ –¥–ª—è –Ω–∞–≥—Ä—É–∑–∫–∏
            thread = threading.Thread(target=cpu_stress)
            thread.start()
            threads.append(thread)
        
        return threads
    
    def simulate_memory_pressure(self, size_mb=100):
        """–ò–º–∏—Ç–∏—Ä—É–µ—Ç –Ω–µ—Ö–≤–∞—Ç–∫—É –ø–∞–º—è—Ç–∏"""
        memory_hog = []
        try:
            for _ in range(size_mb):
                # –í—ã–¥–µ–ª—è–µ–º –ø–æ 1MB
                chunk = bytearray(1024 * 1024)
                memory_hog.append(chunk)
                time.sleep(0.1)
        except MemoryError:
            print("Successfully created memory pressure")
        
        return memory_hog
    
    def simulate_network_latency(self, delay_ms=1000):
        """–ò–º–∏—Ç–∏—Ä—É–µ—Ç –∑–∞–¥–µ—Ä–∂–∫–∏ —Å–µ—Ç–∏"""
        import socket
        
        original_connect = socket.socket.connect
        
        def slow_connect(self, address):
            time.sleep(delay_ms / 1000.0)
            return original_connect(self, address)
        
        socket.socket.connect = slow_connect
        return original_connect
    
    def simulate_random_failures(self, failure_rate=0.1):
        """–°–ª—É—á–∞–π–Ω—ã–µ –æ—Ç–∫–∞–∑—ã –∑–∞–ø—Ä–æ—Å–æ–≤"""
        original_request = requests.request
        
        def failing_request(*args, **kwargs):
            if random.random() < failure_rate:
                raise requests.ConnectionError("Chaos: Random failure")
            return original_request(*args, **kwargs)
        
        requests.request = failing_request
        return original_request

class TestChaosEngineering:
    
    def test_system_resilience_under_cpu_stress(self):
        """–¢–µ—Å—Ç–∏—Ä—É–µ–º —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã –ø–æ–¥ –Ω–∞–≥—Ä—É–∑–∫–æ–π CPU"""
        chaos = ChaosEngineer()
        
        with chaos.chaos_experiment("CPU Stress Test"):
            # –ó–∞–ø—É—Å–∫–∞–µ–º –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ CPU
            stress_threads = chaos.simulate_high_cpu_load(duration=30)
            
            # –¢–µ—Å—Ç–∏—Ä—É–µ–º —á—Ç–æ —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –æ—Ç–≤–µ—á–∞—Ç—å
            start_time = time.time()
            success_count = 0
            total_requests = 0
            
            while time.time() - start_time < 30:
                try:
                    response = requests.get(f"{chaos.base_url}/health", timeout=5)
                    if response.status_code == 200:
                        success_count += 1
                    total_requests += 1
                except requests.RequestException:
                    total_requests += 1
                
                time.sleep(1)
            
            # –ñ–¥–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç–æ–≤
            for thread in stress_threads:
                thread.join()
            
            # –°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ > 80% –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–∞–∂–µ –ø–æ–¥ –Ω–∞–≥—Ä—É–∑–∫–æ–π
            success_rate = success_count / total_requests if total_requests > 0 else 0
            assert success_rate > 0.8, f"Low success rate under CPU stress: {success_rate:.2%}"
    
    def test_system_recovery_after_memory_pressure(self):
        """–¢–µ—Å—Ç–∏—Ä—É–µ–º –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –ø–æ—Å–ª–µ –Ω–µ—Ö–≤–∞—Ç–∫–∏ –ø–∞–º—è—Ç–∏"""
        chaos = ChaosEngineer()
        
        with chaos.chaos_experiment("Memory Pressure Test"):
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –±–∞–∑–æ–≤—É—é —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å
            response = requests.get(f"{chaos.base_url}/health")
            assert response.status_code == 200
            
            # –°–æ–∑–¥–∞–µ–º –Ω–µ—Ö–≤–∞—Ç–∫—É –ø–∞–º—è—Ç–∏
            memory_hog = chaos.simulate_memory_pressure(size_mb=500)
            
            # –î–∞–µ–º —Å–∏—Å—Ç–µ–º–µ –≤—Ä–µ–º—è –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–µ—Ö–≤–∞—Ç–∫–∏ –ø–∞–º—è—Ç–∏
            time.sleep(10)
            
            # –û—Å–≤–æ–±–æ–∂–¥–∞–µ–º –ø–∞–º—è—Ç—å
            del memory_hog
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ —Å–∏—Å—Ç–µ–º–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏–ª–∞—Å—å
            time.sleep(5)  # –í—Ä–µ–º—è –Ω–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
            
            recovery_success = 0
            for attempt in range(10):
                try:
                    response = requests.get(f"{chaos.base_url}/health", timeout=10)
                    if response.status_code == 200:
                        recovery_success += 1
                except requests.RequestException:
                    pass
                time.sleep(1)
            
            # –°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è
            assert recovery_success >= 8, f"System didn't recover properly: {recovery_success}/10"
    
    def test_graceful_degradation_under_network_issues(self):
        """–¢–µ—Å—Ç–∏—Ä—É–µ–º graceful degradation –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å —Å–µ—Ç—å—é"""
        chaos = ChaosEngineer()
        
        with chaos.chaos_experiment("Network Latency Test"):
            # –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é
            original_connect = chaos.simulate_network_latency(delay_ms=2000)
            
            try:
                # –¢–µ—Å—Ç–∏—Ä—É–µ–º —á—Ç–æ —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –º–µ–¥–ª–µ–Ω–Ω–µ–µ
                start_time = time.time()
                response = requests.get(f"{chaos.base_url}/api/users", timeout=30)
                response_time = time.time() - start_time
                
                # –ó–∞–ø—Ä–æ—Å –¥–æ–ª–∂–µ–Ω –≤—ã–ø–æ–ª–Ω–∏—Ç—å—Å—è, –Ω–æ –¥–æ–ª—å—à–µ –æ–±—ã—á–Ω–æ–≥–æ
                assert response.status_code == 200
                assert response_time > 2.0  # –£—á–∏—Ç—ã–≤–∞–µ–º –¥–æ–±–∞–≤–ª–µ–Ω–Ω—É—é –∑–∞–¥–µ—Ä–∂–∫—É
                
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –∑–∞–¥–µ—Ä–∂–∫—É
                data = response.json()
                assert "users" in data or isinstance(data, list)
                
            finally:
                # –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é
                import socket
                socket.socket.connect = original_connect
    
    def test_circuit_breaker_behavior(self):
        """–¢–µ—Å—Ç–∏—Ä—É–µ–º –ø–æ–≤–µ–¥–µ–Ω–∏–µ circuit breaker –ø—Ä–∏ —Å–ª—É—á–∞–π–Ω—ã—Ö —Å–±–æ—è—Ö"""
        chaos = ChaosEngineer()
        
        with chaos.chaos_experiment("Random Failures Test"):
            # –ò–º–∏—Ç–∏—Ä—É–µ–º 50% –æ—Ç–∫–∞–∑–æ–≤
            original_request = chaos.simulate_random_failures(failure_rate=0.5)
            
            try:
                success_count = 0
                circuit_breaker_activated = False
                
                for attempt in range(20):
                    try:
                        response = requests.get(f"{chaos.base_url}/external-api", timeout=5)
                        if response.status_code == 200:
                            success_count += 1
                        elif response.status_code == 503:  # Service Unavailable
                            circuit_breaker_activated = True
                    except requests.RequestException:
                        # –û–∂–∏–¥–∞–µ–º—ã–µ –æ—à–∏–±–∫–∏ –∏–∑-–∑–∞ chaos
                        pass
                    
                    time.sleep(0.5)
                
                # Circuit breaker –¥–æ–ª–∂–µ–Ω —Å—Ä–∞–±–æ—Ç–∞—Ç—å –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–º –ø—Ä–æ—Ü–µ–Ω—Ç–µ –æ—à–∏–±–æ–∫
                assert circuit_breaker_activated, "Circuit breaker should activate under high failure rate"
                
            finally:
                requests.request = original_request
    
    def test_database_connection_pool_exhaustion(self):
        """–¢–µ—Å—Ç–∏—Ä—É–µ–º –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏ –∏—Å—á–µ—Ä–ø–∞–Ω–∏–∏ –ø—É–ª–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π —Å –ë–î"""
        chaos = ChaosEngineer()
        
        def create_long_running_query():
            """–°–æ–∑–¥–∞–µ—Ç –¥–æ–ª–≥–∏–π –∑–∞–ø—Ä–æ—Å –∫ –ë–î"""
            try:
                response = requests.post(f"{chaos.base_url}/admin/long-query", 
                                       json={"duration": 30})
                return response.status_code
            except requests.RequestException:
                return None
        
        with chaos.chaos_experiment("DB Pool Exhaustion"):
            # –ó–∞–ø—É—Å–∫–∞–µ–º –º–Ω–æ–≥–æ –¥–æ–ª–≥–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
            threads = []
            for _ in range(50):  # –ë–æ–ª—å—à–µ —á–µ–º —Ä–∞–∑–º–µ—Ä –ø—É–ª–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
                thread = threading.Thread(target=create_long_running_query)
                thread.start()
                threads.append(thread)
                time.sleep(0.1)
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –Ω–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è
            time.sleep(5)  # –î–∞–µ–º –≤—Ä–µ–º—è –Ω–∞ –∏—Å—á–µ—Ä–ø–∞–Ω–∏–µ –ø—É–ª–∞
            
            # –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—Ä–æ—Å –¥–æ–ª–∂–µ–Ω –ª–∏–±–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å—Å—è, –ª–∏–±–æ –≤–µ—Ä–Ω—É—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é –æ—à–∏–±–∫—É
            try:
                response = requests.get(f"{chaos.base_url}/health", timeout=10)
                # –õ–∏–±–æ —É—Å–ø–µ—Ö, –ª–∏–±–æ 503 (Service Unavailable)
                assert response.status_code in [200, 503]
                
                if response.status_code == 503:
                    error_data = response.json()
                    assert "database" in error_data.get("message", "").lower()
                    
            except requests.RequestException as e:
                # Timeout —Ç–æ–∂–µ –¥–æ–ø—É—Å—Ç–∏–º –ø—Ä–∏ –∏—Å—á–µ—Ä–ø–∞–Ω–∏–∏ –ø—É–ª–∞
                assert "timeout" in str(e).lower()
            
            # –ñ–¥–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –¥–æ–ª–≥–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
            for thread in threads:
                thread.join(timeout=1)

# –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –≤–æ –≤—Ä–µ–º—è chaos —Ç–µ—Å—Ç–æ–≤
class ChaosMonitor:
    """–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º—ã –≤–æ –≤—Ä–µ–º—è chaos —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤"""
    
    def __init__(self, base_url):
        self.base_url = base_url
        self.metrics = []
    
    def start_monitoring(self, duration=60):
        """–ó–∞–ø—É—Å–∫–∞–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è"""
        def monitor():
            start_time = time.time()
            while time.time() - start_time < duration:
                metric = self.collect_metrics()
                self.metrics.append(metric)
                time.sleep(1)
        
        thread = threading.Thread(target=monitor)
        thread.daemon = True
        thread.start()
        return thread
    
    def collect_metrics(self):
        """–°–æ–±–∏—Ä–∞–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ —Å–∏—Å—Ç–µ–º—ã"""
        try:
            start = time.time()
            response = requests.get(f"{self.base_url}/metrics", timeout=5)
            response_time = time.time() - start
            
            if response.status_code == 200:
                data = response.json()
                return {
                    "timestamp": time.time(),
                    "response_time": response_time,
                    "status": "ok",
                    "cpu_usage": data.get("cpu_usage", 0),
                    "memory_usage": data.get("memory_usage", 0),
                    "active_connections": data.get("active_connections", 0)
                }
        except Exception as e:
            return {
                "timestamp": time.time(),
                "status": "error",
                "error": str(e)
            }
    
    def analyze_metrics(self):
        """–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Å–æ–±—Ä–∞–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏"""
        if not self.metrics:
            return {}
        
        successful_metrics = [m for m in self.metrics if m.get("status") == "ok"]
        error_count = len([m for m in self.metrics if m.get("status") == "error"])
        
        if successful_metrics:
            avg_response_time = sum(m["response_time"] for m in successful_metrics) / len(successful_metrics)
            max_response_time = max(m["response_time"] for m in successful_metrics)
        else:
            avg_response_time = max_response_time = None
        
        return {
            "total_samples": len(self.metrics),
            "successful_samples": len(successful_metrics),
            "error_count": error_count,
            "error_rate": error_count / len(self.metrics),
            "avg_response_time": avg_response_time,
            "max_response_time": max_response_time
        }
```

---

## üéì –ú–æ–¥—É–ª—å 9: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ (2-3 –Ω–µ–¥–µ–ª–∏)

### üèõÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏

**–ü—Ä–∏–Ω—Ü–∏–ø—ã —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã:**
```
Dependency Injection ‚Üí –õ–µ–≥–∫–æ–µ –º–æ–∫–∏—Ä–æ–≤–∞–Ω–∏–µ
Single Responsibility ‚Üí –§–æ–∫—É—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã  
Interface Segregation ‚Üí –ù–µ–∑–∞–≤–∏—Å–∏–º—ã–µ —Ç–µ—Å—Ç—ã
Hexagonal Architecture ‚Üí –ò–∑–æ–ª—è—Ü–∏—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏
```

**Python –ø—Ä–∏–º–µ—Ä Hexagonal Architecture:**
    