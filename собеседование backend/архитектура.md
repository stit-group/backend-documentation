# üèóÔ∏è –ë–ª–æ–∫ –∏–Ω—Ç–µ—Ä–≤—å—é: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Backend-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π

*–¶–µ–ª—å: –û—Ü–µ–Ω–∏—Ç—å –≥–ª—É–±–∏–Ω—É –ø–æ–Ω–∏–º–∞–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤, –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —á–∏—Å—Ç–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã, –∑–Ω–∞–Ω–∏–µ SOLID, DI –∏ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –∫ —Å–∏—Å—Ç–µ–º–Ω–æ–º—É –º—ã—à–ª–µ–Ω–∏—é*

---

## üìÅ 1. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ –∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –∫–æ–¥–∞

### –í–æ–ø—Ä–æ—Å 1.1: –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
**–ó–∞–¥–∞—á–∞:** –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ —ç—Ç—É —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–∞–ø–æ–∫ Go-–ø—Ä–æ–µ–∫—Ç–∞. –û–±—ä—è—Å–Ω–∏—Ç–µ, –∫–∞–∫–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã –∑–¥–µ—Å—å –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –∏ –ø–æ—á–µ–º—É —Ç–∞–∫–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è —Å—á–∏—Ç–∞–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π?

```
project/
‚îú‚îÄ‚îÄ infrastructure/
‚îÇ   ‚îú‚îÄ‚îÄ pg/
‚îÇ   ‚îú‚îÄ‚îÄ telemetry/
‚îÇ   ‚îî‚îÄ‚îÄ wa-device-db/
‚îú‚îÄ‚îÄ internal/
‚îÇ   ‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îú‚îÄ‚îÄ controller/
‚îÇ   ‚îú‚îÄ‚îÄ model/
‚îÇ   ‚îú‚îÄ‚îÄ repo/
‚îÇ   ‚îî‚îÄ‚îÄ service/
‚îú‚îÄ‚îÄ pkg/
‚îÇ   ‚îî‚îÄ‚îÄ client/
‚îÇ       ‚îú‚îÄ‚îÄ external/
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ amocrm/
‚îÇ       ‚îî‚îÄ‚îÄ internal/
‚îú‚îÄ‚îÄ go.mod
‚îî‚îÄ‚îÄ main.go
```

**–ß—Ç–æ –∏—â–µ–º –≤ –æ—Ç–≤–µ—Ç–µ:**
- –ü–æ–Ω–∏–º–∞–Ω–∏–µ Clean Architecture —Å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –Ω–∞ —Å–ª–æ–∏ –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø—É "–ª—É–∫–æ–≤–∏—Ü—ã" - –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Å–ª–æ–∏ –Ω–µ –∑–∞–≤–∏—Å—è—Ç –æ—Ç –≤–Ω–µ—à–Ω–∏—Ö
- –û–±—ä—è—Å–Ω–µ–Ω–∏–µ purpose –∫–∞–∂–¥–æ–≥–æ —Å–ª–æ—è:
  - `infrastructure/` - –≤–Ω–µ—à–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–ë–î, —Ç–µ–ª–µ–º–µ—Ç—Ä–∏—è)
  - `internal/` - –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
  - `pkg/` - –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- –£–ø–æ–º–∏–Ω–∞–Ω–∏–µ –ø—Ä–∞–≤–∏–ª–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π: "—Ç–æ–ª—å–∫–æ –≤–Ω–µ—à–Ω–∏–µ —Å–ª–æ–∏ –º–æ–≥—É—Ç –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö"

**–ü–æ–¥—Å–∫–∞–∑–∫–∏ –¥–ª—è –æ—Ü–µ–Ω–∫–∏:**
- ‚≠ê **–û—Ç–ª–∏—á–Ω–æ:** –û–±—ä—è—Å–Ω—è–µ—Ç Clean Architecture, –ø—Ä–∞–≤–∏–ª–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π, —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ concerns
- ‚≠ê **–•–æ—Ä–æ—à–æ:** –ü–æ–Ω–∏–º–∞–µ—Ç –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø–∞–ø–æ–∫, –Ω–æ –Ω–µ—Ç —É–ø–æ–º–∏–Ω–∞–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤
- ‚≠ê **–°–ª–∞–±–æ:** –ü–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –±–µ–∑ –ø–æ–Ω–∏–º–∞–Ω–∏—è –∑–∞—á–µ–º —Ç–∞–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

---

### –í–æ–ø—Ä–æ—Å 1.2: –≠–≤–æ–ª—é—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
**–ó–∞–¥–∞—á–∞:** –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ –ø—Ä–æ–µ–∫—Ç —Ä–∞—Å—Ç–µ—Ç. –ö–∞–∫ –±—ã –≤—ã —Ä–µ–æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–ª–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –¥–æ–º–µ–Ω–æ–≤ (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –∑–∞–∫–∞–∑—ã, –ø–ª–∞—Ç–µ–∂–∏)?

**–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:**
```
project/
‚îú‚îÄ‚îÄ cmd/
‚îÇ   ‚îî‚îÄ‚îÄ server/
‚îú‚îÄ‚îÄ internal/
‚îÇ   ‚îú‚îÄ‚îÄ domain/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ entity/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ repository/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ service/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ handler/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ order/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ payment/
‚îÇ   ‚îú‚îÄ‚îÄ infrastructure/
‚îÇ   ‚îî‚îÄ‚îÄ shared/
‚îî‚îÄ‚îÄ pkg/
```

**–ß—Ç–æ –∏—â–µ–º:**
- Domain-driven —Å—Ç—Ä—É–∫—Ç—É—Ä—É - –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é –∫–æ–¥–∞ –≤–æ–∫—Ä—É–≥ –±–∏–∑–Ω–µ—Å-–¥–æ–º–µ–Ω–æ–≤
- –ü–æ–Ω–∏–º–∞–Ω–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø–∞ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–π –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ –º–æ–¥—É–ª–µ–π
- –í—ã–¥–µ–ª–µ–Ω–∏–µ shared –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

---

## üîó 2. SOLID –ø—Ä–∏–Ω—Ü–∏–ø—ã –∏ –∏—Ö –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ

### –í–æ–ø—Ä–æ—Å 2.1: Single Responsibility Principle (SRP)
**–ó–∞–¥–∞—á–∞:** –ù–∞–π–¥–∏—Ç–µ –Ω–∞—Ä—É—à–µ–Ω–∏—è SRP –≤ —ç—Ç–æ–º –∫–æ–¥–µ –∏ –ø—Ä–µ–¥–ª–æ–∂–∏—Ç–µ —Ä–µ—à–µ–Ω–∏–µ:

```go
type UserService struct {
    db *sql.DB
}

func (s *UserService) CreateUser(user User) error {
    // –í–∞–ª–∏–¥–∞—Ü–∏—è
    if len(user.Email) == 0 {
        return errors.New("email required")
    }
    
    // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
    log.Printf("Creating user: %s", user.Email)
    
    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î
    _, err := s.db.Exec("INSERT INTO users...", user.Name, user.Email)
    if err != nil {
        return err
    }
    
    // –û—Ç–ø—Ä–∞–≤–∫–∞ email
    smtp.SendWelcomeEmail(user.Email)
    
    return nil
}
```

**–ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ:**
```go
type UserService struct {
    repo UserRepository
    validator UserValidator
    logger Logger
    emailSender EmailSender
}

func (s *UserService) CreateUser(user User) error {
    if err := s.validator.Validate(user); err != nil {
        return err
    }
    
    s.logger.Info("Creating user", "email", user.Email)
    
    if err := s.repo.Save(user); err != nil {
        return err
    }
    
    s.emailSender.SendWelcome(user.Email)
    return nil
}
```

**–ß—Ç–æ –∏—â–µ–º:**
- –ü–æ–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –∫–ª–∞—Å—Å –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–Ω—É –ø—Ä–∏—á–∏–Ω—É –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è
- –í—ã–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–µ–π: –≤–∞–ª–∏–¥–∞—Ü–∏—è, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ dependency injection

---

### –í–æ–ø—Ä–æ—Å 2.2: Dependency Inversion Principle (DIP)
**–ó–∞–¥–∞—á–∞:** –û–±—ä—è—Å–Ω–∏—Ç–µ, —á—Ç–æ –Ω–µ —Ç–∞–∫ —Å —ç—Ç–∏–º –∫–æ–¥–æ–º –∏ –∫–∞–∫ –∏—Å–ø—Ä–∞–≤–∏—Ç—å:

```go
type OrderService struct {
    db *PostgreSQLDB // –ø—Ä–æ–±–ª–µ–º–∞ –∑–¥–µ—Å—å
}

func (s *OrderService) CreateOrder(order Order) error {
    return s.db.SaveOrder(order)
}
```

**–ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ:**
```go
type OrderRepository interface {
    Save(order Order) error
    FindByID(id string) (*Order, error)
}

type OrderService struct {
    repo OrderRepository // –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏
}

func (s *OrderService) CreateOrder(order Order) error {
    return s.repo.Save(order)
}

// –†–µ–∞–ª–∏–∑–∞—Ü–∏—è
type PostgreSQLOrderRepository struct {
    db *sql.DB
}

func (r *PostgreSQLOrderRepository) Save(order Order) error {
    // implementation
}
```

**–ß—Ç–æ –∏—â–µ–º:**
- –ü–æ–Ω–∏–º–∞–Ω–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø–∞: "–≤—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ –º–æ–¥—É–ª–∏ –Ω–µ –¥–æ–ª–∂–Ω—ã –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã—Ö, –æ–±–∞ –¥–æ–ª–∂–Ω—ã –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–π"
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ –¥–ª—è –æ–±—Ä–∞—â–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- –£–ø–æ–º–∏–Ω–∞–Ω–∏–µ —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏ –∏ –≥–∏–±–∫–æ—Å—Ç–∏

---

## üîå 3. Dependency Injection

### –í–æ–ø—Ä–æ—Å 3.1: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è DI –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
**–ó–∞–¥–∞—á–∞:** –°–ø—Ä–æ–µ–∫—Ç–∏—Ä—É–π—Ç–µ –ø—Ä–æ—Å—Ç–æ–π DI –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è Go. –ö–∞–∫ –±—ã –≤—ã —Ä–µ—à–∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—É —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π?

**–û–∂–∏–¥–∞–µ–º–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–∞:**
```go
type Container struct {
    services map[reflect.Type]interface{}
    factories map[reflect.Type]func(*Container) interface{}
}

func (c *Container) Register(factory func(*Container) interface{}) {
    // —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ñ–∞–±—Ä–∏–∫–∏
}

func (c *Container) Resolve(target interface{}) error {
    // —Ä–µ–∑–æ–ª–≤–∏–Ω–≥ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
}
```

**–ß—Ç–æ –∏—â–µ–º:**
- –ü–æ–Ω–∏–º–∞–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ DI: Constructor, Setter, Interface injection
- –ó–Ω–∞–Ω–∏–µ, —á—Ç–æ DI —É–ª—É—á—à–∞–µ—Ç —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å, –º–æ–¥—É–ª—å–Ω–æ—Å—Ç—å –∏ —Å–æ–ø—Ä–æ–≤–æ–∂–¥–∞–µ–º–æ—Å—Ç—å
- –ü–æ–¥—Ö–æ–¥—ã –∫ —Ä–µ—à–µ–Ω–∏—é —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (lazy loading, –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã-–ø—Ä–æ—Å–ª–æ–π–∫–∏)

---

### –í–æ–ø—Ä–æ—Å 3.2: DI –≤ —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ
**–ó–∞–¥–∞—á–∞:** –ü–æ–∫–∞–∂–∏—Ç–µ, –∫–∞–∫ –±—ã –≤—ã –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–ª–∏ DI –¥–ª—è –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞ —Å –ë–î, –∫–µ—à–µ–º –∏ –≤–Ω–µ—à–Ω–∏–º API.

**–ü—Ä–∏–º–µ—Ä —Ä–µ—à–µ–Ω–∏—è:**
```go
type Dependencies struct {
    DB     Database
    Cache  Cache
    Logger Logger
    Config Config
}

func NewDependencies() *Dependencies {
    config := LoadConfig()
    logger := NewLogger(config.LogLevel)
    db := NewDatabase(config.DatabaseURL)
    cache := NewRedisCache(config.RedisURL)
    
    return &Dependencies{
        DB:     db,
        Cache:  cache,
        Logger: logger,
        Config: config,
    }
}

func (d *Dependencies) NewUserService() *UserService {
    return &UserService{
        repo:   NewUserRepository(d.DB),
        cache:  d.Cache,
        logger: d.Logger,
    }
}
```

**–ß—Ç–æ –∏—â–µ–º:**
- –ü–æ–Ω–∏–º–∞–Ω–∏–µ composition root pattern
- –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π lifecycle —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
- –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏ runtime –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

---

## üîÑ 4. –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ

### –í–æ–ø—Ä–æ—Å 4.1: Event-Driven Architecture
**–ó–∞–¥–∞—á–∞:** –°–ø—Ä–æ–µ–∫—Ç–∏—Ä—É–π—Ç–µ —Å–∏—Å—Ç–µ–º—É –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–∫–∞–∑–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–æ–±—ã—Ç–∏–π–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã. –ö–∞–∫–∏–µ —Å–æ–±—ã—Ç–∏—è –±—É–¥–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?

**–û–∂–∏–¥–∞–µ–º—ã–π –¥–∏–∑–∞–π–Ω:**
```go
// –°–æ–±—ã—Ç–∏—è
type OrderCreated struct {
    OrderID   string
    UserID    string
    Amount    decimal.Decimal
    Timestamp time.Time
}

type PaymentProcessed struct {
    OrderID       string
    TransactionID string
    Status        PaymentStatus
}

type OrderShipped struct {
    OrderID      string
    TrackingCode string
}

// Event Bus
type EventBus interface {
    Publish(event interface{}) error
    Subscribe(eventType reflect.Type, handler EventHandler) error
}

// Handlers
type OrderEventHandler struct {
    orderService   OrderService
    paymentService PaymentService
    shippingService ShippingService
}

func (h *OrderEventHandler) HandleOrderCreated(event OrderCreated) error {
    return h.paymentService.ProcessPayment(event.OrderID, event.Amount)
}
```

**–ß—Ç–æ –∏—â–µ–º:**
- –ü–æ–Ω–∏–º–∞–Ω–∏–µ publish-subscribe –ø–∞—Ç—Ç–µ—Ä–Ω–∞ –∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏
- –ó–Ω–∞–Ω–∏–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤ EDA: loose coupling, scalability, resilience
- –ü–æ–Ω–∏–º–∞–Ω–∏–µ eventual consistency –∏ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏

---

### –í–æ–ø—Ä–æ—Å 4.2: –ü–∞—Ç—Ç–µ—Ä–Ω—ã –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
**–ó–∞–¥–∞—á–∞:** –ö–∞–∫ –æ–±–µ—Å–ø–µ—á–∏—Ç—å –Ω–∞–¥–µ–∂–Ω—É—é –¥–æ—Å—Ç–∞–≤–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π –≤ event-driven —Å–∏—Å—Ç–µ–º–µ? –ö–∞–∫–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ?

**–û–∂–∏–¥–∞–µ–º—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã:**
1. **At-least-once delivery** —Å –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å—é
2. **Outbox pattern** –¥–ª—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ–π –≥–∞—Ä–∞–Ω—Ç–∏–∏
3. **Circuit breaker** –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –∫–∞—Å–∫–∞–¥–Ω—ã—Ö –æ—Ç–∫–∞–∑–æ–≤
4. **Retry with exponential backoff**

```go
type OutboxEvent struct {
    ID        string
    EventType string
    Payload   json.RawMessage
    CreatedAt time.Time
    Published bool
}

func (s *OrderService) CreateOrder(order Order) error {
    tx, err := s.db.Begin()
    if err != nil {
        return err
    }
    defer tx.Rollback()
    
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∑–∞–∫–∞–∑
    if err := s.repo.SaveWithTx(tx, order); err != nil {
        return err
    }
    
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–æ–±—ã—Ç–∏–µ –≤ outbox
    event := OutboxEvent{
        EventType: "OrderCreated",
        Payload:   marshal(OrderCreated{OrderID: order.ID}),
    }
    if err := s.outboxRepo.SaveWithTx(tx, event); err != nil {
        return err
    }
    
    return tx.Commit()
}
```

**–ß—Ç–æ –∏—â–µ–º:**
- –ü–æ–Ω–∏–º–∞–Ω–∏–µ guaranteed delivery pattern –∏ –º–µ—Ö–∞–Ω–∏–∑–º–æ–≤ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
- –ó–Ω–∞–Ω–∏–µ ACID properties –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö
- –ü–æ–Ω–∏–º–∞–Ω–∏–µ trade-offs –º–µ–∂–¥—É consistency –∏ availability

---

## üèõÔ∏è 5. –û–±—ä–µ–∫—Ç–Ω–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –º—ã—à–ª–µ–Ω–∏–µ

### –í–æ–ø—Ä–æ—Å 5.1: Domain Modeling
**–ó–∞–¥–∞—á–∞:** –°–º–æ–¥–µ–ª–∏—Ä—É–π—Ç–µ –¥–æ–º–µ–Ω –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–∞. –ö–∞–∫–∏–µ —Å—É—â–Ω–æ—Å—Ç–∏ –∏ value objects –≤—ã–¥–µ–ª–∏—Ç–µ?

**–û–∂–∏–¥–∞–µ–º–∞—è –º–æ–¥–µ–ª—å:**
```go
// Entities (–∏–º–µ—é—Ç –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å)
type User struct {
    ID    UserID
    Email EmailAddress
    Profile UserProfile
}

type Order struct {
    ID       OrderID
    UserID   UserID
    Items    []OrderItem
    Status   OrderStatus
    Total    Money
    metadata OrderMetadata
}

// Value Objects (–Ω–µ–∏–∑–º–µ–Ω—è–µ–º—ã–µ, —Å—Ä–∞–≤–Ω–∏–≤–∞—é—Ç—Å—è –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é)
type Money struct {
    Amount   decimal.Decimal
    Currency string
}

func (m Money) Add(other Money) (Money, error) {
    if m.Currency != other.Currency {
        return Money{}, errors.New("currency mismatch")
    }
    return Money{
        Amount:   m.Amount.Add(other.Amount),
        Currency: m.Currency,
    }, nil
}

type EmailAddress struct {
    value string
}

func NewEmailAddress(email string) (EmailAddress, error) {
    if !isValidEmail(email) {
        return EmailAddress{}, errors.New("invalid email")
    }
    return EmailAddress{value: email}, nil
}

// Domain Services
type PricingService interface {
    CalculateTotal(items []OrderItem, discounts []Discount) Money
    ApplyTax(amount Money, taxRate decimal.Decimal) Money
}
```

**–ß—Ç–æ –∏—â–µ–º:**
- –ü–æ–Ω–∏–º–∞–Ω–∏–µ —Ä–∞–∑–Ω–∏—Ü—ã –º–µ–∂–¥—É Entity –∏ Value Object
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Value Objects –¥–ª—è –∏–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏–∏ –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤–∞–ª—é—Ç–∞ –≤ —Ü–µ–Ω–µ)
- –í—ã–¥–µ–ª–µ–Ω–∏–µ Domain Services –¥–ª—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏
- Immutability –∏ defensive copying

---

### –í–æ–ø—Ä–æ—Å 5.2: Aggregate –∏ Repository
**–ó–∞–¥–∞—á–∞:** –ö–∞–∫ –±—ã –≤—ã —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–ª–∏ Aggregate –¥–ª—è Order —Å OrderItems? –ü–æ–∫–∞–∂–∏—Ç–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π Repository.

**–†–µ—à–µ–Ω–∏–µ:**
```go
// Aggregate Root
type Order struct {
    id     OrderID
    userID UserID
    items  []OrderItem
    status OrderStatus
    
    // domain events
    events []DomainEvent
}

func (o *Order) AddItem(product Product, quantity int) error {
    if o.status != OrderStatusDraft {
        return errors.New("cannot modify confirmed order")
    }
    
    item := OrderItem{
        ProductID: product.ID(),
        Quantity:  quantity,
        Price:     product.Price(),
    }
    
    o.items = append(o.items, item)
    o.addEvent(OrderItemAdded{OrderID: o.id, Item: item})
    return nil
}

func (o *Order) Confirm() error {
    if len(o.items) == 0 {
        return errors.New("cannot confirm empty order")
    }
    
    o.status = OrderStatusConfirmed
    o.addEvent(OrderConfirmed{OrderID: o.id})
    return nil
}

// Repository —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å Aggregate Root
type OrderRepository interface {
    Save(order *Order) error
    FindByID(id OrderID) (*Order, error)
    FindByUserID(userID UserID) ([]*Order, error)
}
```

**–ß—Ç–æ –∏—â–µ–º:**
- –ü–æ–Ω–∏–º–∞–Ω–∏–µ Aggregate –∫–∞–∫ –≥—Ä–∞–Ω–∏—Ü—ã consistency
- Repository —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å Aggregate Root
- Domain Events –¥–ª—è –º–µ–∂–∞–≥—Ä–µ–≥–∞—Ç–Ω–æ–π –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏
- –ò–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—è –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª –≤–Ω—É—Ç—Ä–∏ Aggregate

---

## üß™ 6. –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏

### –í–æ–ø—Ä–æ—Å 6.1: –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –º–æ–Ω–æ–ª–∏—Ç–∞
**–ó–∞–¥–∞—á–∞:** –£ –≤–∞—Å –µ—Å—Ç—å –±–æ–ª—å—à–æ–π –º–µ—Ç–æ–¥ –≤ 200 —Å—Ç—Ä–æ–∫, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–∑–¥–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç email, –ª–æ–≥–∏—Ä—É–µ—Ç, –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É. –ö–∞–∫ —Ä–∞–∑–±–∏—Ç—å –Ω–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã?

**–ü–æ–¥—Ö–æ–¥ –∫ —Ä–µ—à–µ–Ω–∏—é:**
1. **–í—ã–¥–µ–ª–∏—Ç—å Use Case:** `CreateUserUseCase`
2. **–†–∞–∑–¥–µ–ª–∏—Ç—å –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏:** Validation, Persistence, Notification, Analytics
3. **–ü—Ä–∏–º–µ–Ω–∏—Ç—å Chain of Responsibility –∏–ª–∏ Pipeline pattern**

```go
type CreateUserUseCase struct {
    pipeline Pipeline[CreateUserRequest, CreateUserResponse]
}

type Pipeline[TRequest, TResponse any] struct {
    steps []PipelineStep[TRequest, TResponse]
}

type ValidationStep struct {
    validator UserValidator
}

func (s *ValidationStep) Execute(ctx context.Context, req CreateUserRequest) error {
    return s.validator.Validate(req.User)
}

type PersistenceStep struct {
    repo UserRepository
}

type NotificationStep struct {
    emailSender EmailSender
}

type AnalyticsStep struct {
    analytics AnalyticsService
}
```

**–ß—Ç–æ –∏—â–µ–º:**
- –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ Single Responsibility Principle
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –¥–ª—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ —Å–ª–æ–∂–Ω–æ–π –ª–æ–≥–∏–∫–∏
- –ü–æ–Ω–∏–º–∞–Ω–∏–µ separation of concerns

---

### –í–æ–ø—Ä–æ—Å 6.2: Performance –∏ Scalability
**–ó–∞–¥–∞—á–∞:** –°–∏—Å—Ç–µ–º–∞ —Å—Ç–∞–ª–∞ –º–µ–¥–ª–µ–Ω–Ω–æ –æ—Ç–≤–µ—á–∞—Ç—å. –ö–∞–∫ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É?

**–ü–ª–∞–Ω –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:**
1. **Observability:** –ú–µ—Ç—Ä–∏–∫–∏, –ª–æ–≥–∏, —Ç—Ä–µ–π—Å–∏–Ω–≥
2. **Bottleneck analysis:** CPU, Memory, I/O, Network
3. **Architecture patterns:**
   - Caching (Redis, Memcached) –¥–ª—è —á–∞—Å—Ç–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö
   - Read replicas –¥–ª—è —á—Ç–µ–Ω–∏—è
   - Load balancing –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–∞–≥—Ä—É–∑–∫–∏
   - Event sourcing –¥–ª—è –∞—É–¥–∏—Ç–∞
   - CQRS –¥–ª—è —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è read/write –æ–ø–µ—Ä–∞—Ü–∏–π

**–ß—Ç–æ –∏—â–µ–º:**
- –°–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–¥—Ö–æ–¥ –∫ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –ó–Ω–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –¥–ª—è —Å–∫–µ–π–ª–∏–Ω–≥–∞
- –ü–æ–Ω–∏–º–∞–Ω–∏–µ trade-offs —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π

---

## üìã –ö—Ä–∏—Ç–µ—Ä–∏–∏ –æ—Ü–µ–Ω–∫–∏

### üéØ –°–∏—Å—Ç–µ–º–Ω–æ–µ –º—ã—à–ª–µ–Ω–∏–µ
- **–û—Ç–ª–∏—á–Ω–æ:** –í–∏–¥–∏—Ç —Å–∏—Å—Ç–µ–º—É —Ü–µ–ª–∏–∫–æ–º, –ø–æ–Ω–∏–º–∞–µ—Ç –≤–∑–∞–∏–º–æ—Å–≤—è–∑–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- **–•–æ—Ä–æ—à–æ:** –ü–æ–Ω–∏–º–∞–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–µ —á–∞—Å—Ç–∏, –Ω–æ –º–æ–∂–µ—Ç —É–ø—É—Å–∫–∞—Ç—å –æ–±—â—É—é –∫–∞—Ä—Ç–∏–Ω—É
- **–¢—Ä–µ–±—É–µ—Ç —Ä–∞–∑–≤–∏—Ç–∏—è:** –§–æ–∫—É—Å–∏—Ä—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –¥–µ—Ç–∞–ª—è—Ö

### üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã
- **–û—Ç–ª–∏—á–Ω–æ:** –ó–Ω–∞–µ—Ç –∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç Clean Architecture, SOLID, DDD
- **–•–æ—Ä–æ—à–æ:** –ó–Ω–∞–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø—ã, –Ω–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ç—Ä–µ–±—É–µ—Ç —É—Ç–æ—á–Ω–µ–Ω–∏–π
- **–¢—Ä–µ–±—É–µ—Ç —Ä–∞–∑–≤–∏—Ç–∏—è:** –ü–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω–æ–µ –∑–Ω–∞–Ω–∏–µ –±–µ–∑ –ø–æ–Ω–∏–º–∞–Ω–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è

### üîß –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –Ω–∞–≤—ã–∫–∏
- **–û—Ç–ª–∏—á–Ω–æ:** –ú–æ–∂–µ—Ç —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–ª–æ–∂–Ω—É—é —Å–∏—Å—Ç–µ–º—É
- **–•–æ—Ä–æ—à–æ:** –°–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å —Ç–∏–ø–æ–≤—ã–º–∏ –∑–∞–¥–∞—á–∞–º–∏
- **–¢—Ä–µ–±—É–µ—Ç —Ä–∞–∑–≤–∏—Ç–∏—è:** –ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å –≤ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏

### üí≠ –û–±—ä–µ–∫—Ç–Ω–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –º—ã—à–ª–µ–Ω–∏–µ
- **–û—Ç–ª–∏—á–Ω–æ:** –ú—ã—Å–ª–∏—Ç –≤ —Ç–µ—Ä–º–∏–Ω–∞—Ö –æ–±—ä–µ–∫—Ç–æ–≤, —Å—É—â–Ω–æ—Å—Ç–µ–π, –¥–æ–º–µ–Ω–æ–≤
- **–•–æ—Ä–æ—à–æ:** –ü–æ–Ω–∏–º–∞–µ—Ç –û–û–ü, –Ω–æ –Ω–µ –≤—Å–µ–≥–¥–∞ –ø—Ä–∏–º–µ–Ω—è–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ
- **–¢—Ä–µ–±—É–µ—Ç —Ä–∞–∑–≤–∏—Ç–∏—è:** –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ –ø—Ä–æ—Ü–µ–¥—É—Ä–Ω–æ–µ –º—ã—à–ª–µ–Ω–∏–µ

---

## üéì –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–µ–º—ã –¥–ª—è –≥–ª—É–±–æ–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏

### Event Sourcing
```go
type EventStore interface {
    SaveEvents(aggregateID string, events []DomainEvent, expectedVersion int) error
    GetEvents(aggregateID string) ([]DomainEvent, error)
}

type UserAggregate struct {
    id      string
    version int
    events  []DomainEvent
}

func (a *UserAggregate) Apply(event DomainEvent) {
    switch e := event.(type) {
    case UserCreated:
        a.id = e.UserID
    case UserEmailChanged:
        // apply changes
    }
    a.version++
}
```

### Hexagonal Architecture
```go
// Ports (interfaces)
type UserService interface {
    CreateUser(user User) error
}

type UserRepository interface {
    Save(user User) error
}

// Adapters
type HTTPUserHandler struct {
    userService UserService
}

type PostgreSQLUserRepository struct {
    db *sql.DB
}
```

**–ò—Ç–æ–≥–æ–≤–∞—è —Ü–µ–ª—å:** –ö–∞–Ω–¥–∏–¥–∞—Ç –¥–æ–ª–∂–µ–Ω –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–µ –ø—Ä–æ—Å—Ç–æ –∑–Ω–∞–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤, –∞ –ø–æ–Ω–∏–º–∞–Ω–∏–µ *–∑–∞—á–µ–º* –∏ *–∫–æ–≥–¥–∞* –∏—Ö –ø—Ä–∏–º–µ–Ω—è—Ç—å, —É–º–µ–Ω–∏–µ –≤–∏–¥–µ—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –∫–∞–∫ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —Ä–µ—à–µ–Ω–∏—è –±–∏–∑–Ω–µ—Å-–∑–∞–¥–∞—á.